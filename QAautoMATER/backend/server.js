(()=>{var a={24:(a,t,e)=>{const i=e(7252).Router(),{readGmailInbox:r}=e(1751);i.post("/email",async(a,t)=>{var e={isSuccess:!1,errorMessage:""};try{await r("qabunch@gmail.com","August@25")}catch(a){e.errorMessage=a.toString()}t.json(await e)}),a.exports=i},382:(a,t,e)=>{const i=e(8938),r=e(6928),s=e(9896);var n=e(2305);const w=e(5692),o=i.create({httpsAgent:new w.Agent({rejectUnauthorized:!1})});async function c(){return{status:"This site can’t be reached",headers:{error:"server is unreachable,meanwhile you can see more QAAutoMATER features on https://qaautomater.vercel.app/"},data:{error:"When nothing works out you need a short break, if still not working then its time to review from that start."}}}a.exports={get:async function(a,t,e){var i;try{let s={headers:await t};try{if(void 0!==await e&&""!==await e){var r=await typeof await e;"object"===await r&&await Object.keys(await e).length>0&&(s.auth=await e)}}catch(a){}i=await o.get(await a,await s)}catch(a){void 0!==await a.message?(i=await a.response,void 0===await i&&(i=await a.message)):i=await c()}return await i},post:async function(a,t,e,i){var w;try{let c={headers:await t};try{if(void 0!==await i&&""!==await i){var u=await typeof await i;"object"===await u&&await Object.keys(await i).length>0&&(c.auth=await i)}}catch(a){}try{var l=!1,d=await t["Content-Type"];if(void 0===await d&&(d=await t["content-type"]),void 0!==await d&&(d=await d.toString().toLocaleLowerCase(),await d.includes("multipart")&&(l=!0),await l)){var p=new n,m=await Object.keys(await e);for(let a=0;a<await m.length;a++){var v=await m[a],g=await e[await v],h=!1;try{h=await Array.isArray(await g)}catch(a){h=!1}if(await h)for(let a=0;a<await g.length;a++){var f=await r.resolve(await g[a]);s.existsSync(await f)&&""!==await await g[a].toString().trim()?await p.append(await v,await s.createReadStream(await f)):await p.append(await v,await g[a])}else f=await r.resolve(await g),s.existsSync(await f)&&""!==await g.toString().trim()?await p.append(await v,await s.createReadStream(await f)):await p.append(await v,await g)}e=await p}}catch(a){console.log(a)}w=await o.post(await a,await e,await c)}catch(a){void 0!==await a.message?(w=await a.response,void 0===await w&&(w=await a.message)):w=await c()}return await w},put:async function(a,t,e,i){var r;try{let n={headers:await t};try{if(void 0!==await i&&""!==await i){var s=await typeof await i;"object"===await s&&await Object.keys(await i).length>0&&(n.auth=await i)}}catch(a){}r=await o.put(await a,await e,await n)}catch(a){void 0!==await a.message?(r=await a.response,void 0===await r&&(r=await a.message)):r=await c()}return await r},patch:async function(a,t,e,i){var r;try{let n={headers:await t};try{if(void 0!==await i&&""!==await i){var s=await typeof await i;"object"===await s&&await Object.keys(await i).length>0&&(n.auth=await i)}}catch(a){}r=await o.patch(await a,await e,await n)}catch(a){void 0!==await a.message?(r=await a.response,void 0===await r&&(r=await a.message)):r=await c()}return await r},Delete:async function(a,t,e){var i;try{let s={headers:await t};try{if(void 0!==await e&&""!==await e){var r=await typeof await e;"object"===await r&&await Object.keys(await e).length>0&&(s.auth=await e)}}catch(a){}i=await o.delete(await a,await s)}catch(a){void 0!==await a.message?(i=await a.response,void 0===await i&&(i=await a.message)):i=await c()}return await i},head:async function(a,t,e){var i;try{let s={headers:await t};try{if(void 0!==await e&&""!==await e){var r=await typeof await e;"object"===await r&&await Object.keys(await e).length>0&&(s.auth=await e)}}catch(a){}i=await o.head(await a,await s)}catch(a){void 0!==await a.message?(i=await a.response,void 0===await i&&(i=await a.message)):i=await c()}return await i},options:async function(a,t,e){var i;try{let s={headers:await t};try{if(void 0!==await e&&""!==await e){var r=await typeof await e;"object"===await r&&await Object.keys(await e).length>0&&(s.auth=await e)}}catch(a){}i=await o.options(await a,await s)}catch(a){void 0!==await a.message?(i=await a.response,void 0===await i&&(i=await a.message)):i=await c()}return await i}}},416:a=>{"use strict";a.exports=require("pdf-parse")},473:(a,t,e)=>{const i=e(7252).Router(),r="./dataHub/",{authCheck:s}=e(2258),n=e(2410),w=e(9896),o=e(3618);async function c(a){var t=[],e=[];try{var i=await async function(a){try{var t=[];return t=await a.split("\n"),1===await t.length&&(await t[0].toLocaleLowerCase().includes("not")||await t[0].toLocaleLowerCase().includes("n/a"))?[]:await t}catch(a){}return await t}(await a);if(await i.length>0)for(let a=0;a<await i.length;a++){var r=await i[a].toString().toLocaleLowerCase();r=await r.toString().replace("fields",""),r=await r.toString().replace("combinations",""),r=await r.toString().replace("combination","");var s=await r;if(await r.includes(":")){s=await r.split(":")[0].trim();var n=await r.split(":")[1].trim();e.push(await n)}else await r.includes("-")&&(s=await r.split("-")[0].trim(),n=await r.split("-")[1].trim(),e.push(await n));const m=await s.match(/[a-zA-Z]+/g);s=await m?await m.join(" "):"";var w=await u(await s),o=await l(await s),c=await d(await w,o);for(let a=0;a<await c.length;a++){var p=await c[a].toString().toUpperCase().trim();const e=await p.match(/[a-zA-Z]+/g);p=await e?await e.join(" "):"",await t.includes(await p)||t.push(await p)}}}catch(a){}return await{output:t,valuedata:e}}async function u(a){const t=await o(await a);return await t.match("#Noun").out("array")}async function l(a){const t=await o(await a);return await t.match("#Pronoun").out("array")}async function d(a,t){if(0===await t.length)return await a;for(let i=0;i<await t.length;i++){var e=await t[i];if(await a.includes(await e)){const t=await a.indexOf(await e);await t>-1&&await a.splice(t,1)}}return await a}i.post("/project/:projectName/gettestinfo",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var o={errorMessage:"",isExistingTestScript:!1,component:"",testId:"",testName:"",listOfTestSteps:[],dependentCustomFunction:[],testDataTableHeader:[],listOfTestScriptData:[],manualTestSteps:""};try{var u=await a.headers.accountlabel,l=await a.params.projectName,d=await a.body,p=await await d.testid,m=await await d.testtool,v=await r+await u+"/"+await l+"/Web/TestScripts/**/"+await p+"@*.json",g=await n.sync(await v);if(0==await g.length)if("qabunch"===await m.toLowerCase())if(v=await r+await u+"/"+await l+"/Manual/TestCaseDetails/**/**/"+await p+".json",g=await n.sync(await v),0===await g.length)o.errorMessage="Test Id "+await p+" does not exist.";else{var h=await g[0],f=await JSON.parse(await w.readFileSync(await h,"utf8"));o.testName=await f.testCaseName,o.testId=await p;var y=await f.placeHolder.split("/");o.component=await y[await y.length-1];var b=await f.expectedStepStyle;if(void 0===await b||"At the end of step"===await b){var S=await f.testSteps,x=await f.testExpectedResult;""!==await x.toString().trim()&&(await x.includes("verify")||await x.includes("validate")||await x.includes("should")||(x="validate "+await x),S=await S+" \n"+await x)}else{S="";var M=await f.testStepWithExpectedResult;for(let a=0;a<await M.length;a++){var N=await M[a].step;S=await S+" \n"+await N}}o.manualTestSteps=await S,o.errorMessage="Test Id "+await p+" information added.";var T=await f.testcaseData;if(""!==await T.toString().trim()){var E=await async function(a){var t=[],e=[],i={};try{var r=(await c(await a)).output,s=(await c(await a)).valuedata;if(await r.length>0){var n={dataField:"id",text:"#",headerStyle:{width:"20px"}};t.push(await n);for(let a=0;a<await r.length;a++){var w=await r[a].toString().toUpperCase();(n={}).dataField=await w,n.text=await w,n.headerStyle={},n.headerStyle.width="150px",t.push(await n),await s.length>0&&(i.id=1,i[await w]=await s[a])}await s.length>0&&e.push(await i)}}catch(a){}return await{columnNeedToSend:t,columnValueNeedToSend:e}}(await T);await E.columnNeedToSend.length>1&&(o.testDataTableHeader=await E.columnNeedToSend,await E.columnValueNeedToSend.length>0&&(o.listOfTestScriptData=await E.columnValueNeedToSend))}var A=await f.testPrecondition;const a=await A.match(/[a-zA-Z0-9._,]+/g);if(A=await a?await a.join(" "):"",""!==await A.toString().trim()){var P={id:1,customfunction:await A,parameter:""};try{var C=await r+await u+"/"+await l+"/Web/CustomPageFunction/Page/"+await A+".json",k=(await JSON.parse(await w.readFileSync(await C,"utf8"))).argumentlist;void 0!==await k&&""!==await k&&(P.parameter=await JSON.stringify(await k))}catch(a){}o.dependentCustomFunction.push(await P)}}else o.errorMessage="Third party integration is not implemented , It will be available based on client requirment";else{h=await g[0];var j=await h.split("\\");o.testName=await j[await j.length-1].split("@")[1].replace(".json",""),o.component=await j[await j.length-2],f=await JSON.parse(await w.readFileSync(await h,"utf8")),o.listOfTestSteps=await f.allsteps,o.dependentCustomFunction=await f.dependentpage,o.testDataTableHeader=await f.testdatacolumn,o.listOfTestScriptData=await f.testdataset,o.isExistingTestScript=!0,o.testId=await j[await j.length-1].split("@")[0],o.errorMessage="Test Id "+await p+" is already automated."}}catch(a){}t.json(o)}),a.exports=i},557:(a,t,e)=>{const i=e(7252);e(9896);const r=i.Router(),{authCheck:s}=e(2258),n=e(3618);async function w(a){const t=await n(await a);let e=null,i=null,r=null;const s=await t.match("#verb").first();await s&&(e=await s.verbs().first().text());const w=await t.match("#Noun").first();return await w&&(i=await w.nouns().first().text()),r=await t.match("#Email").first().text(),""===await r&&(r=await t.match("#Url").first().text(),""===await r&&(r=await t.match("#Date").first().text(),""===await r&&(r=await t.match("#Product").first().text(),""===await r&&(r=await t.match("#Place").first().text(),""===await r&&(r=await t.match("#Person").first().text()),""===await r&&(r=await t.match("#Organization").first().text(),""===await r&&(r=await t.match("#Value").first().text())))))),{action:e,object:i,value:r}}async function o(a){return!(!await a.includes("browser")&&!await a.includes("window")||!(await a.includes("alert")||await a.includes("popup")||await a.includes("notification")))}async function c(a){var t=await n(await a).values(0).toNumber().out();let e=await n(await t).values().toCardinal().out("text");return await e}async function u(a){return!(!await a.includes("generate")&&!await a.includes("random"))}async function l(a){const t=await n(await a);return await t.match("#Noun").out("array")}async function d(a){const t=await n(await a);return await t.match("#Pronoun").out("array")}async function p(a,t){if(0===await t.length)return await a;for(let i=0;i<await t.length;i++){var e=await t[i];if(await a.includes(await e)){const t=await a.indexOf(await e);await t>-1&&await a.splice(t,1)}}return await a}async function m(a,t,e){var i={primaryLocatorProperty:"",secondaryXPath:"",secondaryXPathiOS:"",orLogicalName:"",actionvalue:"",iOSLocatorProperty:""},r=await a.toLocaleLowerCase(),s=await async function(a){var t=await a.split(" ").join("");t=await a.toLocaleLowerCase();var e=await async function(a){return!(!await a.includes("button")&&!await a.includes("Presser"))}(await t);return await e?"BUTTON":(e=await async function(a){return!!await a.includes("link")}(await t),await e?"LINK":(e=await async function(a){return!!(await a.includes("textbox")||await a.includes("field")||await a.includes("editbox")||await a.includes("inputbox")||await a.includes("inputfield")||await a.includes("databox")||await a.includes("searchbox")||await a.includes("searchbar")||await a.includes("provide")||await a.includes("input")||await a.includes("type")||await a.includes("sendkey")||await a.includes("enter")||await a.includes("put")||await a.includes("leave")&&!await a.includes("area"))}(await t),await e?"TEXTBOX":(e=await async function(a){return!!(await a.includes("image")||await a.includes("icon")||await a.includes("logo")||await a.includes("visual"))}(await t),await e?"IMAGE":(e=await async function(a){return!!(await a.includes("checkbox")||await a.includes("tickbox")||await a.includes("choicebox"))}(await t),await e?"CHECKBOX":(e=await async function(a){return!!(await a.includes("radiobutton")||await a.includes("radiochoice")||await a.includes("radioswitch")||await a.includes("radiostogg"))}(await t),await e?"RADIOBUTTON":(e=await async function(a){return!!(await a.includes("listbox")||await a.includes("dropdown")||await a.includes("combobox")||await a.includes("selectbox")||await a.includes("listcontrol")||await a.includes("select")&&await a.includes("from"))}(await t),await e?"LISTBOX":(e=await async function(a){return!!(await a.includes("textarea")||await a.includes("inputarea")||await a.includes("commentbox"))}(await t),await e?"TEXTAREA":(e=await async function(a){return!!await a.includes("label")}(await t),await e?"LABEL":"TEXT"))))))))}(await a),w=await x(await r);if(await w.length>0){var o=await w[await w.length-1],u=await(await s+await o.toUpperCase()).trim();i.orLogicalName=await u.split(" ").join("").trim();var l=await f(await s,t,await o);if(i.primaryLocatorProperty=await l.primaryLocatorProperty,i.secondaryXPath=await l.secondaryXPath,i.secondaryXPathiOS=await l.secondaryXPathiOS,i.iOSLocatorProperty=await l.iOSLocatorProperty,"Type"!==await e.toLocaleLowerCase()){var d=await v(await a);if(""!==await d){var p=await c(await d);if(""!==await p){var m=await Number(await p);if(!await isNaN(await m))if(await r.includes("mobile")||await r.includes("phone")||await r.includes("quant"))(g={valuetobesend:"ProvideValue"}).valuetobesend=await m.toString(),i.actionvalue=await JSON.stringify(await g);else{var g,y=await Number(await p)-1;(g={index:0}).index=await y,i.actionvalue=await JSON.stringify(await g)}}}}return await i}var b=await async function(a,t){switch(await a){case"Click":case"ClickNTimes":case"ClickAll":case"DoubleClick":case"RightClick":case"Tap":case"LongClick":return await async function(a){return await a.includes("clicked")?"(clicked)":await a.includes("clicks")?"(clicks)":await a.includes("click")?"(click)":await a.includes("press")?"(press)":await a.includes("hits")?"(hits)":await a.includes("hit")?"(hit)":await a.includes("triggered")?"(triggered)":await a.includes("triggers")?"(triggers)":await a.includes("trigger")?"(trigger)":await a.includes("choosen")?"(choosen)":await a.includes("chooses")?"(chooses)":await a.includes("choose")?"(choose)":await a.includes("taped")?"(taped)":await a.includes("taps")?"(taps)":await a.includes("tap")?"(tap)":await"(clicked|clicks|click|press|hit|trigger|choose|tap)"}(await t);case"DragandDrop":return await async function(a){return await a.includes("dragging")?"(dragging)":await a.includes("dragged")?"(dragged)":await a.includes("dragger")?"(dragger)":await a.includes("drags")?"(drags)":await a.includes("drag")?"(drag)":await a.includes("pulling")?"(pulling)":await a.includes("pulled")?"(pulled)":await a.includes("pulls")?"(pulls)":await a.includes("pull")?"(pull)":await a.includes("towing")?"(towing)":await a.includes("towed")?"(towed)":await a.includes("tows")?"(tows)":await a.includes("tow")?"(tow)":await"(drag|pull|tow|schlep)"}(await t);case"FileUpload":return await async function(a){return await a.includes("uploading")?"(uploading)":await a.includes("uploaded")?"(uploaded)":await a.includes("uploads")?"(uploads)":await a.includes("transferring")?"(transferring)":await a.includes("transferred")?"(transferred)":await a.includes("transfers")?"(transfers)":await a.includes("transfer")?"(transfer)":await a.includes("transmits")||await a.includes("transmit")?"(transmits)":await a.includes("posts")?"(posts)":await a.includes("post")?"(post)":await a.includes("importing")?"(importing)":await a.includes("imported")?"(imported)":await a.includes("imports")?"(imports)":await a.includes("import")?"(import)":await"(upload|transfer|transmit|post|import)"}(await t);case"Focus":return await async function(a){return await a.includes("focusing")?"(focusing)":await a.includes("focused")?"(focused)":await a.includes("focuses")?"(focuses)":await a.includes("focus")?"(focus)":await a.includes("scroller")?"(scroller)":await a.includes("scrolling")?"(scrolling)":await a.includes("scrolled")?"(scrolled)":await a.includes("scrolls")?"(scrolls)":await a.includes("scroll")?"(scroll)":await a.includes("moveto")?"(moveto)":await a.includes("movesto")?"(movesto)":await a.includes("highlighting")?"(highlighting)":await a.includes("highlighted")?"(highlighted)":await a.includes("highlights")?"(highlights)":await a.includes("highlight")?"(highlight)":await"(focus|scroll|moveto|highlight|movesto)"}(await t);case"GetAttribute":case"GetAttributeForAllElements":return await async function(a){return await a.includes("retrieving")?"(retrieving)":await a.includes("retrieved")?"(retrieved)":await a.includes("retrieves")?"(retrieves)":await a.includes("retrieve")?"(retrieve)":await a.includes("obtaining")?"(obtaining)":await a.includes("obtained")?"(obtained)":await a.includes("obtains")?"(obtains)":await a.includes("obtain")?"(obtain)":await a.includes("fetching")?"(fetching)":await a.includes("fetched")?"(fetched)":await a.includes("fetches")?"(fetches)":await a.includes("fetchs")?"(fetchs)":await a.includes("fetch")?"(fetch)":await a.includes("extracting")?"(extracting)":await a.includes("extracted")?"(extracted)":await a.includes("extracts")?"(extracts)":await a.includes("extract")?"(extract)":await a.includes("capturing")?"(capturing)":await a.includes("captured")?"(captured)":await a.includes("captures")?"(captures)":await a.includes("capture")?"(capture)":await a.includes("getting")?"(getting)":await a.includes("gets")?"(gets)":await a.includes("get")?"(get)":await"(retrieve|obtain|fetch|extract|capture|get)"}(await t);case"GetIndexOfTheElement":return await async function(a){return await a.includes("indexing")?"(indexing)":await a.includes("indexed")?"(indexed)":await a.includes("indexes")?"(indexes)":await a.includes("index")?"(index)":await a.includes("positioning")?"(positioning)":await a.includes("positioned")?"(positioned)":await a.includes("positions")?"(positions)":await a.includes("position")?"(position)":await"(index|position)"}(await t);case"GetTagName":return"(tags|tag|tagnames|tagname)";case"PressKeyBoard":return"(keys|key|keyname|keyboard)";case"Count":return await async function(a){return await a.includes("counting")?"(counting)":await a.includes("counted")?"(counted)":await a.includes("counts")?"(counts)":await a.includes("count")?"(count)":await a.includes("tally")?"(tally)":await a.includes("totaling")?"(totaling)":await a.includes("totaled")?"(totaled)":await"(count|tally|total)"}(await t);case"WaitForElementIsEnabled":case"WaitForElementIsDisabled":case"WaitForElementTillDisplayed":case"WaitForElementTillNotDisplayed":case"WaitForElementTillTextContains":return await async function(a){return await a.includes("waiting")?"(waiting)":await a.includes("waited")?"(waited)":await a.includes("waits")?"(waits)":await a.includes("wait")?"(wait)":await a.includes("pausing")?"(pausing)":await a.includes("paused")?"(paused)":await a.includes("pauses")?"(pauses)":await a.includes("pause")?"(pause)":await a.includes("delaying")?"(delaying)":await a.includes("delayed")?"(delayed)":await a.includes("delays")?"(delays)":await a.includes("delay")?"(delay)":await a.includes("holding")?"(holding)":await a.includes("held")?"(held)":await a.includes("holds")?"(holds)":await a.includes("hold")?"(hold)":await a.includes("timeouts")?"(timeouts)":await a.includes("timeout")?"(timeout)":await a.includes("timedouts")?"(timedouts)":await a.includes("timedout")?"(timedout)":await"(wait|pause|delay|hold|timeout)"}(await t);case"Check":case"CheckAll":case"UncheckAll":return await async function(a){return await a.includes("checkable")?"(checkable)":await a.includes("checker")?"(checker)":await a.includes("checking")?"(checking)":await a.includes("checked")?"(checked)":await a.includes("checks")?"(checks)":await a.includes("check")?"(check)":await a.includes("ticking")?"(ticking)":await a.includes("ticked")?"(ticked)":await a.includes("tickmark")?"(tickmark)":await a.includes("ticks")?"(ticks)":await a.includes("tick")?"(tick)":await"(check|tick|checked|checking|checkable)"}(await t);case"SelectByVisibleText":return await async function(a){return await a.includes("selecting")?"(selecting)":await a.includes("selected")?"(selected)":await a.includes("selects")?"(selects)":await a.includes("select")?"(select)":await a.includes("choosing")?"(choosing)":await a.includes("choice")?"(choice)":await a.includes("chooses")?"(chooses)":await a.includes("choose")?"(choose)":await a.includes("pickings")?"(pickings)":await a.includes("picking")?"(picking)":await a.includes("picker")?"(picker)":await a.includes("picked")?"(picked)":await a.includes("picks")?"(picks)":await a.includes("pick")?"(pick)":await"(select|choose|pick)"}(await t);case"SwitchToFrame":return"(frame|iframe)";case"Type":case"TypeAll":return await async function(a){return await a.includes("textboxes")?"(textboxes)":await a.includes("textboxs")?"(textboxs)":await a.includes("textbox")?"(textbox)":await a.includes("searchboxes")?"(searchboxes)":await a.includes("searchboxs")?"(searchboxs)":await a.includes("searchbox")?"(searchbox)":await a.includes("searchbars")?"(searchbars)":await a.includes("searchbar")?"(searchbar)":await a.includes("typed")?"(typed)":await a.includes("types")?"(types)":await a.includes("typing")?"(typing)":await a.includes("type")?"(type)":await a.includes("enters")?"(enters)":await a.includes("entered")?"(entered)":await a.includes("entering")?"(entering)":await a.includes("enter")?"(enter)":await a.includes("sendkeys")?"(sendkeys)":await a.includes("sendingkeys")?"(sendingkeys)":await a.includes("sentkeys")?"(sentkeys)":await a.includes("sendkey")?"(sendkey)":await a.includes("sentkey")?"(sentkey)":await a.includes("providing")?"(providing)":await a.includes("provided")?"(provided)":await a.includes("provides")?"(provides)":await a.includes("provide")?"(provide)":await a.includes("leaving")?"(leaving)":await a.includes("leaves")?"(leaves)":await a.includes("leave")?"(leave)":await a.includes("inputs")?"(inputs)":await a.includes("inputted")?"(inputted)":await a.includes("inputting")?"(inputting)":await a.includes("input")?"(input)":await"(textbox|searchbox|searchbar|type|enter|sendkeys|provide|leave|sendkey|inputs)"}(await t);case"IsSelected":return"(checked|selected|checks|checkable)";case"AssertElementCountEquals":case"AssertElementCountGreaterThan":case"AssertElementCountLessThan":case"AssertElementAttributeContains":case"AssertElementAttributeNotContains":return await async function(a){return await a.includes("verification")?"(verification)":await a.includes("verifier")?"(verifier)":await a.includes("verifying")?"(verifying)":await a.includes("verified")?"(verified)":await a.includes("verifies")?"(verifies)":await a.includes("verify")?"(verify)":await a.includes("validating")?"(validating)":await a.includes("validation")?"(validation)":await a.includes("validator")?"(validator)":await a.includes("validated")?"(validated)":await a.includes("validates")?"(validates)":await a.includes("validate")?"(validate)":await a.includes("ensuring")?"(ensuring)":await a.includes("ensured")?"(ensured)":await a.includes("ensures")?"(ensures)":await a.includes("ensure")?"(ensure)":await a.includes("counting")?"(counting)":await a.includes("counted")?"(counted)":await a.includes("counts")?"(counts)":await a.includes("count")?"(count)":await"(verify|validate|ensure|count)"}(await t);case"IsDisplayed":case"IsNotDisplayed":return await async function(a){return await a.includes("displaying")?"(displaying)":await a.includes("displayed")?"(displayed)":await a.includes("displays")?"(displays)":await a.includes("display")?"(display)":await a.includes("visibled")?"(visibled)":await a.includes("visibles")?"(visibles)":await a.includes("visible")?"(visible)":await a.includes("visibility")?"(visibility)":await a.includes("presently")?"(presently)":await a.includes("presented")?"(presented)":await a.includes("presents")?"(presents)":await a.includes("present")?"(present)":await"(displayed|displays|display|visible|present)"}(await t);case"IsDisabled":case"IsEnabled":return await async function(a){return await a.includes("enabling")?"(enabling)":await a.includes("enabled")?"(enabled)":await a.includes("enables")?"(enables)":await a.includes("enable")?"(enable)":await a.includes("disabling")?"(disabling)":await a.includes("disabled")?"(disabled)":await a.includes("disables")?"(disables)":await a.includes("disable")?"(disable)":await"(enable|disable)"}(await t);case"Pinch":return"(pinch)";case"ZoomIn":case"ZoomOut":return"(zoom)";default:return""}}(await e,await r);let S=await n(await r);var M="",N="";if(M=await S.match(await b).before().text(),N=await S.match(await b).after().text(),""===await M&&""===await N){var T=await async function(a,t){var e="",i="";if(""===await a)return{beforeKeyword:e,afterKeyword:i};a=await a.toString().replace("(",""),a=await a.toString().replace(")","");var r=await a.split("|");for(let a=0;a<await r.length;a++){var s=await r[a];if(await t.includes(await s)){var n=await t.split(await s);e=await n[0],i=await n[await n.length-1];break}}return{beforeKeyword:e,afterKeyword:i}}(await b,await r);if(M=await T.beforeKeyword,N=await T.afterKeyword,""===await M&&""===await N){if(await r.includes(" ")){const a=r.split(" ");if(await a.length>=2){const t=await a.slice(1),e=await t.join(" ");r=await e}}M=await r}}return i=await h(await N,await t,await s),""===await i.orLogicalName&&(i=await h(await M,await t,await s)),await i}async function v(a){var t="";const e=await n(await a);return t=await e.match("#Email").first().text(),""===await t&&(t=await e.match("#Url").first().text(),""===await t&&(t=await e.match("#Date").first().text(),""===await t&&(t=await e.match("#Product").first().text(),""===await t&&(t=await e.match("#Place").first().text(),""===await t&&(t=await e.match("#Person").first().text()),""===await t&&(t=await e.match("#Date").first().text(),""===await t&&(t=await e.match("#People").first().text(),""===await t&&(t=await e.match("#FirstName").first().text(),""===await t&&(t=await e.match("#Country").first().text(),""===await t&&(t=await e.match("#Address").first().text(),""===await t&&(t=await e.match("#Value").first().text())))))))))),await t}async function g(a){const t=await n(await a);var e=await t.not("#Preposition").text(),i=await l(await e),r=await d(await e),s=await p(await i,await r);return await s.length>0&&(e="index"===await s[0]&&await s.length>1?s[1]:s[0]),await{first:e}}async function h(a,t,e){var i={orLogicalName:"",primaryLocatorProperty:"",iOSLocatorProperty:"",secondaryXPath:"",secondaryXPathiOS:"",actionvalue:""};if(""!==await a){var r=await a.split(" ");if(1===await r.length){var s=await g(await r[0]);if(""===await s.first||"empty"===await s.first)return await i;var w=await await r[0];""!==await e?i.orLogicalName=await e.toUpperCase()+await w.toUpperCase():i.orLogicalName=await w.toUpperCase();var o=await f(await e,t,await w);return i.primaryLocatorProperty=await o.primaryLocatorProperty,i.iOSLocatorProperty=await o.iOSLocatorProperty,i.secondaryXPath=await o.secondaryXPath,i.secondaryXPathiOS=await o.secondaryXPathiOS,await i}var u="",l="";""===await e?(u=await t.DEFAULT.TAG,l=await t.DEFAULT.IOSTAG):("TEXT"===await e?(u=await t.LINK.TAG,l=await t.LINK.IOSTAG):(u=await t[await e].TAG,l=await t[await e].IOSTAG),void 0===await u&&(u=await t.DEFAULT.TAG),void 0===await l&&(l=await t.DEFAULT.IOSTAG));var d=await async function(a){switch(await a.toUpperCase()){case"BUTTON":return"(webbutton|button)";case"LINK":return"(hyperlink|weblink|link)";case"TEXTBOX":return"(textbox|editbox|searchbox|searchbar|inputfield|searchfield|inputs|sendkeys)";case"IMAGE":return"(image|icon|logo)";case"CHECKBOX":return"(checkbox|tickbox)";case"RADIOBUTTON":return"(radiobutton|radio)";case"LISTBOX":return"(listbox|dropdown|select)";case"TEXTAREA":return"(textarea|areabox|searcharea)";case"LABEL":return"(label)";default:return""}}(await e),p=await async function(a,t){var e,i=await a.toLocaleLowerCase(),r="";if(""===await t)return r=await a,await{sentenseBeforeKeyword:r,sentenseBeforeKeyword:r};let s=await n(await i);return r=await s.match(await t).before().text(),e=await s.match(await t).after().text(),""===await r&&""===await e&&(r=await a),await{sentenseBeforeKeyword:r,sentenseAfteKeyword:e}}(await a,await d),m=await p.sentenseBeforeKeyword;m=await m.toString().replace(" the "," "),m=await m.toString().replace("the "," "),m=await m.toString().replace(" field "," "),m=await m.toString().replace("leave ",""),m=await m.toString().replace("empty ","");var h=await g(await m);m=await h.first,""===await m&&(m=await p.sentenseAfteKeyword,""===await m&&(m=await a.split(" ")[0]));var b=await p.sentenseBeforeKeyword,S=await p.sentenseAfteKeyword;void 0!==await S&&""!==await S||(S=await b);var x="";if(await m.split(" ").length>2)var M=await async function(a){const t=await n(await a);if(verbs=await t.nouns(),verbs.length>0){const a=await verbs.first().match("#Noun").text(),t=await verbs.first().match("#Noun #Noun").text(),e=await verbs.first().match("#Noun #Noun").text();return await{first:a,second:t,third:e}}{const t=await a,e="",i="";return await{first:t,second:e,third:i}}}(await m);else M=await g(await m);if(null!==await M&&""!==await M.first){x=await M.first,await x.split(" ").length>3&&(x=await M.second,await x.split(" ").length>3&&(x=await M.third));var N=await v(await a);if(""===await N){var T=await x.split(" "),E=await T.length;await E>3&&(text=await T[await E-2]+" "+await T[await E-1],x=await T[0]);var A=await(await e+await x.toUpperCase()).trim();return w=await x.toLocaleLowerCase(),i.orLogicalName=await A.split(" ").join("").trim(),o=await f(await e,t,await w),i.primaryLocatorProperty=await o.primaryLocatorProperty,i.iOSLocatorProperty=await o.iOSLocatorProperty,i.secondaryXPath=await o.secondaryXPath,i.secondaryXPathiOS=await o.secondaryXPathiOS,await i}if(await x.includes(await N)){var P="";await N.includes(" ")||(P=await N);var C=await y(await x,await N);if("name"!==await C&&""!==await C){var k=await N,j={index:"0"},D=await c(await x);if(""!==await D){var O=await Number(await D);await isNaN(await O)||(N=await Number(await D)-1,await a.includes("mobile")||await a.includes("phone")||await a.includes("quant")?((j={valuetobesend:"ProvideValue"}).valuetobesend=await O.toString(),i.actionvalue=await JSON.stringify(await j)):(j.index=await N,i.actionvalue=await JSON.stringify(await j)))}}if(await x.includes(" ")||(x=await y(await a,await N)),T=await x.split(" "),E=await T.length,await E>3){text=await T[await E-2]+" "+await T[await E-1];var I=await g(await text);x=""!==await I.first?await I.first:await T[0]}else I=await g(await x),x=""!==await I.first?await I.first:await T[0];return x=await x.replace(await k,"").trim(),A=await(await e+await x.toUpperCase()).trim(),w=await x.toLocaleLowerCase(),o=await f(await e,t,await w),i.primaryLocatorProperty=await o.primaryLocatorProperty,i.iOSLocatorProperty=await o.iOSLocatorProperty,i.secondaryXPath=await o.secondaryXPath,i.secondaryXPathiOS=await o.secondaryXPathiOS,i.orLogicalName=await A.split(" ").join("").trim(),""!==await P&&((j={valuetobesend:"ProvideValue"}).valuetobesend=await N,i.actionvalue=await JSON.stringify(await j)),await i}return A=await(await e+await x.toUpperCase()).trim(),w=await x.toLocaleLowerCase(),i.orLogicalName=await A.split(" ").join("").trim(),o=await f(await e,t,await w),i.primaryLocatorProperty=await o.primaryLocatorProperty,i.iOSLocatorProperty=await o.iOSLocatorProperty,i.secondaryXPath=await o.secondaryXPath,i.secondaryXPathiOS=await o.secondaryXPathiOS,j={index:"0"},D=await c(await N),""!==await D?(O=await Number(await D),await isNaN(await O)||(await O>100?((j={valuetobesend:"ProvideValue"}).valuetobesend=await O,i.actionvalue=await JSON.stringify(await j)):(N=await Number(await D)-1,j.index=await N,i.actionvalue=await JSON.stringify(await j)))):((j={valuetobesend:"ProvideValue"}).valuetobesend=await N,i.actionvalue=await JSON.stringify(await j)),await i}}return await i}async function f(a,t,e){var i={primaryLocatorProperty:"",iOSLocatorProperty:"",secondaryXPath:"",secondaryXPathiOS:""};if(""===await e.toString().trim())return await i;e=await e.toLocaleLowerCase(),i.primaryLocatorProperty=await E(await e,await a,await t,"TAG"),i.iOSLocatorProperty=await E(await e,await a,await t,"IOSTAG");var r=await a.toLocaleLowerCase();return"button"===await r||"image"===await r?(i.secondaryXPath=await E(await e,await a,await t,"TAG"),i.secondaryXPathiOS=await E(await e,await a,await t,"IOSTAG"),i.primaryLocatorProperty=await P(await e,await a,await t,"TAG"),i.iOSLocatorProperty=await P(await e,await a,await t,"IOSTAG")):(i.secondaryXPath=await A(await e,await a,await t,"TAG"),i.secondaryXPathiOS=await A(await e,await a,await t,"IOSTAG")),await i}async function y(a,t){try{var e=await a.split(await t);return await e[1].trim()}catch(a){}return""}async function b(a){var t=[];try{const w=await n(await a),o=await w.match("and").before().text(),c=await w.match("and").after().text();if(""===await o||""===await c)t.push(await a);else{var e=await o.toString().split(","),i=await e[0],r=await i.split(" ");if(r=r.length>1?r.slice(0,await r.length-1).join(" "):await i,await e.length>1)for(let a=0;a<await e.length;a++)0===await a?t.push(await e[a]):t.push(await r+" "+await e[a]);else t.push(await i);var s=await c.split(" ");await s.length>1?t.push(await c):t.push(await r+" "+await c)}}catch(e){t.push(await a)}return await t}async function S(a){var t="";if(await a.toLocaleLowerCase().includes(" as "))try{t=await a.split(" as ")[1].toString().trim()}catch(a){t=""}return await t}async function x(a){const t=[];try{var e=/"([^"]*)"/g;let i;for(;null!==(i=await e.exec(await a));)t.push(await i[1]);if(0===await t.length)for(e=/'([^"]*)'/g;null!==(i=await e.exec(await a));)t.push(await i[1]);if(0===await t.length)for(e=/‘(.*?)’/;null!==(i=await e.exec(await a));)t.push(await i[1])}catch(a){}return t}async function M(a){if(""!==await a)return"contains(translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'),'"+await a+"')"}async function N(a,t,e){var i="";switch(await a){case"BUTTON":i=await t.BUTTON[await e];break;case"LINK":i=await t.LINK[await e];break;case"TEXTBOX":i=await t.TEXTBOX[await e];break;case"IMAGE":i=await t.IMAGE[await e];break;case"CHECKBOX":i=await t.CHECKBOX[await e];break;case"RADIOBUTTON":i=await t.RADIOBUTTON[await e];break;case"LISTBOX":i=await t.LISTBOX[await e];break;case"TEXTAREA":i=await t.TEXTAREA[await e];break;case"LABEL":i=await t.LABEL[await e];break;default:i=await t.DEFAULT[await e]}return await i}async function T(a){var t=await C(await a),e=await M(await a);if(await a.includes(" ")){var i=await a.split(" ").join("-"),r=await a.split(" ").join(""),s=await a.split(" ").join("_");t=await t+" or "+await C(await i),t=await t+" or "+await C(await r),t=await t+" or "+await C(await s),e=await e+" or "+await M(await i),e=await e+" or "+await M(await r),e=await e+" or "+await M(await s)}t="["+await t+"]",e="["+await e+"]";var n="(self::*"+await t+" or @*"+await e+")";return await n}async function E(a,t,e,i){if(void 0===await a||""===a.toString().trim())return"";a=await a.toString().trim().toLocaleLowerCase();var r=await T(await a),s=await N(await t,e,i);if("//*"===await s||""===await s)return"//*["+await r+"]";if(await s.startsWith("//")){var n=await s.substring(2);return"//*["+await r+" and (self::"+await n+")]"}return"//*["+await r+"]"}async function A(a,t,e,i){if(void 0===await a||""===a.toString().trim())return"";a=await a.toString().trim().toLocaleLowerCase();var r=await T(await a),s=await N(await t,e,i);return"//*"===await s||""===await s?"//*["+await r+"]":"//*["+await r+"]/.."+await s}async function P(a,t,e,i){if(void 0===await a||""===a.toString().trim())return"";a=await a.toString().trim().toLocaleLowerCase();var r=await T(await a),s=await N(await t,e,i);return"//*"===await s||""===await s?"//*["+await r+"]":await s+"/..//*["+await r+"]"}async function C(a){if(""!==await a)return"contains(translate(@text, 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'),'"+await a+"')"}r.post("/step",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var r={},c=await a.body.step,l=await a.body.elementtag;l=await async function(a){var t={};return void 0===await a||""===a?(t.LINK="//a",t.BUTTON="//button",t.TEXTBOX="//input",t.IMAGE="//img",t.CHECKBOX="//input",t.RADIOBUTTON="//input",t.LISTBOX="//select",t.TEXTAREA="//textarea",t.LABEL="//label",t.DEFAULT="//*",await t):(void 0===await a.LINK&&(a.LINK="//a"),void 0===await a.BUTTON&&(a.LINK="//button"),void 0===await a.TEXTBOX&&(a.TEXTBOX="//input"),void 0===await a.IMAGE&&(a.IMAGE="//img"),void 0===await a.CHECKBOX&&(a.CHECKBOX="//input"),void 0===await a.RADIOBUTTON&&(a.RADIOBUTTON="//input"),void 0===await a.LISTBOX&&(a.LISTBOX="//select"),void 0===await a.TEXTAREA&&(a.TEXTAREA="//textarea"),void 0===await a.LABEL&&(a.LABEL="//label"),void 0===await a.DEFAULT&&(a.DEFAULT="//*"),await a)}(await l);try{let a=await n(await c);c=await a.normalize().out("text");let t=await n(await c);await t.normalize(),await t.contractions().expand(),c=await t.text()}catch(t){c=await a.body.step}const t=await c.match(/[a-zA-Z0-9._,@'"]+/g);c=await t?await t.join(" "):"",await b(await c),r.actionName="",r.orLogicalName="",r.primaryLocator="xpath",r.primaryLocatorProperty="",r.iosLocatorName="xpath",r.iOSLocatorProperty="",r.secondaryXPath="",r.secondaryXPathiOS="",r.actionvalue="";var d=await async function(a,t){var e={actionName:"",orLogicalName:"",primaryLocator:"xpath",primaryLocatorProperty:"",iOSLocatorProperty:"",secondaryXPath:"",secondaryXPathiOS:"",actionvalue:""},i=await a.split(" ").join("");i=await i.toLocaleLowerCase();var r=await async function(a){return!!(await a.includes("wait")||await a.includes("pause")||await a.includes("delay")||await a.includes("timeout"))}(await i);if(await r){if(isWaitMatch=await async function(a){return!!(await a.includes("enable")||await a.includes("disable")&&await a.includes("not"))}(await i),await isWaitMatch){e.actionName="WaitForElementIsEnabled",e.actionvalue='{"timeout": 30}';var s=await m(await a,await t,"WaitForElementIsEnabled");return e.primaryLocatorProperty=await s.primaryLocatorProperty,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.secondaryXPathiOS=await s.secondaryXPathiOS,e.orLogicalName=await s.orLogicalName,await e}if(isWaitMatch=await async function(a){return!!(await a.includes("disable")||await a.includes("enable")&&await a.includes("not"))}(await i),await isWaitMatch)return e.actionName="WaitForElementIsDisabled",e.actionvalue='{"timeout": 30}',s=await m(await a,await t,"WaitForElementIsDisabled"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.secondaryXPathiOS=await s.secondaryXPathiOS,e.orLogicalName=await s.orLogicalName,await e;if(isWaitMatch=await async function(a){return!(!(await a.includes("display")||await a.includes("visible")||await a.includes("notice")||await a.includes("evident"))||!await a.includes("not"))}(await i),await isWaitMatch)return e.actionName="WaitForElementTillNotDisplayed",e.actionvalue='{"timeout": 30}',s=await m(await a,await t,"WaitForElementTillNotDisplayed"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.secondaryXPathiOS=await s.secondaryXPathiOS,e.orLogicalName=await s.orLogicalName,await e;if(isWaitMatch=await async function(a){return!(!await a.includes("text")||!await a.includes("should")&&!await a.includes("contain"))}(await i),await isWaitMatch)return e.actionName="WaitForElementTillTextContains",e.actionvalue='{"timeout":30,"expectedtext":"provide expected text"}',s=await m(await a,await t,"WaitForElementTillTextContains"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.secondaryXPathiOS=await s.secondaryXPathiOS,e.orLogicalName=await s.orLogicalName,await e;var c=await v(await a);if(""===await c)return e.actionName="WaitForElementTillDisplayed",e.actionvalue='{"timeout": 30}',s=await m(await a,await t,"WaitForElementTillDisplayed"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.secondaryXPathiOS=await s.secondaryXPathiOS,e.orLogicalName=await s.orLogicalName,await e;try{var l=await Number(await c);e.actionName="Wait";var d={timeout:5};return d.timeout=await l,e.actionvalue=await JSON.stringify(await d),await e}catch(i){e.actionName="WaitForElementTillDisplayed",e.actionvalue='{"timeout": 30}';s=await m(await a,await t,"WaitForElementTillDisplayed");return e.primaryLocatorProperty=await s.primaryLocatorProperty,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.secondaryXPathiOS=await s.secondaryXPathiOS,e.orLogicalName=await s.orLogicalName,await e}}var p=await async function(a){return!(!(await a.includes("run")||await a.includes("hit")||await a.includes("execute")||await a.includes("trigger")||await a.includes("command"))||!await a.includes("query"))}(await i);if(await p){e.actionName="RunDBQuery";var g={Query:"WriteyourQueryhere"},h=await x(await a);if(await h.length>0){var y=await h[0];g.Query=await y}return e.actionvalue=await JSON.stringify(await g),await e}var b=await async function(a){return!!((await a.includes("verify")||await a.includes("validate")||await a.includes("ensure")||await a.includes("should")||await a.includes("tothe")||await a.includes("display")||await a.includes("enable")||await a.includes("disable"))&&!await a.includes("navigate")||await a.includes("check")&&await a.includes("each"))}(await i);if(await b){if(p=await async function(a){return!(!await a.includes("install")&&!await a.includes("inaugurate")||!await a.includes("app")||!await a.includes("is"))}(await i),await p)return e.actionName="IsAppInstalled",e.actionvalue='{"valuetobesend":"appPackageName"}',await e;var M=await async function(a){return!(!await o(await a)||await a.includes("not"))}(await i);if(await M){e.actionName="AssertAlertTextContains";var N={expectedtext:"provide expected text"},T=await w(await a);return""!==await T.value&&(N.expectedtext=await T.value),e.actionvalue=await JSON.stringify(await N),await e}if(M=await async function(a){return!(!await o(await a)||!await a.includes("not"))}(await i),await M)return e.actionName="AssertAlertTextNotContains",N={expectedtext:"provide expected text"},T=await w(await a),""!==await T.value&&(N.expectedtext=await T.value),e.actionvalue=await JSON.stringify(await N),await e;if(M=await async function(a){return!!(await a.includes("disable")||await a.includes("enable")&&await a.includes("not"))}(await i),await M)return e.actionName="IsDisabled",e.actionvalue="",s=await m(await a,await t,"IsDisabled"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,e.orLogicalName=await s.orLogicalName,await e;if(M=await async function(a){return!(!(await a.includes("display")||await a.includes("visible")||await a.includes("present")||await a.includes("observable")||await a.includes("viewable"))||await a.includes("not"))}(await i),await M){if(e.actionName="IsDisplayed",e.actionvalue="",s=await m(await a,await t,"IsDisplayed"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await a.toLocaleLowerCase().includes("message")||await a.toLocaleLowerCase().includes("information")){var E=await n(await a.toLocaleLowerCase());const i=await E.match("#Noun+ #Verb #Adjective+");if(await i.found){var A=await i.text();if(""!==await A&&void 0!==await A&&(A=await A.toString().replace("text","").trim(),""!==await A)){var P=await f("TEXT",await t,await A);e.primaryLocatorProperty=await P.primaryLocatorProperty,e.secondaryXPath=await P.secondaryXPath,e.secondaryXPathiOS=await P.secondaryXPathiOS,A=await A.split(" ").join("").trim().toUpperCase(),e.orLogicalName="TEXT"+await A,e.iOSLocatorProperty=await P.iOSLocatorProperty}}else{var C=await a.split(" message")[0].trim();""!==await C&&void 0!==await C&&(P=await f("TEXT",await t,await C),e.primaryLocatorProperty=await P.primaryLocatorProperty,e.secondaryXPath=await P.secondaryXPath,C=await C.split(" ").join("").trim().toUpperCase(),e.orLogicalName="TEXT"+await C,e.iOSLocatorProperty=await P.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS)}}return await e}if(M=await async function(a){return!(!(await a.includes("disapp")||await a.includes("display")||await a.includes("visible")||await a.includes("present")||await a.includes("observable")||await a.includes("viewable"))||!await a.includes("not"))}(await i),await M){e.actionName="IsNotDisplayed",e.actionvalue="",s=await m(await a,await t,"IsNotDisplayed"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,E=await n(await a.toLocaleLowerCase());const i=await E.match("#Noun+ #Verb #Adjective+");return await i.found&&(A=await i.text(),""!==await A&&void 0!==await A&&(A=await A.toString().replace("text","").trim(),""!==await A)&&(P=await f("TEXT",await t,await A),e.primaryLocatorProperty=await P.primaryLocatorProperty,e.secondaryXPath=await P.secondaryXPath,e.secondaryXPathiOS=await P.secondaryXPathiOS,A=await A.split(" ").join("").trim().toUpperCase(),e.orLogicalName="TEXT"+await A,e.iOSLocatorProperty=await P.iOSLocatorProperty)),await e}if(M=await async function(a){return!!(await a.includes("enable")||await a.includes("disable")&&await a.includes("not"))}(await i),await M)return e.actionName="IsEnabled",e.actionvalue="",s=await m(await a,await t,"IsEnabled"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e;if(M=await async function(a){return!!(await a.includes("selected")||await a.includes("checked")||await a.includes("ticked"))}(await i),await M&&(e.actionName="IsSelected",e.actionvalue="",s=await m(await a,await t,"IsSelected"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS),M=await async function(a){return!(!await a.includes("count")||await a.includes("less")&&!await a.includes("greater"))}(await i),await M){e.actionName="AssertElementCountEquals",e.actionvalue="",s=await m(await a,await t,"AssertElementCountEquals"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.secondaryXPathiOS=await s.secondaryXPathiOS,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty;var k=await s.actionvalue;if(""!==await k.trim()){if(k=await JSON.parse(await k),void 0!==await k.index){var j=k.index;await isNaN(await j)?(delete k.index,k.expectedcount="Provide Expected count here",e.actionvalue=JSON.stringify(await k)):(delete k.index,j=Number(await j)+1,k.expectedcount=await j)}}else e.actionvalue='{ "expectedcount": "Provide Expected count here" }';return await e}if(M=await async function(a){return!!(await a.includes("count")&&await a.includes("greater")||await a.includes("check")&&await a.includes("each"))}(await i),await M)return e.actionName="AssertElementCountGreaterThan",s=await m(await a,await t,"AssertElementCountGreaterThan"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,k=await s.actionvalue,""!==await k.trim()?(k=await JSON.parse(await k),void 0!==await k.index&&(j=k.index,await isNaN(await j)?(delete k.index,k.expectedcount="Provide Expected count here",e.actionvalue=JSON.stringify(await k)):(delete k.index,j=Number(await j)+1,k.expectedcount=await j))):e.actionvalue='{ "expectedcount": "0" }',await e;if(M=await async function(a){return!(!await a.includes("count")||!await a.includes("less"))}(await i),await M)return e.actionName="AssertElementCountLessThan",s=await m(await a,await t,"AssertElementCountLessThan"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,k=await s.actionvalue,""!==await k.trim()?(k=await JSON.parse(await k),void 0!==await k.index&&(j=k.index,await isNaN(await j)?(delete k.index,k.expectedcount="Provide Expected count here",e.actionvalue=JSON.stringify(await k)):(delete k.index,j=Number(await j)+1,k.expectedcount=await j))):e.actionvalue='{ "expectedcount": "Provide Expected count here" }',await e;if(M=await async function(a){return!!await a.includes("not")}(await i),await M){e.actionName="AssertElementAttributeNotContains",N={attributeNames:"{}"},e.actionvalue=await JSON.stringify(await N),s=await m(await a,await t,"AssertElementAttributeNotContains"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.secondaryXPathiOS=await s.secondaryXPathiOS,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,E=await n(await a.toLocaleLowerCase());const i=await E.match("#Noun+ #Verb #Adjective+");if(await i.found&&(A=await i.text(),""!==await A&&void 0!==await A&&(A=await A.toString().replace("text",""),""!==await A))){var D={attributeNames:{}};N={text:await A},D.attributeNames=await N,e.actionvalue=await JSON.stringify(await D)}return await e}{e.actionName="AssertElementAttributeContains",N={attributeNames:"{}"},e.actionvalue=await JSON.stringify(await N),s=await m(await a,await t,"AssertElementAttributeContains"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.secondaryXPathiOS=await s.secondaryXPathiOS,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,E=await n(await a.toLocaleLowerCase());const i=await E.match("#Noun+ #Verb #Adjective+");return await i.found&&(A=await i.text(),""!==await A&&void 0!==await A&&(A=await A.toString().replace("text",""),""!==await A)&&(D={attributeNames:{}},N={text:await A},D.attributeNames=await N,e.actionvalue=await JSON.stringify(await D))),await e}}if(p=await async function(a){var t=!1;if((await a.includes("back")||await a.includes("previous")||await a.includes("return")||await a.includes("reverse")||await a.includes("backward")||await a.includes("return"))&&(t=!0),await t){if(await a.includes("mobile")&&await a.includes("app"))return!0;if(await a.includes("navigate")||await a.includes("goto")||await a.includes("execute")||await a.includes("perform"))return!0}return!1}(await i),await p)return e.actionName="Back",await e;if(p=await async function(a){return!(!(await a.includes("refresh")||await a.includes("reload")||await a.includes("revisit")||await a.includes("redisplay")||await a.includes("renew"))||!await a.includes("app"))}(await i),await p)return e.actionName="Refresh",await e;if(p=await async function(a){var t=!1;if((await a.includes("acknowledge")||await a.includes("confirm")||await a.includes("respond")||await a.includes("approve")||await a.includes("agree")||await a.includes("allow")||await a.includes("grant")||await a.includes("admit")||await a.includes("accept"))&&(t=!0),await t){if(await a.includes("mobile")&&await a.includes("app"))return!0;if(await a.includes("alert")||await a.includes("notification")||await a.includes("popup")||await a.includes("dialog"))return!0}return!1}(await i),await p)return e.actionName="AlertAccept",await e;if(p=await async function(a){var t=!1;if((await a.includes("cancel")||await a.includes("dismis")||await a.includes("reject")||await a.includes("decline")||await a.includes("ignore")||await a.includes("refuse")||await a.includes("deny")||await a.includes("block")||await a.includes("disallow")||await a.includes("denounce")||await a.includes("negate")||await a.includes("invalidate "))&&(t=!0),await t){if(await a.includes("mobile")&&await a.includes("app"))return!0;if(await a.includes("alert")||await a.includes("notification")||await a.includes("popup")||await a.includes("dialog"))return!0}return!1}(await i),await p)return e.actionName="AlertDismiss",await e;if(p=await async function(a){var t=!1;if((await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("extract")||await a.includes("capture")||await a.includes("get"))&&(t=!0),await t){if(await a.includes("mobile")&&await a.includes("app"))return!0;if(await a.includes("alert")||await a.includes("notification")||await a.includes("popup")||await a.includes("dialog"))return!0}return!1}(await i),await p)return e.actionName="AlertText",await e;if(p=await async function(a){var t=!1;return(await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("extract")||await a.includes("capture")||await a.includes("get"))&&(t=!0),!(!await t||!await a.includes("package"))}(await i),await p)return e.actionName="GetCurrentPackage",await e;if(p=await async function(a){var t=!1;return(await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("extract")||await a.includes("capture")||await a.includes("get"))&&(t=!0),!(!await t||!await a.includes("activity"))}(await i),await p)return e.actionName="GetCurrentActivity",await e;if(p=await async function(a){return!(await a.includes("relaunch")||await a.includes("restart")||!(await a.includes("launch")||await a.includes("start")||await a.includes("fire")||await a.includes("open")||await a.includes("trigger")||await a.includes("initiate")||await a.includes("kickoff"))||!await a.includes("app"))}(await i),await p)return e.actionName="Launch",e.actionvalue='{"apppackage":"provide appPackage","appactivity":"provide appactivity"}',await e;if(p=await async function(a){return!(!await a.includes("swipe")||!await a.includes("left")||await a.includes("at")||await a.includes("on")||await a.includes("in")||await a.includes("near"))}(await i),await p)return e.actionName="SwipeLeft",await e;if(p=await async function(a){return!(!await a.includes("swipe")||!await a.includes("right")||await a.includes("at")||await a.includes("on")||await a.includes("in")||await a.includes("near"))}(await i),await p)return e.actionName="SwipeRight",await e;if(p=await async function(a){return!(!await a.includes("swipe")||!await a.includes("up")||await a.includes("at")||await a.includes("on")||await a.includes("in")||await a.includes("near"))}(await i),await p)return e.actionName="SwipeUp",e.actionvalue='{"totalSwipeCount":"1"}',await e;if(p=await async function(a){return!(!await a.includes("swipe")||!await a.includes("down")||await a.includes("at")||await a.includes("on")||await a.includes("in")||await a.includes("near"))}(await i),await p)return e.actionName="SwipeDown",e.actionvalue='{"totalSwipeCount":"1"}',await e;if(p=await async function(a){return!(!await a.includes("relaunch")&&!await a.includes("restart")||!await a.includes("app"))}(await i),await p)return e.actionName="RestartApp",await e;if(p=await async function(a){return!(!(await a.includes("activate")||await a.includes("focus")||await a.includes("switch")||await a.includes("moveto"))||!await a.includes("app"))}(await i),await p)return e.actionName="SwitchTo",e.actionvalue='{"valuetobesend":"appPackageName"}',await e;if(p=await async function(a){return!(!(await a.includes("hide")||await a.includes("mask")||await a.includes("disguise"))||!await a.includes("keyboard"))}(await i),await p)return e.actionName="HideKeyboard",await e;var O=await async function(a){return!!(await a.includes("mobile")&&await a.includes("app")||await a.includes("mobile")&&await a.includes("step"))}(await i);if(await O)return p=await async function(a){return!!(await a.includes("close")||await a.includes("exit")||await a.includes("quit")||await a.includes("terminate")||await a.includes("end")||await a.includes("shutdown"))}(await i),await p?(e.actionName="Close",e.actionvalue='{"valuetobesend":""}',await e):(e.actionName="",await e);if(p=await async function(a){return!!(await a.includes("save")&&await a.includes("the")||await a.includes("session"))}(await i),await p)return e.actionName="SaveSessionVariable",e.actionvalue='{"variablename":"Provide variable name"}',await e;if(p=await u(await i),await p)return e.actionName="GenerateUtilityValue",e.actionvalue='{"valuetobesend":"Provide value"}',await e;if(p=await u(await i),await p)return e.actionName="GenerateUtilityValue",e.actionvalue='{"valuetobesend":"Provide value"}',await e;var I=await async function(a){return!(!await a.includes("checkbox")&&!await a.includes("tickbox")||await a.includes("all")||await a.includes("uncheck")&&await a.includes("unticked"))}(await i);if(await I)return e.actionName="Check",e.actionvalue="",s=await m(await a,await t,"Check"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e;if(I=await async function(a){return!(!await a.includes("checkbox")&&!await a.includes("tickbox")||!await a.includes("all")||await a.includes("uncheck")&&await a.includes("unticked"))}(await i),await I)return e.actionName="CheckAll",e.actionvalue="",e.orLogicalName="TAGCHECKBOX",e.primaryLocatorProperty=await parentTagForElement.CHECKBOX.TAG,e.iOSLocatorProperty=await parentTagForElement.CHECKBOX.IOSTAG,e.secondaryXPath=await s.secondaryXPath,e.secondaryXPathiOS=await s.secondaryXPathiOS,e.orLogicalName="TAGCHECKBOX",e.actionvalue="",await e;if(I=await async function(a){return!(!await a.includes("checkbox")&&!await a.includes("tickbox")||!await a.includes("all")||!await a.includes("uncheck")&&!await a.includes("unticked"))}(await i),await I)return e.actionName="Uncheck",e.actionvalue="",s=await m(await a,await t,"Uncheck"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.secondaryXPathiOS=await s.secondaryXPathiOS,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,await e;if(I=await async function(a){return!(!await a.includes("checkbox")&&!await a.includes("tickbox")||!await a.includes("all")||!await a.includes("uncheck")&&!await a.includes("unticked"))}(await i),await I)return e.actionName="UncheckAll",e.actionvalue="",e.orLogicalName="TAGCHECKBOX",e.primaryLocatorProperty=await parentTagForElement.CHECKBOX.TAG,e.iOSLocatorProperty=await parentTagForElement.CHECKBOX.IOSTAG,e.secondaryXPath=await s.secondaryXPath,e.secondaryXPathiOS=await s.secondaryXPathiOS,e.orLogicalName="TAGCHECKBOX",e.actionvalue="",await e;if(I=await async function(a){return!(!(await a.includes("click")||await a.includes("press")||await a.includes("hit")||await a.includes("trigger"))||await a.includes("rightclick")||await a.includes("doubleclick")||await a.includes("times")||!(await a.includes("all")||await a.includes("every")||await a.includes("entire")||await a.includes("wholly")))}(await i),await I)return e.actionName="ClickAll",e.actionvalue="",s=await m(await a,await t,"ClickAll"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e;if(I=await async function(a){return!(!(await a.includes("click")||await a.includes("press")||await a.includes("trigger")||await a.includes("choose")||await a.includes("tap"))||await a.includes("rightclick")||await a.includes("doubleclick")||await a.includes("times")||await a.includes("clickall")||await a.includes("lisbox")||await a.includes("dropdown")||await a.includes("keys")||await a.includes("every"))}(await i),await I)return e.actionName="Click",e.actionvalue="",s=await m(await a,await t,"Click"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e;if(I=await async function(a){return!(!await a.includes("tap")||await a.includes("double")||await a.includes("press")||await a.includes("long"))}(await i),await I)return e.actionName="Tap",e.actionvalue="",s=await m(await a,await t,"Tap"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e;if(I=await async function(a){return!(!(await a.includes("click")||await a.includes("press")||await a.includes("hit")||await a.includes("trigger"))||await a.includes("rightclick")||await a.includes("doubleclick")||await a.includes("clickall")||!(await a.includes("times")||await a.includes("rounds")||await a.includes("occasion")))}(await i),await I){e.actionName="ClickNTimes",e.actionvalue="",s=await m(await a,await t,"ClickNTimes"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS;var L="";""!==await await s.actionvalue&&(L=await JSON.parse(await s.actionvalue));var F=await L.index;return void 0!==await F&&(delete L.index,L.countofclick=await F,L=await JSON.stringify(await L)),e.actionvalue=await L,await e}if(I=await async function(a){return!(!(await a.includes("click")||await a.includes("press")||await a.includes("hit")||await a.includes("trigger"))||await a.includes("rightclick")||await a.includes("times")||await a.includes("all")||await a.includes("tap")||!await a.includes("double"))}(await i),await I)return e.actionName="DoubleClick",e.actionvalue="",s=await m(await a,await t,"DoubleClick"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e;if(I=await async function(a){return!(!(await a.includes("click")||await a.includes("press")||await a.includes("hit")||await a.includes("trigger"))||await a.includes("rightclick")||await a.includes("times")||await a.includes("all")||await a.includes("tap")||!await a.includes("long"))}(await i),await I)return e.actionName="LongClick",e.actionvalue="",s=await m(await a,await t,"LongClick"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e;if(I=await async function(a){return!!(await a.includes("drag")||await a.includes("tow")||await a.includes("schlep"))}(await i),await I)return e.actionName="DragandDrop",e.actionvalue="",s=await m(await a,await t,"DragandDrop"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,k=await s.actionvalue,""!==await k.trim()?((k=await JSON.parse(await k)).nextelement="provide element name",e.actionvalue=JSON.stringify(await k)):e.actionvalue='{"nextelement":"provide element name"}',await e;if(I=await async function(a){return!!(await a.includes("focus")||await a.includes("scroll")||await a.includes("moveto")||await a.includes("highlight"))}(await i),await I)return e.actionName="Focus",e.actionvalue="",s=await m(await a,await t,"Focus"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e;if(I=await async function(a){return!(!(await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("extract")||await a.includes("capture")||await a.includes("get"))||await a.includes("all")||await a.includes("every")||await a.includes("entire")||await a.includes("index")||await a.includes("position")||await a.includes("count"))}(await i),await I)return e.actionName="GetAttribute",e.actionvalue="",s=await m(await a,await t,"GetAttribute"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,k=await s.actionvalue,""!==await k.trim()?((k=await JSON.parse(await k)).attributename="provide attribute name",e.actionvalue=JSON.stringify(await k)):e.actionvalue='{"attributename":"provide attribute name"}',await e;if(I=await async function(a){return!(!(await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("extract")||await a.includes("capture")||await a.includes("get"))||await a.includes("index")||await a.includes("position")||await a.includes("count")||!(await a.includes("all")||await a.includes("every")||await a.includes("entire")))}(await i),await I)return e.actionName="GetAttributeForAllElements",e.actionvalue="",s=await m(await a,await t,"GetAttributeForAllElements"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,k=await s.actionvalue,""!==await k.trim()?((k=await JSON.parse(await k)).attributename="provide attribute name",e.actionvalue=JSON.stringify(await k)):e.actionvalue='{"attributename":"provide attribute name"}',await e;if(I=await async function(a){return!(!(await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("extract")||await a.includes("capture")||await a.includes("get"))||!await a.includes("index")&&!await a.includes("position")||await a.includes("all")||await a.includes("every")||await a.includes("entire"))}(await i),await I)return e.actionName="GetIndexOfTheElement",e.actionvalue="",s=await m(await a,await t,"GetIndexOfTheElement"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e;if(I=await async function(a){return!!await a.includes("tagname")}(await i),await I)return e.actionName="GetTagName",e.actionvalue="",s=await m(await a,await t,"GetTagName"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e;if(I=await async function(a){return!(!(await a.includes("select")||await a.includes("choose")||await a.includes("pick"))||!(await a.includes("listbox")||await a.includes("selectbox")||await a.includes("dropdown")||await a.includes("select"))||await a.includes("option")||await a.includes("index"))}(await i),await I)return e.actionName="SelectByVisibleText",e.actionvalue="",s=await m(await a,await t,"SelectByVisibleText"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,k=await s.actionvalue,""!==await k.trim()?e.actionvalue=await k:e.actionvalue='{ "valuetobesend": "Provide text" }',await e;if(I=await async function(a){return!(!(await a.includes("select")||await a.includes("choose")||await a.includes("pick"))||!(await a.includes("listbox")||await a.includes("selectbox")||await a.includes("dropdown")||await a.includes("select"))||!await a.includes("option")&&!await a.includes("index"))}(await i),await I){if(e.actionName="SelectByIndex",e.actionvalue="",s=await m(await a,await t,"SelectByVisibleText"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,k=await s.actionvalue,""!==await k.trim()){if(k=await JSON.parse(await k),void 0!==await k.index){var U=await k.index;delete k.index,k.valuetobesend=await U}else k.valuetobesend="Provide index";e.actionvalue=JSON.stringify(await k)}else e.actionvalue='{ "valuetobesend": "Provide text" }';return await e}return I=await async function(a){return!(!await a.includes("frame")||await a.includes("default")||await a.includes("parent")||await a.includes("top"))}(await i),await I?(e.actionName="SwitchToFrame",e.actionvalue="",s=await m(await a,await t,"SwitchToFrame"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e):(I=await async function(a){return!(!await a.includes("frame")||!(await a.includes("default")||await a.includes("parent")||await a.includes("top")||await a.includes("main")))}(await i),await I?(e.actionName="SwitchToDefaultContent",e.actionvalue="",await e):(I=await async function(a){return!(!(await a.includes("textbox")||await a.includes("set")||await a.includes("input")||await a.includes("editbox")||await a.includes("inputbox")||await a.includes("inputfield")||await a.includes("databox")||await a.includes("searchbox")||await a.includes("searchbar")||await a.includes("provide")||await a.includes("type")||await a.includes("put")||await a.includes("sendkeys")||await a.includes("enter")||await a.includes("field")||await a.includes("leave")||await a.includes("fill"))||await a.includes("all")||await a.includes("form"))}(await i),await I?(e.actionName="Type",e.actionvalue="",s=await m(await a,await t,"Type"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,k=await s.actionvalue,""!==await k.trim()?e.actionvalue=await k:(D=await S(await a),""!==await D?((g={valuetobesend:"Provide text"}).valuetobesend=await D,e.actionvalue=await JSON.stringify(await g)):e.actionvalue='{ "valuetobesend": "Provide text" }'),(await i.includes("leave")||await i.includes("empty")||await i.includes("blank"))&&(e.actionvalue='{ "valuetobesend": "" }'),await e):(I=await async function(a){return!(!(await a.includes("textbox")||await a.includes("set")||await a.includes("input")||await a.includes("editbox")||await a.includes("inputbox")||await a.includes("inputfield")||await a.includes("databox")||await a.includes("searchbox")||await a.includes("searchbar")||await a.includes("provide")||await a.includes("type")||await a.includes("put")||await a.includes("sendkeys")||await a.includes("enter")||await a.includes("field")||await a.includes("leave")||await a.includes("fill"))||!await a.includes("all")&&!await a.includes("form"))}(await i),await I?(e.actionName="TypeAll",e.actionvalue="[]",e.orLogicalName="TAGTEXTBOX",e.primaryLocatorProperty=await t.TEXTBOX.TAG,e.iOSLocatorProperty=await t.TEXTBOX.IOSTAG,e.secondaryXPathiOS=await t.TEXTBOX.IOSTAG,e.secondaryXPath=await t.TEXTBOX.TAG,await e):(I=await async function(a){return!(!(await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("get")||await a.includes("capture")||await a.includes("extract"))||!(await a.includes("count")||await a.includes("tally")||await a.includes("total")||await a.includes("all")))}(await i),await I?(e.actionName="Count",e.actionvalue="",s=await m(await a,await t,"Count"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e):(p=await async function(a){return!(!(await a.includes("run")||await a.includes("hit")||await a.includes("execute")||await a.includes("trigger")||await a.includes("command")||await a.includes("cmd"))||!await a.includes("android")&&!await a.includes("adb"))}(await i),await p?(e.actionName="RunADBCommand",h=await x(await a),0==await h.length?e.actionvalue='{"valuetobesend":"adbcommand"}':(y=await h[0],(g={valuetobesend:"adbcommand"}).valuetobesend=await y,e.actionvalue=await JSON.stringify(await g)),await e):(p=await async function(a){return!(!(await a.includes("send")||await a.includes("type")||await a.includes("provide")||await a.includes("enter"))||!await a.includes("keypad")&&!await a.includes("keyboard"))}(await i),await p?(e.actionName="SendKeysUsingKeyPad",D=await v(await a),""!==await D?((g={valuetobesend:"keypadkeyname"}).valuetobesend=await D,e.actionvalue=await JSON.stringify(await g)):(D=await S(await a),""!==await D?((g={valuetobesend:"keypadkeyname"}).valuetobesend=await D,e.actionvalue=await JSON.stringify(await g)):e.actionvalue='{ "valuetobesend": "keypadkeyname" }'),await e):(p=await async function(a){return!(!(await a.includes("run")||await a.includes("hit")||await a.includes("execute")||await a.includes("trigger")||await a.includes("command")||await a.includes("cmd"))||!await a.includes("kernel")&&!await a.includes("shell"))}(await i),await p?(e.actionName="RunShellCommand",h=await x(await a),0==await h.length?e.actionvalue='{"valuetobesend":"kernelcommand"}':(y=await h[0],(g={valuetobesend:"kernelcommand"}).valuetobesend=await y,e.actionvalue=await JSON.stringify(await g)),await e):(I=await async function(a){return!(!await a.includes("zoom")||!await a.includes("in")&&!await a.includes("plus"))}(await i),await I?(e.actionName="ZoomIn",e.actionvalue="",s=await m(await a,await t,"ZoomIn"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e):(I=await async function(a){return!(!await a.includes("zoom")||!(await a.includes("out")||await a.includes("minus")||await a.includes("decrease")))}(await i),await I?(e.actionName="ZoomOut",e.actionvalue="",s=await m(await a,await t,"ZoomIn"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e):(I=await async function(a){return!!await a.includes("pinch")}(await i),await I?(e.actionName="Pinch",e.actionvalue="",s=await m(await a,await t,"Pinch"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e):(I=await async function(a){return!!(await a.includes("swipe")&&await a.includes("left")&&(await a.includes("at")||await a.includes("on")||await a.includes("in")||await a.includes("near")))}(await i),await I?(e.actionName="SwipeLeftAt",e.actionvalue="",s=await m(await a,await t,"Pinch"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e):(I=await async function(a){return!!(await a.includes("swipe")&&await a.includes("right")&&(await a.includes("at")||await a.includes("on")||await a.includes("in")||await a.includes("near")))}(await i),await I?(e.actionName="SwipeRightAt",e.actionvalue="",s=await m(await a,await t,"Pinch"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e):(I=await async function(a){return!!(await a.includes("swipe")&&await a.includes("up")&&(await a.includes("at")||await a.includes("on")||await a.includes("in")||await a.includes("near")))}(await i),await I?(e.actionName="SwipeUpAt",e.actionvalue="",s=await m(await a,await t,"Pinch"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e):(I=await async function(a){return!!(await a.includes("swipe")&&await a.includes("down")&&(await a.includes("at")||await a.includes("on")||await a.includes("in")||await a.includes("near")))}(await i),await I?(e.actionName="SwipeDownAt",e.actionvalue="",s=await m(await a,await t,"Pinch"),e.primaryLocatorProperty=await s.primaryLocatorProperty,e.secondaryXPath=await s.secondaryXPath,e.orLogicalName=await s.orLogicalName,e.actionvalue=await s.actionvalue,e.iOSLocatorProperty=await s.iOSLocatorProperty,e.secondaryXPathiOS=await s.secondaryXPathiOS,await e):await e))))))))))))))}(await c,await l);""!==await d.actionName&&(r.actionName=await d.actionName,r.actionvalue=await d.actionvalue,r.orLogicalName=await d.orLogicalName,r.primaryLocatorProperty=await d.primaryLocatorProperty,r.iOSLocatorProperty=await d.iOSLocatorProperty,r.secondaryXPath=await d.secondaryXPath,r.secondaryXPathiOS=await d.secondaryXPathiOS)}catch(a){r.actionName="",r.orLogicalName="",r.primaryLocator="Xpath",r.primaryLocatorProperty="",r.secondaryXPath="",r.secondaryXPathiOS="",r.actionvalue=""}t.json(await r)}),r.post("/breakSteps",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var r=[],w=await a.body.step;try{let a=await n(await w);w=await a.normalize().out("text");let t=await n(await w);await t.normalize(),await t.contractions().expand(),w=await t.text()}catch(t){w=await a.body.step}const t=await w.match(/[a-zA-Z0-9._,]+/g);w=await t?await t.join(" "):"",r=await b(await w)}catch(a){(r=[]).push(await w)}t.json(await r)}),r.post("/gettestdatacolumn",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var r=[],n=await a.body.step;const t=await n.match(/[a-zA-Z0-9._,]+/g);n=await t?await t.join(" "):"";var w=await l(await n),o=await d(await n);r=await p(await w,await o)}catch(a){r=[]}t.json(await r)}),a.exports=r},636:a=>{"use strict";a.exports=require("selenium-webdriver/remote")},645:(a,t,e)=>{const{isDirectoryExist:i,readLargeJsonFile:r}=e(7229),{get:s,post:n,put:w,patch:o,Delete:c,head:u,options:l}=e(382),{generateRandomNumberWithNDigits:d,getPassword:p,getTitle:m,getUserName:v,getURl:g,getEmail:h,getFirstName:f,getLastName:y,getAddress:b,getUuid:S,getCountry:x,getPhoneNumber:M,getState:N,getCity:T,getZipCode:E,getWords:A,getNumberFromRange:P,addOrSubtractDaysToCurrentDate:C,getString:k,extractNumberFromString:j,splitAndSaveIndexValue:D,addTwoNumber:O,subtractTwoNumber:I,multiplyTwoNumber:L,devideTwoNumber:F,reminderTwoNumber:U,getPercentage:V,addPercentageInNumber:B,subtractPercentageInNumber:R,sumOfArray:J,getipv4:X,getipv6:W,getAirline:Y,getAirPlane:G,getFlightNumber:Q,getAccountName:q,getAccountNumber:Z,getCardCVV:K,getCardIssuer:H,getCardNumber:_,getbicycle:z,getcolor:$,getfuel:aa,getmodel:ta,getvehicle:ea,getvin:ia,getvrm:ra,getdepartment:sa,getdproduct:na,getdproductDescription:wa,getproductMaterial:oa,getproductName:ca,getjobTitle:ua,getjobType:la,getzodiacSign:da,getmac:pa,getuserAgent:ma,getdomainName:va,getavatar:ga,getDateDifference:ha,getPhoneImEI:fa}=e(6777),ya="./dataHub/";var ba=e(9896);const Sa=e(2410),xa=(e(6928),e(4716)),Ma=e(6212);async function Na(a,t,e){var i=await a.Url[await t];for(let a=0;a<await i.length;a++)if(await i[a].name===await e)return await i[a].url;throw new Error(await e+" does not exist under environment "+await t)}async function Ta(a,t,e){var i={};for(let r=0;r<await a.length;r++)i[await a[r][await t]]=await a[r][await e];return i}async function Ea(a,t,e,i,r,s){return a=await Pa(await a,await i,await r),a=await async function(a){var t=await a;try{if(!await JSON.stringify(await a).toLocaleLowerCase().includes("{{randomdata."))return await t}catch(a){}var e=await Aa(await a,"{{RandomData.");if(e.length>0){try{var i=await JSON.stringify(await t);for(let a=0;a<await e.length;a++){var r=await e[a];await r.includes("||")?(r.split("||")[0],r.split("||")[1]):await r;var s=await Ga(r);let t=typeof await s;i="number"===await t?await i.replaceAll('"{{RandomData.'+await r+'}}"',Number(await s)):"object"===t?await i.replaceAll('"{{RandomData.'+await r+'}}"',JSON.stringify(await s)):await i.replaceAll("{{RandomData."+await r+"}}",s)}}catch(a){}return await JSON.parse(await i)}return await a}(await a),a=await async function(a,t){var e=await a;try{if(!await JSON.stringify(await a).toLocaleLowerCase().includes("{{file."))return await e}catch(a){}var i=!1,r=await Aa(await a,"{{File.");if(0===await r.length&&(i=!0,r=await Aa(await a,"{{file.")),r.length>0){try{var s=await JSON.stringify(await e);for(let a=0;a<await r.length;a++){var n=await r[a],w=await ya+await t+"/Api/Uploads/"+await n,o=await Sa.sync(await w);if(await o.length>0){var c=await w;s=await i?await s.replaceAll("{{file."+await n+"}}",c):await s.replaceAll("{{File."+await n+"}}",c)}}}catch(a){}return await JSON.parse(await s)}return await a}(await a,await s),await Ca(await a,await t,await e,await i,await r)}async function Aa(a,t){var e=[];try{a=await JSON.stringify(await a);var i=await a.split(t);for(let a=0;a<await i.length;a++){var r=await i[a];if(await r.includes("}}")){var s=await r.split("}}")[0];await e.push(await s)}}}catch(a){}return await e}async function Pa(a,t,e){var i=await a;try{if(!await JSON.stringify(await a).toLocaleLowerCase().includes("{{c."))return await i}catch(a){}var r=!0,s=await Aa(await a,"{{c.");if(0===await s.length&&(r=!1,s=await Aa(await a,"{{C.")),s.length>0){try{var n=await JSON.stringify(await i);for(let a=0;a<await s.length;a++){var w=await s[a];try{var o=await t[await w][await e];void 0!==await o&&(n=await r?await n.replaceAll("{{c."+await w+"}}",o):await n.replaceAll("{{C."+await w+"}}",o))}catch(a){if(void 0===await o)try{var c=await t.CommonTestData;void 0!==await c&&(o=await c[await w][await e],void 0!==await o&&(n=await r?await n.replaceAll("{{c."+await w+"}}",o):await n.replaceAll("{{C."+await w+"}}",o)))}catch(a){}}}}catch(a){}return await JSON.parse(await n)}return await a}async function Ca(a,t,e,i,r){var s=await a;try{if(!await JSON.stringify(await a).toLocaleLowerCase().includes("{{"))return await s}catch(a){}var n=await Aa(await a,"{{");if(await n.length>0){var w=await JSON.stringify(await s);for(let a=0;a<await n.length;a++){var o=await n[a],c=await e[t][o];if(void 0===await c){var u=await Object.keys(await e);for(let a=0;a<await u.length;a++){var l=await u[a];if(await t!==l&&(c=await e[await l][await o],void 0!==await c))break}}var d=new RegExp("{{"+o+"}}","g");let i=typeof await c;w="number"===await i?await w.replace(await d,await Number(await c)):"object"===i?await w.replace(await d,await JSON.stringify(await c)):await w.replace(await d,await c)}return await JSON.parse(await w)}return await a}async function ka(a,t,e,i,r,s,n,w,o){var c={};console.log("Dependent API - Getting All Child");let u=await xa();var l=await async function(a,t,e,i,r){var s=await async function(a,t,e,i){var r=[],s=[];try{for(;0!==await s.length||0!==await i.length;){var n={};n[await e]=await i,r.push(await n);for(let a=0;a<await i.length;a++)s.push(await i[a]);var w=await s[0].component,o=await s[0].testid;e=await o.split("@")[0];var c=await ya+await a+"/"+await t+"/Api/TestScripts/"+w+"/"+o+".json",u=await JSON.parse(await ba.readFileSync(await c,"utf8"));i=await u.DependendtApiScripts,s.splice(0,1)}}catch(a){}return r}(await a,await t,await e,await i);if("Integration Testing"===await r)return await s;if(await s.length>0){let a=await s.slice(0,1);return await a}return await s}(await a,await t,await i,await r,await e);let d=xa(),p=(await xa.duration(d.diff(u))).asSeconds();console.log("Dependent API - Getting All Child executed on "+p+" seconds.");var m=await l.length;for(let i=0;i<await m;i++){var v=await l[m-(i+1)],g=Object.keys(await v)[0],h=await v[await g];if(await h.length>0)for(let i=0;i<await h.length;i++){var f=await ja(await h,"seq",(i+1).toString());if(f.length>0){var y=await h[f[0]].component,b=await h[f[0]].testid,S=await b.split("@")[0],x=await b.split("@")[1],M=await h[f[0]].reqoverridekey;if(void 0!==await M)try{M=await JSON.parse(await M),M=await Pa(await M,await o,await s)}catch(a){M={}}var N=await Da(await a,await t,await y,await S,await x),T=await N.ComponentUrl,E=await Na(await n,await s,await T),A=await N.RelativeUrl;A=await Qa(await A,await M);var P=await N.RequestHeader,C=await N.HttpMethod,k=await Ta(await P,"key","value");k=await Za(await k,await M);var j=await N.RequestBody[1];if(j=await qa(await j,await M),"Unit Testing"!==await e){j=await Ea(await j,await S,await w,await o,await s,await t),E=await Ea(await E,await S,await w,await o,await s,await t),k=await Ea(await k,await S,await w,await o,await s,await t),A=await Ea(await A,await S,await w,await o,await s,await t);var D=await N.AutherizationCredentialsKey;void 0===await D&&(D="");var O=await $a(await D,await n,await o,await s)}if(E+=A,"Unit Testing"===await e){let e=await xa();console.log("Fetching Mock Data from the Existing Server.");var I=await Oa(await a,await E,await C,await k,await j,await y,await S,await x,await t,await o,await s);let i=xa(),r=(await xa.duration(await i.diff(await e))).asSeconds();console.log("Fetching Mock Data from the Existing Server are getting in "+r+" seconds.")}else{I=await Ia(await E,await C,await k,await j,await O);var L=await _a(await t,await y,await b);if(await L)try{if(Number(await I.ResponseCode)>=200&&Number(await I.ResponseCode)<300){var F=await I.ResponseHeader,U=await I.ResponseBody;await za(await t,await y,await b,await U,await F)}}catch(a){}}let i=await xa();console.log("Getting Variable from the Dependent Response");for(let a=0;a<f.length;a++){var V=await h[f[a]].variable;try{var B=await JSON.parse(await V);B=await Pa(await B,await o,await s);var R=await Object.keys(await B);for(let a=0;a<await R.length;a++){var J=await R[a],X=await B[await J],W=await La(await X),Y=await Fa(await I,await W);if(void 0===w[g]&&(w[g]={}),"number"==typeof await Y&&(Y=await Number(await Y)),void 0===await Y)return c[b]=await I,c[b].errorMessage=await J+" key with value "+await X+" does not exist on Response Data.",c;w[await g][await J]="",w[await g][await J]=await Y}}catch(a){}}c[b]=await I;let r=xa(),u=(await xa.duration(r.diff(i))).asSeconds();console.log("Getting Variable from the Dependent Response step completed on "+u+" seconds.")}}}return c}async function ja(a,t,e){var i=[];for(let r=0;r<await a.length;r++)await a[r][t]===e&&i.push(r);return i}async function Da(a,t,e,i,r){var s={};try{var n=await i+"@"+await r,w=await ya+await a+"/"+await t+"/Api/TestScripts/"+await e+"/"+await n+".json";s=await JSON.parse(await ba.readFileSync(await w,"utf8"))}catch(a){}return s}async function Oa(a,t,e,i,s,n,w,o,c,u,l){var d={},p=!1;switch(await e.trim().toLocaleLowerCase()){case"post":case"put":case"patch":p=!0}try{var m=await async function(a,t,e,i,s){testDetails={};let n=await xa();try{console.log("Reading Mock Response File.....");var w=await i+"@"+await s,o=await ya+await a+"/"+await t+"/Api/MockRepo/"+await e+"/"+await w+".json";testDetails=await r(await o)}catch(a){testDetails={}}let c=xa(),u=(await xa.duration(await c.diff(await n))).asSeconds();return console.log("File data is successfully fetched in  "+u+" seconds."),testDetails}(await a,await c,await n,await w,await o),v=await m.ResponseBody.MockedResponseBody,g=await v,h=await m.ResponseHeader;if(!await m.IsMockResponseOverride||void 0===await m.IsMockResponseOverride){try{v=await Ea(await v,await w,{},await u,await l,await c)}catch(a){v=await g}h=await Ta(await h,"key","value");var f=await h;try{h=await Ea(await h,await w,{},await u,await l,await c)}catch(a){h=await f}}d.Url=t,d.Method=e,d.ResponseCode=200,d.ResponseBody=await v,d.ResponseHeader=await h,p&&(d.RequestBody=await s),Object.keys(await i).length>0&&(d.RequestHeader=await i)}catch(a){d.error="Mock Response data is not found on server, or Mock response data is not valid ."+await a}return d}async function Ia(a,t,e,i,r){var d,p={},m=!1;switch(t.trim().toLocaleLowerCase()){case"get":d=await s(await a,await e,await r);break;case"post":d=await n(await a,await e,await i,await r),m=!0;break;case"put":d=await w(await a,await e,await i,await r),m=!0;break;case"patch":d=await o(await a,await e,await i,await r),m=!0;break;case"delete":d=await c(await a,await e,await i,await r);break;case"head":d=await u(await a,await e,await i,await r);break;case"options":d=await l(await a,await e,await i,await r)}p.Url=await a,p.Method=await t;var v=await d.status;void 0===await v&&(v="error:Requested service does not give any response."),p.ResponseCode=await v;var g=await d.data;return void 0===await g&&(g="error:Requested service does not give any response."),p.ResponseBody=await g,p.ResponseHeader=await d.headers,m&&(p.RequestBody=await i),await Object.keys(await e).length>0&&(p.RequestHeader=await e),""!==await r&&(p.Requestauth=await r),await p}async function La(a){var t=[];if(await a.includes("[")&&await a.includes("]")){var e=await a.split("[");for(let a=0;a<await e.length;a++){var i=await e[a];if(""!==await i.trim()){var r=await i.split("]")[0];t.push(await r)}}}else t.push(await a);return await t}async function Fa(a,t){try{var e=await a;for(let a=0;a<await t.length;a++){var i=await Ua(await t[a]);e=await e[await i]}}catch(a){}return await e}async function Ua(a){return isNaN(await a)||(a=await Number(await a)),await a}async function Va(a,t,e,i,r,s,n){var w;try{for(let m=0;m<await t.length;m++){var o=await t[m].variable,c=await JSON.parse(await o),u=await Object.keys(await c);for(let t=0;t<await u.length;t++){var l=await u[t],d=await c[await l];l=await Pa(await l,await s,await n),d=await Pa(await d,await s,await n);var p=await La(await d);await p.shift(),await d.toLocaleLowerCase().includes("requestbody")&&(w=await Fa(await i,await p),"number"==typeof await w&&(w=Number(await w))),await d.toLocaleLowerCase().includes("requestheader")&&(w=await Fa(await e,await p),"number"==typeof await w&&(w=Number(await w))),void 0===await r[await a]&&(r[await a]={}),r[a][l]="",void 0===await w?r[await a][await l]="Key not found":r[await a][await l]=await w}}}catch(o){for(let o=0;o<await t.length;o++)l=await t[o].variable,d=await t[o].key,l=await Pa(await l,await s,await n),d=await Pa(await d,await s,await n),p=await La(await d),await p.shift(),await d.toLocaleLowerCase().includes("requestbody")&&(w=await Fa(await i,await p),"number"==typeof await w&&(w=Number(await w))),await d.toLocaleLowerCase().includes("requestheader")&&(w=await Fa(await e,await p),"number"==typeof await w&&(w=Number(await w))),void 0===await r[await a]&&(r[await a]={}),r[a][l]="",void 0===await w?r[await a][await l]="Key not found":r[await a][await l]=await w}}async function Ba(a,t,e=""){for(let i=0;i<await a.length;i++)a[await i][await t]=await e;return await a}async function Ra(a,t){for(let w=0;w<await t.length;w++){var e=await t[w].expression,i=await t[w].function,r=await La(await e),s=await Fa(await a,r);void 0===await s&&(s="Key not found!"),await i.toString().toLowerCase().includes("length")&&(s=await s.length),"object"==typeof await s?t[w].actual=await JSON.stringify(await s):t[w].actual=await s;var n=await t[w].expected;t[await w].expected=await Ca(await n)}return await t}async function Ja(a,t){var e=await a.length+1;for(let r=0;r<await t.length;r++){var i={id:await e,expression:await t[r].expression,function:await t[r].function,expected:await t[r].expected,actual:await t[r].actual};a.push(await i),e=await e+1}return await a}async function Xa(a,t,e){switch(await a){case"ShouldBe":return e=await Wa(await e),t=await Wa(await t),await e===await t;case"ShouldContains":return await e.toString().toLocaleLowerCase().includes(await t.toLocaleLowerCase());case"LengthShouldBe":return Number(await e)===Number(await t);case"LengthGreaterThanEqualTo":return Number(await e)>=Number(await t);case"LengthLessThanEqualTo":return Number(await e)<=Number(await t);case"KeyShouldExist":return void 0!==await e;case"KeyShouldNotExist":return void 0===await e;case"ShouldBeNull":return null===await e;case"ShouldNotBeNull":return null!==await e;case"ValueBetween":var i=await t.toString().trim().split("-")[0];i=await Ya(await i);var r=await t.toString().trim().split("-")[1];return r=await Ya(await r),await e>=await i&&await e<=await r;case"ShouldBeInTheList":return await t.includes(await e);case"ShouldNotBeInTheList":return!await t.includes(await e);default:return!1}}async function Wa(a){var t=typeof await a;switch(await t.toString().toLocaleLowerCase()){case"string":a=await a.toString(),isNaN(await a)||(a=await Number(await a));break;case"number":a=Number(await a);break;case"object":a=await JSON.stringify(await a);break;case"boolean":a=Boolean(await a);break;default:a=await a.toString()}return await a}async function Ya(a){return await Number(await a.toString().replace(/[^0-9.]+/gi,""))}async function Ga(a){var t=await a.split("||"),e=await t[0].split("(")[0];switch(await e){case"firstName":return await f();case"url":return await g();case"sumOfArray":var i=await t[1];return i=await i.split(")")[0],await J(await i);case"lastName":return await y();case"address":return await b();case"email":return await h();case"uuid":return await S();case"country":return await x();case"state":return await N();case"city":return await T();case"zipCode":return await E();case"phoneNumber":return await M();case"phoneimei":return await fa();case"word":return i=await t[1],i=void 0===(i=await i.split(")")[0])?1:await Number(i),await A(await i);case"string":return i=await t[1],i=void 0===(i=await i.split(")")[0])?10:await Number(i),await k(await i);case"number":i=await t[1];var r=1,s=99999;return void 0!==(i=await i.split(")")[0])&&(r=await Number(i.split(",")[0]),s=await Number(i.split(",")[1])),await P(await r,await s);case"date":i=await t[1];var n=0,w="DD MMM yyyy";if(void 0!==(i=await i.split(")")[0])){n=await Number(i.split(",")[0]),w=await i.split(",")[1];try{var o=await i.split(",")[2]}catch(a){o=void 0}}var c=await C(await n,await w,await o);return await c;case"getDateDifference":i=await t[1],n=0;var u="",l="",d="",p="DD-MMM-yyyy",m="DD-MMM-yyyy";if(void 0!==(i=await i.split(")")[0])){u=await i.split(",")[0],l=await i.split(",")[1];try{d=await i.split(",")[2],void 0===await d&&(d="days")}catch(a){d="days"}try{p=await i.split(",")[3],void 0===await p&&(p="DD-MMM-yyyy")}catch(a){p="DD-MMM-yyyy"}try{m=await i.split(",")[4],void 0===await m&&(m="DD-MMM-yyyy")}catch(a){m="DD-MMM-yyyy"}}return c=await ha(await u,await l,await d,await p,m),await c;case"extractNumberFromString":i=await t[1];var v="",F=!0;if(void 0===(i=await i.split(",")))return 0;v=await Number(await i[0]);try{F=await i[1],F="true"===await F.toLocaleLowerCase()}catch(a){await F,F=!0}return await j(await v,await F);case"splitAndSaveIndexValue":i=await t[1],v="";var U="",z="";if(void 0===(i=await i.split(",")))return"Error-Provide correct Input";v=await i[0];try{U=await i[1]}catch(a){U=""}try{z=await Number(await i[2])}catch(a){z=0}return await D(await v,await U,await z);case"addTwoNumber":i=await t[1];var ya=0,ba=0,Sa=0;if(F=!0,void 0===(i=await i.split(",")))return 0;ya=await Number(await i[0].trim());try{ba=await Number(await i[1].trim())}catch(a){ba=0}try{Sa=await Number(await i[2].trim())}catch(a){Sa=0}return await O(await ya,await ba,await Sa);case"subtractTwoNumber":if(i=await t[1],ya=0,ba=0,Sa=0,F=!0,void 0===(i=await i.split(",")))return 0;ya=await Number(await i[0].trim());try{ba=await Number(await i[1].trim())}catch(a){ba=0}try{Sa=await Number(await i[2].trim())}catch(a){Sa=0}return await I(await ya,await ba,await Sa);case"multiplyTwoNumber":if(i=await t[1],ya=0,ba=0,Sa=0,F=!0,void 0===(i=await i.split(",")))return 0;ya=await Number(await i[0].trim());try{ba=await Number(await i[1].trim())}catch(a){ba=0}try{Sa=await Number(await i[2].trim())}catch(a){Sa=0}return await L(await ya,await ba,await Sa);case"devideTwoNumber":if(i=await t[1],ya=0,ba=0,Sa=0,F=!0,void 0===(i=await i.split(",")))return 0;ya=await Number(await i[0].trim());try{ba=await Number(await i[1].trim())}catch(a){ba=0}try{Sa=await Number(await i[2].trim())}catch(a){Sa=0}return await L(await ya,await ba,await Sa);case"reminderTwoNumber":if(i=await t[1],ya=0,ba=0,Sa=0,F=!0,void 0===(i=await i.split(",")))return 0;ya=await Number(await i[0].trim());try{ba=await Number(await i[1].trim())}catch(a){ba=0}try{Sa=await Number(await i[2].trim())}catch(a){Sa=0}return await L(await ya,await ba,await Sa);case"getPercentage":if(i=await t[1],ya=0,ba=0,Sa=0,F=!0,void 0===(i=await i.split(",")))return 0;ya=await Number(await i[0].trim());try{ba=await Number(await i[1].trim())}catch(a){ba=0}try{Sa=await Number(await i[2].trim())}catch(a){Sa=0}return await V(await ya,await ba,await Sa);case"addPercentageInNumber":if(i=await t[1],ya=0,ba=0,Sa=0,F=!0,void 0===(i=await i.split(",")))return 0;ya=await Number(await i[0].trim());try{ba=await Number(await i[1].trim())}catch(a){ba=0}try{Sa=await Number(await i[2].trim())}catch(a){Sa=0}return await B(await ya,await ba,await Sa);case"subtractPercentageInNumber":if(i=await t[1],ya=0,ba=0,Sa=0,F=!0,void 0===(i=await i.split(",")))return 0;ya=await Number(await i[0].trim());try{ba=await Number(await i[1].trim())}catch(a){ba=0}try{Sa=await Number(await i[2].trim())}catch(a){Sa=0}return await R(await ya,await ba,await Sa);case"ipv4":return await X();case"ipv6":return await W();case"airline":return await Y();case"airplane":return await G();case"flightNumber":return await Q();case"accountName":return await q();case"accountNumber":return await Z();case"creditCardCVV":return await K();case"creditCardIssuer":return await H();case"creditCardNumber(cardtype)":return i=await t[1],void 0===(i=await i.split(")")[0])&&(i="visa"),await _(await i);case"bicycle":return awaitgetbicycle();case"color":return await $();case"fuel":return await aa();case"model":return await ta();case"vehicle":return await ea();case"vin":return await ia();case"vrm":return await ra();case"department":return await sa();case"product":return await na();case"productDescription":return await wa();case"productMaterial":return await oa();case"productName":return await ca();case"jobTitle":return await ua();case"jobType":return await la();case"zodiacSign":return await da();case"mac":return await pa();case"userAgent":return await ma();case"domainName":return await va();case"avatar":return await ga();default:return""}}async function Qa(a,t){if(void 0!==await t)try{await Object.keys(await t).length>0&&void 0!==await t.relativeUrl&&(a=await t.relativeUrl.toString().trim())}catch(t){return await a}return await a}async function qa(a,t){if(void 0!==await t)try{var e=await Object.keys(await t);if(await e.length>0)for(let n=0;n<await e.length;n++){var i=await e[n],r=await t[await i];if(await i.toString().toLocaleLowerCase().startsWith("requestbody")){var s=await La(await i);await s.shift(),a=await Ka(await a,await s,await r)}}}catch(a){}return await a}async function Za(a,t){if(void 0!==await t)try{var e=await Object.keys(await t);if(await e.length>0)for(let n=0;n<await e.length;n++){var i=await e[n],r=await t[await i];if(await i.toString().toLocaleLowerCase().startsWith("requestheader")){var s=await La(await i);await s.shift(),a=await Ka(await a,await s,await r)}}}catch(a){}return await a}async function Ka(a,t,e){var i=await a,r=[];for(let e=0;e<t.length-1;e++){var s={},n=await Ha(await t[e]);s[await n]=await a[await n],r.push(s),a=await a[await n]}(s={})[await Ha(t[t.length-1])]=await e,r.push(s);var w=r.length;for(let a=0;a<w-1;a++){var o=w-(a+1),c=o-1,u=await Ha(await t[o]),l=await Ha(await t[c]);r[c][l][u]=await r[o][u]}var d=await Ha(await t[0]);return i[d]=await r[0][d],await i}async function Ha(a){return isNaN(await a)||(a=Number(await a)),a}async function _a(a,t,e){var i=!1;try{var r=await ya+await a+"/Api/MockRepo/"+await t+"/"+await e+".json";await ba.existsSync(await r)&&(i=!0)}catch(a){}return await i}async function za(a,t,e,i,r){var s,n=!1;try{var w=await ya+await a+"/Api/MockRepo/"+await t+"/"+await e+".json";if(await ba.existsSync(await w)){var o=await JSON.parse(await ba.readFileSync(await w,"utf8"));if(void 0!==await o.IsMockResponseOverride&&await o.IsMockResponseOverride){try{s=await Ma.lock(await w,{retries:{retries:10,minTimeout:500,maxTimeout:2e3,factor:2}})}catch(a){throw console.log("File "+w+" is locked by another user, Please try after sometime."),new Error("File "+w+" is locked by another user, Please try after sometime.")}o.ResponseBody={},o.ResponseBody.MockedResponseBody={},o.ResponseHeader=[],o.ResponseBody.MockedResponseBody=await i;var c=await Object.keys(await r);for(let a=0;a<await c.length;a++){var u,l=await c[a],d=await r[await l];u={id:await Number(a+1),key:await l,value:await d},o.ResponseHeader.push(await u)}var p=await JSON.stringify(await o);await ba.writeFileSync(await w,await p);try{await s()}catch(a){}n=!0}}}catch(a){console.log("Unable to save response data on Mock repository for component "+await t+" and test "+await e+". becuase of "+await a.toString());try{await s()}catch(a){}}return await n}async function $a(a,t,e,i){if(void 0===await a||""===await a)return"";var r=await t.Authorization;if(void 0===await r)return"";if(0===await r.length)return"";for(let t=0;t<await r.length;t++){var s=await r[t].key;if(await s===await a){var n=await r[t].username;n=await Pa(await n,await e,await i);var w=await r[t].password;w=await Pa(await w,await e,await i);var o={username:await n,password:await w};return await o}}return""}async function at(a){var t=!1;try{var e=await Object.keys(await a);if(await e.length>0)for(let t=0;t<await e.length;t++){var i=await e[t],r=await a[await i];if(void 0!==await r.errorMessage&&""!==await r.errorMessage)return!0}}catch(a){t=!1}return await t}async function tt(a){var t="";try{var e=await Object.keys(await a);if(await e.length>0)for(let t=0;t<await e.length;t++){var i=await e[t],r=await a[await i];if(void 0!==await r.errorMessage&&""!==await r.errorMessage)return await r.errorMessage}}catch(a){t=""}return await t}a.exports={executeApiTestScript:async function(a,t,e,i,r,s,n,w,o,c,u,l){try{var d=new Date,p={isSuccess:"Pass",assertionData:[],responseData:{},executiontime:0},m=await async function(a,t,e,i){var r={isSuccess:"Pass",assertionData:[],responseData:{},executiontime:0},s=await ya+await a+"/"+await t+"/Api/TestScripts/"+await e+"/"+await i+".json";if(!await ba.existsSync(await s)){var n={};n.errorMessage="Test script "+await i+" does not found on the server.";var w={id:1,stepdefinition:"Test Script Execution",action:"NA",testdata:await n,status:"Fail",screenshot:""};r.assertionData.push(await w),r.isSuccess="Fail"}return await r}(await a,await t,await e,await r);if("Fail"===!await m.isSuccess)return console.log("********* Test script "+await r+" does not exist under the component "+await e),await m;console.log("********* Test script "+await r+" execution started for component "+await e);var v=0,g={},h=[],f=await ya+await a+"/"+await t+"/Api/TestScripts/"+await e+"/"+await r+".json",y=await JSON.parse(await ba.readFileSync(await f,"utf8")),b=await y.ComponentUrl,S=await Na(await w,await n,await b),x=await y.RelativeUrl;x=await Qa(await x,await u),S=await S+await x;var M=await y.RequestHeader,N=await y.HttpMethod,T=await Ta(await M,"key","value");T=await Ea(await T,await s,await o,await l,await n,await t);var E=await y.AutherizationCredentialsKey;void 0===await E&&(E="");var A=await $a(await E,await w,await l,await n),P=1,C=await y.RequestBody;"Post"!==N&&"Put"!==N&&"Patch"!==N||(P=void 0!==await u?1:await Object.keys(await C).length);var k={},j={},D=[];try{var O=await y.IsFormData;void 0===await O&&(O=!1)}catch(a){O=!1}for(let e=1;e<=await P;e++){d=new Date;var I=await y.DependendtApiScripts;let i=await xa();console.log(await r+": calling for Dependendt API "+JSON.stringify(await I));var L=await ka(await a,await t,await c,await s,await I,await n,await w,await o,await l);let p=xa(),m=(await xa.duration(p.diff(i))).asSeconds();console.log("Dependendt Api cripts executed on "+m+" seconds.");var F=await at(await L),U=await y.Assertion;C=await y.RequestBody[await e.toString()],C=await qa(await C,await u),C=await Ea(await C,await s,await o,await l,await n,await t);var V=await y.RequestVariable;S=await Ea(await S,await s,await o,await l,await n,await t),T=await Ta(await M,"key","value"),T=await Za(await T,await u),T=await Ea(await T,await s,await o,await l,await n,await t),await Va(await s,await V,await T,await C,await o,await l,await n),await F?(j.Url=await S,j.Method=await N,j.RequestHeader=await T,j.errorMessage=await tt(await L)):j=await Ia(await S,await N,await T,await C,await A),v=await Object.keys(await L).length,k["Test Results for Dataset "+e]=await j,v>0&&(k["Dependendt Api Response Result"]=await L),U=await Ea(await U,await s,await o,await l,await n,await t),U=await Ba(await U,"actual"),U=await Ra(j,U),D=await Ja(await D,await U);var B=new Date,R=(await B.getTime()-await d.getTime())/1e3;j["Execution Time"]=await R+" Seconds"}1===P&&0==v?g[await i]=await j:1===P&&v>0?(j["Dependendt Api Response Result"]=await L,g[await i]=await j):g[await i]=await k,h[await i]=await D,p.isSuccess=await async function(a){for(let s=0;s<await a.length;s++){var t=await a[s].actual,e=await a[s].expected,i=await a[s].function,r=await Xa(await i,await e,await t);if(!await r)return"Fail"}return await"Pass"}(await U),p.assertionData=await h,p.responseData=await g}catch(a){try{g={};var J=a.toString();p.isSuccess="Fail",U=[],U=await y.Assertion,U=await Ba(U,"actual","Not Evaluated");var X=await w.Url[await n];void 0===await X&&(J="For the "+await n+" environment, no information was found regarding the Component and URL. Please make sure to add the API URL associated with the component. You can update this from the configuration page.");var W={};W[await i]=await U,p.assertionData=await W,g[await i]={errorMessage:J},p.responseData=await g,B=new Date,R=(await B.getTime()-d.getTime())/1e3,R=Number(await R.toString().split(".")[0]),j["Execution Time"]=await R+" Seconds"}catch(a){console.log("Test script execution throw exception "+await a.toString())}}if(B=new Date,R=await(await B.getTime()-await d.getTime())/1e3,await R.toString().includes(".")&&(R=await R.toFixed(2)),p.executiontime=await R,"Pass"===await p.isSuccess){var Y=await _a(await t,await e,await r);if(await Y)try{var G=await Object.keys(await p.responseData),Q=await G[0],q=await p.responseData[await Q].ResponseHeader,Z=await p.responseData[await Q].ResponseBody;await za(await t,await e,await r,await Z,await q)}catch(a){}}return console.log("********* Test script "+await r+" execution completed for component "+await e),p},createNameSpaceFromExpression:La,getValueFromJsonUsingNameSpace:Fa}},729:(a,t,e)=>{const i=e(7252).Router(),{saveFile:r,isDirectoryExist:s,createDirectory:n,isSpaceFreeOnAccount:w}=e(7229),{authCheck:o}=e(2258);e(9896),i.post("/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await o(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var c=await i.totalStorage,u=await a.headers.accountlabel,l={isFileSaved:!1,errorMessage:""};try{var d=a.params.projectName,p=await w(await u,await d,await c);if(!await p.isSuccess)return l.errorMessage=await p.errorMessage,t.json(l);var m=a.params.testingtype,v=a.body.environment.toString().trim();await s(await u+"/"+d+"/"+m+"/Reports/"+v)||await n(await u+"/"+d+"/"+m+"/Reports/"+v);var g=a.body.executionStartDate.toString().trim()+"_"+a.body.executionStartTime.toString().trim();await r(await u+"/"+d+"/"+m+"/Reports/"+v+"/"+g+".json",a.body),l.isFileSaved=!0}catch(a){l.errorMessage=a.toString()}t.json(l)}),a.exports=i},829:a=>{"use strict";a.exports=require("jsonwebtoken")},861:(a,t,e)=>{const{isDirectoryExist:i}=e(7229),{executeTestStep:r,evaluateValuecomingfromTestScript:s,createElementandElements:n,executeDependendtPageFunction:w,takeScreenshot:o,createElementasPerProvidedValue:c,saveScreenshot:u,GetCommonDataFromParam:l}=e(4967),d="./dataHub/",p=e(6928);var m=e(9896);const{remote:v}=e(2792),g=e(4716),{env:h}=e(5949);async function f(a,t){var e={isStepInvolved:!1,parentSteps:{}};try{var i=await Object.keys(await t);if(await i.length>0)for(let o=0;o<await i.length;o++){var r=await i[o],s=await t[await r],n=await Object.keys(await s);for(let t=0;t<await n.length;t++){var w=await n[t];(await s[await w]).includes(await a)&&(e.isStepInvolved=!0,e.parentSteps[await r]=w)}}}catch(a){}return await e}async function y(a,t,e){try{void 0!==await a[await t]&&(e[await t]={});var i=await a.ifTrue;void 0!==await i&&await Array.isArray(await i)&&(e[await t]={},e[await t].true=await i)}catch(a){}try{i=await a.ifFalse,void 0!==await i&&await Array.isArray(await i)&&(void 0===e[await t]&&(e[await t]={}),e[await t].false=await i)}catch(a){}return await e}async function b(a){try{var t=await a.ifTrue;if(void 0!==await t)return!0}catch(a){}try{if(t=await a.ifFalse,void 0!==await t)return!0}catch(a){}return await!1}async function S(a,t,e,i,r,s,n,w,o,c){let u=null;var l={isSuccess:!0,errorMessage:"",driver:null,supportingEvidence:{}},m={};try{l.supportingEvidence.Platform=await i,l.supportingEvidence.Device=await r;var h=await async function(a,t,e,i,r,s,n,w,o){var c={caps:{},clienthost:""},u="",l={},m="";try{if(s=await JSON.parse(await JSON.stringify(s)),"Server"===await e||"Client"===await e){var v=!1,g=!1,h=await s.Emulator;if(void 0!==await h&&0!==await h.length){for(let a=0;a<await h.length;a++)if(await h[a].name===await r){m=await h[a].udid;var f=await h[a].host;c.clienthost=await f,u=await h[a].apk,v=!0;break}if(await v){var y=await s.Environment;if(void 0!==await y&&0!==await y.length)for(let a=0;a<y.length;a++)if(await y[a].name.toString().toLowerCase()===await n.toString().toLowerCase()){if("android"===i.toString().toLowerCase())var b=await y[a].apk;"ios"===i.toString().toLowerCase()&&(b=await y[a].ipa),l=await JSON.parse(await y[a].capability),g=!0}if(await g){var S=l;if(S.platformName=await i,S["appium:udid"]=await m,"android"===await i.toString().toLowerCase()?S["appium:automationName"]="UiAutomator2":"ios"===await i.toString().toLowerCase()&&(S["appium:automationName"]="XCUITest"),""!==await b)if("Server"===await e){var x=await p.resolve(await d+await a+"/"+await t+"/Mobile/Downloads/"+await n+"/"+await b);S["appium:app"]=await x}else"Client"===await e&&(x=await p.resolve(await u),S["appium:app"]=await x);var M=await Object.keys(await S);if(await M.length>0)for(let a=0;a<await M.length;a++){var N=await M[a],T=await S[await N],E="";if(await T.toString().toLowerCase().startsWith("c.")&&(E=await T.substring(2),void 0!==await w[await E])){var A=await w[await E][await n];void 0!==await A&&(S[await N]=await A)}if(await T.toString().toLowerCase().startsWith("session.")){var P=await T.substring(8);void 0!==await o[await P]&&(A=await o[await P],S[await N]=await A)}if(await N.toLocaleLowerCase().includes(":options"))try{var C=await T,k={},j=await Object.keys(await C);for(let a=0;a<await j.length;a++){var D=await j[a],O=await T[await D];await O.toString().toLowerCase().startsWith("session.")&&(P=await O.substring(8),void 0!==await o[await P]&&(O=await o[await P])),k[await D]=await O}S[await N]=await k}catch(a){}}c.caps=await S}}else c.caps.error="Device Information does not found on the server."}}else{var I=await s.ExecutionCapabilities;if(void 0!==await I){var L=await I[await e];void 0!==await L&&(L=await L[await i],void 0!==await L&&(mobileCaps=await L[await r])),g=!1,y=await s.Environment,l={};var F="",U="";for(let a=0;a<y.length;a++)if(await y[a].name.toString().toLowerCase()===await n.toString().toLowerCase()){l=await JSON.parse(await y[a].capability),F=await y[a].apk,U=await await y[a].ipa,g=!0;break}if("android"===await i.toString().toLowerCase()?void 0===await mobileCaps["appium:automationName"]&&(mobileCaps["appium:automationName"]="UiAutomator2",""!==await F&&void 0===await mobileCaps["appium:app"]&&(mobileCaps["appium:app"]=await F)):"ios"===await i.toString().toLowerCase()&&void 0===await mobileCaps["appium:automationName"]&&(mobileCaps["appium:automationName"]="XCUITest",""!==await U&&void 0===await mobileCaps["appium:app"]&&(mobileCaps["appium:app"]=await U)),await g){M=await Object.keys(await l);for(let a=0;a<await M.length;a++)N=await M[a],void 0===await mobileCaps[await N]&&(mobileCaps[await N]=await l[await N])}if(M=await Object.keys(await mobileCaps),await M.length>0)for(let a=0;a<await M.length;a++)if(N=await M[a],T=await mobileCaps[await N],E="",await T.toString().toLowerCase().startsWith("c.")&&(E=await T.substring(2),void 0!==await w[await E])&&(A=await w[await E][await n],void 0!==await A&&(mobileCaps[await N]=await A)),await T.toString().toLowerCase().startsWith("session.")&&(P=await T.substring(8),void 0!==await o[await P]&&(A=await o[await P],mobileCaps[await N]=await A)),await N.toLocaleLowerCase().includes(":options"))try{C=await T,k={},j=await Object.keys(await C);for(let a=0;a<await j.length;a++)D=await j[a],O=await T[await D],await O.toString().toLowerCase().startsWith("session.")&&(P=await O.substring(8),void 0!==await o[await P]&&(O=await o[await P])),k[await D]=await O;mobileCaps[await N]=await k}catch(a){}mobileCaps.platformName=await i,c.caps=await mobileCaps}}}catch(a){}return await c}(await a,await t,await e,await i,await r,await s,await n,await w,await c),f="";if(""!==await h.caps["appium:app"]&&void 0!==await h.caps["appium:app"]&&void 0!==await h.caps["appium:appPackage"]&&void 0!==await h.caps["appium:appActivity"]&&(f=await h.caps["appium:app"],await delete h.caps["appium:app"]),void 0!==await o&&""!==await o){var y=await async function(a,t,e,i){try{var r=await a.ApplicationDetails;if(void 0===await r)return await"";var s=await r[await e];if(void 0===await s)return await"";for(let a=0;a<await s.length;a++){var n=await s[a].name;if(await t===await n){if("Android"===await i)var w=await s[a].apk;return"iOS"===await i&&(w=await s[a].ipa),void 0===await w&&(w=""),await w}}}catch(a){}return await""}(await s,await o,await n,await i);""!==await y&&void 0!==await y&&(h.caps["appium:app"]=await y)}if(l.supportingEvidence.CapabilityData=await h,0===await Object.keys(await h).length)return l.errorMessage="There is no capability found for launching the Mobile app.",await l;var b=1;if(void 0!==h.caps.connectionRetryCount&&(b=await h.caps.connectionRetryCount,delete h.caps.connectionRetryCount),"Server"===await e){var S=h.caps;m={connectionRetryCount:await Number(await b),maxInstances:1,hostname:process.env.APPIUM_HOST||"127.0.0.1",port:parseInt(process.env.APPIUM_PORT,100)||4723,logLevel:"info",capabilities:S},u=await v(await m),await u.setTimeout({implicit:0})}else if("Client"===await e){S=h.caps;var x=await h.clienthost;if(await x.toString().toLowerCase().startsWith("c.")){var M=await x.substring(2);if(void 0!==await w[await M]){var T=await w[await M][await n];void 0!==await T&&(x=await T)}}m={connectionRetryCount:await Number(await b),maxInstances:1,logLevel:"info",hostname:await x,port:443,protocol:"https",capabilities:S},u=await v(m),await u.setTimeout({implicit:0})}else{var E=await async function(a,t,e,i){try{var r="";const c=await new Date;var s=await a.ExecutionCapabilities[await t][await e][await i];if(void 0===await s){var n=await g(await c).format("DD MMM yyyy");return r=await r+" "+await n,await r}var w=await s["appium:deviceName"],o=await s["appium:platformVersion"];return void 0===await o&&(o=""),void 0===await w&&(w=""),r=await w+" "+await o,r=await r.toString().trim(),n=await g(await c).format("DD MMM yyyy"),r=await r+" "+await n,await r}catch(a){return n=await g(await presentDate).format("DD MMM yyyy"),r=await r+" "+await n,await r}}(await s,await e,await i,await r);switch(await e){case"SauceLabs":var A=await h.caps["sauce:options"];if(void 0===await A)h.caps["sauce:options"]={},h.caps["sauce:options"].name=await E,h.caps["sauce:options"].build=await E;else{var P=await h.caps["sauce:options"].name;void 0===await P&&(h.caps["sauce:options"].name=await E);var C=await h.caps["sauce:options"].build;void 0===await C&&(h.caps["sauce:options"].build=await E)}break;case"BrowserStack":A=await h.caps["bstack:options"],void 0===await A?(h.caps["bstack:options"]={},h.caps["bstack:options"].projectName="QAautoMATER",h.caps["bstack:options"].buildName=await E):(P=await h.caps["bstack:options"].projectName,void 0===await P&&(h.caps["bstack:options"].projectName="QAautoMATER"),C=await h.caps["bstack:options"].buildName,void 0===await C&&(h.caps["bstack:options"].buildName=await E))}var k=await s.ExecutionCapabilities[await e].connectionRetryCount;void 0===await k&&(k=1);var j=s.ExecutionCapabilities[await e].maxInstances;j=null==await j?1:Number(await j),S=h.caps;var D=await s.ExecutionCapabilities[await e].hostname;D=await N(await D,await w,await n);var O=await s.ExecutionCapabilities[await e].baseUrl;O=await N(await O,await w,await n);var I=await s.ExecutionCapabilities[await e].port;I=await N(await I,await w,await n);var L=await s.ExecutionCapabilities[await e].user;L=await N(await L,await w,await n);var F=await s.ExecutionCapabilities[await e].key;F=await N(await F,await w,await n),m={connectionRetryCount:Number(await k),hostname:await D,baseUrl:await O,port:await I,user:await L,key:await F,capabilities:S},u=await v(await m),await u.setTimeout({implicit:0})}}catch(a){if(await a.toString().includes("preinstalled"))if(""!==await f){var U=h.caps;void 0!==await U["appium:appPackage"]&&await delete U["appium:appPackage"],void 0!==await U["appium:appActivity"]&&await delete U["appium:appActivity"],U["appium:app"]=await f,delete m.capabilities,m.capabilities=await U;try{u=await v(await m),await u.setTimeout({implicit:0})}catch(a){l.isSuccess=!1,l.errorMessage=await a.toString()+" Capability details "+JSON.stringify(await U)}}else l.isSuccess=!1,l.errorMessage="Mobile app is not preinstalled on the device.Please provide mobile app path details";else l.isSuccess=!1,l.errorMessage=await a.toString()+" Capability details "+JSON.stringify(await h.caps)}return await new Promise(a=>setTimeout(a,5e3)),l.driver=await u,await l}async function x(a){var t={};try{var e=await typeof await a;t="string"===await e?await JSON.parse(await a):await a}catch(a){t={}}return await t}async function M(a){var t="{}";try{var e=await typeof await a;t="object"===await e?await JSON.stringify(await a):await a}catch(a){t="{}"}return await t}async function N(a,t,e){if(await a.toString().toLowerCase().startsWith("c.")){var i=await a.substring(2);if(void 0!==await t[await i]){var r=await t[await i][await e];if(void 0!==await r)return await r}}return await a}e(2103),a.exports={executeTestScript:async function(a,t,e,i,n,l,p,v,g,h,N,T,E,A,P,C,k,j,D,O,I){let L=null;try{var F={driver:null},U=new Date,V={isSuccess:!0,assertionData:[],globalError:"",executiontime:0},B=[],R=await async function(a,t,e,i){var r={isSuccess:!0,assertionData:[],globalError:"",executiontime:0},s=await d+await a+"/"+await t+"/Mobile/TestScripts/"+await e+"/"+await i+".json";if(!await m.existsSync(await s)){var n={};n.errorMessage="Test script "+await i+" does not found on the server.";var w={id:1,stepdefinition:"Test Script Execution",action:"NA",testdata:await n,status:"Fail",screenshot:""};r.assertionData.push(await w),r.isSuccess=!0}return await r}(await a,await t,await e,await i);if(!await R.isSuccess)return await R;var J=await d+await a+"/"+await t+"/Mobile/OR.json",X=d+await a+"/"+await t+"/Mobile/TestScripts/"+await e+"/"+await i+".json",W=await m.readFileSync(await J,"utf8");W=await JSON.parse(await W);var Y=await m.readFileSync(await X,"utf8");Y=await JSON.parse(await Y);var G=await Y.allsteps,Q=await Y.testdataset,q=1;if(await Q.length>0&&(q=await Q.length,void 0!==await A))try{var Z=await Object.keys(await A);if(await Z.length>0)for(let a=0;a<await Z.length;a++){var K=await Z[a],H=await Object.keys(await A[await K]);for(let a=0;a<await H.length;a++){var _=await H[a];_=await _.trim().toUpperCase();var z=Number(await K)-1;if(void 0!==await Q[await z][await _]){var $=await A[await K][await _];Q[await z][await _]=await $}}}}catch(a){}var aa=1,ta=[],ea="";for(let e=0;e<await q;e++){var ia={};void 0!==await j&&(ia.TestIdDetails=await j,ia.TestId=await j.TestId,ia.TestName=await j.TestName,ia.Environment=await j.Environment,ia.ExecutedBy=await j.ExecutedBy,ia.Component=await j.Component),ea="";var ra=!0,sa=new Date,na=await Y.dependentpage;if(F=await S(await a,await t,await l,await p,await v,await T,await n,await g,await O,await ia),!await F.isSuccess){var wa=await F.errorMessage;ra=!1,V.isSuccess=!1;var oa={id:1,stepdefinition:"Launch Mobile Application",action:await"LaunchApp",testdata:await wa,status:"",screenshot:""};B.push(await oa)}try{ia.Capability=await F.supportingEvidence.CapabilityData.caps}catch(a){}L=await F.driver;try{ia.DeviceName=await L.capabilities.deviceName,ia.DeviceModal=await L.capabilities.deviceModel}catch(a){}var ca={output:""},ua=!0;if(await ra&&await na.length>0){var la=await w(await a,await t,await na,await L,await g,await Q,await ia,await W,await h,await ca,await p,await E,await e,await C,await k,await P,await D,await I);ua=await la.isSuccess;var da=await la.stepAssertion,pa={};await ua||(pa.errorMessage=await la.errorMessage);try{pa.TestData=JSON.parse(await la.testData)}catch(a){pa.TestData={}}pa.ListOfTestSteps=await la.supportingEvidence;try{pa=JSON.stringify(await pa)}catch(a){pa="{}"}da.testdata=await pa,B.push(await da),V.isSuccess=await ua}if(await ra&&await ua){var ma={},va={};for(let w=0;w<await G.length;w++){try{var ga,ha={},fa={},ya={isSuccess:!0},ba="Pass",Sa=await aa,xa=await G[w].isreporting,Ma=await G[w].id,Na=await G[w].stepdefinition,Ta=await G[w].action,Ea=await G[w].element,Aa=await G[w].value;Aa=await s(await Aa,await g,await Q,await ia,await e,await fa,await Aa,await E,await D),await Aa;try{ha.TestData=await JSON.parse(await Aa)}catch(a){ha.TestData={}}ga=await b(await ha.TestData),await ga&&(ma=await y(ha.TestData,await Ma,await ma));var Pa=!1,Ca=await f(await Ma,await ma);if(await Ca.isStepInvolved){var ka=[],ja=await Ca.parentSteps,Da=await Object.keys(await ja);for(let a=0;a<await Da.length;a++){var Oa=await Da[a],Ia=await ja[await Oa],La=await va[await Oa];await Ia.toString()===await La.toString()?ka.push("true"):ka.push("false")}Pa=!!await ka.includes("false")}if(await Pa){ha.warningMessage="Test Step skipped because of conditional Statement";try{ha=JSON.stringify(await ha)}catch(a){ha="{}"}oa={id:await Sa,stepdefinition:await Na,action:await Ta,testdata:await ha,status:"Warning",screenshot:ea},B.push(await oa)}else{var Fa=await c(await a,await L,await Ea,await W,await Ta,await g,await Q,await ia,await e,await h,await t,!1,await Aa,await fa,await p,await E,await P,await C,await D,await I);if(await Fa.isElementPresent){var Ua=await Fa.element,Va=await Fa.elements,Ba=await Fa.elementIndex;ya=await r(await a,await t,await Ta,await L,await Ua,await Aa,await ca,await ia,await h,await W,await g,await Q,await Va,await Ba,await p,await E,await Ea,await e,await fa,await C,await D,await P,await I),ha=await ya.supportingEvidence,void 0===await ha&&(ha={});try{ha.TestData=await JSON.parse(await Aa)}catch(a){ha.TestData={}}va[await Ma]=await ya.isSuccess}else if(await ga)va[await Ma]=!1,ya.isSuccess=!0,ya.errorMessage=await Fa.errorMessage,ha.errorMessage=await Fa.errorMessage,ha.warningMessage="Conditional statement,hence step status showing Warning.",ba="Warning";else if(""===await xa||"Yes"===await xa){ya.isSuccess=!1;var Ra=await Fa.errorMessage,Ja="";try{Ja=await JSON.parse(await Ra)}catch(a){Ja=await Ra}ya.errorMessage=await Ja,ha.errorMessage=await Ja,ba="Fail"}ya.isSuccess||(await ga?(ya.isSuccess=!0,V.isSuccess=!0,ha.errorMessage=await ya.errorMessage,ha.warningMessage="Conditional statement,hence step status showing Warning.",ba="Warning"):""!==await xa&&"Yes"!==await xa||(V.isSuccess=!1,await ya.errorMessage,ha.errorMessage=await ya.errorMessage,ba="Fail")),"For each step"===await N&&(ea="Yes"===await k?await u(await a,await t,await L,"Mobile",await n,await i,Number(await e)+1,Number(await w)+1):await o(await L));try{ha=await x(await ha),ha=await M(await ha)}catch(a){ha="{}"}oa={id:await Sa,stepdefinition:await Na,action:await Ta,testdata:await ha,status:await ba,screenshot:ea};if(B.push(await oa),!ya.isSuccess)break}}catch(r){if(""===await xa||"Yes"===await xa){V.isSuccess=!1,(ha={}).errorMessage=await r.toString();try{ha=JSON.stringify(await ha)}catch(a){ha="{}"}ba="Fail","For each step"===await N&&(ea="Yes"===await k?await u(await a,await t,await L,"Mobile",await n,await i,Number(await e)+1,Number(await w)+1):await o(await L)),oa={id:await Sa,stepdefinition:await Na,action:await Ta,testdata:await ha,status:await ba,screenshot:ea},B.push(await oa);break}}aa=await aa+1}if("For failure & success"===await N){ea="Yes"===await k?await u(await a,await t,await L,"Mobile",await n,await i,Number(await e)+1,1):await o(await L);var Xa=await B.length-1;B[await Xa].screenshot=await ea}}if(await ra&&await q>1){var Wa=new Date,Ya=await(await Wa.getTime()-await sa.getTime())/1e3,Ga={};Ga.ExecutionTime=await Ya+" seconds",oa={id:await aa,stepdefinition:"End of Iteration for Data Row id "+(e+1),action:await"ExecutionTime",testdata:await Ga,status:"",screenshot:""},B.push(await oa),aa=await aa+1}ta.push(await V.isSuccess),V.assertionData=await B;try{await(await L).deleteSession({shutdownDriver:!0}),await new Promise(a=>setTimeout(a,2e3))}catch(a){}}}catch(a){V.globalError=await a.message;try{await(await L).deleteSession({shutdownDriver:!0}),await new Promise(a=>setTimeout(a,2e3))}catch(a){}if(await V.globalError.includes("no such file or directory")){ha={errorMessage:"Test script does not found on the server."};try{ha=JSON.stringify(await ha)}catch(a){ha="{}"}oa={id:1,stepdefinition:"Test Script Eeecution",action:"NA",testdata:await ha,status:"Fail",screenshot:""},B.push(await oa),ta.push(!1),V.assertionData=await B}else{(ha={}).errorMessage=await a.toString();try{ha=JSON.stringify(await ha)}catch(a){ha="{}"}oa={id:1,stepdefinition:"Test Script Execution",action:"NA",testdata:await ha,status:"Fail",screenshot:""},B.push(await oa),ta.push(!1),V.assertionData=await B}V.isSuccess=!1}await ta.includes(!1)&&(V.isSuccess=!1);var Qa=new Date;return Ya=await(await Qa.getTime()-await U.getTime())/1e3,Ya=await Number(await Ya.toString().split(".")[0]),V.executiontime=await Ya,V},launchMobileApp:S}},1025:a=>{"use strict";a.exports=require("stream-json")},1500:(a,t,e)=>{const i=e(7252);var r=e(9896);const s=i.Router();var n="./dataHub/",w="./dataHub/";const{getActiveThreadCounter:o,getPlanForAccount:c,addUIExecutionThread:u,resetUIExecutionThread:l}=e(5843),{saveFile:d,isDirectoryExist:p,createDirectory:m,getKeyValueFromJsonArray:v,isSpaceFreeOnAccount:g,readJSONFile:h}=e(7229),{authCheck:f}=e(2258),{post:y}=e(382),b=e(2410);s.post("/project/:projectName/testingtype/:testingtype/createnewtestsuitename",async(a,t)=>{var e={},i=await f(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage,w={isSuccess:!1,errorMessage:""};try{var o=await a.headers.accountlabel,c=a.params.projectName,u=await a.params.testingtype;switch(await u){case"Web":case"Mobile":case"Api":break;default:return w.errorMessage="component name is incorrect.",t.json(w)}var l=await g(await o,await c,await s);if(!await l.isSuccess)return w.errorMessage=await l.errorMessage,t.json(w);await p(await o+"/"+c+"/"+await u+"/TestSuite/")||await m(await o+"/"+c+"/"+await u+"/TestSuite/");var d=await a.body.testsuitename,v=!/[\\/:*?"<>|]/.test(await d);await v||(w.errorMessage="Test suite name is incorrect.",t.json(w));var h=await n+await o+"/"+await c+"/"+await u+"/TestSuite/"+await d+".json",y=await b.sync(await h);await y.length>0&&(w.errorMessage="Test suite name is already exist.",t.json(w));const e={},i=JSON.stringify(await e,null,2);await r.writeFileSync(await h,await i),w.isSuccess=!0}catch(a){w.errorMessage=await a.message}t.json(w)}),s.post("/project/:projectName/testingtype/:testingtype/deletetestsuite",async(a,t)=>{var e={},i=await f(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={isFileSaved:!1,errorMessage:""};try{var w=a.params.projectName,o=await a.params.testingtype,c=await a.body.suiteName,u=await a.headers.accountlabel;switch(await o){case"Web":case"Mobile":case"Api":break;default:return s.errorMessage="component name is incorrect.",t.json(s)}var l=await n+await u+"/"+await w+"/"+await o+"/TestSuite/"+await c+".json";await r.unlinkSync(await l),s.isFileSaved=!0}catch(a){s.errorMessage=await a.message}t.json(s)}),s.get("/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e=a.params.projectName,i=a.params.testingtype,s=[],w={},o=await f(await a);if(!await o.isSuccess)return w.isUserAuthenticated=!1,w.errorMessage=o.errorMessage,t.status=await o.responseCode,t.json(await w);var c=await a.headers.accountlabel,u=[];try{s=await r.readdirSync(n+await c+"/"+e+"/"+i+"/TestSuite");for(let a=0;a<s.length;a++)u.push(await s[a].replace(".json",""))}catch(a){}t.json(u)}),s.post("/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await f(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileSaved:!1,errorMessage:""};try{var s=await a.headers.accountlabel,n=a.params.projectName,w=a.params.testingtype,o=a.body.fileName.toString().trim();if(!await p(await s+"/"+n+"/"+w+"/TestSuite/"+o+".json"))return r.errorMessage="Test Suite does not exist on Server.",t.json(r);await d(await s+"/"+n+"/"+w+"/TestSuite/"+o+".json",await a.body),r.isFileSaved=!0}catch(a){r.errorMessage=a.toString()}t.json(r)}),s.get("/project/:projectName/testingtype/:testingtype/testsuite/:testsuitename",async(a,t)=>{var e={},i=await f(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=a.params.projectName,n=a.params.testingtype,o=a.params.testsuitename,c=await a.headers.accountlabel,u={};try{var l=await w+await c+"/"+s+"/"+n+"/TestSuite/"+o+".json";u=await JSON.parse(await r.readFileSync(await l,"utf8"));try{var p=await u.testsuite[0].createdby;if(void 0===await p){var m=await u.testsuite;for(let a=0;a<await m.length;a++){var v=await m[a].component,g=await m[a].testid+"@"+await m[a].testname,h=await w+await c+"/"+s+"/"+n+"/TestScripts/"+await v+"/"+await g+".json",y=await JSON.parse(await r.readFileSync(await h,"utf8")),b=await y.createdBy;void 0===await b&&(b=await y.lastUpdatedBy),b=void 0===await b?"User not Found":await b.toString().trim().split(" ")[0],m[a].createdby=await b}u.testsuite=await m,await d(await c+"/"+s+"/"+n+"/TestSuite/"+o+".json",await u)}}catch(a){}}catch(a){}t.json(u)}),s.post("/api/project/:projectName",async(a,t)=>{var e={isAllScriptsGetPassed:!1},i=await await a.body;if(void 0===await i)return e.Error="Request body can not be blank, testSuiteName should be provided.",t.json(e);var s=await a.params.projectName,o=await i.testSuiteName;if(void 0===await o)return e.Error="Request body is inorrect testSuiteName should be provided.",t.json(e);var c=await a.headers.accountlabel,u={},l={reportInDashBoard:"Yes",triggerFrom:"CI/CD pipeline"};l.suiteName=await o,l.emailTriggerValue="Yes",l.recipientEmail="";var d=await s+"/Api/Configuration.json",p=await h(await d),m=await p.Environment;if(void 0===await m)return e.Error="Please add environment from the configuration page",t.json(e);if(0===await m.length)return e.Error="Please add environment from the configuration page",t.json(e);try{if(await o.toString().toLocaleLowerCase().includes("regression")){if(d=await s+"/Api/Configuration.json",p=await h(await d),void 0===await i.environment){var v=await p.DefaultSelectedEnvironment;void 0===await v&&(v=await m[0].name),l.environment=await v}else l.environment=await i.environment;var g=await a.body.testingType;void 0===await g?l.testingType="Integration Testing":l.testingType=await g;var f=await a.body.threadCount;if(void 0===await f?l.threadCount=1:l.threadCount=Number(await f),void 0===await i.recipientEmail)try{var b=await p.EMAILDETAILS.DefaultEmailProtocol,S=await p.EMAILDETAILS[await b].recipientEmail;l.recipientEmail=await S}catch(a){l.emailTriggerValue="No"}else l.recipientEmail=await i.recipientEmail;var x=[],M=await r.readdirSync(n+await c+"/"+s+"/Api/TestScripts"),N=1;for(let a=0;a<await M.length;a++){var T=await M[await a],E=await r.readdirSync(n+await c+"/"+s+"/Api/TestScripts/"+T);for(let a=0;a<await E.length;a++){var A=E[a];if(await A.toLocaleLowerCase().includes(".json")&&await A.includes("@")){var P={id:await N,component:await T,testid:await A.split("@")[0],testname:await A.split("@")[1].replace(".json",""),status:""};x.push(await P),N=await N+1}}}if(l.testscriptforExecution=await x,0===await x.length)return e.Error="No test script found for execution.",t.json(e)}else{d=await w+await c+"/"+s+"/Api/TestSuite/"+o+".json",u=await JSON.parse(await r.readFileSync(await d,"utf8"));var C=await a.body.environment;if(void 0!==await C?l.environment=await C:l.environment=await u.environment,g=await a.body.testingType,void 0!==await g?l.testingType=await g:l.testingType=await u.testingtype,f=await a.body.threadCount,void 0!==await f?l.threadCount=await f:l.threadCount=await u.threadcount,void 0===await i.recipientEmail)try{b=await p.EMAILDETAILS.DefaultEmailProtocol,S=await p.EMAILDETAILS[await b].recipientEmail,l.recipientEmail=await S}catch(a){l.emailTriggerValue="No"}else l.recipientEmail=await i.recipientEmail;if(l.testscriptforExecution=await u.testsuite,void 0===await u.testsuite||0===await u.testsuite.length)return e.Error="No test script found for execution.",t.json(e)}l.threadCount=await Number(await l.threadCount);var k={Authorization:await a.headers.authorization,userEmail:await a.headers.useremail,userselectedaccount:await s,accountlabel:await a.headers.accountlabel},j=await a.get("Host");const F=await a.protocol;var D=await y(F+"://"+await j+"/apiexecutor/project/"+await s,await k,await l);e.excutionDetails=await D.data,e.excutionDetails=await D.data;var O=await e.excutionDetails,I=!0,L=await O.listOfTestScipts;for(let a=0;a<await L.length;a++)if("Pass"!==await L[a].status){I=!1;break}e.isAllScriptsGetPassed=await I}catch(a){}t.json(e)}),s.post("/ui/project/:projectName",async(a,t)=>{var e={isAllScriptsGetPassed:!1};console.log("Test suite execution initiated using API services.");var i={isAllScriptsGetPassed:!1},s=await a.params.projectName,o=await await a.body,c=await a.headers.accountlabel;if(void 0===await o)return console.log("API Service : Request body can not be blank, testSuiteName should be provided."),i.Error="Request body can not be blank, testSuiteName should be provided.",t.json(i);var u=await a.body.testSuiteName;if(void 0===await u)return console.log("API Service: Request body is inorrect testSuiteName should be provided in request body."),i.Error="Request body is inorrect testSuiteName should be provided.",t.json(i);var l={},d={},p={reportInDashBoard:"Yes",triggerFrom:"CI/CD pipeline",screenShotOption:"For failure & success",testingType:"Integration Testing"};p.suiteName=await u,p.emailTriggerValue="Yes",p.recipientEmail="";try{var m=await c+"/"+await s+"/Web/Configuration.json";l=await h(await m)}catch(a){return console.log("API Service: Configuration.json file does not exist for project "+await s),i.Error="API Service: Configuration.json file does not exist for project "+await s,t.json(i)}var g=await l.Environment;if(void 0===await g)return console.log("API Service: Environment details is not found on Configuration.json file."),i.Error="API Service: Environment details is not found on Configuration.json file.",t.json(i);if(0===await g.length)return console.log("API Service: Environment details is not found on Configuration.json file."),i.Error="API Service: Environment details is not found on Configuration.json file.",t.json(i);try{if(await u.toString().toLocaleLowerCase().includes("regression")){if(void 0===await o.environment){var f=await l.DefaultSelectedEnvironment;void 0===await f&&(f=await g[0].name),p.environment=await f}else p.environment=await o.environment;if(void 0===await o.threadcount?p.threadCount=1:p.threadCount=await o.threadcount,void 0===await o.deviceName){var b=await await l.DefaultBrowser;void 0===await b&&(b="Chrome"),p.deviceName=await b}else p.deviceName=await o.deviceName;if(void 0===await o.runAt?p.runAt="Server":p.runAt=await o.runAt,void 0===await o.screenName){var S=await l.DefaultExecutionPlatform;void 0===await S&&(S="Desktop"),p.screenName=await S}else p.screenName=await o.screenName;if(void 0===await o.applicationUrl?p.applicationUrl=await v(await l.Environment,"name",await l.DefaultSelectedEnvironment,"url"):p.applicationUrl=await o.applicationUrl,void 0===await o.recipientEmail)try{var x=await l.EMAILDETAILS.DefaultEmailProtocol,M=await l.EMAILDETAILS[await x].recipientEmail;p.recipientEmail=await M}catch(a){p.emailTriggerValue="No"}else p.recipientEmail=await o.recipientEmail;var N=[],T=await r.readdirSync(n+await c+"/"+s+"/Web/TestScripts"),E=1;for(let a=0;a<await T.length;a++){var A=await T[await a],P=await r.readdirSync(n+await c+"/"+s+"/Web/TestScripts/"+A);for(let a=0;a<await P.length;a++){var C=P[a];if(await C.toLocaleLowerCase().includes(".json")&&await C.includes("@")){var k={id:await E,component:await A,testid:await C.split("@")[0],testname:await C.split("@")[1].replace(".json",""),status:""};N.push(await k),E=await E+1}}}if(p.testscriptforExecution=await N,0===await N.length)return i.Error="No test script found for execution.",t.json(i)}else{try{m=await w+await c+"/"+s+"/Web/TestSuite/"+await u+".json",d=await JSON.parse(await r.readFileSync(await m,"utf8"))}catch(a){return console.log("API Service:Test suite "+await u+" does not exist on server."),i.Error="Test suite "+await u+" does not exist on server.",t.json(i)}if(void 0===await o.environment?p.environment=await d.environment:p.environment=await o.environment,void 0===await o.threadcount?p.threadCount=await d.threadcount:p.threadCount=await o.threadcount,void 0===await o.deviceName?p.deviceName=await d.device:p.deviceName=await o.deviceName,void 0===await o.runAt?p.runAt=await d.runat:p.runAt=await o.runAt,void 0===await o.screenName?p.screenName=await d.screen:p.screenName=await o.screenName,void 0===await o.applicationUrl?p.applicationUrl=await v(await l.Environment,"name",await d.environment,"url"):p.applicationUrl=await o.applicationUrl,void 0===await o.recipientEmail)try{x=await l.EMAILDETAILS.DefaultEmailProtocol,M=await l.EMAILDETAILS[await x].recipientEmail,p.recipientEmail=await M}catch(a){p.emailTriggerValue="No"}else p.recipientEmail=await o.recipientEmail;if(p.testscriptforExecution=await d.testsuite,void 0===await d.testsuite||0===await d.testsuite.length)return console.log("API Service:No test script found for execution."),i.Error="No test script found for execution..",t.json(i)}p.threadCount=await Number(await p.threadCount);var j={Authorization:await a.headers.authorization,userEmail:await a.headers.useremail,userselectedaccount:await s,accountlabel:await a.headers.accountlabel},D=await a.get("Host");const h=await a.protocol;var O=await y(h+"://"+await D+"/executor/project/"+await s,await j,await p);if(i.excutionDetails=await O.data,e=await i.excutionDetails,console.log("API Service- Test script Execution Response are here"),console.log(await e),void 0!==await e.isUserAuthenticated&&!await await e.isUserAuthenticated)return i.Error="API Service: User Authorization key is not valid.Please verify token.",t.json(i);var I=!0,L=await e.listOfTestScipts;for(let a=0;a<await L.length;a++)if("Pass"!==await L[a].status){I=!1;break}i.isAllScriptsGetPassed=await I}catch(a){console.log("API Service- we are getting exception"+await a.toString())}t.json(await i)}),s.post("/mobile/project/:projectName",async(a,t)=>{var e={isAllScriptsGetPassed:!1},i=await a.params.projectName,s=await await a.body;if(void 0===await s)return e.Error="Request body can not be blank, testSuiteName should be provided.",t.json(e);var o=await s.testSuiteName;if(void 0===await o)return e.Error="Request body is inorrect testSuiteName should be provided.",t.json(e);var c=await a.headers.accountlabel,u={},l={reportInDashBoard:"Yes",triggerFrom:"CI/CD pipeline",screenShotOption:"For failure & success",testingType:"Integration Testing"};l.suiteName=await o,l.emailTriggerValue="Yes",l.recipientEmail="";var d=await c+"/"+await i+"/Mobile/Configuration.json",p=await h(await d),m=await p.Environment;if(void 0===await m)return e.Error="Please add environment from the configuration page",t.json(e);if(0===await m.length)return e.Error="Please add environment from the configuration page",t.json(e);try{if(await o.toString().toLocaleLowerCase().includes("regression")){if(void 0===await s.environment){var v=await p.DefaultSelectedEnvironment;void 0===await v&&(v=await m[0].name),l.environment=await v}else l.environment=await s.environment;if(void 0===await s.threadcount?l.threadCount=1:l.threadCount=await s.threadcount,void 0===await s.runAt){var g=await p.DefaultRunAtOption;void 0===await g?l.runAt="Server":l.runAt=await g}else l.runAt=await s.runAt;if(void 0===await s.executionPlatform){var f=await p.DefaultExecutionPlatform;void 0===await f&&(f="Android"),l.screenName=await f}else l.screenName=await s.screenName;if(void 0!==await s.applicationName&&(l.applicationName=await s.applicationName),void 0===await s.deviceName){if("Server"===await l.runAt){var b=await p.Emulator;if(void 0===await b)return e.Error="Emulator Information does not exist on configuration page.",t.json(e);if(0===await b.length)return e.Error="Emulator Information does not exist on configuration page.",t.json(e);l.deviceName=await b[0].name}}else l.deviceName=await s.deviceName;if(void 0===await s.recipientEmail)try{var S=await p.EMAILDETAILS.DefaultEmailProtocol,x=await p.EMAILDETAILS[await S].recipientEmail;l.recipientEmail=await x}catch(a){l.emailTriggerValue="No"}else l.recipientEmail=await s.recipientEmail;var M=[],N=await r.readdirSync(n+await c+"/"+i+"/Mobile/TestScripts"),T=1;for(let a=0;a<await N.length;a++){var E=await N[await a],A=await r.readdirSync(n+await c+"/"+i+"/Mobile/TestScripts/"+E);for(let a=0;a<await A.length;a++){var P=A[a];if(await P.toLocaleLowerCase().includes(".json")&&await P.includes("@")){var C={id:await T,component:await E,testid:await P.split("@")[0],testname:await P.split("@")[1].replace(".json",""),status:""};M.push(await C),T=await T+1}}}if(l.testscriptforExecution=await M,0===await M.length)return e.Error="No test script found for execution.",t.json(e)}else{try{d=await w+await c+"/"+i+"/Mobile/TestSuite/"+await o+".json",u=await JSON.parse(await r.readFileSync(await d,"utf8"))}catch(a){return e.Error="Test suite "+await o+" does not exist on server.",t.json(e)}if(void 0===await s.environment?l.environment=await u.environment:l.environment=await s.environment,void 0===await s.threadcount?l.threadCount=await u.threadcount:l.threadCount=await s.threadcount,void 0===await s.deviceName?l.deviceName=await u.device:l.deviceName=await s.deviceName,void 0===await s.runAt?l.runAt=await u.runat:l.runAt=await s.runAt,void 0===await s.executionPlatform?l.screenName=await u.screen:l.screenName=await s.executionPlatform,void 0===await s.recipientEmail)try{S=await p.EMAILDETAILS.DefaultEmailProtocol,x=await p.EMAILDETAILS[await S].recipientEmail,l.recipientEmail=await x}catch(a){l.emailTriggerValue="No"}else l.recipientEmail=await s.recipientEmail;if(l.testscriptforExecution=await u.testsuite,void 0===await u.testsuite||0===await u.testsuite.length)return e.Error="No test script found for execution.",t.json(e)}l.threadCount=await Number(await l.threadCount);var k={Authorization:await a.headers.authorization,userEmail:await a.headers.useremail,userselectedaccount:await i,accountlabel:await a.headers.accountlabel},j=await a.get("Host");const h=await a.protocol;var D=await y(h+"://"+await j+"/mobileexecutor/project/"+await i,await k,await l);e.excutionDetails=await D.data;var O=await e.excutionDetails,I=!0,L=await O.listOfTestScipts;for(let a=0;a<await L.length;a++)if("Pass"!==await L[a].status){I=!1;break}e.isAllScriptsGetPassed=await I}catch(a){}t.json(await e)}),a.exports=s},1559:a=>{"use strict";a.exports=require("selenium-webdriver/edge")},1572:a=>{"use strict";a.exports=require("nodemailer")},1715:(a,t,e)=>{const i=e(7252).Router(),{saveFile:r,isDirectoryExist:s,createDirectory:n,getFolderSizeInBytes:w,addLogMessageInConsole:o,readJSONFile:c,saveFileAsEncyptedContent:u}=e(7229);var l="./dataHub/",d=e(9896);e(2410);const p=e(4716),m=["gmail.com","yahoo.com","outlook.com","hotmail.com","live.com","rediffmail.com"],v=e(8938),g=new(e(5692).Agent)({rejectUnauthorized:!1});i.post("/registration",async(a,t)=>{var e={isSuccess:!1,errorMessage:""};try{var i=await a.body;try{var r=await i.orgname;if(r=(r||"").toString().trim().toUpperCase(),!/^[a-zA-Z0-9_ ]*$/.test(await r))return e.errorMessage="Company name can contain only letters (A–Z, a–z), numbers (0–9), dot (.), and underscore (_) and space.",t.json(e);if(await r.toString().length>100)return e.errorMessage="Company name length can not greter than 100 char.",t.json(e);var w=await i.projectname;if(w=await w.toString().trim(),!/^[a-zA-Z0-9_]*$/.test(w))return e.errorMessage="Project name can contain only letters (A–Z, a–z), numbers (0–9), dot (.), and underscore (_).",t.json(e);if(await w.toString().length>100)return e.errorMessage="Project name length can not greter than 100 char.",t.json(e);var o=await i.email;if(o=await o.toString().trim().toLowerCase(),!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o))return e.errorMessage="Email can not valid.",t.json(e);const a=o.split("@")[1].toLowerCase();if(m.includes(a))return e.errorMessage="Please use your organization email address.",t.json(e);var p=await i.password;if(p=await p.toString().trim(),!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[A-Za-z\d]{6,}$/.test(p))return e.errorMessage="Password must be at least 6 characters and include 1 uppercase letter,1 lowercase letter, and 1 number..",t.json(e);var h=await i.serverurl,f=await i.onprem,y={};y.email=await o,y.orgname=await r,y.projectname=await w;var b=await v.post(await h+"signup/remoteusercheck",await y,{httpsAgent:g});if(resData=await b.data,!await resData.isSuccess)return e.errorMessage=await resData.errorMessage,t.json(e);if(y.onprem=f,b=await v.post(await h+"signup/saveorglicence",await y,{httpsAgent:g}),resData=await b.data,!await resData.isSuccess)return e.errorMessage=await resData.errorMessage,t.json(e);var S=await s(await r+"/UserDetails");if(await S)return e.errorMessage="Organization or company name is already taken. Please choose a different name.",t.json(e);await n(await r+"/UserDetails");var x=await l+await r+"/UserDetails/UserDetails.json",M=await s(await r+"/UserDetails/UserDetails.json");if(!await M){const a={},t=JSON.stringify(await a,null,2);await d.writeFileSync(await x,await t)}var N=await c(await r+"/UserDetails/UserDetails.json"),T=await N[await o];if(void 0!==await T)return e.errorMessage="Email is already taken. Please choose a different email.",t.json(e);N[await o]={},(T={}).firstName="QAautoMATER",T.lastName="User",T.secretKey=await p,T.secretKey=await p;var E=[];E.push(await w),T.accounts=await E;var A=[];A.push(await r),T.accountLabel=await A,N[await o]=await T;var P=await u(await r+"/UserDetails/UserDetails.json",await N);if(!await P)return e.errorMessage="Unable to add user details.",t.json(e);var C=await l+await r+"/UserDetails/AccountAdmin.json";if(M=await s(await r+"/UserDetails/AccountAdmin.json"),!await M){const a={},t=JSON.stringify(await a,null,2);await d.writeFileSync(await C,await t)}var k=await c(await r+"/UserDetails/AccountAdmin.json"),j=await k[await w];if(!(void 0===await j&&(k[w]=[]),j=await k[await w],await j.includes(await o)||(k[await w].push(await o),P=await u(await r+"/UserDetails/AccountAdmin.json",await k),await P)))return e.errorMessage="Unable to add user into admin section.",t.json(e);M=await s("UserAccountInfo.json");var D=await l+"/UserAccountInfo.json";if(!await M){const a={},t=JSON.stringify(await a,null,2);await d.writeFileSync(await D,await t)}var O=await c("UserAccountInfo.json");O[await o]={};var I=[];I.push(await r),O[await o].accountLabel=await I,P=await u("UserAccountInfo.json",await O),await P&&(e.isSuccess=!0)}catch(a){return e.errorMessage=await a.toString(),t.json(e)}}catch(a){e.errorMessage=await a.toString()}t.json(e)}),i.post("/remoteusercheck",async(a,t)=>{var e={isSuccess:!1,errorMessage:""};try{var i=await await a.body,r=await i.email,s=await i.orgname,n=await c("UserAccountInfo.json");if(void 0!==await n){var w=await n[await r];if(void 0!==await w)return e.errorMessage="Email is already taken. Please choose a different email.",t.json(e);n[await r]={};var o=[];o.push(await s),n[await r].accountLabel=await o;var l=await u("UserAccountInfo.json",await n);await l&&(e.isSuccess=!0)}}catch(a){e.errorMessage=await a.toString()}t.json(e)}),i.post("/saveorglicence",async(a,t)=>{var e={isSuccess:!1,errorMessage:""};try{var i=await await a.body,n=await i.orgname,w=await i.onprem,o=await i.projectname,u=await s("OrgLicenceDetails/"+await n+".json");if(await u)return e.errorMessage="Licence key is already present.",t.json(e);const h={},f=JSON.stringify(await h,null,2);var m=await l+"OrgLicenceDetails/"+await n+".json";await d.writeFileSync(await m,await f);var v=await c("OrgLicenceDetails/"+await n+".json");const y=p(),b=p(y).add(365,"days").format("DD MMM YYYY"),S=p(y).add(15,"days").format("DD MMM YYYY"),x=p(y).add(15,"days").format("DD MMM YYYY"),M=p(y).add(15,"days").format("DD MMM YYYY");v.maxProjects=1,v[await o]={},v[await o].maxUsers=3,await w?(v[await o].maxThreadForUI=2,v[await o].maxThreadForAPI=2,v[await o].maxThreadForMobile=2):(v[await o].maxThreadForUI=1,v[await o].maxThreadForAPI=1,v[await o].maxThreadForMobile=1),v[await o].licenseValidityFromPresentDay=await b,v[await o].isManualComponentDisplayed=!0,v[await o].isDefectComponentDisplayed=!0,v[await o].isAutomationComponentDisplayed=!1,v[await o].isUIComponentDisplayed=!1,v[await o].isApiComponentDisplayed=!1,v[await o].isMobileComponentDisplayed=!1,v[await o].maxNumberOfEnvPerAccount=4,await w?v[await o].totalStorage="10 GB":v[await o].totalStorage="1 GB",v[await o].UILicenceValidity=await S,v[await o].MobileLicenceValidity=await x,v[await o].APILicenceValidity=await M;var g=await r("OrgLicenceDetails/"+await n+".json",await v);await g?e.isSuccess=!0:e.errorMessage="Unexpected error, please try after sometime."}catch(a){e.errorMessage=await a.toString()}t.json(e)}),a.exports=i},1751:(a,t,e)=>{const i=e(1572),{format:r}=e(4023);async function s(a,t){try{var e=await t.TitlePrefix,i=await t.env,r=await t.executionDate,s=await t.executionTime,n=await t.totalExecutionTime,w=await t.totalPass,o=await t.totalFail,c=await t.suiteName,u=await t.executedBy,l=Number(await w)+Number(await o);a=(a=(a=(a=(a=(a=(a=a.replace(/Change9/g,await e)).replace(/Change8/g,await i)).replace(/Change7/g,await r)).replace(/Change1/g,await s)).replace(/Change4/g,await l)).replace(/Change2/g,await w)).replace(/Change3/g,await o);let d=await(w/l*100).toFixed(2),p=(100-d).toFixed(2);a=(a=(a=(a=(a=a.replace(/Change5/g,await d)).replace(/Change6/g,await p)).replace(/ChangeTime/g,await n)).replace(/ChangeSuiteName/g,await c)).replace(/ChangeExecutedBy/g,await u)}catch(a){}return await a}async function n(){return"<html>\n<head>\n<meta http-equiv=Content-Type content=\"text/html; charset=windows-1252\">\n<meta name=Generator content=\"Microsoft Word 15 (filtered)\">\n<style>\n\x3c!--\n /* Font Definitions */\n @font-face\n\t{font-family:\"Cambria Math\";\n\tpanose-1:2 4 5 3 5 4 6 3 2 4;}\n@font-face\n\t{font-family:Calibri;\n\tpanose-1:2 15 5 2 2 2 4 3 2 4;}\n /* Style Definitions */\n p.MsoNormal, li.MsoNormal, div.MsoNormal\n\t{margin-top:0in;\n\tmargin-right:0in;\n\tmargin-bottom:8.0pt;\n\tmargin-left:0in;\n\tline-height:107%;\n\tfont-size:11.0pt;\n\tfont-family:\"Calibri\",sans-serif;}\np.MsoNoSpacing, li.MsoNoSpacing, div.MsoNoSpacing\n\t{margin-right:0in;\n\tmargin-left:0in;\n\tfont-size:12.0pt;\n\tfont-family:\"Times New Roman\",serif;}\nspan.apple-converted-space\n\t{mso-style-name:apple-converted-space;}\n.MsoChpDefault\n\t{font-family:\"Calibri\",sans-serif;}\n.MsoPapDefault\n\t{margin-bottom:8.0pt;\n\tline-height:107%;}\n@page WordSection1\n\t{size:8.5in 11.0in;\n\tmargin:1.0in 1.0in 1.0in 1.0in;}\ndiv.WordSection1\n\t{page:WordSection1;}\n--\x3e\n</style>\n</head>\n<body lang=EN-US>\n<div class=WordSection1>\n<div align=center>\n<table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=664\n style='width:498.0pt;background:#00B0F0;border-collapse:collapse'>\n <tr style='height:326.95pt'>\n  <td width=664 valign=top style='width:498.0pt;border:solid windowtext 1.0pt;\n  padding:0in 5.4pt 0in 5.4pt;height:326.95pt'>\n  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:\n  normal'><span style='font-size:10.0pt'>&nbsp;</span></p>\n  <div align=center>\n  <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0\n   style='background:#C6D9F1;border-collapse:collapse'>\n   <tr style='height:14.6pt'>\n    <td width=554 valign=top style='width:415.55pt;border:solid windowtext 1.0pt;\n    background:#365F91;padding:0in 5.4pt 0in 5.4pt;height:14.6pt'>\n    <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:\n    .0001pt;text-align:center;line-height:normal'><b><span style='font-size:\n    16.0pt;color:white'>Change9 Test Suite Results</span></b></p>\n    </td>\n   </tr>\n   <tr style='height:65.15pt'>\n    <td width=554 valign=top style='width:415.55pt;border:solid windowtext 1.0pt;\n    border-top:none;background:#DBE5F1;padding:0in 5.4pt 0in 5.4pt;height:65.15pt'>\n    <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n    line-height:normal'><span style='font-size:10.0pt;color:#1F497D'>&nbsp;</span></p>\n    <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n    line-height:normal'><span style='font-size:10.0pt;color:#002060'>Hello,</span></p>\n    <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n    line-height:normal'><span style='font-size:10.0pt;color:#002060'>Greetings\n    for the day!</span></p>\n    <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n    line-height:normal'><span style='font-size:10.0pt;color:#002060'>Please\n    find Automation Run Result below:</span></p>\n    <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n    line-height:normal'><b><span style='font-size:10.0pt;color:#4A442A'>&nbsp;</span></b></p>\n    </td>\n   </tr>\n  </table>\n  </div>\n  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:\n  normal'>&nbsp;</p>\n  <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0\n   style='margin-left:11.2pt;background:#D9D9D9;border-collapse:collapse'>\n   <tr style='height:147.65pt'>\n    <td width=620 valign=top style='width:465.0pt;border:solid windowtext 1.0pt;\n    background:#365F91;padding:0in 5.4pt 0in 5.4pt;height:147.65pt'>\n    <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n    line-height:normal'><span style='font-size:10.0pt'>&nbsp;</span></p>\n    <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=596\n     style='width:446.95pt;margin-left:3.35pt;background:white;border-collapse:\n     collapse'>\n\t  <tr style='height:10.7pt'>\n      <td width=306 valign=top style='width:229.5pt;border:solid windowtext 1.0pt;\n      padding:0in 5.4pt 0in 5.4pt;height:10.7pt'>\n      <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:\n      .0001pt;text-align:center;line-height:normal'><span style='font-size:\n      10.0pt;color:#002060'>Executed Suite Name</span></p>\n      </td>\n      <td width=290 valign=top style='width:217.45pt;border:solid windowtext 1.0pt;\n      border-left:none;padding:0in 5.4pt 0in 5.4pt;height:10.7pt'>\n      <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n      line-height:normal'><span style='font-size:10.0pt;color:#002060'>ChangeSuiteName</span></p>\n      </td>\n     </tr>\n\t <tr style='height:10.7pt'>\n      <td width=306 valign=top style='width:229.5pt;border:solid windowtext 1.0pt;\n      padding:0in 5.4pt 0in 5.4pt;height:10.7pt'>\n      <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:\n      .0001pt;text-align:center;line-height:normal'><span style='font-size:\n      10.0pt;color:#002060'>Executed By</span></p>\n      </td>\n      <td width=290 valign=top style='width:217.45pt;border:solid windowtext 1.0pt;\n      border-left:none;padding:0in 5.4pt 0in 5.4pt;height:10.7pt'>\n      <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n      line-height:normal'><span style='font-size:10.0pt;color:#002060'>ChangeExecutedBy</span></p>\n      </td>\n     </tr>\n     <tr style='height:10.7pt'>\n      <td width=306 valign=top style='width:229.5pt;border:solid windowtext 1.0pt;\n      padding:0in 5.4pt 0in 5.4pt;height:10.7pt'>\n      <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:\n      .0001pt;text-align:center;line-height:normal'><span style='font-size:\n      10.0pt;color:#002060'>Total Test Execution Time</span></p>\n      </td>\n      <td width=290 valign=top style='width:217.45pt;border:solid windowtext 1.0pt;\n      border-left:none;padding:0in 5.4pt 0in 5.4pt;height:10.7pt'>\n      <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n      line-height:normal'><span style='font-size:10.0pt;color:#002060'>ChangeTime</span></p>\n      </td>\n     </tr>\n    </table>\n    <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n    line-height:normal'>&nbsp;</p>\n    <div align=center>\n    <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0 width=597\n     style='width:447.8pt;background:#C6D9F1;border-collapse:collapse'>\n     <tr style='height:104.55pt'>\n      <td width=307 valign=top style='width:3.2in;border:solid windowtext 1.0pt;\n      background:white;padding:0in 5.4pt 0in 5.4pt;height:104.55pt'>\n      <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:\n      .0001pt;text-align:center;line-height:normal'><span style='color:#002060'>Summary</span></p>\n      <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n      line-height:normal'><b><span style='font-size:10.0pt'>&nbsp;</span></b></p>\n      <div align=center>\n      <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0\n       width=269 style='width:201.65pt;border-collapse:collapse'>\n       <tr style='height:10.7pt'>\n        <td width=155 valign=top style='width:116.1pt;border:solid windowtext 1.0pt;\n        padding:0in 5.4pt 0in 5.4pt;height:10.7pt'>\n        <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n        line-height:normal'><span style='font-size:10.0pt;color:#002060'>Execution Date</span></p>\n        </td>\n        <td width=114 valign=top style='width:85.55pt;border:solid windowtext 1.0pt;\n        border-left:none;padding:0in 5.4pt 0in 5.4pt;height:10.7pt'>\n        <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n        line-height:normal'><span style='font-size:10.0pt;color:#002060'>Change7</span></p>\n        </td>\n       </tr>\n       <tr style='height:12.65pt'>\n        <td width=155 valign=top style='width:116.1pt;border:solid windowtext 1.0pt;\n        border-top:none;padding:0in 5.4pt 0in 5.4pt;height:12.65pt'>\n        <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n        line-height:normal'><span style='font-size:10.0pt;color:#002060'>Execution\n        Time</span></p>\n        </td>\n        <td width=114 valign=top style='width:85.55pt;border-top:none;\n        border-left:none;border-bottom:solid windowtext 1.0pt;border-right:\n        solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt;height:12.65pt'>\n        <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n        line-height:normal'><span style='font-size:10.0pt;color:#002060'>Change1</span></p>\n        </td>\n       </tr>\n       <tr style='height:11.9pt'>\n        <td width=155 valign=top style='width:116.1pt;border:solid windowtext 1.0pt;\n        border-top:none;padding:0in 5.4pt 0in 5.4pt;height:11.9pt'>\n        <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n        line-height:normal'><span style='font-size:10.0pt;color:#002060'>Pass</span></p>\n        </td>\n        <td width=114 valign=top style='width:85.55pt;border-top:none;\n        border-left:none;border-bottom:solid windowtext 1.0pt;border-right:\n        solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt;height:11.9pt'>\n        <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n        line-height:normal'><span style='font-size:10.0pt;color:#002060'>Change2</span></p>\n        </td>\n       </tr>\n       <tr style='height:12.6pt'>\n        <td width=155 valign=top style='width:116.1pt;border:solid windowtext 1.0pt;\n        border-top:none;padding:0in 5.4pt 0in 5.4pt;height:12.6pt'>\n        <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n        line-height:normal'><span style='font-size:10.0pt;color:#002060'>Fail</span></p>\n        </td>\n        <td width=114 valign=top style='width:85.55pt;border-top:none;\n        border-left:none;border-bottom:solid windowtext 1.0pt;border-right:\n        solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt;height:12.6pt'>\n        <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n        line-height:normal'><span style='font-size:10.0pt;color:#002060'>Change3</span></p>\n        </td>\n       </tr>\n       <tr style='height:13.35pt'>\n        <td width=155 valign=top style='width:116.1pt;border:solid windowtext 1.0pt;\n        border-top:none;padding:0in 5.4pt 0in 5.4pt;height:13.35pt'>\n        <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n        line-height:normal'><span style='font-size:10.0pt;color:#002060'>Total</span></p>\n        </td>\n        <td width=114 valign=top style='width:85.55pt;border-top:none;\n        border-left:none;border-bottom:solid windowtext 1.0pt;border-right:\n        solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt;height:13.35pt'>\n        <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n        line-height:normal'><b><span style='color:#002060'>Change4</span></b></p>\n        </td>\n       </tr>\n      </table>\n      </div>\n      </td>\n      <td width=290 valign=top style='width:217.4pt;border:solid windowtext 1.0pt;\n      border-left:none;background:white;padding:0in 5.4pt 0in 5.4pt;height:\n      104.55pt'>\n      <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:\n      .0001pt;text-align:center;line-height:normal'><span style='font-size:\n      10.0pt;color:#1F497D'>Pass /Fail Percentage</span></p>\n      <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:\n      .0001pt;text-align:center;line-height:normal'><b><span style='font-size:\n      10.0pt;color:#1F497D'>Change8-Environment</span></b></p>\n      <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n      line-height:normal'><span style='font-size:10.0pt'>&nbsp;</span></p>\n      <div align=center>\n      <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0\n       width=240 style='width:180.3pt;background:red;border-collapse:collapse'>\n       <tr style='height:17.0pt'>\n        <td width=121 valign=top style='width:90.5pt;border:solid windowtext 1.0pt;\n        background:#00B050;padding:0in 5.4pt 0in 5.4pt;height:17.0pt'>\n        <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:\n        .0001pt;text-align:center;line-height:normal'><b><span\n        style='font-size:12.0pt;color:white'>Pass</span></b></p>\n        </td>\n        <td width=120 valign=top style='width:89.8pt;border:solid windowtext 1.0pt;\n        border-left:none;background:#00B050;padding:0in 5.4pt 0in 5.4pt;\n        height:17.0pt'>\n        <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:\n        .0001pt;text-align:center;line-height:normal'><b><span\n        style='font-size:12.0pt;color:white'>Change5 %</span></b></p>\n        </td>\n       </tr>\n      </table>\n      </div>\n      <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n      line-height:normal'><span style='font-size:12.0pt'>&nbsp;</span></p>\n      <div align=center>\n      <table class=MsoNormalTable border=0 cellspacing=0 cellpadding=0\n       width=240 style='width:180.3pt;background:red;border-collapse:collapse'>\n       <tr style='height:17.0pt'>\n        <td width=121 valign=top style='width:90.5pt;border:solid windowtext 1.0pt;\n        padding:0in 5.4pt 0in 5.4pt;height:17.0pt'>\n        <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:\n        .0001pt;text-align:center;line-height:normal'><b><span\n        style='font-size:12.0pt;color:white'>Fail</span></b></p>\n        </td>\n        <td width=120 valign=top style='width:89.8pt;border:solid windowtext 1.0pt;\n        border-left:none;padding:0in 5.4pt 0in 5.4pt;height:17.0pt'>\n        <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:\n        .0001pt;text-align:center;line-height:normal'><b><span\n        style='font-size:12.0pt;color:white'>Change6 %</span></b></p>\n        </td>\n       </tr>\n      </table>\n      </div>\n      </td>\n     </tr>\n    </table>\n    </div>\n    <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;\n    line-height:normal'><span style='font-size:10.0pt;color:#D9D9D9'>&nbsp;</span></p>\n    </td>\n   </tr>\n  </table>\n  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:\n  normal'><span style='font-size:10.0pt'>&nbsp;</span></p>\n  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:\n  normal'><span style='font-size:10.0pt;color:#002060'>&nbsp;</span></p>\n  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:\n  normal'><span style='font-size:10.0pt;color:#002060'>Thanks,</span></p>\n  <p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:\n  normal'><span style='font-size:10.0pt;color:#002060'>QA Automation Team</span></p>\n  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\n  text-align:center;line-height:normal'><span style='font-size:10.0pt;\n  color:#002060'>&nbsp;</span></p>\n  <p class=MsoNormal align=center style='margin-bottom:0in;margin-bottom:.0001pt;\n  text-align:center;line-height:normal'><span style='font-size:10.0pt;\n  color:#002060'>*** This is an automatically generated email. Please do not\n  reply to this message. ***</span></p>\n  </td>\n </tr>\n</table>\n</div>\n<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:\nnormal'><span style='font-size:13.5pt;color:black'>&nbsp;</span></p>\n<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:\nnormal'><span style='font-size:13.5pt;color:black'>&nbsp;</span></p>\n<p class=MsoNormal style='margin-bottom:0in;margin-bottom:.0001pt;line-height:\nnormal'><span style='font-size:13.5pt;font-family:\"Times New Roman\",serif;\ncolor:black'>&nbsp;</span></p>\n</div>\n</body>\n</html>\n"}function w(a,t,e){return new Promise((i,s)=>{const n=r({headers:e});let w="";n.on("data",a=>{w+=a.toString()}).on("end",()=>{i(w)}).on("error",a=>s(a)),a.forEach(a=>{const e={"S.No":a.id,Component:a.component,TestId:a.testid,TestName:a.testname,Status:a.status,"Reason of Failure":""};if("Fail"===a.status)try{const r=a.id.toString(),s=t[r];if(s&&s.length>0){const a=s[s.length-1],t=JSON.parse(a.testdata);var i="";i="string"==typeof t.errorMessage?t.errorMessage:void 0!==(i=t.errorMessage).applicationErrorMessage?i.applicationErrorMessage:void 0!==i.errorMessage?i.errorMessage:JSON.stringify(i),e["Reason of Failure"]=i}else e["Reason of Failure"]="No assertion data found"}catch(a){console.error("Error extracting failure reason:",a),e["Reason of Failure"]="Error extracting failure reason"}n.write(e)}),n.end()})}a.exports={sendEmail:async function(a){try{var t=await a.host,e=await a.port,r=await a.senderEmail,o=await a.password,c=await a.recipientEmail,u=await a.TitlePrefix;const d=i.createTransport({host:await t,port:Number(await e),secure:!1,auth:{user:await r,pass:await o},tls:{ciphers:"SSLv3"}});var l=await n();l=await s(await l,await a);let p=[];try{const t=["S.No","Component","TestId","TestName","Status","Reason of Failure"],e=await w(await a.resultOfTestScripts.listOfTestScipts,await a.resultOfTestScripts.testscriptAssertionData,await t);p.push({filename:"Test-Detail-Report.csv",content:e,contentType:"text/csv"})}catch(a){console.error("Error generating CSV: ",a)}const m={from:await r,to:await c,subject:await u+" Test Execution Results",html:await l,attachments:p.length>0?p:[]};try{await d.sendMail(m),console.error("Email Trigger-Email sent successfully.")}catch(a){console.error("Email Trigger-Error sending email: ",a)}}catch(a){console.error("Email Trigger-Unable to send email because of ",a)}},sendEmailUsingSMTPRelay:async function(a){try{var t=await a.host,e=await a.port,r=await a.senderEmail,o=await a.recipientEmail,c=await a.TitlePrefix;const l=i.createTransport({host:await t,port:Number(await e),secure:!1,tls:{rejectUnauthorized:!1}});var u=await n();u=await s(await u,await a);let d=[];try{const t=["S.No","Component","TestId","TestName","Status","Reason of Failure"],e=await w(await a.resultOfTestScripts.listOfTestScipts,await a.resultOfTestScripts.testscriptAssertionData,await t);d.push({filename:"Test-Detail-Report.csv",content:e,contentType:"text/csv"})}catch(a){console.error("Error generating CSV: ",a)}const p={from:await r,to:await o,subject:await c+" Test Execution Results",html:await u,attachments:d.length>0?d:[]};try{await l.sendMail(p),console.log("Email Trigger - Email sent successfully.")}catch(a){console.error("Email Trigger - Error sending email: ",a)}}catch(a){console.error("Email Trigger - Unable to send email because of ",a)}}}},1816:a=>{"use strict";a.exports=require("ms-chromium-edge-driver")},2072:(a,t,e)=>{const i=e(7252).Router(),{getActiveThreadCounter:r,getPlanForAccount:s,addUIExecutionThread:n,resetUIExecutionThread:w}=e(5843),{executeTestScript:o}=e(861),{saveFile:c,isDirectoryExist:u,createDirectory:l,addOrSubtractDaysToCurrentDate:d,deleteAllFileFromFolder:p,addLogMessageInConsole:m,isSpaceFreeOnAccount:v,readJSONFile:g}=e(7229),{getAllCustomFunction:h}=e(6777),{sendEmail:f,sendEmailUsingSMTPRelay:y}=e(1751);var b="./dataHub/";const{authCheck:S}=e(2258);var x=e(9896);const M=e(2410);async function N(a,t,e){for(let s=0;s<await a.length;s++){var i=await a[s].component,r=await a[s].testid;if(await i===await t&&await r===await e)return s}return-1}async function T(a,t,e,i,r,s,n,w,o,c,u,l,d){try{if(void 0!==await a&&"Yes"===await a&&void 0!==await t&&""!==await t&&void 0!==await e&&void 0!==await e.EMAILDETAILS){var p=await e.EMAILDETAILS.DefaultEmailProtocol;if(void 0!==await p&&""!==await p){var m=await e.EMAILDETAILS[await p],v={};v.host=await m.host,v.port=await m.port,v.senderEmail=await m.senderEmail,v.password=await m.password,v.recipientEmail=await t,v.TitlePrefix=await i,v.env=await r,v.executionDate=await s,v.executionTime=await n,v.totalPass=await w,v.totalFail=await o,v.suiteName=await u,v.executedBy=await l,v.resultOfTestScripts=await d,v.totalExecutionTime=await async function(a){try{a=await Number(await a);let t=Math.floor(await a/3600),e=Math.floor(await a%3600/60),i=await a%60,r=[];return await t>0&&r.push(`${t} hour${t>1?"s":""}`),await e>0&&r.push(`${e} minute${e>1?"s":""}`),await i>0&&r.push(`${i} second${i>1?"s":""}`),r.length>0?r.join(" "):"0 seconds"}catch(t){return a+" seconds"}}(await c),"SMTP Relay"===await p?await y(await v):await f(await v)}}}catch(a){console.log("Email Sent exception ocuured "+await a.toString())}}i.post("/project/:projectName",async(a,t)=>{var e={},i=await S(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var f=await a.headers.accountlabel,y=!1,E=await i.totalStorage,A=await a.headers.useremail,P={globalError:"",listOfTestScipts:[],testscriptAssertionData:[],executionTimeForTestScripts:{}},C={},k=0,j=0;try{var D=new Date,O=await d(0,"DD MMM YYYY"),I=await d(0,"hh mm A"),L=[],F=await a.body.environment,U=await a.body.runAt,V=await Number(await a.body.threadCount),B=await a.body.reportInDashBoard,R=await a.body.screenName,J=await a.body.deviceName,X=await a.params.projectName,W=await a.body.emailTriggerValue,Y=await a.body.recipientEmail,G=await a.body.suiteName,Q=!0;void 0!==await G&&"CustomTestScriptSelection"!==await G||(G="CustomTestScriptSelection",Q=!1);var q=await a.body.applicationName;void 0===await q&&(q="");var Z=await v(await f,await X,await E);if(!await Z.isSuccess)return P.globalError=await Z.errorMessage,t.json(P);L=await a.body.testscriptforExecution;var K,H=[],_={};try{var z=await f+"/"+await X+"/Mobile/Configuration.json";_=await g(await z)}catch(a){}var $=[];try{var aa=await _.PageLoaderXpath[await R];void 0!==await aa&&($=await aa)}catch(a){}var ta={};try{z=await f+"/"+await X+"/Mobile/CommonTestData.json";var ea=await g(await z);ta=void 0===await ea.CommonTestData?{}:await ea.CommonTestData}catch(a){ta={},ea={}}var ia=await ea.TestDataExistingEnvironment;void 0===await ia&&(ia=[]),K=await a.body.environment,await p(await f+"/"+await X+"/Mobile/Downloads/"),await l(await f+"/"+await X+"/Mobile/Downloads/");var ra=await h(await f,await X,"Mobile");try{await _.ExecutionCapabilities[await U]}catch(a){if("Server"!==await U&&"Client"!==await U)return P.globalError="Please add capability details on Mobile configuration page for cloud execution server "+await U,t.json(await P)}var sa={},na=await _.DefaultScreenshotOption;void 0===await na&&(na="For failure & success");var wa=await _.defaultTimeOut;void 0===await wa&&(wa=0);var oa="Yes";try{oa=await _.SelectedSelfHealingOption,void 0===await oa&&(oa="Yes")}catch(a){oa="Yes"}var ca=await L.length;if(ca<=V&&(V=await ca),"Server"===await U){var ua=await r(await f,await X,"Mobile"),la=await s(await i),da=Number(await la.maxThreadForUI);if(await ua>=Number(await la.maxThreadForUI))return P.globalError=await da+" thread are already active, as per your plan max "+await da+" thread can be active at a time, Please release the thread or wait till thread get released.",t.json(await P);var pa=Number(await da)-Number(await ua);if(Number(await V)>Number(await pa))return P.globalError="Only "+await pa+" thread is/are available.Please update Thread count* as per availability",await m(await P.globalError),t.json(await P);await n(await f,await X,await A,await V,"Mobile"),y=!0}console.log("********* Mobile Execution is triggered by the user "+await A+" with Environment "+await F+", thread count "+await V+", Report to be saved in Dashboard value "+await B+",testsuite,"+await G+" and test script count "+await ca);var ma=[],va=[],ga={};ga.Environment=await F,ga.PlatForm=await R,ga.ExecutedBy=await A,ga.DeviceName=await J;try{var ha=await f+"/"+await X+"/Mobile/Misc/GlobalVariable.Json",fa=await g(await ha);if(await Object.keys(await fa).length>0){var ya=await Object.keys(await fa);for(let a=0;a<await ya.length;a++){var ba=await ya[a],Sa=await fa[await ba];ga[await ba]=await Sa}}}catch(a){}for(let a=0;a<await L.length;a++){await a;try{var xa=await L[a].component;if(void 0!==await xa&&null!==await xa&&""!==await xa){var Ma=await L[a].testid,Na=await L[a].testname,Ta={};Ta.Component=await xa,Ta.TestId=await Ma,Ta.TestName=await Na,Ta.Environment=await F,Ta.ExecutedBy=await A;var Ea=o(await f,await X,await xa,await Ma+"@"+await Na,await F,await U,await R,await J,await ta,await ra,await na,await _,await K,await"",await wa,await oa,await B,await Ta,await ga,await q,await $);ma.push(Ea),await new Promise(a=>setTimeout(a,1e3)),va.push(Ea),await va.length===await V&&await Promise.any(va.map((a,t)=>a.then(a=>[a,t]))).then(([a,t])=>{va.splice(t,1)})}}catch(t){console.log("Exception: for reading component for test script index "+await a+" , hence skipping this test script "+JSON.stringify(await L))}}await Promise.all(await ma).then(a=>{var t=a;for(let a=0;a<t.length;a++){""!==t[a].globalError&&(P.globalError=t[a].globalError);var e=Number(a+1);L[a].id=e,t[a].isSuccess?(L[a].status="Pass",k+=1):(L[a].status="Fail",j+=1),C[e.toString()]=t[a].assertionData,sa[Number(e)]=t[a].executiontime;var i={component:L[a].component,duration:t[a].executiontime};H.push(i)}}),P.executionTimeForTestScripts=await sa,P.listOfTestScipts=await L,P.testscriptAssertionData=await C;var Aa={};for(let a=0;a<await H.length;a++){var Pa=await H[a].component,Ca=await H[a].duration;void 0===await Aa[Pa]?Aa[await Pa]=Number(await Ca):Aa[await Pa]=Number(Aa[Pa])+Number(await Ca)}if(P.executionTimeForComponent=await Aa,"yes"===await B.toString().toLowerCase())try{Q=!0;var ka=await P.listOfTestScipts;void 0!==await G&&"CustomTestScriptSelection"!==await G||(Q=!1,G="CustomTestScriptSelection");var ja={},Da=await a.body.existingSuiteName,Oa=await b+await f+"/"+X+"/Mobile/Reports/"+await F+"/"+Da+".json",Ia=await x.existsSync(await Oa);if(""!==await Da&&void 0!==await Da&&await Ia){var La=((new Date).getTime()-D.getTime())/1e3;La=await Number(await La.toString().split(".")[0]),ja={TimeStamp:await O+" "+await I,TotalTestScripts:await ka.length,Duration:await La+" seconds",ExecutedBy:await A,platform:await R,device:await J},z=await b+await f+"/"+X+"/Mobile/Reports/"+await F+"/"+Da+".json";var Fa=await JSON.parse(await x.readFileSync(await z,"utf8"));for(let a=0;a<await ka.length;a++){var Ua=await ka[a].component;if(void 0!==await Ua&&null!==await Ua&&""!==await Ua){Ma=await ka[a].testid;var Va=await ka[a].status,Ba=await N(await Fa.listOfExecutedTestScripts,await Ua,await Ma);if(await Ba>=0){var Ra=await Fa.listOfExecutedTestScripts[await Ba].status;if(ka[a].id=Number(await Ba)+1,Fa.listOfExecutedTestScripts[await Ba]=await ka[a],Fa.assertionResultsForAllTestScripts[Number(await Ba+1).toString()]=await P.testscriptAssertionData[Number(await a+1).toString()],await Va!==await Ra)if("pass"===await Va.toLowerCase()){var Ja=Number(Fa.totalPass),Xa=Number(Fa.totalFail);Fa.totalPass=await Ja+1,""!==await Ra&&(Fa.totalFail=await Xa-1);var Wa=Number(Fa.componentPassFail[0][await Ua]),Ya=Number(Fa.componentPassFail[1][await Ua]);Fa.componentPassFail[0][await Ua]=await Wa+1,""!==await Ra&&(Fa.componentPassFail[1][await Ua]=await Ya-1)}else"fail"===await Va.toLowerCase()&&(Ja=Number(Fa.totalPass),Xa=Number(Fa.totalFail),""!==await Ra&&(Fa.totalPass=await Ja-1),Fa.totalFail=await Xa+1,Wa=Number(Fa.componentPassFail[0][await Ua]),Ya=Number(Fa.componentPassFail[1][await Ua]),""!==await Ra&&(Fa.componentPassFail[0][await Ua]=await Wa-1),Fa.componentPassFail[1][await Ua]=await Ya+1)}}}void 0===await Fa.testSuiteReExecutionHistory&&(Fa.testSuiteReExecutionHistory=[]),Fa.testSuiteReExecutionHistory.push(await ja),await c(await f+"/"+X+"/Mobile/Reports/"+await F+"/"+Da+".json",await Fa);try{La=((new Date).getTime()-D.getTime())/1e3,La=await Number(await La.toString().split(".")[0]);var Ga=await Da;await Ga.includes("-")&&(Ga=await Ga.split("-")[0]),await T(await W,await Y,await _,"Mobile",await F,await O,await I,await k,await j,await La,await Ga,await A,await P),await m(await A+" Total "+await k+" scripts get passed.  "+await j+" scripts get failed and total execution time is "+await La+" seconds.")}catch(a){}}else{var Qa=[],qa={},Za={};for(let a=0;a<await ka.length;a++){Ua=await ka[a].component,void 0===qa[await Ua]&&(qa[await Ua]=0),void 0===Za[await Ua]&&(Za[await Ua]=0);var Ka=await ka[a].status;"Pass"===await Ka?qa[await Ua]=await qa[await Ua]+1:"Fail"===Ka&&(Za[await Ua]=await Za[await Ua]+1)}Qa.push(await qa),Qa.push(await Za);var Ha={};Ha.executedBy=await A,Ha.executionStartDate=await O,Ha.executionStartTime=await I,Ha.testingType="Integration Testing",Ha.listOfExecutedTestScripts=await P.listOfTestScipts,Ha.assertionResultsForAllTestScripts=await P.testscriptAssertionData,Ha.environment=await F,Ha.totalPass=await k,Ha.totalFail=await j,Ha.screen=await R,Ha.devicebrowser=await J,Ha.componentPassFail=await Qa,Ha.executionTimeData=await P.executionTimeForComponent,Ha.executionTimeForTestScripts=await P.executionTimeForTestScripts;var _a=await a.body.triggerFrom;void 0===await _a&&(_a="QAautoMATER UI"),Ha.triggerFrom=await _a,La=((new Date).getTime()-D.getTime())/1e3,La=await Number(await La.toString().split(".")[0]),Ha.totalExecutionTime=await La,await u(await f+"/"+X+"/Mobile/Reports/"+F)||await l(await f+"/"+X+"/Mobile/Reports/"+await F);var za=await Ha.executionStartDate.toString().trim()+"_"+await Ha.executionStartTime.toString().trim(),$a=await Ha.executionStartTime.toString().trim(),at=await $a.split(" "),tt=Number(await at[1]);for(let a=0;a<60;a++){var et=await f+"/"+X+"/Mobile/Reports/"+await F+"/*"+await za+".json";if(0==(await M.sync(await et)).length)break;if(59==await tt){tt=0;var it=Number(await at[0]);it=Number(await it)+1;var rt=await it.toString();1===await rt.toString().length&&(rt="0"+await rt),at[0]=await rt}else tt=Number(await tt)+1;var st=await tt.toString();1===await st.toString().length&&(st="0"+await st),$a=await at[0]+" "+await st+" "+at[2],za=await Ha.executionStartDate.toString().trim()+"_"+await $a.toString().trim()}if(await Ia||""===Da)za=await G+"-"+await za;else{try{await Da.includes("-")&&(Da=await Da.split("-")[0])}catch(a){Da=await G}G=await Da,za=await Da+"-"+await za}if(Ha.suiteName=await G,await Q||"CustomTestScriptSelection"!==await G)try{var nt=await G,wt=await b+await f+"/"+X+"/Mobile/TestSuite/"+nt+".json",ot=await x.existsSync(await wt);if(await ot){var ct=await JSON.parse(await x.readFileSync(await wt,"utf8")),ut=await ct.testsuite;if(await ut.length!==await ca){var lt=await P.testscriptAssertionData,dt=await P.listOfTestScipts,pt=[],mt={};for(let a=0;a<await ut.length;a++){var vt=await ut[a];vt.status="";var gt=await vt.id,ht=await vt.component,ft=await vt.testid;for(let a=0;a<await dt.length;a++){var yt=await dt[a].component,bt=await dt[a].testid;if(await yt==await ht&&await bt==await ft){vt.status=await dt[a].status,mt[await gt.toString()]=await lt[await dt[a].id.toString()];break}}pt.push(await vt)}Ha.assertionResultsForAllTestScripts=await mt,Ha.listOfExecutedTestScripts=await pt}}}catch(a){}await c(await f+"/"+await X+"/Mobile/Reports/"+await F+"/"+await za+".json",await Ha),console.log("********* Test Reports is successfully saved to the server where execution is triggered by the user "+await A),await T(await W,await Y,await _,"Mobile",await F,await Ha.executionStartDate,await Ha.executionStartTime,await k,await j,await Ha.totalExecutionTime,await G,await A,await P)}}catch(a){console.log("Unable to Save Reports because of "+await a.toString())}else try{La=((new Date).getTime()-D.getTime())/1e3,La=await Number(await La.toString().split(".")[0]),await T(await W,await Y,await _,"Mobile",await F,await O,await I,await k,await j,await La,await G,await A,await P)}catch(a){}}catch(a){console.log("Test suite execution throw exception and reports not generated "+await a.toString())}try{""!==await P.globalError&&await P.listOfTestScipts.length>0&&(P.globalError="")}catch(a){}"Server"===await U&&await y&&await w(await f,await X,await A,await V,"Mobile"),t.json(await P)}),a.exports=i},2096:a=>{"use strict";a.exports=require("morgan")},2103:a=>{"use strict";a.exports=require("crypto-js")},2258:(a,t,e)=>{const i=e(829),r=e(8330);e(4716);var s=e(9896);e(2103),e(3106);const n=e(8938),w=new(e(5692).Agent)({rejectUnauthorized:!1}),{addLogMessageInConsole:o,verifyReqestHeaderAccountAndProject:c,readJSONFile:u}=e(7229);async function l(a,t,e){var i={isUserExistonServer:!1,isSuccess:!1,errorMessage:"",expiresOn:"",accounts:[],maxUsers:0,maxThreadForUI:0,maxThreadForAPI:0,maxThreadForMobile:0,isManualComponentDisplayed:!1,isDefectComponentDisplayed:!1,isAutomationComponentDisplayed:!1,isUIComponentDisplayed:!1,isApiComponentDisplayed:!1,isMobileComponentDisplayed:!1,maxNumberOfEnvPerAccount:1,totalStorage:""};i.apiVersion=await r.version;try{var s=await n.get(await e+"license/org/"+await a+"/project/"+await t,{httpsAgent:w});if(s=await s.data,!await s.isSuccess)return i.errorMessage=await s.errorMessage,i;var o=await s.projectDetails;i.expiresOn=await o.licenseValidityFromPresentDay,i.accounts=await await async function(a){var t=[];try{var e=await Object.keys(await a);for(let s=0;s<await e.length;s++){var i=await e[s],r=await a[await i];"object"==typeof await r&&t.push(await i)}}catch(a){}return await t}(await s.orgDetails),i.isUserExistonServer=!0,i.isSuccess=!0,i.maxUsers=await o.maxUsers,i.maxThreadForUI=await o.maxThreadForUI,i.maxThreadForAPI=await o.maxThreadForAPI,i.maxThreadForMobile=await o.maxThreadForMobile,i.isManualComponentDisplayed=await o.isManualComponentDisplayed,i.isDefectComponentDisplayed=await o.isDefectComponentDisplayed,i.isAutomationComponentDisplayed=await o.isAutomationComponentDisplayed,i.isUIComponentDisplayed=await o.isUIComponentDisplayed,i.isApiComponentDisplayed=await o.isApiComponentDisplayed,i.isMobileComponentDisplayed=await o.isMobileComponentDisplayed,i.maxNumberOfEnvPerAccount=await o.maxNumberOfEnvPerAccount,i.totalStorage=await o.totalStorage}catch(t){return i.errorMessage=await a+" account does not exist in License key. Please connect QaBunch Support Team.",i}return await i}a.exports={authCheck:async function(a){var t={responseCode:200,isSuccess:!1,firstName:"",lastName:"",errorMessage:"",image:""};t.apiVersion=await r.version;var e="";t.maxUsers=0,t.maxThreadForUI=0,t.maxThreadForAPI=0,t.maxThreadForMobile=0,t.maxNumberOfEnvPerAccount=1,t.accounts=[],t.totalStorage="",t.isSuperAdmin=!1,t.isManualComponentDisplayed=!1,t.isDefectComponentDisplayed=!1,t.isAutomationComponentDisplayed=!1,t.isUIComponentDisplayed=!1,t.isApiComponentDisplayed=!1,t.isMobileComponentDisplayed=!1,t.host="",t.support="",t.expiresOn="";try{var n=await a.headers.useremail;if(void 0===await n)return t.responseCode=400,t.errorMessage="UserEmail is missing in request header section.",await o("User email "+await n+" is missing in request header section."),t;if(n=await n.toString().toLocaleLowerCase().trim(),""===await n)return t.responseCode=400,t.errorMessage="UserEmail can not be blank.",await o("User email "+await n+" is missing in request header section."),t;if(void 0===await a.headers.authorization)return t.responseCode=400,t.errorMessage="Autherization token is missing in request header",await o("Autherization key is missing in request header for user email "+await"User email "+await n),t;try{e=await a.headers.authorization.split(" ")[1]}catch(a){return t.responseCode=400,t.errorMessage="Autherization token is not provided in correct format.",await o("Autherization key is not provided  in correct format for user email "+await n),t}if(void 0===await e)return t.responseCode=400,t.errorMessage="Autherization token is not provided in correct format.",await o("Autherization key is not provided  in correct format for user email "+await n),t;var w=await a.headers.accountlabel,c=await a.headers.userselectedaccount,d=await a.headers.serverurl,p=await u(await w+"/UserDetails/UserDetails.json"),m=await p[n],v=await m.secretKey;const r=await i.verify(await e,await v);if(await r.email.toLowerCase()===await n.toLowerCase()){var g=await"./dataHub/"+await w+"/UserSession/UserSession.json",h=await JSON.parse(await s.readFileSync(await g,"utf8"));if(await h[await c][await n.toLowerCase()].toLowerCase()===await e.toLowerCase()){var f=await p[await n.toLowerCase()].firstName;void 0===await f&&(f="FirstName"),t.firstName=await f;var y=await p[await n.toLowerCase()].lastName;void 0===await y&&(y="LastName"),t.lastName=await y;var b=await l(await w,await c,await d);if(!await b.isSuccess)return t.isSuccess=!1,t.errorMessage=await b.errorMessage,t;t.maxUsers=await b.maxUsers,t.maxThreadForUI=await b.maxThreadForUI,t.maxThreadForAPI=await b.maxThreadForAPI,t.maxThreadForMobile=await b.maxThreadForMobile,t.maxNumberOfEnvPerAccount=await b.maxNumberOfEnvPerAccount,t.accounts=await b.accounts,t.totalStorage=await b.totalStorage,t.isManualComponentDisplayed=await b.isManualComponentDisplayed,t.isDefectComponentDisplayed=await b.isDefectComponentDisplayed,t.isAutomationComponentDisplayed=await b.isAutomationComponentDisplayed,t.isUIComponentDisplayed=await b.isUIComponentDisplayed,t.isApiComponentDisplayed=await b.isApiComponentDisplayed,t.isMobileComponentDisplayed=await b.isMobileComponentDisplayed,t.host=await b.host,t.support=await b.support,t.expiresOn=await b.expiresOn;var S=!1;try{var x=await u(await w+"/UserDetails/AccountAdmin.json");await x[await c].includes(await n)&&(S=!0)}catch(a){S=!1}t.isSuperAdmin=await S,t.isSuccess=!0}else t.responseCode=200,t.errorMessage="your session has expired."}else t.responseCode=401,t.errorMessage="You are not authorized to view this page"}catch(a){t.responseCode=400,t.errorMessage=await a.message,await o(await n+" "+await a.message)}return await t},isLicenseValid:l}},2305:a=>{"use strict";a.exports=require("form-data")},2410:a=>{"use strict";a.exports=require("glob")},2792:a=>{"use strict";a.exports=require("webdriverio")},3106:a=>{"use strict";a.exports=require("zlib")},3123:(a,t,e)=>{const i=e(9896),r=e(7252).Router();var s="./dataHub/",n="./dataHub/";const{saveFile:w,isDirectoryExist:o,createDirectory:c,deleteFile:u,renameFile:l,isSpaceFreeOnAccount:d,readJSONFile:p,saveFileAsEncyptedContent:m}=e(7229),{authCheck:v}=e(2258),{getAllCustomFunction:g}=e(6777),{post:h}=e(382),f=e(4716),y=e(2410),{NUMBER:b}=e(5504),S=e(6928);async function x(a,t,e,r,n,w,o=[]){try{var c=await s+await a+"/"+await r+"/"+await n+"/"+await w+"/"+await t+".json",u=await JSON.parse(await i.readFileSync(await c,"utf8")),l=await u.allsteps;for(let t=0;t<await l.length;t++){var d=await l[t],p=await d.action;if(await e.includes(await p)&&!await o.includes(await p)){o.push(await p);var m=await p;await x(await a,await m,await e,await r,await n,await w,o)}}}catch(a){}return o}async function M(a,t,e,r,s){var w={element:[],testdata:[]},o=[],c=[];try{for(let w=0;w<await t.length;w++){var u=await t[w],l=await n+await a+"/"+e+"/"+await r+"/CustomPageFunction/"+await s+"/"+await u+".json",d=await JSON.parse(await i.readFileSync(await l,"utf8"));if("Page"===await s){var p=await d.dependentpage;if(await p.length>0){var m=await p[0].parameter;if(""!==await m&&"{}"!==await m)try{var v=await JSON.parse(await m),g=await Object.keys(await v);if(await g.length>0)for(let a=0;a<await g.length;a++){var h=await g[a],f=await v[await h];await f.toLocaleLowerCase().toString().startsWith("c.")&&(await f.includes("+")&&(f=await f.toString().split("+")[0]),f=await f.substring(2),f=await f.toUpperCase(),await c.includes(await f)||c.push(await f))}}catch(a){}}}var y=await d.allsteps;for(let a=0;a<await y.length;a++){var b=await y[a].element;if(""!==await b&&(await o.includes(await b)||o.push(await b)),m=await y[a].value,""!==await m&&"{}"!==await m)try{if(v=await JSON.parse(await m),g=await Object.keys(await v),await g.length>0)for(let a=0;a<await g.length;a++)h=await g[a],f=await v[await h],await f.toLocaleLowerCase().toString().startsWith("c.")&&(await f.includes("+")&&(f=await f.toString().split("+")[0]),f=await f.substring(2),f=await f.toUpperCase(),await c.includes(await f)||c.push(await f))}catch(a){}}}}catch(a){}return w.element=await o,w.testdata=await c,await w}async function N(a,t,e,r,s){var o={isSuccess:!0,errorMessage:""};if(await s.length>0)try{var c=await n+await a+"/"+await t+"/"+await r+"/OR.json",u=await JSON.parse(await i.readFileSync(await c,"utf8"));try{var l=await n+await a+"/"+await e+"/"+await r+"/OR.json",d=await JSON.parse(await i.readFileSync(await l,"utf8"))}catch(a){d={}}var p=0;for(let a=0;a<await s.length;a++){var m=s[a];if(void 0===await d[await m]){p=Number(await p)+1,d[await m]={};var v=await u[await m];void 0!==await v?d[await m]=await v:("Web"===await r&&(d[await m].locator="xpath",d[await m].locatorproperty="//tbd",d[await m].alternatexpath=""),"Mobile"===await r&&(d[await m].locator="xpath",d[await m].locatorproperty="//tbd",d[await m].ioslocator="xpath",d[await m].ioslocatorproperty="//tbd",d[await m].alternatexpath="",d[await m].alternatexpathios=""))}}await p>0&&await w(await a+"/"+await e+"/"+await r+"/OR.json",await d)}catch(a){o.isSuccess=!1,o.errorMessage=await a.toString()}return await o}async function T(a,t,e,i,r){var s={isSuccess:!0,errorMessage:""};if(await r.length>0)try{try{var n=await a+"/"+await t+"/"+await i+"/CommonTestData.json",w=await p(await n);void 0===await w.CommonTestData&&(w.CommonTestData={})}catch(a){(w={}).CommonTestData={}}try{var o=await a+"/"+await e+"/"+await i+"/CommonTestData.json",c=await p(await o);void 0===await c.CommonTestData&&(c.CommonTestData={});var u=await c.TestDataExistingEnvironment;void 0===await u&&(u=[])}catch(a){(c={}).CommonTestData={},u=[]}var l=0;for(let a=0;a<await r.length;a++){var d=r[a];if(void 0===await c.CommonTestData[await d]){l=Number(await l)+1,c.CommonTestData[await d]={};for(let a=0;a<await u.length;a++){var v=await u[a];try{var g=w.CommonTestData[await d][await v];void 0===await g&&(g="")}catch(a){g=""}c.CommonTestData[await d][await v]=await g}}}await l>0&&await m(await a+"/"+await e+"/"+await i+"/CommonTestData.json",await c)}catch(a){s.isSuccess=!1,s.errorMessage=await a.toString()}return await s}async function E(a,t,e,r,n,w=[]){try{var o=await s+await a+"/"+await e+"/"+await r+"/"+await n+"/"+await t+".json",c=await JSON.parse(await i.readFileSync(await o,"utf8")),u=await c.dependentpage;for(let t=0;t<await u.length;t++){var l=await u[t],d=await l.customfunction;if(void 0!==await d&&!await w.includes(await d)){w.push(await d);var p=await d;await E(await a,await p,await e,await r,await n,w)}}}catch(a){}return w}async function A(a,t,e,r,n,w,u){var l={isSuccess:!1,errorMessage:""},d=await a+"/"+await t+"/"+await e+"/CustomPageFunction/"+await r+"/",p=await o(await d+await w+".json");if(!await p)return l.errorMessage="Function "+await w+" does not exist on the "+await t+" account.",l;var m=await a+"/"+await n+"/"+await e+"/CustomPageFunction/"+await r+"/";if(p=await o(await m+await u+".json"),await p)return l.errorMessage="Function "+await u+" already exist on the  "+await n+" account.",l;await c(await m),await i.copyFileSync(await s+await d+await w+".json",await s+await m+await u+".json");var v=[],h=await g(await a,await t,await e),f=await x(await a,await w,await h,await t,await e,"CustomPageFunction/Function",await v);if(await f.length>0)for(let a=0;a<await f.length;a++){var y=await f[a];p=await o(await m+await y+".json"),await p||await i.copyFileSync(await s+await d+await y+".json",await s+await m+await y+".json")}v.push(await w);var b=await M(await a,await v,await t,await e,"Function"),S=await b.element,E=await b.testdata;return await S.length>0&&(await c(await a+"/"+await n+"/"+await e+"/"),l=await N(await a,await t,await n,await e,await S),!await l.isSuccess)||await E.length>0&&(await c(await n+"/"+await e+"/"),l=await T(await a,await t,await n,await e,await E),!await l.isSuccess)||(l.isSuccess=!0,l.errorMessage="The function and its dependent sub-functions with elements have been moved from account "+await t+" to account "+await n),l}async function P(a,t,e,r,n,w,o=[]){try{var c=await s+await a+"/"+await r+"/"+await n+"/"+await w+"/"+await t+".json",u=await JSON.parse(await i.readFileSync(await c,"utf8")),l=await u.allsteps;for(let t=0;t<await l.length;t++){var d=await l[t],p=await d.action;if(void 0!==await p&&!await o.includes(await p)&&await e.includes(await p)){o.push(await p);var m=await p;await P(await a,await m,await e,await r,await n,await w,o)}}}catch(a){}return o}async function C(a,t,e,r,n,w,u){var l={isSuccess:!1,errorMessage:""},d=await a+"/"+await t+"/"+await e+"/CustomPageFunction/"+await r+"/",p=await o(await d+await w+".json");if(!await p)return l.errorMessage="Page "+await w+" does not exist on the "+await t+" account.",l;var m=await a+"/"+await n+"/"+await e+"/CustomPageFunction/"+await r+"/";if(p=await o(await m+await u+".json"),await p)return l.errorMessage="Page "+await u+" already exist on the  "+await n+" account.",l;await c(await m),await i.copyFileSync(await s+await d+await w+".json",await s+await m+await u+".json");var v=await E(await a,await w,await t,await e,"CustomPageFunction/Page",await([]));if(await v.length>0){for(let a=0;a<await v.length;a++){var h=await v[a];p=await o(await m+await h+".json"),await p||await i.copyFileSync(await s+await d+await h+".json",await s+await m+await h+".json")}v.push(await w)}var f=await M(await a,await v,await t,await e,"Page"),y=await f.element,b=await f.testdata;if(await y.length>0&&(await c(await a+"/"+await n+"/"+await e+"/"),l=await N(await a,await t,await n,await e,await y),!await l.isSuccess))return res.json(l);if(await b.length>0&&(await c(await n+"/"+await e+"/"),l=await T(await a,await t,await n,await e,await b),!await l.isSuccess))return res.json(l);var S=await g(await t,await e),x=[];for(let i=0;i<await v.length;i++)h=await v[i],await P(await a,await h,await S,await t,await e,"CustomPageFunction/Page",await x);for(let i=0;i<await x.length;i++){var C=await x[i];await A(await a,await t,await e,"Function",await n,await C,await C)}return l.isSuccess=!0,l.errorMessage="The Page and its dependent sub-page and function with elements have been moved from account "+await t+" to account "+await n,l}r.get("/project/:projectName/testingtype/:testingtype/custom/:customType",async(a,t)=>{var e={},r=await v(await a);if(!await r.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=r.errorMessage,t.status=await r.responseCode,t.json(await e);var n=[];try{var w=await a.headers.accountlabel,o=a.params.projectName,c=a.params.testingtype;switch(await c){case"Web":case"Mobile":break;default:return t.json(n)}var u=a.params.customType.toString().trim(),l=await i.readdirSync(s+await w+"/"+o+"/"+await c+"/CustomPageFunction/"+u);for(let a=0;a<l.length;a++){var d=l[a];d.toLocaleLowerCase().includes(".json")&&(d=d.replace(".json",""),n.push(d))}}catch(a){}t.json(n)}),r.get("/project/:projectName/testingtype/:testingtype/custom/:customType/name/:name",async(a,t)=>{var e={},r=await v(await a);if(!await r.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=r.errorMessage,t.status=await r.responseCode,t.json(await e);var s=a.params.projectName,w=a.params.customType,o=a.params.name,c=await a.headers.accountlabel,u={},l=a.params.testingtype;switch(await l){case"Web":case"Mobile":break;default:return t.json(u)}try{var d=await n+await c+"/"+s+"/"+await l+"/CustomPageFunction/"+w+"/"+o+".json";u=await JSON.parse(await i.readFileSync(await d,"utf8"))}catch(a){}t.json(u)}),r.delete("/project/:projectName/testingtype/:testingtype/custom/:customType/name/:name",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileDeleted:!1,errorMessage:""};try{var s=await a.headers.accountlabel,n=a.params.projectName,w=a.params.customType,o=a.params.name,c=a.params.testingtype;switch(await c){case"Web":case"Mobile":break;default:return r.errorMessage="Invalid testing Type",t.json(r)}await u(await s+"/"+n+"/"+await c+"/CustomPageFunction/"+w+"/"+o+".json"),r.isFileDeleted=!0}catch(a){r.errorMessage=a.toString()}t.json(r)}),r.post("/project/:projectName/testingtype/:testingtype/custom/:customType",async(a,t)=>{var e={},r=await v(await a);if(!await r.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=r.errorMessage,t.status=await r.responseCode,t.json(await e);var n=await r.totalStorage,u={isFileSaved:!1,errorMessage:""};try{var l=await a.headers.accountlabel,p=a.params.projectName,m=a.params.customType.toString().trim(),g=a.params.testingtype,h=await d(await l,await p,await n);if(!await h.isSuccess)return u.errorMessage=await h.errorMessage,t.json(u);switch(await g){case"Web":case"Mobile":break;default:return u.errorMessage="Invalid testing Type",t.json(u)}await o(await l+"/"+p+"/"+await g+"/CustomPageFunction/"+m)||await c(await l+"/"+p+"/"+await g+"/CustomPageFunction/"+m);var y={},b=await a.headers.useremail;try{var S=await f().format(),x=await s+await l+"/"+p+"/"+await g+"/CustomPageFunction/"+m+"/"+await a.body.fileName+".json";y=await JSON.parse(await i.readFileSync(await x,"utf8")),void 0!==await y.createdBy&&(a.body.fileData.createdBy=await y.createdBy),a.body.fileData.lastUpdatedBy=await b+" on "+await S}catch(t){a.body.fileData.createdBy=await b+" on "+await S}var M=await a.body.fileName;M=await M.toString().trim(),await w(await l+"/"+p+"/"+await g+"/CustomPageFunction/"+m+"/"+await M+".json",await a.body.fileData),u.isFileSaved=!0}catch(a){u.errorMessage=a.toString()}t.json(u)}),r.post("/project/:projectName/testingtype/:testingtype/custom/:customType/rename",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileSaved:!1,errorMessage:""};try{var s=await a.headers.accountlabel,n=a.params.projectName,w=a.params.customType,c=a.body.oldName.toString().trim(),u=a.body.newName.toString().trim(),d=a.params.testingtype;switch(await d){case"Web":case"Mobile":break;default:return r.errorMessage="Invalid testing Type",t.json(r)}var p=await o(await s+"/"+n+"/"+await d+"/CustomPageFunction/"+w+"/"+u+".json");await p?(r.isFileSaved=!1,r.errorMessage="New Name is already exist on server."):(await l(await s+"/"+n+"/"+await d+"/CustomPageFunction/"+w+"/"+c+".json",n+"/"+await d+"/CustomPageFunction/"+w+"/"+u+".json"),r.isFileSaved=!0)}catch(a){r.errorMessage=a.toString()}t.json(r)}),r.get("/project/:projectName/testingtype/:testingtype/customfunctionlistwithargs",async(a,t)=>{var e={},r=await v(await a);if(!await r.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=r.errorMessage,t.status=await r.responseCode,t.json(await e);var w={};try{var o=a.params.projectName,c=a.params.testingtype,u=await a.headers.accountlabel;switch(await c){case"Web":case"Mobile":break;default:return t.json(w)}var l=await i.readdirSync(s+await u+"/"+o+"/"+await c+"/CustomPageFunction/Function");for(let a=0;a<l.length;a++){var d=l[a];if(d.toLocaleLowerCase().includes(".json")){d=d.replace(".json",""),w[await d]=[];var p=await n+await u+"/"+o+"/"+await c+"/CustomPageFunction/Function/"+d+".json",m=await JSON.parse(await i.readFileSync(await p,"utf8"));w[await d]=await m.argumentlist}}}catch(a){}t.json(w)}),r.post("/project/:projectName/testingtype/:testingtype/createpagefunctionfromtestscript",async(a,t)=>{var e={},r=await v(await a);if(!await r.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=r.errorMessage,t.status=await r.responseCode,t.json(await e);var s=await r.totalStorage,o=a.params.projectName;o=await o.toString().trim();var c=await a.headers.accountlabel,u={},l=await d(await c,await o,await s);if(!await l.isSuccess)return u.errorMessage=await l.errorMessage,t.json(u);var p=a.body.pagename,m=a.params.testingtype;switch(m=await m.toString().trim(),await m){case"Web":case"Mobile":break;default:return t.json(u)}try{var g=await p[0].customfunction,y=await n+await c+"/"+o+"/"+await m+"/CustomPageFunction/Page/"+g+".json";u=await JSON.parse(await i.readFileSync(await y,"utf8"))}catch(t){try{var b="Validate "+await g,S={argumentlist:"",allsteps:[],dependentpage:[]},x={id:1,stepdefinition:await b,action:"",element:"",value:"",isreporting:"Y"},M={Authorization:await a.headers.authorization,userEmail:await a.headers.useremail,userselectedaccount:await o},N=await a.get("Host");const t=await a.protocol;var T={};T.step=await b,T.elementtag=await a.body.elementtag;var E=await h(t+"://"+await N+"/aistep/step",await M,await T),A=await E.data;x.action=await A.actionName,x.element=await A.orLogicalName,x.value=await A.actionvalue;var P=await x.element.toString().toUpperCase();if(void 0!==await P&&""!==await P&&null!==await P){var C=await n+await o+"/"+await m+"/OR.json",k=await JSON.parse(await i.readFileSync(await C,"utf8"));void 0===await k[await P]&&(k[await P]={},k[await P].locator="Xpath",k[await P].locatorproperty=await A.primaryLocatorProperty,k[await P].alternatexpath=await A.secondaryXPath,await w(await c+"/"+await o+"/"+await m+"/OR.json",await k),console.log("OR file gets saved with new element "+await P))}S.allsteps.push(await x);var j=await f().format();S.createdBy=await userEmail+" on "+await j,await w(await c+"/"+await o+"/"+await m+"/CustomPageFunction/Page/"+g+".json",await S)}catch(a){}}t.json(u)}),r.post("/exportcustomfunction",async(a,t)=>{var e={isSuccess:!1,errorMessage:""},i=await v(await a);if(!await i.isSuccess)return e.errorMessage=i.errorMessage,t.json(await e);try{var r=await a.headers.accountlabel,s=await a.headers.useremail.toString().toLocaleLowerCase().trim(),n=await a.body.testingType,w=await a.body.reusableType,o=await a.body.originalName,c=await a.body.newName,u=await a.body.originAccount,l=await a.body.accountTomove;switch(await n){case"Web":case"Mobile":case"Api":break;default:return e.errorMessage="Invalid Testing type provided",t.json(await e)}switch(await w){case"Page":case"Function":case"TestScript":break;default:return e.errorMessage="Invalid reusable Type provided",t.json(await e)}var d=await p(await r+"/UserDetails/UserDetails.json"),m=await d[await s].accounts;if(!await m.includes(await u)||!await m.includes(await l))return e.errorMessage="Please connect with QaBunch or your admin team for exporting the feature.",t.json(e);switch(await w){case"Page":e=await C(await r,await u,await n,await w,await l,await o,await c);break;case"Function":e=await A(await r,await u,await n,await w,await l,await o,await c)}}catch(a){return e.errorMessage=await a.toString(),t.json(e)}t.json(e)}),r.post("/testingtype/:testingtype/getdependencydetails",async(a,t)=>{var e={isSuccess:!1,errorMessage:"",deptableInfoData:[]},r=await v(await a);if(!await r.isSuccess)return e.errorMessage=r.errorMessage,t.status=await r.responseCode,t.json(await e);try{var n=a.params.testingtype,w=await a.headers.accountlabel;switch(await n){case"Web":case"Mobile":break;default:return e.errorMessage="Invalid Testing type provided.",t.json(e)}var o=await a.headers.account;if(void 0===await o||""===await o)return e.errorMessage="Project can not be blank.",t.json(e);var c=await a.body.type;if(void 0===await c||""===await c)return e.errorMessage="Reusable Type can not be blank.",t.json(e);var u=await a.body.function;if(void 0===await u||""===await u)return e.errorMessage="functionname Type can not be blank.",t.json(e);var l=[],d=0;const r=await s+await w+"/"+await o+"/"+await n+"/TestScripts/**/*.json";var p=await y.sync(await r);for(let a=0;a<await p.length;a++){var m=await JSON.parse(await i.readFileSync(await p[a],"utf8")),g=await JSON.stringify(await m);if(await g.includes(await u)){var h=await S.basename(p[a]),f=await h.split("@")[1].replace(".json",""),b=await g.split(await u),x=await b.length-1;d=Number(await d)+1;var M={};M={id:await d,name:await f,type:"Test Script",count:Number(await x)},l.push(await M)}}var N=await s+await w+"/"+await o+"/"+await n+"/CustomPageFunction/Function/*.json";p=await y.sync(await N);for(let a=0;a<await p.length;a++)h=await S.basename(p[a]),f=await h.replace(".json",""),await f!==await u&&(m=await JSON.parse(await i.readFileSync(await p[a],"utf8")),g=await JSON.stringify(await m),await g.includes(await u)&&(b=await g.split(await u),x=await b.length-1,d=Number(await d)+1,M={},M={id:await d,name:await f,type:"Application Function",count:Number(await x)},l.push(await M)));N=await s+await w+"/"+await o+"/"+await n+"/CustomPageFunction/Page/*.json",p=await y.sync(await N);for(let a=0;a<await p.length;a++)h=await S.basename(p[a]),f=await h.replace(".json",""),await f!==await u&&(m=await JSON.parse(await i.readFileSync(await p[a],"utf8")),g=await JSON.stringify(await m),await g.includes(await u)&&(b=await g.split(await u),x=await b.length-1,d=Number(await d)+1,M={},M={id:await d,name:await f,type:"Page Function",count:Number(await x)},l.push(await M)));e.deptableInfoData=await l,e.isSuccess=!0}catch(a){e.errorMessage=await a.toString()}t.json(e)}),a.exports=r},3150:(a,t,e)=>{const i=e(7252).Router(),{authCheck:r}=e(2258),s=e(8330);e(9896);const n=e(829),{addLogMessageInConsole:w,readJSONFile:o}=e(7229);i.post("/isusersessionvalid",async(a,t)=>{var e={isUserAuthenticated:!1};e.apiVersion=await s.version,e.firstName="",e.lastName="",e.errorMessage="";try{var i=await a.headers.useremail;if(void 0===await i)return e.errorMessage="UserEmail is missing in request header section.",await w("User email "+await i+" is missing in request header section."),t.json(await e);if(i=await i.toString().toLocaleLowerCase().trim(),""===await i)return e.errorMessage="UserEmail can not be blank.",await w("User email "+await i+" is missing in request header section."),t.json(await e);if(void 0===await a.headers.authorization)return e.errorMessage="Autherization token is missing in request header",await w("Autherization key is missing in request header for user email "+await"User email "+await i),t.json(await e);try{token=await a.headers.authorization.split(" ")[1]}catch(a){return e.errorMessage="Autherization token is not provided in correct format.",await w("Autherization key is not provided  in correct format for user email "+await i),t.json(await e)}if(void 0===await token)return e.errorMessage="Autherization token is not provided in correct format.",await w("Autherization key is not provided  in correct format for user email "+await i),t.json(await e);var r=await a.headers.accountlabel,c=await o(await r+"/UserDetails/UserDetails.json"),u=await c[i],l=await u.secretKey;const s=await n.verify(await token,l);await s.email.toLowerCase()===await i.toLowerCase()?(e.isUserAuthenticated=!0,e.firstName=await u.firstName,e.lastName=await u.lastName):(e.errorMessage="Your session has expired. Please log in again to continue",await w("user email "+await i+" session has expired. Please log in again to continue."))}catch(a){return e.errorMessage=await a.toString(),await w(await a.toString()),t.json(await e)}t.json(await e)}),a.exports=i},3184:a=>{"use strict";a.exports=require("stream-json/streamers/StreamObject")},3268:a=>{"use strict";a.exports=require("body-parser")},3351:a=>{"use strict";a.exports=require("du")},3404:a=>{"use strict";a.exports=require("stream-chain")},3498:a=>{"use strict";a.exports=require("mysql2/promise")},3506:(a,t,e)=>{const i=e(7252),r=e(9896),{readdir:s}=e(9896).promises,n=i.Router(),{saveFile:w,isDirectoryExist:o,createDirectory:c,deleteFile:u,isSpaceFreeOnAccount:l,readJSONFile:d}=e(7229);var p="./dataHub/";const{authCheck:m}=e(2258),{getPastDate:v,getMostRecentFile:g}=e(7229),h=e(2410),f=e(4716),{get:y}=e(382),{getSprintDefectDetails:b,getallIssueDetails:S}=e(7455);async function x(a){return await Object.keys(await a).length>0?await a.value:""}async function M(a){if(0===await a.length)return"";var t=[];for(let e=0;e<await a.length;e++)t.push(await a[e].value);return await t.toString()}async function N(a){var t={isSuccess:!1,host:"",username:"",password:"",project:"",customissuetype:""};for(let e=0;e<await a.length;e++)if("Jira"===await a[e].tool){t.host=await a[e].url,t.username=await a[e].username,t.password=await a[e].password,t.project=await a[e].project,t.customissuetype=await a[e].customissuetype,t.isSuccess=!0;break}return await t}n.post("/project/:projectName/createnewdefect",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage,n={isFileSaved:!1,errorMessage:"",defectId:""};try{var u=await a.params.projectName,d=await a.headers.accountlabel,v=await l(await d,await u,await s);if(!await v.isSuccess)return n.errorMessage=await v.errorMessage,t.json(n);var g=await a.body,h=await g.placeHolder.trim(),y=await g.testCycle,b=await g.createdBy;h=await h+"/"+await y;var S=await o(await d+"/"+await u+"/Manual/DefectDetails/"+await h);await S||await c(await d+"/"+await u+"/Manual/DefectDetails/"+await h);var x={};try{var M=await p+await d+"/"+await u+"/Manual/NewDefectId.json";x=await JSON.parse(await r.readFileSync(await M,"utf8"))}catch(a){x={}}g.History=[{id:1,history:"New defect Created.",by:await b,timestamp:await f().format()}],g.Comments=[];var N="DF-"+Number(await Object.keys(await x).length+1);await w(await d+"/"+await u+"/Manual/DefectDetails/"+await h+"/"+await N+".json",await g),n.isFileSaved=!0,n.defectId=await N,x[await N]=await b,await w(await d+"/"+await u+"/Manual/NewDefectId.json",await x)}catch(a){n.errorMessage=a.toString()}t.json(n)}),n.post("/project/:projectName/getalldefects",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var s=await a.params.projectName,n=[],w=await a.headers.accountlabel,o=await a.body.componentPath.trim(),c=await a.body.isjirasdefect;if(await c){var u=await w+"/"+await s+"/Manual/Configuration.json";try{var l=await d(await u),p=await l.ListOfTestCycle;if(void 0!==await p&&0!==p.length){await p.length>10&&(p=await p.slice(0,10));var v=await N(await l.Tools);if(await v.isSuccess){isJiraDefectTools=!0;var g={};g.host=await v.host,g.username=await v.username,g.password=await v.password,g.project=await v.project;var f=["Bug"],y=await v.customissuetype;if(void 0!==await y&&""!==await y){y=await y.toString().trim();var S=await y.split(",");for(let a=0;a<await S.length;a++)f.push(await S[a].toString().trim())}g.customissuetype=await f,g.sprint=await p;var T=await b(await g);n=await T.alldefectidwithtitle}}}catch(a){}}else{var E=await w+"/"+await s+"/Manual/DefectDetails/",A="",P=await o.split("/");for(let a=1;a<await P.length;a++)A=await A+"/"+await P[a];await A.includes("/")&&(A=await A.substring(1));var C=1;E=await E+"**/"+await A;const a=await"./dataHub/"+await E;var k=await h.sync(await a+"/**/*.json");for(let a=0;a<await k.length;a++){var j=await k[a].split("\\"),D=await j[await j.length-1],O=await JSON.parse(await r.readFileSync(await k[a],"utf8")),I=await O.customfields;void 0===await I&&(I=[]);var L=await x(await O.assignedTo),F=await M(await O.testId),U={id:await C,defectid:await D.replace(".json",""),title:await O.defectName,component:await O.placeHolder,priority:await O.priority,severity:await O.severity,status:await O.status,assignto:await L,cycle:await O.testCycle,testid:await F,createdby:await O.createdBy};for(let a=0;a<await I.length;a++){var V=await I[a].key,B=await I[a].value;U[await V]=await B}n.push(await U),C=Number(await C)+1}}}catch(a){console.log(await a)}t.json(await n)}),n.post("/project/:projectName/getdefectiddetails",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={};try{var n=await a.headers.accountlabel,w=await a.params.projectName,o=(s=await a.body,await s.testPath.trim()),c=await n+"/"+await w+"/Manual/DefectDetails/"+await o+".json";try{var u=await p+await c;s=await JSON.parse(await r.readFileSync(await u,"utf8"))}catch(a){s={}}}catch(a){s={}}t.json(s)}),n.post("/project/:projectName/adddefectcomment",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage,n=await a.headers.accountlabel,o={isFileSaved:!1,errorMessage:""};try{var c=await a.params.projectName,u=await l(await n,await c,await s);if(!await u.isSuccess)return o.errorMessage=await u.errorMessage,t.json(o);var d=await a.body,v=await d.testPath.trim(),g=await d.testComment,h=await a.headers.useremail,y=await n+"/"+await c+"/Manual/DefectDetails/"+v+".json",b={};try{var S=await p+await y;b=await JSON.parse(await r.readFileSync(await S,"utf8"));var x=await b.Comments;void 0===await x&&(x=[]);var M={id:Number(await x.length)+1,comment:await g,by:await h,timestamp:await f().format()};x.push(await M),b.Comments=await x,await w(await y,await b),o.isFileSaved=!0}catch(a){o.errorMessage=a.toString()}}catch(a){o.errorMessage=a.toString()}t.json(o)}),n.post("/project/:projectName/updatedefect",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage,n={isFileSaved:!1,errorMessage:""},o={};try{var u=await a.headers.accountlabel,d=await a.params.projectName,v=await l(await u,await d,await s);if(!await v.isSuccess)return n.errorMessage=await v.errorMessage,t.json(n);o=await a.body;var g=await a.headers.useremail,y=await o.testPath.trim(),b=await u+"/"+await d+"/Manual/DefectDetails/"+await y+".json",S=await h.sync(await p+await b);if(0==await S.length){const a=await y.lastIndexOf("/"),t=await y.substring(0,a),e=await y.substring(a+1);if(S=await h.sync(await p+await u+"/"+await d+"/Manual/DefectDetails/**/**/"+await e+".json"),0==await S.length)return n.errorMessage="Defect does not exist on Server,Please refresh the page and try again.",await n;await c(await u+"/"+await d+"/Manual/DefectDetails/"+await t),await r.renameSync(await S[0],await p+await b),S[0]=await p+await b}try{var x=await S[0];testInfo=await JSON.parse(await r.readFileSync(await x,"utf8"));var M=await o.history,N="";await o.defectName!==await testInfo.defectName&&(N="Title ("+await await testInfo.defectName+"->"+await await o.defectName+")."),await o.priority!==await testInfo.priority&&(N=N+"Priority ("+await await testInfo.priority+"->"+await await o.priority+")."),await o.severity!==await testInfo.severity&&(N=N+"Severity ("+await await testInfo.severity+"->"+await await o.severity+")."),await o.status!==await testInfo.status&&(N=N+"Status ("+await await testInfo.status+"->"+await await o.status+")."),await o.testCycle!==await testInfo.testCycle&&(N=N+"Test Cycle ("+await await testInfo.testCycle+"->"+await await o.testCycle+").");var T="",E="";try{JSON.stringify(await o.assignedTo)!==JSON.stringify(await testInfo.assignedTo)&&(E=await o.assignedTo.label,T=await testInfo.assignedTo.label,void 0===await E&&(E=""),void 0===await T&&(T=""),N=N+"Assigned To ("+await T+"->"+await E+").")}catch(a){}try{if(JSON.stringify(await o.testId)!==JSON.stringify(await testInfo.testId)){var A=[],P=[];if(E=await o.testId,T=await testInfo.testId,void 0===await E||0===await E.length)P="";else{for(let a=0;a<await E.length;a++)P.push(await E[a].label);P=await JSON.stringify(await P)}if(void 0===await T||0===await T.length)A="";else{for(let a=0;a<await T.length;a++)A.push(await T[a].label);A=await JSON.stringify(await A)}N=N+"Test Id ("+await A+"->"+await P+")."}}catch(a){}try{if(JSON.stringify(await o.environment)!==JSON.stringify(await testInfo.environment)){if(A=[],P=[],E=await o.environment,T=await testInfo.environment,void 0===await E||0===await E.length)P="";else{for(let a=0;a<await E.length;a++)P.push(await E[a].label);P=await JSON.stringify(await P)}if(void 0===await T||0===await T.length)A="";else{for(let a=0;a<await T.length;a++)A.push(await T[a].label);A=await JSON.stringify(await A)}N=N+"Environment ("+await A+"->"+await P+")."}}catch(a){}await M.includes("Attachment")&&(N+="Attachment."),await M.includes("Steps to reproduce")&&(N+="Steps to reproduce");try{if(await JSON.stringify(await o.customfields)!==await JSON.stringify(await testInfo.customfields))for(let a=0;a<await o.customfields.length;a++){var C=!1,k=await o.customfields[a].key,j=await o.customfields[a].value;for(let a=0;a<await testInfo.customfields.length;a++){var D=await testInfo.customfields[a].key;if(await D===await k){C=!0,T=await testInfo.customfields[a].value,await j!==await T&&(N=N+k+" ("+await T+"->"+await j+").");break}}await C||(N=N+k+" (Not exist->"+await j+").")}}catch(a){}var O="";""!==await N&&(O="Defect "+await N+" fields updated."),testInfo.defectName=await o.defectName,testInfo.priority=await o.priority,testInfo.severity=await o.severity,testInfo.status=await o.status,testInfo.assignedTo=await o.assignedTo,testInfo.testId=await o.testId,testInfo.defectSteps=await o.defectSteps,testInfo.testCycle=await o.testCycle;var I=await o.environment;void 0===await I&&(I=[]),testInfo.environment=await I;var L=await o.attachment;void 0===await L&&(L=[]),testInfo.attachment=await L;var F=await o.customfields;void 0===await F&&(F=[]),testInfo.customfields=await F;var U=await testInfo.History;if(void 0===await U&&(U=[]),""!=await O){var V={id:Number(await U.length)+1,history:await O,by:await g,timestamp:await f().format()};U.push(await V)}testInfo.History=await U,await w(await b,await testInfo),n.isFileSaved=!0}catch(a){n.errorMessage=a.toString()}}catch(a){n.errorMessage=a.toString()}t.json(n)}),n.post("/project/:projectName/deletedefect",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={isFileDeleted:!1,errorMessage:""};try{var n=await a.headers.accountlabel,o=await a.params.projectName,c=await a.body,l=await c.testPath.trim(),d=await c.defectId.trim(),v=await a.headers.useremail,g=await n+"/"+await o+"/Manual/DefectDetails/"+await l+".json";try{var h=await g;await u(await h),s.isFileDeleted=!0;var f={};try{h=await p+await n+"/"+await o+"/Manual/DeletedDefectId.json",f=await JSON.parse(await r.readFileSync(await h,"utf8"))}catch(a){f={}}h=await n+"/"+await o+"/Manual/DeletedDefectId.json",f[await d]=await v,await w(await h,await f)}catch(a){s.errorMessage=a.toString()}}catch(a){s.errorMessage=a.toString()}t.json(s)}),n.get("/project/:projectName/defectid/:defectid",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={};try{var n=await a.params.projectName,w=await a.headers.accountlabel,o=(s=await a.body,await a.params.defectid),c=await p+await w+"/"+await n+"/Manual/DefectDetails/**/**/**/"+await o+".json",u=await h.sync(await c);if(0==await u.length)return t.json(s);try{s=await JSON.parse(await r.readFileSync(await u[0],"utf8"))}catch(a){s={}}}catch(a){s={}}t.json(s)}),n.post("/project/:projectName/getjiraissuedetails",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);let r={isSuccess:!1,errorMessage:"",defectprioritydata:{},defectStatusData:{}};try{var s=await a.headers.accountlabel,n=await a.params.projectName,w=await a.body.allissues,o=await s+"/"+await n+"/Manual/Configuration.json";try{var c=await d(await o),u=await N(await c.Tools);if(await u.isSuccess){isJiraDefectTools=!0;var l={};l.host=await u.host,l.username=await u.username,l.password=await u.password,l.project=await u.project;var p=["Bug"],v=await u.customissuetype;if(void 0!==await v&&""!==await v){v=await v.toString().trim();var g=await v.split(",");for(let a=0;a<await g.length;a++)p.push(await g[a].toString().trim())}l.customissuetype=await p,l.allissues=await w,r=await S(await l)}}catch(a){}}catch(a){}t.json(r)}),a.exports=n},3618:a=>{"use strict";a.exports=require("compromise")},3644:(a,t,e)=>{const i=e(7252),r=e(9896),{readdir:s}=e(9896).promises,n=i.Router(),{saveFile:w,isDirectoryExist:o,createDirectory:c,deleteFile:u,deleteOlderFile:l,deleteAllFileFromFolder:d,readJSONFile:p}=e(7229);var m="./dataHub/";const{authCheck:v}=e(2258),{getPastDate:g,getMostRecentFile:h,isSpaceFreeOnAccount:f}=e(7229),y=e(2410),{get:b}=(e(4716),e(382)),{NUMBER:S}=e(5504);async function x(a,t,e,i){var s=[],n={};try{if(await e.length>0&&await i.length>0)for(let s=0;s<await i.length;s++){var w=await i[s].status,o=await i[s].component,c=await i[s].testid,u=await m+await a+"/"+await t+"/Manual/TestCaseDetails/"+await o+"/**/"+await c+".json";u=await M(u);var l=await y.sync(await u);if(await l.length>0){var d=await JSON.parse(await r.readFileSync(await l[0],"utf8")),p=await d.testCaseCustomFields;void 0===await p&&(p=[])}else console.log("Test case is deleted from the server for component "+await o+" and Testid "+await c+", but still present in Test plan."),d={testCaseCustomFields:[]},p=[];for(let a=0;a<await e.length;a++){var v=await e[a],g="Not Provided";void 0===await n[await v]&&(n[await v]={},n[await v].labels=[]);for(let a=0;a<await p.length;a++){var h=await p[a].key;if(await h===await v){g=await p[a].value,await g,i[s][await v]=await g;break}}switch(await n[await v].labels.includes(await g)||await n[await v].labels.push(await g),void 0===await n[await v][await g]&&(n[await v][await g]={},n[await v][g].Pass=0,n[await v][g].Fail=0,n[await v][g].Pending=0,n[await v][g].NA=0,n[await v][g].Blocked=0),await w){case"Pass":n[await v][g].Pass=await Number(n[await v][g].Pass)+1;break;case"Fail":n[await v][g].Fail=await Number(n[await v][g].Fail)+1;break;case"Pending":n[await v][g].Pending=await Number(n[await v][g].Pending)+1;break;case"NA":n[await v][g].NA=await Number(n[await v][g].NA)+1;break;case"Blocked":n[await v][g].Blocked=await Number(n[await v][g].Blocked)+1}}}}catch(a){}try{var f=await Object.keys(await n);if(await f.length>0)for(let a=0;a<await f.length;a++){var b={header:"",labels:[],yAxis:[]},S=await f[a],x=await n[await S].labels;b.header=await S,b.labels=await x;var N=[],T=[],E=[],A=[],P=[],C=[];for(let a=0;a<await x.length;a++){var k=await x[a],j=await n[await S][await k];T.push(await j.Pass),E.push(await j.Fail),A.push(await j.Pending),P.push(await j.NA),C.push(await j.Blocked)}N.push(await T),N.push(await E),N.push(await A),N.push(await P),N.push(await C),b.yAxis=await N,s.push(await b)}}catch(a){console.log(await a.toString())}return await s}async function M(a){try{return await a.toString().includes("[")||await a.toString().includes("]")?a.replace(/[\[\]]/g,"*"):await a}catch(t){return await a}}n.post("/project/:projectName",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={CustomFieldGraphData:[]};try{var n=await a.headers.accountlabel,w=await a.params.projectName,o=await a.body,c=await o.testCycle.trim(),u=await o.testPlanName.trim(),l=await n+"/"+await w+"/Manual/TestPlan/"+await c+"/"+await u+".json";try{var d=await m+await l;s=await JSON.parse(await r.readFileSync(await d,"utf8")),void 0===await s.CustomFieldGraphData&&(s.CustomFieldGraphData=[]);try{var g=await s.AllTestCases;if(void 0!==await g&&0!==g.length){l=await w+"/Manual/Configuration.json";var h=await p(await l);if(void 0!==await h){var f=await h.TestCaseCustomKeys;if(void 0!==await f&&await f.length>0){var y=[];for(let a=0;a<await f.length;a++){var b=await f[a].key;y.push(await b)}await y.length>0&&(s.CustomFieldGraphData=await x(await n,await w,await y,await g))}var S=await h.TestExecutionCustomKeys;if(void 0!==await S&&await S.length>0){for(let a=0;a<await g.length;a++){var M=await g[a];for(let t=0;t<await S.length;t++)b=await S[t].key,void 0===await M[await b]&&(g[a][await b]="")}s.AllTestCases=await g}}}}catch(a){}}catch(a){(s={}).CustomFieldGraphData=[]}}catch(a){s={}}t.json(s)}),n.post("/project/:projectName/gettestplanname",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=[];try{var s=await a.params.projectName,n=await a.body,w=await n.testCycle.trim(),o=await a.headers.accountlabel;if(""===await w.trim())return t.json(r);var c=await o+"/"+await s+"/Manual/TestPlan/"+await w;try{var u=await m+await c;u=await M(u);var l=await y.sync(await u+"/*.json");for(let a=0;a<await l.length;a++){var d=await l[a].split("\\"),p=await d[await d.length-1];r.push(await p.replace(".json",""))}}catch(a){r=[]}}catch(a){r=[]}t.json(r)}),n.get("/project/:projectName/getallplaceholder",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=[];try{var n=await a.params.projectName,w=await a.headers.accountlabel,o=await w+"/"+await n+"/Manual/PlaceHolderTree.json";try{var c=await m+await o,u=await JSON.parse(await r.readFileSync(await c,"utf8"));for(let a=0;a<await u.length;a++){var l=await u[a].key;s.push(await l)}}catch(a){s=[]}}catch(a){s=[]}t.json(await s)}),n.post("/project/:projectName/getalltestcase",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=[];try{var n=await a.params.projectName,w=await a.headers.accountlabel,o=await a.body.placeHolderName.trim(),c=await w+"/"+await n+"/Manual/TestCaseDetails/"+await o;"all"===await o.toLowerCase()&&(c=await w+"/"+await n+"/Manual/TestCaseDetails");try{var u=await m+await c;u=await M(u);var l=await y.sync(await u+"/**/*.json");for(let a=0;a<await l.length;a++){var d=await l[a],p=await d.split("\\"),g=await p[await p.length-1].replace(".json",""),h=await JSON.parse(await r.readFileSync(await d,"utf8")),f={id:Number(a)+1,component:await h.placeHolder,testid:await g,testname:await h.testCaseName,assignto:"",status:"Pending"};s.push(await f)}}catch(a){s=[]}}catch(a){s=[]}t.json(await s)}),n.post("/project/:projectName/deletetestplan",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileDeleted:!1,errorMessage:""};try{var s=await a.params.projectName,n=await a.body.testcycle,w=await a.body.testplan,o=await a.headers.accountlabel,c=await m+await o+"/"+await s+"/Manual/TestPlan/"+await n+"/"+await w+".json";c=await M(c);var l=await y.sync(await c);if(0===await l.length)return fileSaved.errorMessage=await w+" does not exist on server.",await t.json(fileSaved);await u(await o+"/"+await s+"/Manual/TestPlan/"+await n+"/"+await w+".json"),await d(await o+"/"+await s+"/Manual/Attachments/TestPlan/"+await n+"/"+await w),r.isFileDeleted=!0}catch(a){r.errorMessage=await a.message}t.json(await r)}),n.post("/project/:projectName/savetestplan",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage,n={isFileSaved:!1,errorMessage:""};try{var u=await a.params.projectName,l=await a.headers.accountlabel,d=await f(await l,await u,await s);if(!await d.isSuccess)return n.errorMessage=await d.errorMessage,t.json(n);var p=await a.body,g=await p.testCycle,h=await p.testPlanName,b=await p.testSuite,S=await p.customFields,x=await o(await l+"/"+await u+"/Manual/TestPlan/"+await g);await x||await c(await l+"/"+await u+"/Manual/TestPlan/"+await g);var N=await m+await l+"/"+await u+"/Manual/TestPlan/"+await g+"/"+await h+".json";N=await M(N);var T=await y.sync(await N);if(await T.length>0)return n.errorMessage=await h+" is already exist on server",await t.json(n);var E={};E.testSuiteName=await b,E.customFields=await S,E.TestCaseExecutionDetails={};try{var A=await m+await l+"/"+await u+"/Manual/TestSuite/"+await b+".json",P=await JSON.parse(await r.readFileSync(await A,"utf8")),C=await P.AllTestCases;if(void 0!==await C&&await C.length>0)for(let a=0;a<await C.length;a++){var k=await C[a].component,j=await C[a].testid;E.TestCaseExecutionDetails[await j]={},E.TestCaseExecutionDetails[await j].testPrecondition="",E.TestCaseExecutionDetails[await j].testcaseData="",E.TestCaseExecutionDetails[await j].testExecutionStatusOnStepLavel=[],E.TestCaseExecutionDetails[await j].attachments=[],E.TestCaseExecutionDetails[await j].comments=[];var D=await m+await l+"/"+await u+"/Manual/TestCaseDetails/"+await k+"/**/"+await j+".json";D=await M(D);var O=await y.sync(await D);if(await O.length>0){var I=await JSON.parse(await r.readFileSync(await O[0],"utf8"));E.TestCaseExecutionDetails[await j].testPrecondition=await I.testPrecondition,E.TestCaseExecutionDetails[await j].testcaseData=await I.testcaseData;var L=await I.expectedStepStyle;if("At the each step"===await L){var F=await I.testStepWithExpectedResult;for(let a=0;a<await F.length;a++)F[a].status="Pending";E.TestCaseExecutionDetails[await j].testExecutionStatusOnStepLavel=await F}else{var U=await I.testSteps,V=U.split("\n"),B=[];for(let a=0;a<await U.length;a++){var R=await V[a];try{var J;if(R=await R.replace(/^\d+\.\s/,""),""!==await R)J={id:await Number(a)+1,step:await R,expectedresult:"",stepdata:"",status:"Pending"},B.push(await J)}catch(a){}}var X=await I.testExpectedResult;if(""!==await X)if(await B.length>0)B[await B.length-1].expectedresult=await X;else{var W={id:1,step:"Step Not Availiable",expectedresult:await X,stepdata:"",status:"Pending"};B.push(await W)}E.TestCaseExecutionDetails[await j].testExecutionStatusOnStepLavel=await B}}}if(await C.length>0){for(let a=0;a<await C.length;a++)C[a].linkeddefect="",C[a].status="Pending",C[a].assignto="",C[a].executedBy="";E.AllTestCases=await C}}catch(a){}await w(await l+"/"+await u+"/Manual/TestPlan/"+await g+"/"+await h+".json",await E),n.isFileSaved=!0}catch(a){n.errorMessage=a.toString()}t.json(n)}),n.post("/project/:projectName/updatetestplan",async(a,t)=>{var e={CustomFieldGraphData:[]},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage,n={isFileSaved:!1,errorMessage:"",CustomFieldGraphData:[]};try{var o=await a.params.projectName,c=await a.headers.accountlabel,u=await f(await c,await o,await s);if(!await u.isSuccess)return n.errorMessage=await u.errorMessage,t.json(n);var l=await a.body,d=await l.testCycle,g=await l.testPlanName,h=await m+await c+"/"+await o+"/Manual/TestPlan/"+await d+"/"+await g+".json";h=await M(h);var b=await y.sync(await h);if(0===await b.length)return n.errorMessage=await g+" does not exist on server",await t.json(n);var S=await JSON.parse(await r.readFileSync(await b[0],"utf8")),N=await l.AllTestCases,T=await Object.keys(N);if(await T.length>0){var E=await S.AllTestCases;for(let a=0;a<await T.length;a++){var A=await T[a];for(let a=0;a<await E.length;a++){var P=await E[a].testid;if(await P===await A){var C=await Object.keys(await N[await A]);for(let t=0;t<await C.length;t++){var k=await C[t],j=await N[await A][await k];E[a][await k]=await j}break}}}S.AllTestCases=await E}var D=await l.testStepResultData;if(T=await Object.keys(await D),await T.length>0){E=await S.TestCaseExecutionDetails;for(let a=0;a<await T.length;a++){A=await T[a];var O=await Object.keys(await D[await A]);for(let a=0;a<await O.length;a++){var I=await O[a],L=await D[await A][await I];E[await A].testExecutionStatusOnStepLavel[Number(await I)-1].status=await L}}S.TestCaseExecutionDetails=await E}var F=await l.comments;if(T=await Object.keys(await F),await T.length>0){E=await S.TestCaseExecutionDetails;for(let a=0;a<await T.length;a++){A=await T[a];var U=await Object.keys(await F[await A]);for(let a=0;a<await U.length;a++){I=await U[a];var V=await F[await A][await I];E[await A].comments[Number(await I)-1]=await V}}S.TestCaseExecutionDetails=await E}if(F=await l.attachments,T=await Object.keys(await F),await T.length>0){E=await S.TestCaseExecutionDetails;for(let a=0;a<await T.length;a++){A=await T[a],U=await Object.keys(await F[await A]);for(let a=0;a<await U.length;a++)I=await U[a],V=await F[await A][await I],E[await A].attachments[Number(await I)-1]=await V}S.TestCaseExecutionDetails=await E}var B=await l.updateattachmentstestidtable,R=await Object.keys(await B);if(await R.length>0){E=await S.TestCaseExecutionDetails;for(let a=0;a<await R.length;a++){A=await R[a];var J=await B[await A];E[await A].attachments=await J}S.TestCaseExecutionDetails=await E}await w(await c+"/"+await o+"/Manual/TestPlan/"+await d+"/"+await g+".json",await S),void 0===await S.CustomFieldGraphData&&(S.CustomFieldGraphData=[]);try{var X=await S.AllTestCases;if(void 0!==await X&&0!==X.length){var W=await o+"/Manual/Configuration.json",Y=await p(await W);if(void 0!==await Y){var G=await Y.TestCaseCustomKeys;if(void 0!==await G&&await G.length>0){var Q=[];for(let a=0;a<await G.length;a++)k=await G[a].key,Q.push(await k);await Q.length>0&&(n.CustomFieldGraphData=await x(await o,await Q,await X))}}}}catch(a){}n.isFileSaved=!0}catch(a){n.errorMessage=a.toString()}t.json(n)}),n.post("/project/:projectName/updatetestplanattribute",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage,n={isSuccess:!1,errorMessage:""};try{var o=await a.params.projectName,c=await a.headers.accountlabel,u=await f(await c,await o,await s);if(!await u.isSuccess)return n.errorMessage=await u.errorMessage,t.json(n);var l=await a.body.testcycle,d=await a.body.testplan,p=await a.body.customFields,g=await m+await c+"/"+await o+"/Manual/TestPlan/"+await l+"/"+await d+".json";g=await M(g);var h=await y.sync(await g);if(0===await h.length)return fileSaved.errorMessage=await d+" does not exist on server.",await t.json(fileSaved);if(void 0===await p||0===await p.length)return fileSaved.errorMessage="Test plan custom fields are not in correct format.",await t.json(fileSaved);var b=await JSON.parse(await r.readFileSync(await h[0],"utf8"));b.customFields=await p,await w(await c+"/"+await o+"/Manual/TestPlan/"+await l+"/"+await d+".json",await b),n.isSuccess=!0}catch(a){n.errorMessage=await a.message}t.json(await n)}),n.post("/project/:projectName/clonetestplan",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage,n={isSuccess:!1,errorMessage:""};try{var o=await a.params.projectName,u=await a.headers.accountlabel,l=await f(await u,await o,await s);if(!await l.isSuccess)return n.errorMessage=await l.errorMessage,t.json(n);var d=await a.body.testcycle,p=await a.body.testplan,g=await a.body.newtestcycle,h=await m+await u+"/"+await o+"/Manual/TestPlan/"+await d+"/"+await p+".json";h=await M(h);var b=await y.sync(await h);if(0===await b.length)return n.errorMessage=await p+" does not exist on server.",await t.json(fileSaved);await m,await u,await o,await g;var S=await JSON.parse(await r.readFileSync(await b[0],"utf8")),x=await S.AllTestCases;for(let a=0;a<await x.length;a++)x[a].linkeddefect="",x[a].status="Pending",x[a].assignto="",x[a].executedBy="";S.AllTestCases=await x;var N=await S.TestCaseExecutionDetails,T=await Object.keys(await N);for(let a=0;a<await T.length;a++){var E=await T[a];N[await E].attachments=[],N[await E].comments=[];var A=await N[await E].testExecutionStatusOnStepLavel;for(let a=0;a<await A.length;a++)N[await E].testExecutionStatusOnStepLavel[a].status="Pending"}S.TestCaseExecutionDetails=await N,await c(await u+"/"+await o+"/Manual/TestPlan/"+await g),await w(await u+"/"+await o+"/Manual/TestPlan/"+await g+"/"+await p+".json",await S),n.isSuccess=!0}catch(a){n.errorMessage=await a.message}t.json(await n)}),n.post("/project/:projectName/addnewtestcaseintestplan",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={isSuccess:!1,errorMessage:""};try{var n=await a.params.projectName,o=await a.body.testcycle,c=await a.body.testplan,u=await a.body.newtestcase,l=await a.headers.accountlabel;if(void 0===await n||""===await n)return s.errorMessage="Project name can not be null.",t.json(await s);if(void 0===await o||""===await o)return s.errorMessage="Test Cycle can not be null.",t.json(await s);if(void 0===await c||""===await c)return s.errorMessage="Test Plan name can not be null.",t.json(await s);if(void 0===await u||""===await u)return s.errorMessage="New Test Case info can not be null.",t.json(await s);if(0==await u.length)return s.errorMessage="New Test Case info found.",t.json(await s);var d=await m+await l+"/"+await n+"/Manual/TestPlan/"+await o+"/"+await c+".json";d=await M(d);var p=await y.sync(await d);if(0===await p.length)return s.errorMessage=await c+" does not exist on server.",await t.json(fileSaved);var g=await JSON.parse(await r.readFileSync(await p[0],"utf8")),h=await g.AllTestCases,f=await h.length;const e=new Set(await h.map(a=>`${a.component}|${a.testid}`));var b=await u.filter(a=>!e.has(`${a.component}|${a.testid}`));if(0==await b.length)return s.errorMessage="Selected Test cases are already linked with Test plan.",await t.json(fileSaved);var S=await g.TestCaseExecutionDetails;for(let a=0;a<await b.length;a++){var x=await b[a];f=Number(await f)+1,x.id=await f;var N=x.component,T=x.testid,E=await m+await l+"/"+await n+"/Manual/TestCaseDetails/"+await N+"/**/"+await T+".json";E=await M(E);var A=await y.sync(await E);if(await A.length>0){h.push(await x),S[await T]={},S[await T].attachments=[],S[await T].comments=[];var P=await JSON.parse(await r.readFileSync(await A[0],"utf8"));S[await T].testPrecondition=await P.testPrecondition,S[await T].testcaseData=await P.testcaseData;var C=await P.expectedStepStyle;if("At the each step"===await C){var k=await P.testStepWithExpectedResult;for(let a=0;a<await k.length;a++)k[a].status="Pending";S[await T].testExecutionStatusOnStepLavel=await k}else{var j=await P.testSteps,D=j.split("\n"),O=[];for(let a=0;a<await j.length;a++){var I=await D[a];try{var L;if(I=await I.replace(/^\d+\.\s/,""),""!==await I)L={id:await Number(a)+1,step:await I,expectedresult:"",stepdata:"",status:"Pending"},O.push(await L)}catch(a){}}var F=await P.testExpectedResult;""!==await F&&await O.length>0&&(O[await O.length-1].expectedresult=await F),S[await T].testExecutionStatusOnStepLavel=await O}}else console.log("Test ID "+await T+" under component "+await N+" does not exist on the server.")}g.TestCaseExecutionDetails=await S,g.AllTestCases=await h,await w(await l+"/"+await n+"/Manual/TestPlan/"+await o+"/"+await c+".json",await g),s.isSuccess=!0}catch(a){s.errorMessage=await a.message}t.json(await s)}),n.post("/project/:projectName/removetestcasesfromtestplan",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={isSuccess:!1,errorMessage:""};try{var n=await a.params.projectName,o=await a.body.testcycle,c=await a.body.testplan,l=await a.headers.accountlabel,d=await a.body.deletedtestcases;if(void 0===await n||""===await n)return s.errorMessage="Project Name can not be blank.",await t.json(s);if(void 0===await o||""===await o)return s.errorMessage="Test Cycle can not be blank.",await t.json(s);if(void 0===await c||""===await c)return s.errorMessage="Test Plan name can not be blank.",await t.json(s);if(void 0===await d||""===await d)return s.errorMessage="Test Cases can not be blank.",await t.json(s);if(0===await d.length)return s.errorMessage="Test Cases can not be blank.",await t.json(s);var p=await m+await l+"/"+await n+"/Manual/TestPlan/"+await o+"/"+await c+".json";p=await M(p);var g=await y.sync(await p);if(0===await g.length)return s.errorMessage=await c+" does not exist on server.",await t.json(fileSaved);var h=await JSON.parse(await r.readFileSync(await g[0],"utf8")),f=await h.AllTestCases,b=await h.TestCaseExecutionDetails,S=[];for(let a=0;a<await d.length;a++){var x=await d[a].testid;if(void 0!==await f)for(let a=0;a<await f.length;a++){var N=await f[a].testid;if(await N===await x){S.push(await x),f.splice(await a,1);break}}else S.push(await x)}for(let a=0;a<await S.length;a++){var T=await S[a];try{var E=await b[await T].attachments;if(await E.length>0)for(let a=0;a<await E.length;a++){var A=await E[a].file;A=await T+"_"+await A,await u(await l+"/"+await n+"/Manual/Attachments/TestPlan/"+await o+"/"+await c+"/"+await A)}}catch(a){}delete b[await T]}if(void 0!==await f){for(let a=0;a<await f.length;a++)f[a].id=await Number(a)+1;h.AllTestCases=await f}h.TestCaseExecutionDetails=await b,await w(await l+"/"+await n+"/Manual/TestPlan/"+await o+"/"+await c+".json",await h),s.isSuccess=!0}catch(a){s.errorMessage=await a.message}t.json(await s)}),a.exports=n},3768:a=>{"use strict";a.exports=require("appium-adb")},3851:a=>{"use strict";a.exports=require("selenium-webdriver/lib/logging")},4023:a=>{"use strict";a.exports=require("@fast-csv/format")},4033:(a,t,e)=>{const i=e(7252).Router(),r=e(2410),{authCheck:s}=e(2258);var n=e(9896);i.post("/project/:projectName",async(a,t)=>{var e={globalMessage:"",accountMessage:""};try{var i=a.params.projectName;if(void 0===await i)return t.json(await e);if(""===await i.toString().trim())return t.json(await e);var s=await a.headers.accountlabel,w=await"./dataHub/"+"AccountDetails/ProductUpdates/ProductUpdates.json",o=await r.sync(await w);if(await o.length>0){var c=await JSON.parse(await n.readFileSync(await o[0],"utf8")),u=await c.GlobalUpdateMessage;if(void 0!==await u&&(e.globalMessage=await u.toString().trim()),void 0!==await c[await s]){var l=await c[await s].accountMessage;void 0!==await l&&(e.accountMessage=await l.toString().trim())}}}catch(a){}t.json(e)}),a.exports=i},4355:(a,t,e)=>{const i=e(7252).Router(),{saveFile:r,isDirectoryExist:s,createDirectory:n,deleteFile:w,renameFile:o,getFileCount:c,isSpaceFreeOnAccount:u,addLogMessageInConsole:l}=e(7229);var d="./dataHub/";const p="./dataHub/",{authCheck:m}=e(2258);var v=e(9896);const g=e(2410),h=e(4716),f=e(6928);e(6212),i.get("/component/:componentName/testid/:testdetails/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);await a.header("Cache-Control","private, no-cache, no-store, must-revalidate"),await t.header("Cache-Control","private, no-cache, no-store, must-revalidate");var r=a.params.projectName,s=a.params.testingtype,n=a.params.componentName,w=a.params.testdetails,o=await a.headers.accountlabel,c={};try{c=await v.readFileSync(p+await o+"/"+r+"/"+s+"/TestScripts/"+n+"/"+w+".json","utf8"),c=await JSON.parse(await c)}catch(a){}t.json(c)}),i.post("/project/:projectName/testingtype/:testingtype/gettestdetails",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);await a.header("Cache-Control","private, no-cache, no-store, must-revalidate"),await t.header("Cache-Control","private, no-cache, no-store, must-revalidate");var r=await a.headers.accountlabel,s=a.params.projectName,n=a.params.testingtype,w=a.body.component,o=a.body.testfile,c={};try{c=await v.readFileSync(await p+await r+"/"+await s+"/"+await n+"/TestScripts/"+await w+"/"+await o+".json","utf8"),c=await JSON.parse(await c)}catch(a){}t.json(c)}),i.post("/component/:componentName/testid/:testdetails/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var w=await i.totalStorage,o=await a.headers.accountlabel,c={isFileSaved:!1,errorMessage:""};try{var l=a.params.projectName,d=await a.headers.useremail,f=await h().format(),y=await u(await o,await l,await w);if(!await y.isSuccess)return c.errorMessage=await y.errorMessage,t.json(c);var b=a.params.testingtype,S=a.params.componentName;S=await S.toString().trim();var x=a.params.testdetails;await s(await o+"/"+l+"/"+b+"/TestScripts/"+S)||await n(await o+"/"+l+"/"+b+"/TestScripts/"+S);const e=await p+await o+"/"+await l+"/"+b+"/TestScripts/"+await S;var M=await x.split("@")[0],N=await g.sync(await e+"/**/"+M+"@*.json"),T=!0;if(await N.length>0){T=!1;var E=N[0].split("\\");if(existingFileName=await E[await E.length-1].replace(".json",""),existingFileName.toLowerCase()!==await x.toLocaleLowerCase())return c.errorMessage="Test Id "+M+" is already exist on server.",t.json(c);var A=await v.readFileSync(await N[0],"utf8");A=await JSON.parse(await A);var P=await A.createdBy;void 0===await P&&(a.body.createdBy=await d+" on "+await f)}await T?a.body.createdBy=await d+" on "+await f:a.body.lastUpdatedBy=await d+" on "+await f,await r(await o+"/"+l+"/"+b+"/TestScripts/"+await S+"/"+await x+".json",a.body),c.isFileSaved=!0}catch(a){c.errorMessage=a.toString()}t.json(c)}),i.delete("/component/:componentName/testid/:testdetails/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileDeleted:!1,errorMessage:""};try{var s=await a.headers.accountlabel,n=a.params.projectName.trim(),w=a.params.testingtype.trim(),o=a.params.componentName.trim(),c=a.params.testdetails.trim();const t=await p+await s+"/"+await n+"/"+await w+"/TestScripts/"+await o;var u=await g.sync(await t+"/**/"+await c+".json");if(await u.length>0){await v.unlinkSync(await u[0]),r.isFileDeleted=!0;try{var l=await c;const a=await l.indexOf("@"),t=await l.substring(0,await a),e=await l.substring(await a+1),i=await p+await s+"/"+await n+"/"+await w+"/TestSuite/*.json";var d=await g.sync(await i);if(await d.length>0)for(let a=0;a<await d.length;a++){var h=await d[a],f=await JSON.parse(await v.readFileSync(await h,"utf8"));if(await JSON.stringify(await f).includes(await e)){var y=await f.testsuite;for(let i=0;i<await y.length;i++){var b=await y[i].component,S=await y[i].testid,x=await y[i].testname;if(await o===await b&&await S===await t&&await x===await e){await y.splice(i,1);for(let t=0;t<await y.length;t++)y[a].id=await Number(t)+1;f.testsuite=await y;var M=await JSON.stringify(await f);await v.writeFileSync(await h,await M);break}}}}}catch(a){}}else r.errorMessage="File does not exist on the server.",r.isFileDeleted=!0}catch(a){r.errorMessage=a.toString()}t.json(r)}),i.post("/component/:componentName/testid/:testdetails/project/:projectName/testingtype/:testingtype/updateid",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileSaved:!1,errorMessage:""};try{var s=await a.headers.accountlabel,n=a.params.projectName.trim(),w=a.params.testingtype.trim(),o=a.params.componentName.trim(),c=a.params.testdetails.trim(),u=await c.split("@")[1].trim(),l=await a.body.newId.trim();const t=await p+await s+"/"+await n+"/"+await w+"/TestScripts/"+await o;var d=await g.sync(await t+"/**/"+await c+".json");if(0===await d.length)r.isFileSaved=!1,r.errorMessage="Test "+c+" does not exist on the server.";else{var h=await g.sync(await t+"/"+await l+"@"+await u+".json");if(await h.length>0)r.isFileSaved=!1,r.errorMessage="New Test id is already exist on the server.";else{await v.renameSync(await d[0],await t+"/"+await l+"@"+await u+".json"),r.isFileSaved=!0;try{var f=await c;const a=await f.indexOf("@"),t=await f.substring(0,await a),e=await f.substring(await a+1),i=await p+await s+"/"+await n+"/"+await w+"/TestSuite/*.json";var y=await g.sync(await i);if(await y.length>0)for(let a=0;a<await y.length;a++){var b=await y[a],S=await JSON.parse(await v.readFileSync(await b,"utf8"));if(await JSON.stringify(await S).includes(await e)){var x=await S.testsuite;for(let a=0;a<await x.length;a++){var M=await x[a].component,N=await x[a].testid,T=await x[a].testname;if(await o===await M&&await N===await t&&await T===await e){x[await a].testid=await l,S.testsuite=await x;var E=await JSON.stringify(await S);await v.writeFileSync(await b,await E);break}}}}}catch(a){}}}}catch(a){r.errorMessage=a.toString()}t.json(r)}),i.post("/component/:componentName/project/:projectName/testingtype/:testingtype/rename",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileSaved:!1,errorMessage:""};try{var s=await a.headers.accountlabel,n=a.params.projectName.trim(),w=a.params.testingtype.trim(),o=a.params.componentName.trim(),c=a.body.oldName.trim(),u=a.body.newName.trim();const t=await p+await s+"/"+await n+"/"+await w+"/TestScripts/"+await o;var l=await g.sync(await t+"/**/"+await c+".json"),d=await g.sync(await t+"/**/"+await u+".json");if(await d.length>0)r.errorMessage="Test case id with same is already present on server.";else if(0===await l.length)r.errorMessage="Test case id with name "+await c+" does not exist on the server.";else{await v.renameSync(await l[0],await t+"/"+await u+".json"),r.isFileSaved=!0;try{const a=await c.indexOf("@"),t=await c.substring(0,await a),e=await c.substring(await a+1),i=await u.substring(await a+1),r=await p+await s+"/"+await n+"/"+await w+"/TestSuite/*.json";var h=await g.sync(await r);if(await h.length>0)for(let a=0;a<await h.length;a++){var f=await h[a],y=await JSON.parse(await v.readFileSync(await f,"utf8"));if(await JSON.stringify(await y).includes(await e)){var b=await y.testsuite;for(let a=0;a<await b.length;a++){var S=await b[a].component,x=await b[a].testid,M=await b[a].testname;if(await o===await S&&await x===await t&&await M===await e){b[await a].testname=await i,y.testsuite=await b;var N=await JSON.stringify(await y);await v.writeFileSync(await f,await N);break}}}}}catch(a){}}}catch(a){r.errorMessage=a.toString()}t.json(r)}),i.post("/project/:projectName/getchildapidetails",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.headers.accountlabel,s=a.params.projectName.trim(),n=a.body.parentTestId,w=a.body.depApiDetails,o=[],c=[];try{for(;0!==await c.length||0!==await w.length;){var u={};u[await n]=await w,o.push(await u);for(let a=0;a<await w.length;a++)c.push(await w[a]);var l=await c[0].component,p=await c[0].testid;n=await p.split("@")[0];var g=await d+await r+"/"+await s+"/Api/TestScripts/"+await l+"/"+await p+".json",h=await JSON.parse(await v.readFileSync(await g,"utf8"));w=await h.DependendtApiScripts,c.splice(0,1)}}catch(a){}t.json(o)}),i.post("/project/:projectName/testingtype/:testingtype/newname",async(a,t)=>{var e={isFileSaved:!1,errorMessage:""},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.isFileSaved=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.headers.accountlabel,s=a.params.projectName,n=a.params.testingtype;switch(await n){case"Web":case"Api":case"Mobile":break;default:e.errorMessage="Wrong data provided.",t.json(e)}try{var w=await a.body.component,o=await a.body.testid,c=await a.body.newname,u=await d+await r+"/"+await s+"/"+await n+"/TestScripts/"+await w+"/"+await o+"@*.json",l=await g.sync(await u);if(0===await l.length)return e.errorMessage="Test Id does not exist on the server.",t.json(e);await v.renameSync(await l[0],await d+await r+"/"+await s+"/"+await n+"/TestScripts/"+await w+"/"+await o+"@"+await c+".json"),e.isFileSaved=!0;try{const a=await f.parse(await l[0]),t=await a.name,e=await t.indexOf("@"),i=await t.substring(await e+1),u=await p+await r+"/"+await s+"/"+await n+"/TestSuite/*.json";var h=await g.sync(await u);if(await h.length>0)for(let a=0;a<await h.length;a++){var y=await h[a],b=await JSON.parse(await v.readFileSync(await y,"utf8"));if(await JSON.stringify(await b).includes(await i)){var S=await b.testsuite;for(let a=0;a<await S.length;a++){var x=await S[a].component,M=await S[a].testid,N=await S[a].testname;if(await w===await x&&await M===await o&&await N===await i){S[await a].testname=await c,b.testsuite=await S;var T=await JSON.stringify(await b);await v.writeFileSync(await y,await T);break}}}}}catch(a){}}catch(a){e.errorMessage=await a}t.json(e)}),a.exports=i},4403:(a,t,e)=>{const i=e(7252);var r=e(9896);const s=i.Router(),{isDirectoryExist:n,createDirectory:w,readJSONFile:o,saveFile:c,isSpaceFreeOnAccount:u}=e(7229),{get:l}=e(382),{authCheck:d}=e(2258),{faker:p}=e(5941),m=e(4716);async function v(a,t){var e={reqBodyTemplate:{},reqBodyDataType:"object"},i={},r="object";try{var s=await t.requestBody;if(void 0===await s){var n=await t.parameters;if(void 0!==await n)for(let a=0;a<await n.length;a++)if("body"===await n[a].in){var w=await n[a].schema;if(r=await w.type,void 0!==await w){var o=await w.items;if(void 0!==await o){var c=await o.type;void 0===await r&&(r=await c),s=await o.$ref}else{s=await w.$ref;var u=await w.type;void 0===await r&&(r=await u)}}break}}if(void 0!==await s)if(void 0!==await s.content){var l=await s.content;if(void 0!==await l){var d=await Object.keys(await l);if(await d.length>0){var p=await d[0],m=await l[await p].schema;if(void 0===await m.$ref)i=await m;else{var v=await m.$ref.split("/")[1].toString();i=await g(await a[await v],await m.$ref)}try{u=await m.type,void 0===await r&&(r=await u)}catch(a){}}}}else v=await s.split("/")[1].toString(),i=await g(await a[await v],await s)}catch(a){}return void 0===await r&&void 0!==await i.type&&(r=await await i.type),e.reqBodyTemplate=await i,e.reqBodyDataType=await r,await e}async function g(a,t){let e=await a;try{const i=await t.split("/");await i.shift();for(const r of await i)if(r!==await i[0]){if(!e[r])throw new Error(`Reference not found: ${t}`);if(await e[await r].properties)for(const t of Object.keys(await e[await r].properties)){const i=await e[await r].properties[t];if(await i.$ref){const s=await g(await a,await i.$ref.substr(2));e[r].properties[t]=await s}if(await i.items&&await i.items.$ref){const s=await g(a,i.items.$ref.substr(2));e[r].properties[t].items=await s}}if(await e[await r].$ref){const t=await g(a,e[r].$ref.substr(2));e[r]=await t}e=e[r]}}catch(a){console.log(await a),e={}}return e}async function h(a,t,e,i,r,s,n,w,o,c,u,l,d,p,m,v){var g={totalScripts:0,tbdScripts:0},h=0,T=0;s=await async function(a){var t="";switch(await a.toString().toLowerCase()){case"get":default:t="Get";break;case"post":t="Post";break;case"put":t="Put";break;case"delete":t="Delete";break;case"patch":t="Patch";break;case"head":t="Head";break;case"options":t="Options"}return await t}(await s);var E=await b(await d,await n,!0,await w),A=await async function(a,t){var e={},i=[],r=await x(await a);return"array"===await t?i.push(await r):(i={},i=await r),e[1]=await i,await e}(await c,await p),P="TC-"+Number(Number(await Number(await l)+await Number(h))),C=await async function(a,t){try{if(void 0!==await t){if(!await a.includes("{"))return await a;for(let n=0;n<await t.length;n++){var e=await t[await n].in;if("path"===await e){var i=await t[await n].name,r=await t[await n].type;void 0===r&&(r=await t[await n].schema.type);var s=await S(await r);a=await a.replace("{"+i+"}",await s)}}}}catch(a){}return await a}(await r,await n);if(""===await m)var k="TBD-To Test Success Response for method "+await s+" and endpoint "+await r;else k="TBD--To Test Success Response for "+await m;var j=await P+"@"+await k,D=await async function(a){return await a.includes(201)?201:(await a.includes(200),200)}(await o),O=await y(await a,await t,await e,await j,await i,await C,await s,await E,await A,await D,await v);if(await O&&(h=Number(h)+1,T=await Number(T)+1),void 0!==await w&&await Object.keys(await w).length>0){var I=await b(await d,await n,!1,{}),L="TC-"+Number(Number(await Number(await l)+await Number(h)));if(""===await m)var F=await L+"@To test authenticity for method "+await s+" and enpoint "+await r;else F=await L+"@To test authenticity for "+await m;O=await y(await a,await t,await e,await F,await i,await C,await s,await I,await A,401,await v),await O&&(h=Number(h)+1)}if(await r.includes("{")&&await async function(a){return!!await a.includes(404)}(await o)){if(L="TC-"+Number(Number(await Number(await l)+await Number(h))),""===await m)var U=await L+"@To test 404 response when path parameter has invalid datatype for method "+await s+" and enpoint "+await r;else U=await L+"@To test 404 response for "+await m;var V=await async function(a,t){try{if(void 0!==await t){if(!await a.includes("{"))return await a;for(let n=0;n<await t.length;n++){var e=await t[await n].in;if("path"===await e){var i=await t[await n].name,r=await t[await n].type;void 0===await r&&(r=await t[await n].schema.type);var s=await M(await r);a=await a.replace("{"+i+"}",await s)}}}}catch(a){}return await a}(await r,await n);O=await y(await a,await t,await e,await U,await i,await V,await s,await E,await A,404,await v),await O&&(h=Number(h)+1)}var B=await N(await s);if(await B){L="TC-"+Number(Number(await Number(await l)+await Number(h)));var R;U=""===await m?await L+"@To test Bad Response 400 response when request body has invalid format for method "+await s+" and enpoint "+await r:await L+"@To test bad response 400 response for "+await m+" when request body has invalid formart.",R="object"===await p?[]:{},O=await y(await a,await t,await e,await U,await i,await C,await s,await E,await R,400,await v),await O&&(h=Number(h)+1)}if(B=await N(await s),await B&&void 0!==await A&&(A=await A[1],void 0!==await A)){var J=0;if("object"===await p?J=await Object.keys(await A).length:(J=await A.length,A=await A[0]),await J>0)try{var X=await c.properties,W=await Object.keys(await X);if(await W.length>0)for(let n=0;n<await W.length;n++){var Y=await f(await A),G=await W[n],Q=await X[await G].type,q=await M(await Q);Y[await G]=await q;var Z={};"object"===await p?(Z[1]={},Z[1]=await Y):(Z[1]=[],Z[1].push(await await Y)),L="TC-"+Number(Number(await Number(await l)+await Number(h))),U=""===await m?await L+"@To test Bad Response 400 response when request body key "+await G+" is inavlid for method "+await s+" and enpoint "+await r:await L+"@To test bad response 400 response for "+await m+" when requesy body key "+await G+" is invalid.",O=await y(await a,await t,await e,await U,await i,await C,await s,await E,await Z,400,await v),await O&&(h=Number(h)+1)}}catch(a){}}return g.totalScripts=await h,g.tbdScripts=await T,await g}async function f(a){var t={},e=await Object.keys(await a);for(let r=0;r<await e.length;r++){var i=await e[r];t[await i]=await a[await i]}return await t}async function y(a,t,e,i,r,s,n,w,o,u,l){try{var d=!0,p={};p.ComponentUrl=await r,p.RelativeUrl=await s,p.HttpMethod=await n,p.AutherizationCredentialsKey="",p.RequestHeader=await w,p.RequestBody=await o,p.RequestVariable=[],p.Assertion=[{id:1,expression:"ResponseCode",function:"ShouldBe",expected:await u,actual:0}],p.DependendtApiScripts=[],i=await i.replace(new RegExp("{","g"),""),i=await i.replace(new RegExp("}","g"),""),i=await i.replace(new RegExp("/","g"),"-");var v=await m().format();p.createdBy=await l+" on "+await v,await c(await a+"/"+await t+"/Api/TestScripts/"+await e+"/"+await i+".json",await p)}catch(a){d=!1}return await d}async function b(a,t,e=!1,i={}){var r=[],s=[];try{for(let t=0;t<await a.length;t++){var n;n=await a[t],r.push(await n)}var w=await r.length;for(let a=0;a<await r.length;a++){var o=await r[a].key.toString().toLowerCase();s.push(await o)}if(await e){var c=await Object.keys(await i);if(await c.length>0)for(let a=0;a<await c.length;a++){var u=await c[a].toString();if(!await s.includes(await u.toLocaleLowerCase())){w=Number(await w)+1;var l={id:await w,key:await u,value:await"TBD"};r.push(await l),s.push(await u.toLocaleLowerCase())}}}if(await t.length>0)for(let a=0;a<await t.length;a++){var d=await t[a].in;if("header"===await d.toString().toLocaleLowerCase()){var p=await t[a].name;await s.includes(await p.toLocaleLowerCase())||(w=Number(await w)+1,l={id:await w,key:await p,value:"TBD"},r.push(await l),s.push(await u.toLocaleLowerCase()))}}}catch(a){}return await r}async function S(a){switch(await a.toString().toLowerCase()){case"integer":return p.number.int({min:1,max:100});case"string":return p.string.alpha(5);case"object":return{};case"array":return[];case"boolean":return!0}}async function x(a){try{var t={};await async function a(t,e){for(const i in t.properties){const r=t.properties[i];if(r.$ref){const a=await resolveReference(r.$ref);e[i]=await x(a)}else if("object"===r.type)e[i]={},await a(r,e[i]);else if("array"===r.type){if(e[i]=[],r.items)if("object"===r.items.type){const t={};await a(r.items,t),e[i].push(t)}else e[i].push(await S(r.items.type))}else e[i]=await S(r.type)}}(a,t)}catch(a){console.error("Error:",a)}return t}async function M(a){switch(await a.toString().toLowerCase()){case"integer":return"IamNotInteger";case"string":return.5;case"object":return[{id:1,message:"i am message1"},{id:2,message:"i am message2"}];case"array":return{id:1,message:"I am value of message"};default:return null}}async function N(a){switch(await a.toString().toLowerCase()){case"post":case"put":case"patch":return!0;default:return!1}}async function T(a,t,e,i,s){try{var n=await r.readdirSync("./dataHub/"+await a+"/"+await t+"/Api/TestScripts/"+e);for(let v=0;v<await n.length;v++){var w=await n[v],o=await"./dataHub/"+await a+"/"+await t+"/Api/TestScripts/"+await e+"/"+await w,c=await JSON.parse(await r.readFileSync(await o,"utf8")),u=await c.RelativeUrl;if(await c.HttpMethod.toLowerCase()===await i.toLowerCase())if(await s.includes("{")&&await s.includes("}")){if(await s.split("/").length===await u.split("/").length){var l=[],d=await s.split("{");for(let a=0;a<await d.length;a++){var p=await d[a];await p.includes("}")||l.push(await p)}var m=!0;for(let a=0;a<await l.length;a++)p=await l[a],await u.toLowerCase().includes(await p.toLowerCase())||(m=!1);if(await m)return!0}}else if(await u.toLowerCase()===await s.toLowerCase())return!0}}catch(a){}return!1}s.post("/project/:projectName",async(a,t)=>{var e={},i=await d(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,s=await a.params.projectName,c=await a.headers.accountlabel,p={isSuccess:!0,errorMessage:"",totalEndPoint:0,totalController:0,existingEndPoint:0,totalScriptCreated:0,scriptCountInCompleteStatus:0},m=await u(await c,await s,await r);if(!await m.isSuccess)return p.errorMessage=await m.errorMessage,t.json(p);var g=await a.headers.useremail,f=0,y=0,b=0,S=[];try{var x=await c+"/"+await s+"/Api/Configuration.json",M=await o(await x),N=[],E=await a.body.url,A=await a.body.componentKey,P=await l(await E,{}),C=await P.data,k=await C.paths;if(void 0===await k)return p.isSuccess=!1,p.errorMessage="URL does not return Swagger JSON format. Please make sure you are adding correct URL.",t.json(await p);var j=await async function(a){try{var t=await a.securityDefinitions;void 0===await t&&(t=await a.security),void 0===await t&&(t={});var e=await Object.keys(await t);if(await e.length>0)for(let a=0;a<await e.length;a++){var i=await e[a];"header"!==await t[await i].in&&delete t[await i]}}catch(a){return{}}return await t}(await C),D=await Object.keys(await k);p.totalEndPoint=await D.length;for(let a=0;a<await D.length;a++){var O=await D[await a],I=await Object.keys(await k[await O]);for(let a=0;a<await I.length;a++){var L=!1,F=await I[a],U=await await k[await O][await F];if(void 0!==await U.tags&&await await U.tags.length>0){var V=await U.tags[0];if(await N.includes(await V)||N.push(await V),await n(await c+"/"+await s+"/Api/TestScripts/"+await V)?L=await T(await c,await s,await V,await F,await O):await w(await c+"/"+await s+"/Api/TestScripts/"+await V),await L)await S.includes(await I+"-"+await O)||(S.push(await I+"-"+await O),b=await Number(b)+1);else{var B,R=await v(await C,await U);B=await R.reqBodyTemplate;var J=await R.reqBodyDataType,X=await U.parameters;void 0===await X&&(X=[]);try{var W=[],Y=Object.keys(await U.responses);for(let a=0;a<await Y.length;a++){var G=await Y[a];W.push(await G)}}catch(a){W=[]}var Q=await U.summary;void 0===await Q&&(Q=await U.description),void 0===await Q&&(Q="");var q=[];q=await M.HttpHeader,void 0!==await q&&0!=await q.length||(q=[{id:1,key:"accept",value:"application/json"},{id:2,key:"content-type",value:"application/json"}]);var Z=await h(await c,await s,await V,await A,await O,await F,await X,await j,await W,await B,await C,await f+1,await q,await J,await Q,await g);f=Number(await f)+Number(await Z.totalScripts),y=await Number(await Z.tbdScripts)+Number(await y)}}}}p.totalController=await N.length,p.totalScriptCreated=await f,p.existingEndPoint=await b,p.scriptCountInCompleteStatus=Number(await f)-Number(await y)}catch(a){p.isSuccess=!1,p.errorMessage=await a.message}t.json(p)}),a.exports=s},4458:(a,t,e)=>{const{ADB:i}=e(3768);a.exports={androidABD:async function(a){var t={isSuccess:!0,errorMessage:"",output:"",supportingEvidence:{}};try{const r=await i.createADB();var e=await r.adbExec(await a);t.output=await e}catch(a){t.isSuccess=!1,t.errorMessage=await a}return await t},androidShell:async function(a){var t={isSuccess:!0,errorMessage:"",output:"",supportingEvidence:{}};try{const r=await i.createADB();var e=await r.shell(await a);t.output=await e}catch(a){t.isSuccess=!1,t.errorMessage=await a}return await t}}},4475:a=>{"use strict";a.exports=require("selenium-webdriver/firefox")},4623:(a,t,e)=>{const i=e(7252).Router(),{saveFile:r,isDirectoryExist:s,createDirectory:n,isSpaceFreeOnAccount:w,readJSONFile:o}=e(7229);var c="./dataHub/";const{authCheck:u}=e(2258);var l=e(9896);const d=e(2410),p=e(6212);async function m(a){try{return await a.toString().includes("[")||await a.toString().includes("]")?a.replace(/[\[\]]/g,"*"):await a}catch(t){return await a}}i.get("/project/:projectName/getalltestsuite",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=[];try{var w=await a.headers.accountlabel,o=a.params.projectName;if(!await s(await w+"/"+o+"/Manual/TestSuite/"))return await n(await w+"/"+await o+"/Manual/TestSuite/"),t.json(await r);var l=await c+await w+"/"+await o+"/Manual/TestSuite/*.json";l=await m(l);var p=await d.sync(await l);for(let a=0;a<await p.length;a++){var v=await p[a].split("\\"),g=await v[await v.length-1].replace(".json","");r.push(await g)}await r.sort()}catch(a){}t.json(r)}),i.post("/project/:projectName/savetestsuite",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.headers.accountlabel,o=await i.totalStorage,p={isSuccess:!1,errorMessage:""};try{var v=a.params.projectName,g=await w(await r,await v,await o);if(!await g.isSuccess)return p.errorMessage=await g.errorMessage,t.json(p);await s(await r+"/"+await v+"/Manual/TestSuite/")||await n(await r+"/"+await v+"/Manual/TestSuite/");var h=await a.body.testsuitename,f=!/[\\/:*?"<>|]/.test(await h);await f||(p.errorMessage="Test suite name is incorrect.",t.json(p));var y=await c+await r+"/"+await v+"/Manual/TestSuite/"+await h+".json";y=await m(y);var b=await d.sync(await y);if(await b.length>0)return p.errorMessage="Test suite name is already exist.",t.json(p);const e={},i=JSON.stringify(await e,null,2);await l.writeFileSync(await y,await i),p.isSuccess=!0}catch(a){p.errorMessage=await a.message}t.json(p)}),i.get("/project/:projectName/testsuitename/:suitename",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=[];try{var s=await a.headers.accountlabel,n=await a.params.projectName,w=await a.params.suitename,p=await c+await s+"/"+await n+"/Manual/TestSuite/"+await w+".json",v=await JSON.parse(await l.readFileSync(await p,"utf8"));if(void 0===await v.AllTestCases)r=[];else{try{var g=await v.AllTestCases;if(await g.length>0){var h=await s+"/"+await n+"/Manual/Configuration.json",f=await o(await h);if(void 0!==await f){var y=await f.TestCaseCustomKeys;if(void 0!==await y&&await y.length>0){var b=[],S={},x={};for(let a=0;a<await y.length;a++){var M=await y[a].key,N=await y[a].value;if(!await b.includes(await M)){b.push(await M);var T=!1;try{var E=await JSON.parse(await N);await Array.isArray(await E)&&(T=!0,x[await M]=await E)}catch(a){}S[await M]=await T}}if(await b.length>0)for(let a=0;a<await g.length;a++){var A=await g[a].component,P=await g[a].testid,C=await c+await s+"/"+await n+"/Manual/TestCaseDetails/"+await A+"/**/"+await P+".json";C=await m(C);var k=await d.sync(await C);if(await k.length>0){var j=await k[0],D=await JSON.parse(await l.readFileSync(await j,"utf8"));for(let t=0;t<await b.length;t++){var O=b[t],I="",L=await D.testCaseCustomFields;if(void 0!==await L||await L.length>0)for(let a=0;a<await L.length;a++){var F=await L[a].key;if(await F===await O){I=await L[a].value,void 0===await I&&(I="");break}}g[a][await O]=await I}}else{console.log("Test case is deleted from the server for component "+await A+" and Testid "+await P+", but still present in Test suite "+await w);for(let t=0;t<await b.length;t++)O=b[t],g[a][await O]=""}}}}}}catch(a){}r=await g}}catch(a){r=[]}t.json(r)}),i.get("/project/:projectName/getcomponent",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=a.params.projectName,s=await a.headers.accountlabel,n=[];try{n=await l.readdirSync(c+await s+"/"+r+"/Manual/TestCaseDetails");var w=await n;for(let a=0;a<await w.length;a++){var o=await w[a];o=await m(o);var p=await d.sync(await c+await s+"/"+await r+"/Manual/TestCaseDetails/"+await o+"/**/*.json");0===await p.length&&(n=await n.filter(a=>a!==o))}}catch(a){}t.json(n)}),i.post("/project/:projectName/fetchtestcasesfromcomponent",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=[];try{var s=a.params.projectName,n=await a.body.components,w=await a.headers.accountlabel;if(void 0===await n)return t.json(r);0===await n.length&&t.json(r);var p=!1,v=[];for(let a=0;a<await n.length;a++){var g=await n[a].value;if(await v.includes(await g)||v.push(await g),"select all"===await g.toString().toLowerCase()){p=!0;break}}var h=[],f=await w+"/"+await s+"/Manual/Configuration.json",y=await o(await f);if(void 0!==await y){var b=await y.TestCaseCustomKeys;if(void 0!==await b&&await b.length>0)for(let a=0;a<await b.length;a++){var S=await b[a].key;await h.includes(await S)||h.push(await S)}}var x=await c+await w+"/"+await s+"/Manual/TestCaseDetails/";if(await p){var M=await d.sync(await x+"**/**/*.json"),N=1;for(let a=0;a<await M.length;a++){var T={},E=(T={id:Number(await N),component:"",testid:"",testname:""},await JSON.parse(await l.readFileSync(await M[a],"utf8"))),A=(g=await E.placeHolder,await E.testCaseName);T.component=await g,T.testname=await A;var P=await M[a].split("\\"),C=await P[await P.length-1].replace(".json","");if(T.testid=await C,await h.length>0)for(let a=0;a<await h.length;a++){var k=h[a],j="",D=await E.testCaseCustomFields;if(void 0!==await D||await D.length>0)for(let a=0;a<await D.length;a++){var O=await D[a].key;if(await O===await k){j=await D[a].value,void 0===await j&&(j="");break}}T[await k]=await j}r.push(await T),N=Number(await N)+1}}else{N=1;for(let a=0;a<await v.length;a++){var I=await v[a];I=await m(I),M=await d.sync(await x+await I+"/**/*.json");for(let a=0;a<await M.length;a++){if(T={},T={id:Number(await N),component:"",testid:"",testname:""},E=await JSON.parse(await l.readFileSync(await M[a],"utf8")),g=await E.placeHolder,A=await E.testCaseName,T.component=await g,T.testname=await A,P=await M[a].split("\\"),C=await P[await P.length-1].replace(".json",""),T.testid=await C,await h.length>0)for(let a=0;a<await h.length;a++){if(k=h[a],j="",D=await E.testCaseCustomFields,void 0!==await D||await D.length>0)for(let a=0;a<await D.length;a++)if(O=await D[a].key,await O===await k){j=await D[a].value,void 0===await j&&(j="");break}T[await k]=await j}r.push(await T),N=Number(await N)+1}}}}catch(a){}t.json(r)}),i.post("/project/:projectName/linktestcase",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileSaved:!1,errorMessage:""};try{var s=a.params.projectName,n=await a.body.suiteName,w=await a.body.testcases,o=await a.headers.accountlabel;void 0===await w&&(w=[]);var v=await c+await o+"/"+await s+"/Manual/TestSuite/"+await n+".json";v=await m(v);var g,h=await d.sync(await v);if(0===await h.length)return r.errorMessage="Test suite "+await n+" does not exist on server.",t.json(r);try{g=await p.lock(await v,{retries:{retries:10,minTimeout:500,maxTimeout:2e3,factor:2}})}catch(a){return r.errorMessage="File "+v+" is locked by another user, Please try after sometime.",t.json(r)}var f=await JSON.parse(await l.readFileSync(await h[0],"utf8"));void 0===await f.AllTestCases&&(f.AllTestCases=[]),f.AllTestCases=await w;var y=await JSON.stringify(await f);await l.writeFileSync(await v,await y),r.isFileSaved=!0;try{await g()}catch(a){}}catch(a){try{await g()}catch(a){}r.errorMessage=await a.message}t.json(r)}),i.post("/project/:projectName/deletetestsuite",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileSaved:!1,errorMessage:""};try{var s=a.params.projectName,n=await a.body.suiteName,w=await a.headers.accountlabel,o=await c+await w+"/"+await s+"/Manual/TestSuite/"+await n+".json";await l.unlinkSync(await o),r.isFileSaved=!0}catch(a){r.errorMessage=await a.message}t.json(r)}),i.post("/project/:projectName/testingtype/:testingtype/fetchtestscriptsfromcomponent",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=[];try{var s=a.params.projectName,n=await a.params.testingtype,w=await a.headers.accountlabel,o=await a.body.components;if(void 0===await o)return t.json(r);if(0===await o.length)return t.json(r);switch(await n){case"Web":case"Mobile":case"Api":break;default:return t.json(r)}var p=!1,v=[];for(let a=0;a<await o.length;a++){var g=await o[a].value;if(await v.includes(await g)||v.push(await g),"select all"===await g.toString().toLowerCase()){p=!0;break}}var h=await c+await w+"/"+await s+"/"+await n+"/TestScripts/";if(await p){var f=await d.sync(await h+"**/**/*.json"),y=1;for(let a=0;a<await f.length;a++){var b={},S=(b={id:Number(await y),component:"",testid:"",testname:"",createdby:""},await f[await f.length-(a+1)].split("\\")),x=(g=await S[await S.length-2],await S[await S.length-1]),M=await x.split("@");if(2===await M.length){var N=await x.split("@")[0],T=await x.split("@")[1];T=await T.toString().replace(".json","")}else{const a=await x.lastIndexOf("@");N=await x.substring(0,a),T=x.substring(a+1),T=await T.toString().replace(".json","")}var E=await JSON.parse(await l.readFileSync(await f[a],"utf8")),A=await E.createdBy;void 0===await A&&(A=await E.lastUpdatedBy),A=void 0===await A?"User not Found":await A.toString().trim().split(" ")[0],b.component=await g,b.testname=await T,b.testid=await N,b.createdby=await A,r.push(await b),y=Number(await y)+1}}else{y=1;for(let a=0;a<await v.length;a++){var P=await v[a];P=await m(P),f=await d.sync(await h+await P+"/**/*.json");for(let a=0;a<await f.length;a++)b={},b={id:Number(await y),component:"",testid:"",testname:"",createdby:""},S=await f[await f.length-(a+1)].split("\\"),g=await S[await S.length-2],x=await S[await S.length-1],N=await x.split("@")[0],T=await x.split(await N)[1].substring(1).replace(".json",""),b.component=await g,b.testname=await T,b.testid=await N,E=await JSON.parse(await l.readFileSync(await f[a],"utf8")),A=await E.createdBy,A=void 0===await A?"Not Available":await A.toString().trim().split(" ")[0],b.createdby=await A,r.push(await b),y=Number(await y)+1}}}catch(a){}t.json(r)}),a.exports=i},4716:a=>{"use strict";a.exports=require("moment")},4967:(a,t,e)=>{const i="./dataHub/",r=e(8215);var s=e(9896);const n=e(2410),w=e(6928),{saveFile:o,isDirectoryExist:c,createDirectory:u,readJSONFile:l}=e(7229),{getColumnValuesBasedOnConditions:d,readPdfFile:p,verifyPdfPageCount:m,getRowCountFromExcel:v,readExcelFile:g,getCellCalueFromExcel:h}=e(9147),{apiCall:f}=e(5460),{createNameSpaceFromExpression:y,getValueFromJsonUsingNameSpace:b}=e(645),{runDBQuery:S}=e(8786),{Builder:x,Browser:M,By:N,Key:T,until:E,Select:A,Capabilities:P}=e(4973),{androidABD:C,androidShell:k}=e(4458),{Array_ExcludeCharacters:j,List_GetUniqueValues:D,JSON_getKeyValue:O,String_Trim:I,String_ToUpperCase:L,String_ToLowerCase:F,String_Substring:U,String_StartsWith:V,String_SplitandSaveValueAsPerIndex:B,String_Split:R,String_Replace:J,String_RemoveNumberFromTheString:X,String_Length:W,String_ExtractNumberFromTheString:Y,String_EndsWith:G,String_Concat:Q,Array_Length:q,Math_SubtractTwoNumber:Z,Math_SubtractPercentage:K,Math_Round:H,Math_Reminder:_,Math_MultiplyTwoNumber:z,Math_GetPercentage:$,Math_Floor:aa,Math_DivideTwoNumber:ta,Math_Ceil:ea,Math_AddTwoNumber:ia,Math_Abs:ra,Math_AddPercentage:sa,Date_getDate:na,Date_GetDateDifference:wa,Date_FormatDateTemplate:oa,Array_DeleteItem:ca,Array_DeleteItemBasedOnIndex:ua,Array_GetValueBasedOnIndex:la,Array_Push:da,Array_Search:pa,Array_Sort:ma,Array_SortDesc:va,Array_SumOfArray:ga}=e(8220),{generateRandomNumberWithNDigits:ha,getPassword:fa,getTitle:ya,getUserName:ba,getURl:Sa,getEmail:xa,getFirstName:Ma,getLastName:Na,getAddress:Ta,getUuid:Ea,getCountry:Aa,getPhoneNumber:Pa,getState:Ca,getCity:ka,getZipCode:ja,getWords:Da,getNumberFromRange:Oa,addOrSubtractDaysToCurrentDate:Ia,getString:La,extractNumberFromString:Fa,splitAndSaveIndexValue:Ua,addTwoNumber:Va,subtractTwoNumber:Ba,multiplyTwoNumber:Ra,devideTwoNumber:Ja,reminderTwoNumber:Xa,getPercentage:Wa,addPercentageInNumber:Ya,subtractPercentageInNumber:Ga,sumOfArray:Qa,getipv4:qa,getipv6:Za,getAirline:Ka,getAirPlane:Ha,getFlightNumber:_a,getAccountName:za,getAccountNumber:$a,getCardCVV:at,getCardIssuer:tt,getCardNumber:et,getbicycle:it,getcolor:rt,getfuel:st,getmodel:nt,getvehicle:wt,getvin:ot,getvrm:ct,getdepartment:ut,getdproduct:lt,getdproductDescription:dt,getproductMaterial:pt,getproductName:mt,getjobTitle:vt,getjobType:gt,getzodiacSign:ht,getmac:ft,getuserAgent:yt,getdomainName:bt,getavatar:St,getDateDifference:xt,getPhoneImEI:Mt}=e(6777),Nt=e(2103);async function Tt(a,t,e,i,r,s,n,w,o,c,u,l,d,p,m,v,g,h,f,y,b,S,x){var M={isSuccess:!1,errorMessage:""};if(await o.includes(await e))if(T=[],0===(N=await Et(await s)))M.isSuccess=!0;else for(let E=0;E<await N;E++){if(A=await At(await s,E,await N),A=await Ot(await A,await u,await l,await w,0,await f,await A,await v,await b),await E>0){if(P=await ce(await a,await i,await g,await c,await e,await u,await l,await w,await h,await o,await t,!1,await A,await f,await m,await v,await S,await y,await b,await x),!await P.isElementPresent){M.isSuccess=!1,M.isSuccess=await P.errorMessage;break}r=await P.element,d=await P.elements,p=await P.elementIndex}if(M=await Pt(await a,await t,await e,await A,await i,await c,await u,await l,await w,0,await o,await n,await m,await v,await y,await b,await S,await x),await N>1&&(C=await M.supportingEvidence,void 0!==await C&&(T.push(await C),M.supportingEvidence=await T)),!M.isSuccess)break}else{var N,T=[],E=[];if(0===(N=await Et(await s)))M.isSuccess=!0;else for(let j=0;j<await N;j++){var A=await At(await s,j,await N);if(A=await Ot(await A,await u,await l,await w,0,await f,await A,await v,await b),await j>0){var P=await ce(await a,await i,await g,await c,await e,await u,await l,await w,await h,await o,await t,!1,await A,await f,await m,await v,await S,await y,await b,await x);if(!await P.isElementPresent){M.isSuccess=!1,M.isSuccess=await P.errorMessage;break}r=await P.element,d=await P.elements,p=await P.elementIndex}if(M=await Dt(await a,await e,await i,await r,await A,await n,await w,await c,await t,await d,await p,await v,await m,await b),await N>1){var C=await M.supportingEvidence;try{void 0!==await C&&0!==await Object.keys(await C).length&&T.push(await C)}catch(a){}var k=await M.valuetobesend;try{void 0!==await k&&E.push(await k)}catch(a){}await T.length>0?M.supportingEvidence=await T:M.supportingEvidence=await E}if(!M.isSuccess)break}}return M}async function Et(a){var t=1;try{var e=await JSON.parse(await a);t=await e.loopCounter,void 0===await t&&(t=1),t=await isNaN(await t)?1:await Number(await t)}catch(a){t=1}return await t}async function At(a,t,e){try{if(await e>1){var i=await JSON.parse(await a),r={},s=await Object.keys(await i);for(let a=0;a<await s.length;a++){var n=await s[a],w=await i[await n],o=await typeof await w;switch(await o){case"object":var c=await w;break;case"number":c=await w;break;case"string":try{c=await JSON.parse(await w)}catch(a){c=await w}}if("methodParameters"===await n){if(await Array.isArray(await c))return w=await c[await t],await w}else if(void 0!==await c.methodParameters){var u=await c.methodParameters;try{var l=await JSON.parse(await u);u=await l}catch(a){}await Array.isArray(await u)&&(w=await u[await t])}r[await n]=await w}a=await JSON.stringify(await r)}}catch(a){}return await a}async function Pt(a,t,e,r,n,w,o,c,u,l,d,p,m,v,g,h,f,y){var b={},S={isSuccess:!1,errorMessage:"",additionaldata:"",supportingEvidence:{}},x=await i+await t+"/Mobile/CustomPageFunction/Function/"+await e+".json",M=await JSON.parse(await s.readFileSync(await x,"utf8")),N=await M.argumentlist,T=await r;if(""!==await N&&""!==T)try{if("object"!=typeof await r)var E=await JSON.parse(await r);else E=await T;var A=await Object.keys(await N);for(let a=0;a<await A.length;a++){var P=await A[a],C=await E[await P];if(void 0===await C&&await P.toLocaleLowerCase().toString().startsWith("args.")){var k="ARGS."+await P.substring(5);C=await E[await k],void 0!==await C&&(b[await k]=await C)}void 0===await C?b[await P]=void 0:(C=await Ot(await C,await o,await c,await u,0,await b,await C,await v,await h),b[await P]=await C)}}catch(a){return S.isSuccess=!1,S.errorMessage="Provided data is invalid. data should be send in JSON format "+await a,await S}var j=await M.allsteps,D=[],O={},I={},L={};for(let e=0;e<await j.length;e++){L={Stepdefinition:"",Action:"",locator:"",Status:"",TestData:{},SupportingData:{}};var F=!1,U=await j[e].stepdefinition,V=await j[e].action,B=await j[e].element,R=await j[e].value,J=await j[e].isreporting;R=await Ot(await R,await o,await c,await u,0,await b,await R,await v,await h);var X=await j[e].id;L={Stepdefinition:await U,Action:await V,locator:await B,Status:"",TestData:{},SupportingData:{}};var W=!1,Y=await Ct(await X,await O);if(await Y.isStepInvolved&&(W=await ke(await Y,await I)),await W)L.Status="Warning",L.TestData=await Te(await R),L.SupportingData=await Pe(),I[await X]=!1,D.push(await L);else if(L={Stepdefinition:await U,Action:await V,locator:await B,Status:"",TestData:{},SupportingData:{}},await d.includes(await V)){var G=await Et(await R);for(let i=0;i<await G;i++){L={},L={Stepdefinition:await U,Action:await V,locator:await B,Status:"",TestData:{},SupportingData:{}};var Q=await At(await R,await i,await G);Q=await Ot(await Q,await o,await c,await u,0,await b,await Q,await v,await h);var q=await Pt(await a,await t,await V,await Q,await n,await w,await o,await c,await u,await e,await d,await p,await m,await v,await g,await h,await f,await y);if(await q.isSuccess?L.Status="Pass":L.Status="Fail",F=await jt(await Te(await R)),await F&&(O=await kt(await Te(await R),await X,await O),"Warning"===await q.status?(I[await X]=!1,q.supportingData={},q.supportingData.errorMessage=await q.errorMessage):I[await X]=!0,await q.isSuccess||(L.Status="Warning",q.isSuccess=!0)),L.TestData=await Te(await Q),L.SupportingData=await q.supportingEvidence,"no"!==await J.toString().toLocaleLowerCase()&&(D.push(await L),!await q.isSuccess))break}}else if(q=await Ae(await a,await F,await U,await V,await B,await R,await X,await o,await c,await u,await b,await v,await O,await I,await n,await w,await e,await d,await t,await y,await f,await p,await m,await g,await h),F=await jt(await Te(await R)),await F&&(O=await kt(await Te(await R),await X,await O),I[await X]=await q.isSuccess),L.Status=await q.status,L.TestData=await q.testData,L.SupportingData=await await q.supportingData,"no"!==await J.toString().toLocaleLowerCase()&&(D.push(await L),!await q.isSuccess))break}return S.isSuccess=await q.isSuccess,S.supportingEvidence.ListOfTestSteps=await D,S.errorMessage=await q.errorMessage,await S}async function Ct(a,t){var e={isStepInvolved:!1,parentSteps:{}};try{var i=await Object.keys(await t);if(await i.length>0)for(let o=0;o<await i.length;o++){var r=await i[o],s=await t[await r],n=await Object.keys(await s);for(let t=0;t<await n.length;t++){var w=await n[t];(await s[await w]).includes(await a)&&(e.isStepInvolved=!0,e.parentSteps[await r]=w)}}}catch(a){}return await e}async function kt(a,t,e){try{void 0!==await a[await t]&&(e[await t]={});var i=await a.ifTrue;void 0!==await i&&await Array.isArray(await i)&&(e[await t]={},e[await t].true=await i)}catch(a){}try{i=await a.ifFalse,void 0!==await i&&await Array.isArray(await i)&&(void 0===e[await t]&&(e[await t]={}),e[await t].false=await i)}catch(a){}return await e}async function jt(a){try{var t=await a.ifTrue;if(void 0!==await t)return!0}catch(a){}try{if(t=await a.ifFalse,void 0!==await t)return!0}catch(a){}return await!1}async function Dt(a,t,e,r,o,x,M,N,T,E,P,ya,ba,Ma){var Na={isSuccess:!0,errorMessage:"",additionaldata:"",supportingEvidence:{}};null!==await r?r=await r["element-6066-11e4-a52e-4f735466cecf"]:null!==await E&&await E.length>0&&(r=await E[0]["element-6066-11e4-a52e-4f735466cecf"]);try{switch(await t){case"RunADBCommand":Na=await oe(await o),await Na.isSuccess&&(Na=await C(await Na.valuetobesend),x.output=await Na.output,Na.supportingEvidence.ADBCommandResponse=await x.output);break;case"RestartAppTillElementIsPresent":break;case"DBRecordCountShouldBe":if(Na=await be(await o),await Na.isSuccess){var Ea=Number(await Na.rowsCount),Aa=0,Ca=await x.output;try{var ka=await JSON.parse(await Ca);Aa=await ka.length}catch(a){Aa=0}Na.supportingEvidence.TotalDBRecordCount=await Aa,await Ea!==await Aa&&(Na.isSuccess=!1,Na.errorMessage="Expected Db Records count is "+await Ea+" however actual DB record count is "+await Aa+".")}else Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage;break;case"DBRecordCountShouldBeGreaterThan":if(Na=await be(await o),await Na.isSuccess){Ea=Number(await Na.rowsCount),Aa=0,Ca=await x.output;try{ka=await JSON.parse(await Ca),Aa=await ka.length}catch(a){Aa=0}Na.supportingEvidence.TotalDBRecordCount=await Aa,await Ea<await Aa||(Na.isSuccess=!1,Na.errorMessage="Expected Db Records count is "+await Ea+" however actual DB record count is "+await Aa+".")}else Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage;break;case"DBRecordCountShouldBeLessThan":if(Na=await be(await o),await Na.isSuccess){Ea=Number(await Na.rowsCount),Aa=0,Ca=await x.output;try{ka=await JSON.parse(await Ca),Aa=await ka.length}catch(a){Aa=0}Na.supportingEvidence.TotalDBRecordCount=await Aa,await Ea>await Aa||(Na.isSuccess=!1,Na.errorMessage="Expected Db Records count is "+await Ea+" however actual DB record count is "+await Aa+".")}else Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage;break;case"RunShellCommand":Na=await oe(await o),await Na.isSuccess&&(Na=await k(await Na.valuetobesend),x.output=await Na.output,Na.supportingEvidence.ShellCommandResponse=await x.output);break;case"RunDBQuery":Na=await ye(await o),await Na.isSuccess?(Na=await S(await T,"Mobile",await ya,await Na.Query,await Na.database),await Na.isSuccess?(x.output=await Na.output,Na.errorMessage="Result "+await x.output,Na.supportingEvidence.SQLQueryResults=await x.output):Na.errorMessage=await Na.errorMessage):(Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage);break;case"DBRecordsCount":if(Na=await ye(await o),await Na.isSuccess)if(Na=await S(await T,"Mobile",await ya,await Na.Query,await Na.database),await Na.isSuccess)try{x.output=JSON.parse(await Na.output).length,Na.errorMessage="Result "+await x.output,Na.supportingEvidence.SQLQueryResults=await x.output}catch(a){x.output=0,Na.errorMessage=await a.toString()}else x.output=0,Na.errorMessage=await Na.errorMessage;else x.output=0,Na.errorMessage=await Na.errorMessage;break;case"SaveDBColumnValueInSessionVariable":if(Na=await async function(a){var t={isSuccess:!0,errorMessage:"",allcolumn:[],allvariable:[],rowIndex:0,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid,  rowIndex and columnname should be provided in the value section. e.g. {"rowIndex":0,"DbColumn":"MyVariable"}.',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a),i=!1;if(void 0===await e.rowIndex&&(t.rowIndex=void 0,i=!0),await i)r=await Object.keys(await e);else{t.rowIndex=await e.rowIndex;var r=await Object.keys(await e);if(1===await r.length)return t.errorMessage='Provided value is invalid,  rowIndex and columnname should be provided in the value section. e.g. {"rowIndex":0,"DbColumn":"MyVariable"}.',t.isSuccess=!1,await t}for(let a=0;a<await r.length;a++){var s=await r[a];if("rowIndex"!==await s){if(await t.allcolumn.includes(await s))return t.errorMessage="Provided value is invalid,  Duplicate column "+await s+" are found.}.",t.isSuccess=!1,await t;await t.allcolumn.push(await await s);var n=await e[await s];if(await t.allvariable.includes(await n))return t.errorMessage="Provided value is invalid,  Duplicate variable "+await n+" are found.}.",t.isSuccess=!1,await t;await t.allvariable.push(await await n)}}}catch(a){return t.errorMessage='Provided value is invalid,  rowIndex and columnname should be provided in the value section. e.g. {"rowIndex":0,"DbColumn":"MyVariable"}.',t.isSuccess=!1,await t}return await t}(await o),await Na.isSuccess){var Da=await JSON.parse(await x.output);if(void 0!==await Na.rowIndex)var Ia=Number(await Na.rowIndex);else Ia=void 0;var Fa=await Na.allcolumn,Ua=await Na.allvariable;Na.supportingEvidence.DBTableColumnValue={};for(let a=0;a<await Ua.length;a++){var Va=await Ua[a],Ba=await Fa[a];if(void 0===await Ia){var Ra=[];for(let a=0;a<await Da.length;a++){var Ja=await Da[await a][await Ba];Ra.push(await Ja)}Na.supportingEvidence.DBTableColumnValue[await Va]=await Ra,M[await Va]=await Ra}else{if(await Ia>=await Da.length){Na.isSuccess=!1,Na.errorMessage="Total Db Records count is "+await Da.length+" and rowIndex provided in test data is "+await Ia+". Please note index is started with 0";break}if(Ja=await Da[await Ia][await Ba],void 0===await Ja){Na.isSuccess=!1,Na.errorMessage="Column name "+await Ba+" does not exist in Records data.";break}Na.supportingEvidence.DBTableColumnValue[await Va]=await Ja,M[await Va]=await Ja}}}else Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage;break;case"Check":var Xa=await e.isElementSelected(await r);await Xa||await e.elementClick(await await r);break;case"CheckAll":Na=await async function(a,t){var e={isSuccess:!0,errorMessage:"",supportingEvidence:{}};try{var i=await await t;for(let t=0;t<await i.length;t++){var r=await i[t]["element-6066-11e4-a52e-4f735466cecf"],s=await a.isElementSelected(await r);await s||await a.elementClick(await r)}}catch(a){return e.isSuccess=!1,e.errorMessage=await a.toString(),await e}return await e}(await e,await E);break;case"Click":await e.elementClick(await await r);break;case"Tap":var{x:Wa,y:Ya}=await e.getElementLocation(await r);await e.touchAction([{action:"press",x:await Wa,y:await Ya},{action:"release"}]);break;case"Pinch":var Ga=.5,{x:Wa,y:Ya}=await e.getElementLocation(await r),Qa=await e.getElementSize(await r),qa=await Qa.width,Za=await await Qa.height,Ka=Wa+qa/2,Ha=Ya+Za/2,_a=qa*Ga;await e.touchAction([{action:"press",x:await Ka,y:await Ha-await _a/2},{action:"moveTo",x:await Ka,y:await Ha+await _a/2},{action:"release"}]);break;case"ZoomIn":Ga=2;var{x:Wa,y:Ya}=await e.getElementLocation(await r);Qa=await e.getElementSize(await r),qa=await Qa.width,Za=await await Qa.height,Ka=Wa+qa/2,Ha=Ya+Za/2,_a=qa*(Ga-1),await e.touchAction([{action:"press",x:await Ka-await _a/2,y:await Ha},{action:"moveTo",x:await Ka,y:await Ha},{action:"release"}]);break;case"ZoomOut":Ga=.5;var{x:Wa,y:Ya}=await e.getElementLocation(await r);Qa=await e.getElementSize(await r),qa=await Qa.width,Za=await await Qa.height,Ka=Wa+qa/2,Ha=Ya+Za/2,_a=qa*(1-Ga),await e.touchAction([{action:"press",x:await Ka,y:await Ha},{action:"moveTo",x:await Ka-await _a/2,y:await Ha},{action:"release"}]);break;case"Refresh":var za=await e.getWindowSize(),$a=za.width/2,tt=100,it=$a,rt=za.height-100;await e.touchAction([{action:"press",x:$a,y:tt},{action:"wait",ms:1e3},{action:"moveTo",x:it,y:rt},{action:"release"}]);break;case"SwipeLeft":$a=.8,it=.2,Ya=.5;var{width:qa,height:Za}=await e.getWindowSize(),st={x:Math.floor($a*qa),y:Math.floor(Ya*Za)},nt={x:Math.floor(it*qa),y:Math.floor(Ya*Za)};await e.touchAction([{action:"press",...st},{action:"wait",ms:1e3},{action:"moveTo",...nt},{action:"release"}]);break;case"SwipeRight":$a=.2,it=.8;var Ya=.5,{width:qa,height:Za}=await e.getWindowSize();st={x:Math.floor($a*qa),y:Math.floor(Ya*Za)},nt={x:Math.floor(it*qa),y:Math.floor(Ya*Za)},await e.touchAction([{action:"press",...st},{action:"wait",ms:1e3},{action:"moveTo",...nt},{action:"release"}]);break;case"SwipeLeftAt":var{x:Wa,y:Ya}=await e.getElementLocation(await r),wt=(Qa=await e.getElementSize(await r),qa=await Qa.width,Za=await await Qa.height,$a=await Wa+.8*await qa,it=await Wa+.2*await qa,await Ya+await Za/2);await e.touchAction([{action:"press",x:$a,y:wt},{action:"wait",ms:1e3},{action:"moveTo",x:it,y:wt},{action:"release"}]);break;case"SwipeRightAt":var{x:Wa,y:Ya}=await e.getElementLocation(await r);Qa=await e.getElementSize(await r),qa=await Qa.width,Za=await Qa.height,$a=await Wa+.2*await qa,it=await Wa+.8*await qa,wt=await Ya+await Za/2,await e.touchAction([{action:"press",x:$a,endy:wt},{action:"wait",ms:1e3},{action:"moveTo",x:it,endy:wt},{action:"release"}]);break;case"SwipeUp":Na=await Me(await o),await Na.isSuccess&&await async function(a,t){t=await Number(await t);for(let w=0;w<await t;w++){var{width:e,height:i}=await a.getWindowRect(),r=e/2,s=.8*i,n=.2*i;await a.touchAction([{action:"press",x:r,y:s},{action:"wait",ms:1e3},{action:"moveTo",x:r,y:n},{action:"release"}])}}(await e,await Na.totalSwipeCount);break;case"SwipeUpAt":var{x:Wa,y:Ya}=await e.getElementLocation(await r),{width:qa,height:Za}=await e.getElementSize(await r);$a=await Wa+await qa/2,tt=await Ya+await Za-10,it=await $a,rt=await Ya+await Za-300,await e.touchAction([{action:"press",x:Wa,y:tt},{action:"wait",ms:1e3},{action:"moveTo",x:Wa,y:rt},{action:"release"}]);break;case"SwipeDown":Na=await Me(await o),await Na.isSuccess&&await async function(a,t){t=await Number(await t);for(let w=0;w<await t;w++){var{width:e,height:i}=await a.getWindowRect(),r=e/2,s=.5*i,n=1*i;await a.touchAction([{action:"press",x:r,y:s},{action:"wait",ms:1e3},{action:"moveTo",x:r,y:n},{action:"release"}])}}(await e,await Na.totalSwipeCount);break;case"SwipeDownAt":var{x:Wa,y:Ya}=await e.getElementLocation(await r),{width:qa,height:Za}=await e.getElementSize(await r);$a=await Wa+await qa/2,tt=await Ya+await Za-10,it=await $a,rt=await Ya+await Za+300,await e.touchAction([{action:"press",x:Wa,y:tt},{action:"wait",ms:1e3},{action:"moveTo",x:Wa,y:rt},{action:"release"}]);break;case"ClickAll":await new Promise(a=>setTimeout(a,1e3));var ot=await await E;for(let a=0;a<await ot.length;a++)await new Promise(a=>setTimeout(a,300)),await e.elementClick(await ot[a]["element-6066-11e4-a52e-4f735466cecf"]),await Ft(await e);break;case"ClickNTimes":if(Na=await async function(a){var t={isSuccess:!0,errorMessage:"",countofclick:0,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid. countofclick should be provided in value section e.g. {"countofclick":2}',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];if(void 0===await i&&((e={}).countofclick=await a),void 0===await e.countofclick)return t.errorMessage='Provided value is invalid. countofclick should be provided in value section e.g. {"countofclick":2}',t.isSuccess=!1,await t;var r=await _t(await e.countofclick);if(!await r)return t.errorMessage='Provided value is invalid. countofclick should be provided in value section e.g. {"countofclick":2}',t.isSuccess=!1,await t;t.countofclick=await e.countofclick}catch(a){return t.errorMessage='Provided value is invalid. countofclick should be provided in value section e.g. {"countofclick":2}',t.isSuccess=!1,await t}return await t}(await o),await Na.isSuccess){for(let a=0;a<await Number(Na.countofclick);a++)await new Promise(a=>setTimeout(a,500)),await e.elementClick(await r),await Ft(await e);break}break;case"Count":try{x.output=await(await E).length}catch(a){x.output=0}Na.errorMessage="Result "+await x.output,Na.additionaldata=await x.output,Na.supportingEvidence.Count=await x.output;break;case"DoubleClick":var{x:Wa,y:Ya}=await e.getElementLocation(await r);await e.touchAction([{action:"tap",x:Wa,y:Ya}]),await new Promise(a=>setTimeout(a,200)),await e.touchAction([{action:"tap",x:Wa,y:Ya}]);break;case"LongClick":var{x:Wa,y:Ya}=await e.getElementLocation(await r);await e.touchAction([{action:"press",x:Wa,y:Ya},{action:"wait",ms:2e3},{action:"release"}]);break;case"DragandDrop":if(Na=await async function(a){var t={isSuccess:!0,errorMessage:"",nextelement:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, nextelement should be provided in the value section. e.g. {"nextelement":"buttonXYZ"). Next element should be in Object Repository page',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(void 0===await e.nextelement||""===await e.nextelement.toString().trim())return t.errorMessage='Provided value is invalid, nextelement should be provided in the value section. e.g. {"nextelement":"buttonXYZ"). Next element should be in Object Repository page',t.isSuccess=!1,await t;t.nextelement=await e.nextelement.toString().trim()}catch(a){return t.errorMessage='Provided value is invalid, nextelement should be provided in the value section. e.g. {"nextelement":"buttonXYZ"). Next element should be in Object Repository page',t.isSuccess=!1,await t}return await t}(await o),await Na.isSuccess){var ct=null,ut=await Bt(await e,await Na.nextelement,await N,"Android");if(await ut.isElementInOr){if(!await ut.isElementPresent)return Na.isSuccess=!1,void(Na.errorMessage=await ut.errorMessage);ct=await ut.webElement;var{x:Wa,y:Ya}=await e.getElementLocation(await r),{newx:lt,newy:dt}=await e.getElementLocation(await ct);await e.touchAction([{action:"press",x:Wa,y:Ya},{action:"moveTo",newx:lt,newy:dt},{action:"release"}])}else Na.isSuccess=!1,Na.errorMessage=await Na.nextelement+" does not exist in Object Repository."}break;case"FileUpload":if(Na=await te(await o,await T),await Na.isSuccess){var pt=await w.resolve(await i+await T+"/Mobile/Uploads/"+await Na.filename);await(await r).sendKeys(await pt)}break;case"Focus":var{x:Wa,y:Ya}=await e.getElementLocation(await r);await e.touchAction([{action:"moveTo",x:Wa,y:Ya},{action:"release"}]);break;case"Scroll":break;case"GetAttribute":Na=await we(await o),await Na.isSuccess&&("text"===await Na.attributename.toLocaleLowerCase()?x.output=await ge(await e,await r):x.output=await e.getElementAttribute(await r,await Na.attributename),Na.additionaldata=await x.output,Na.errorMessage="Result "+await x.output,Na.supportingEvidence.ApplicationData=await x.output);break;case"GetAttributeForAllElements":if(Na=await we(await o),await Na.isSuccess){var mt=[],vt=await E;for(let a=0;a<await vt.length;a++)await focus(await e,await vt[a]),"text"===await Na.attributename?runTimeText=await ge(await e,await vt[a]):runTimeText=await e.getElementAttribute(await vt[a],await Na.attributename),mt.push(await runTimeText);x.output=await mt,Na.additionaldata=await x.output,Na.errorMessage="Result "+await x.output,Na.supportingEvidence.ApplicationData=await mt}break;case"GetIndexOfTheElement":x.output=await P,Na.additionaldata=await x.output,Na.supportingEvidence.index=await P;break;case"GetTagName":x.output=await(await r).getTagName(await o),Na.errorMessage="Result "+await x.output,Na.supportingEvidence.TagName=await x.output;break;case"RightClick":await(await e).actions().contextClick(await r).perform();break;case"SelectByIndex":if(Na=await oe(await o),await Na.isSuccess){var gt=new A(await r);await(await gt).selectByIndex(Number(await Na.valuetobesend))}break;case"ExecuteScript":Na=await oe(await o),await Na.isSuccess&&await e.executeScript(await Na.valuetobesend);break;case"SelectByValue":Na=await oe(await o),await Na.isSuccess&&(gt=new A(await r),await(await gt).selectByValue(await Na.valuetobesend));break;case"SelectByVisibleText":Na=await oe(await o),await Na.isSuccess&&(gt=new A(await r),await(await gt).selectByVisibleText(await Na.valuetobesend));break;case"SwitchToDefaultContents":await e.switchTo().defaultContent();break;case"SwitchToFrame":await e.switchTo().frame(await r);break;case"Type":Na=await oe(await o),await Na.isSuccess&&await he(await e,await r,await Na.valuetobesend,await ba);break;case"SendKeysUsingKeyPad":break;case"TypeAll":await new Promise(a=>setTimeout(a,1e3)),Na=await async function(a){var t={isSuccess:!0,errorMessage:"",valuetobesend:[],supportingEvidence:{}};try{if(""===await a.toString().trim())return t.isSuccess=!0,await t;var e=await JSON.parse(await a),i=await Object.keys(await e);if(0===await i.length)return t.isSuccess=!0,await t;var r=[];for(let a=0;a<await i.length;a++){var s=await i[a],n=await e[await s];r.push(await n)}t.valuetobesend=await r}catch(a){t.isSuccess=!1,t.errorMessage='Incorrect value are provided, value should be passed as json array e.g. [{"providedattributename":"id","valuetobesend":"Provide value"}]'}return await t}(await o),await Na.isSuccess&&(Na=await async function(a,t,e,i){var r={isSuccess:!0,errorMessage:"",supportingEvidence:{}};r.supportingEvidence.ListOfTestData=[];try{var s=await await t;for(let t=0;t<await s.length;t++){var n=await s[t]["element-6066-11e4-a52e-4f735466cecf"],w="",o=!0;await new Promise(a=>setTimeout(a,300));var c=await a.getElementText(await n);switch(await c.toLocaleLowerCase()){case"email":w=await xa();break;case"url":w=await Sa();break;case"phone":case"phonenuber":case"mobile":case"mobilenumber":case"tel":w=await Pa();break;case"number":try{var u=await a.getElementAttribute(await n,"minValue");null!==await u&&void 0!==u||(u=1)}catch(a){u=1}try{var l=await a.getElementAttribute(await n,"maxValue");null!==await l&&void 0!==l||(l=1e3)}catch(a){l=1e3}try{var d=await a.getElementAttribute(await n,"maxlength");null!==await d&&void 0!==d||(o=!1,d=5)}catch(a){o=!1,d=5}w=await o?await ha(await d):await Oa(await u,await l);break;case"password":w=await fa();break;case"address":case"street":w=await Ta();break;case"zip":case"pin":case"zipcode":case"pincode":w=await ja();break;case"cardnumber":w=await et();break;case"cvv":case"securitycode":w=await at();break;case"expirationdate":w=await generateExpiryDate();break;default:w=""}if(""===await w){try{var p=await a.getElementAttribute(await n,"resource-id");null!==await p&&""!==p||(p=await a.getElementAttribute(await n,"content-desc"),null!==await p&&""!==p||(p=await a.getElementAttribute(await n,"hint"),null!==await p&&""!==p||(p=await a.getElementAttribute(await n,"text"))))}catch(t){try{p=await a.getElementAttribute(await n,"name")}catch(a){}if(null===await p||""===await p||void 0===await p)try{p=await a.getElementAttribute(await n,"value")}catch(a){}}if(w=await fe(await p),""===await w){try{d=await a.getElementAttribute(await n,"maxlength")}catch(a){d=null}null!==await d&&void 0!==d||(o=!1,d=5),w=10===await d?await Pa():await La(await d)}}if(0!==await e.length)for(let t=0;t<await e.length;t++){var m="",v=await e[t],g=await Object.keys(await v)[0];m="text"===await g.toLocaleLowerCase()?await a.getElementText(await n):await a.getElementAttribute(await n,await g);var h=await v[await g];try{if(await m.toString().toLocaleLowerCase().includes(await h.toString().toLocaleLowerCase())){if(w=await v.valuetobesend,void 0===await w)return r.isSuccess=!1,r.errorMessage='Incorrect value are provided, value should be passed json array e.g. [{"providedattributename":"id","valuetobesend":"Provide value"}]',await r;await e.splice(t,1);break}}catch(a){}}var f=await a.isElementDisplayed(await n);await f&&(await he(await a,await n,await w,await i),r.supportingEvidence.ListOfTestData.push(await w),await Ft(await a))}}catch(a){return r.isSuccess=!1,r.errorMessage=await a.toString(),await r}return await r}(await e,await E,await Na.valuetobesend,await ba));break;case"Uncheck":Xa=await e.isElementSelected(await r),await Xa&&await e.elementClick(await await r);break;case"UncheckAll":Na=await async function(a,t){var e={isSuccess:!0,errorMessage:"",supportingEvidence:{}};try{var i=await await t;for(let t=0;t<await i.length;t++){var r=await i[t]["element-6066-11e4-a52e-4f735466cecf"],s=await a.isElementSelected(await r);await s&&await a.elementClick(await r)}}catch(a){return e.isSuccess=!1,e.errorMessage=await a.toString(),await e}return await e}(await e,await E);break;case"Back":await e.back();break;case"Close":Na=await oe(await o),await Na.isSuccess&&(""===await Na.valuetobesend.toString().trim()?await e.closeApp():await e.terminateApp(await Na.valuetobesend));break;case"Forward":await e.forward();break;case"AlertAccept":await e.acceptAlert();break;case"AlertDismiss":await e.dismissAlert();case"AlertText":x.output=await e.getAlertText(),Na.errorMessage="Result "+await x.output,Na.supportingEvidence.AlertText=await x.output;break;case"AlertSendKeys":Na=await oe(await o),await Na.isSuccess&&await e.sendAlertText(await Na.valuetobesend);case"GetCurrentPackage":x.output=await e.getCurrentPackage(),Na.additionaldata=await x.output,Na.errorMessage="Result "+await x.output,Na.supportingEvidence.AppPackage=await x.output;break;case"GetCurrentActivity":x.output=await e.getCurrentActivity(),Na.additionaldata=await x.output,Na.errorMessage="Result "+await x.output,Na.supportingEvidence.AppActivity=await x.output;break;case"SwitchTo":Na=await oe(await o),await Na.isSuccess&&await e.activateApp(await Na.valuetobesend);break;case"Remove":Na=await oe(await o),await Na.isSuccess&&await e.removeApp(await Na.valuetobesend);break;case"OpenNotification":await e.openNotifications();break;case"Launch":Na=await async function(a){var t={isSuccess:!1,errorMessage:"",apppackage:"",appactivity:"",supportingEvidence:{}};try{var e=await JSON.parse(await a);t.apppackage=await e.apppackage,t.appactivity=await e.appactivity,t.isSuccess=!0}catch(a){t.errorMessage="Provided Input is incorrect , apppackage and appactivity should be present in input. "+await a.toString()}return t}(await o),await Na.isSuccess&&await e.startActivity(await Na.apppackage,await Na.appactivity);break;case"RestartApp":await e.closeApp(),await e.launchApp();break;case"HideKeyboard":await Ne(await ba,await e);break;case"Wait":Na=await Ht(await o),await Na.isSuccess&&await new Promise(a=>setTimeout(a,1e3*Number(Na.timeout)));break;case"WaitForElementIsDisabled":var ht=await e.isElementEnabled(await r);Na=await Ht(await o),await ht&&(Na.isSuccess=!1,Na.errorMessage="Mobile Element is not disabled after waiting "+await Na.timeout+" seconds.");break;case"WaitForElementIsEnabled":ht=await e.isElementEnabled(await r),Na=await Ht(await o),await ht||(Na.isSuccess=!1,Na.errorMessage="Mobile Element is not enabled after waiting "+await Na.timeout+" seconds.");break;case"WaitForElementTillDisplayed":Na=await Ht(await o);var ft=await e.isElementDisplayed(await r);await ft||(Na.isSuccess=!1,Na.errorMessage="Mobile Element is not displayed after waiting "+await Na.timeout+" seconds.");break;case"WaitForElementTillNotDisplayed":break;case"WaitForElementTillTextContains":if(Na=await async function(a){var t={isSuccess:!0,errorMessage:"",timeout:30,expectedtext:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];if(void 0===await i){e={};var r=await await a;if(!await r.includes(","))return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t;e.timeout=await r[0].toString().trim(),e.expectedtext=await r[1].toString().trim()}}catch(i){if(e={},r=await await a,!await r.includes(","))return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t;e.timeout=await r[0].toString().trim(),e.expectedtext=await r[1].toString().trim()}if(void 0===await e.timeout)return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t;if(void 0===await e.expectedtext)return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t;var s=await _t(await e.timeout);if(!await s)return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t;t.timeout=await e.timeout,t.expectedtext=await e.expectedtext}catch(a){return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t}return await t}(await o),await Na.isSuccess){var yt=await async function(a,t,e,i){for(let s=0;s<await e;s++){var r=await ge(await a,await t);if(await r.toString().toLocaleLowerCase().includes(await i.toString().toLocaleLowerCase()))break;await new Promise(a=>setTimeout(a,1e3))}}(await e,await r,await Number(await Na.timeout),await Na.expectedtext);await yt||(Na.isSuccess=!1,Na.errorMessage="Expected Mobile Element text "+await await Na.expectedtext+" is not displayed after waiting "+await Na.timeout+" seconds.")}break;case"AssertContains":Na=await ie(await o),await Na.isSuccess&&(Na=await re(await Na.actualvalue,await Na.expectedvalue));break;case"AssertElementAttributeContains":if(Na=await de(await o),await Na.isSuccess){var bt=await Na.attributeNames,St=await Object.keys(await bt);if(await St.length>0){var xt=[],Mt="";Na.supportingEvidence.AttributeDetails={};for(let a=0;a<await St.length;a++){var Nt=await St[a];try{if("text"===await Nt.toString().toLocaleLowerCase())var Tt=await ge(await e,await r);else Tt=await e.getElementAttribute(await r,await Nt)}catch(a){Tt="null"}null===await Tt&&(Tt="null"),await Tt.toString().toLowerCase().trim().includes(await bt[await Nt].toString().toLowerCase().trim())?xt.push(!0):xt.push(!1),Na.supportingEvidence.AttributeDetails[await Nt]=await Tt,Mt=Mt+"Expected "+await Nt+" is "+await await bt[await Nt]+", and actual it has "+await Tt+" ."}var Et=await ue(await xt);await Et||(Na.isSuccess=!1),Na.errorMessage=await Mt}}break;case"AssertElementAttributeEquals":if(Na=await de(await o),await Na.isSuccess&&(bt=await Na.attributeNames,St=await Object.keys(await bt),await St.length>0)){xt=[],Mt="",Na.supportingEvidence.AttributeDetails={};for(let a=0;a<await St.length;a++){Nt=await St[a];try{Tt="text"===await Nt.toString().toLocaleLowerCase()?await ge(await e,await r):await e.getElementAttribute(await r,await Nt)}catch(a){Tt="null"}null===await Tt&&(Tt="null"),await Tt!==await bt[await Nt]?xt.push(!1):xt.push(!0),Na.supportingEvidence.AttributeDetails[await Nt]=await Tt,Mt=Mt+"Expected "+await Nt+" is "+await await bt[await Nt]+", and actual it has "+await Tt+" ."}Et=await ue(await xt),await Et||(Na.isSuccess=!1),Na.errorMessage=await Mt}break;case"AssertElementAttributeNotContains":if(Na=await de(await o),await Na.isSuccess&&(bt=await Na.attributeNames,St=await Object.keys(await bt),await St.length>0)){xt=[],Mt="",Na.supportingEvidence.AttributeDetails={};for(let a=0;a<await St.length;a++){try{if(Nt=await St[a],"text"===await Nt)Tt=await ge(await e,await r);else try{Tt=await e.getElementAttribute(await r,await Nt)}catch(a){Tt="null"}await Tt.toString().toLowerCase().trim().includes(await bt[await Nt].toString().toLowerCase().trim())?xt.push(!1):xt.push(!0)}catch(a){xt.push(!0)}Na.supportingEvidence.AttributeDetails[await Nt]=await Tt,Mt=Mt+"Expected "+await Nt+" is "+await await bt[await Nt]+", and actual it has "+await Tt+" ."}Et=await ue(await xt),await Et||(Na.isSuccess=!1),Na.errorMessage=await Mt}break;case"AssertElementCountEquals":if(Na=await $t(await o),await Na.isSuccess){var At=await(await E).length;Na.supportingEvidence.ActualElementCount=await At,Number(await At)!==Number(await Na.expectedcount)&&(Na.isSuccess=!1,Na.errorMessage="Expected element count is "+await Na.expectedcount+" however actual count is "+await At+".")}break;case"AssertElementCountGreaterThan":Na=await $t(await o),await Na.isSuccess&&(At=await(await E).length,Na.supportingEvidence.ActualElementCount=await At,Number(await At)>Number(await Na.expectedcount)||(Na.isSuccess=!1,Na.errorMessage="Expected element count is "+await Na.expectedcount+" however actual count is "+await At+"."));break;case"AssertElementCountLessThan":Na=await $t(await o),await Na.isSuccess&&(At=await(await E).length,Na.supportingEvidence.ActualElementCount=await At,Number(await At)<Number(await Na.expectedcount)||(Na.isSuccess=!1,Na.errorMessage="Expected element count is "+await Na.expectedcount+" however actual count is "+await At+"."));break;case"IsFileExistOnDownloadFolder":if(Na=await te(await o,await T),await Na.isSuccess)try{var Pt=await w.parse(await Na.filename).name,Ct=await w.parse(await Na.filename).ext,kt=await i+await T+"/Web/Downloads/*"+await Pt+"*."+await Ct,jt=await n.sync(await kt);0===await jt.length&&(Na.isSuccess=!1,Na.errorMessage="File/Folder "+await Na.filename+" does not exist on browser Downloads folder.")}catch(a){Na.isSuccess=!1,Na.errorMessage="File Name and extension should be required. Please pass the correct file name."}break;case"AssertEquals":Na=await ie(await o),await Na.isSuccess&&(Na=await async function(a,t){var e={isSuccess:!0,errorMessage:"",supportingEvidence:{}};try{var i=await typeof await a,r=await typeof await t;if("string"===await i){var s=await isNaN(await a);await s||(i="number")}if("string"===await r&&(s=await isNaN(await t),await s||(r="number")),"string"===await r&&"string"===await i)await a.toString().trim()!==await t.toString().trim()&&(e.isSuccess=!1,e.errorMessage="Expected value is "+await t+" however actual value is "+await a+".");else if("number"===await r&&"number"===await i)await Number(await a)!==await Number(await t)&&(e.isSuccess=!1,e.errorMessage="Expected value is "+await t+" however actual value is "+await a+".");else{var n=await se(t),w=!1;await n?(w=await async function(a,t){if(!Array.isArray(await a)||!Array.isArray(await t))return!1;if(a.length!==t.length)return!1;const e=(await a).slice().sort(),i=(await t).slice().sort();return e.every((a,t)=>a===i[t])}(await a,await t),await w||(e.isSuccess=!1,e.errorMessage="Expected value is "+await t+" however actual value is "+await a+".")):(w=await async function(a,t){return await Object.keys(a).length===await Object.keys(t).length&&await ne(await a,await t)}(await a,await t),await w||(e.isSuccess=!1,e.errorMessage="Expected value is "+await JSON.stringify(await t)+" however actual value is "+await JSON.stringify(await a)+"."))}}catch(i){e.isSuccess=!1,e.errorMessage="Expected value is "+await JSON.stringify(await t)+" however actual value is "+await JSON.stringify(await a)+"."}return await e}(Na.actualvalue,await Na.expectedvalue));break;case"AssertGreaterThan":Na=await ie(await o),await Na.isSuccess&&Number(await Na.actualvalue<=await Number(await Na.expectedvalue))&&(Na.isSuccess=!1,Na.errorMessage="Expected value is "+await Number(await Na.expectedvalue)+" and actual value is "+await Na.actualvalue);break;case"AssertLessThan":Na=await ie(await o),await Na.isSuccess&&Number(await Na.actualvalue>=await Number(await Na.expectedvalue))&&(Na.isSuccess=!1,Na.errorMessage="Expected value is "+await Number(await Na.expectedvalue)+" and actual value is "+await Na.actualvalue);break;case"AssertNotContains":if(Na=await ie(await o),await Na.isSuccess){var Dt=await re(await Na.actualvalue,await Na.expectedvalue);await Dt.isSuccess?(Na.errorMessage=await Dt.errorMessage,Na.isSuccess=!1):(Na.errorMessage=await Dt.errorMessage,Na.isSuccess=!0)}break;case"AssertTitleContains":if(Na=await ae(await o),await Na.isSuccess){var Ot=await(await(await e).getTitle()).toString().toLocaleLowerCase();Na.supportingEvidence.ActualAppTitle=await Ot;var It=await Na.title.toString().toLocaleLowerCase().trim();await Ot.includes(await It)||(Na.isSuccess=!1,Na.errorMessage="Expected window Title is "+await Na.title+" however actual title is "+await Ot+"."),Na.errorMessage="Expected window Title is "+await Na.title+" and actual title is "+await Ot+"."}break;case"AssertTitleEquals":if(Na=await ae(await o),await Na.isSuccess){var Lt=await(await e).getTitle();Na.supportingEvidence.ActualAppTitle=await Lt,await Lt!==await Na.title&&(Na.isSuccess=!1,Na.errorMessage="Expected window Title is "+Na.title+" however actual title is "+await Lt+"."),Na.errorMessage="Expected window Title is "+await Na.title+" and actual title is "+await Lt+"."}break;case"AssertAlertTextContains":Na=await ee(await o),await Na.isSuccess&&(Ot=await e.getAlertText(),Na.supportingEvidence.AlertText=await Ot,It=await Na.expectedtext.toString().toLowerCase().trim(),await Ot.includes(await It)?Na.errorMessage="Expected alert text "+await Na.expectedtext+" is not present in actual text "+await Ot+".":(Na.isSuccess=!1,Na.errorMessage="Expected alert text "+await Na.expectedtext+" is present in actual text "+await Ot+"."));break;case"AssertAlertTextEquals":Na=await ee(await o),await Na.isSuccess&&(Lt=await e.getAlertText(),Na.supportingEvidence.AlertText=await Lt,await Lt!==await Na.expectedtext&&(Na.isSuccess=!1,Na.errorMessage="Expected alert text is "+Na.expectedtext+" however actual text is "+await Lt+"."),Na.errorMessage="Expected alert text is "+await Na.expectedtext+" and actual text is "+await Lt+".");break;case"AssertAlertTextNotContains":Na=await ee(await o),await Na.isSuccess&&(Ot=await e.getAlertText().toString().toLowerCase().trim(),Na.supportingEvidence.AlertText=await Ot,It=await Na.expectedtext.toString().toLowerCase().trim(),await Ot.includes(await It)?(Na.isSuccess=!1,Na.errorMessage="Expected alert text "+await Na.expectedtext+" is present in actual text "+await Ot+"."):Na.errorMessage="Expected alert text "+await Na.expectedtext+" is not present in actual text "+await Ot+".");break;case"AssertUrlContains":if(Na=await zt(await o),await Na.isSuccess){var Ut=await(await e).getCurrentUrl();Na.supportingEvidence.AppUrl=await Ut,await Ut.toString().toLowerCase().trim().includes(await Na.url.toString().toLowerCase().trim())||(Na.isSuccess=!1,Na.errorMessage="Expected window Url is "+await Na.url+" however actual Url is "+await Ut+"."),Na.errorMessage="Expected window Url is "+await Na.url+" and actual Url is "+await Ut+"."}break;case"AssertUrlEquals":Na=await zt(await o),await Na.isSuccess&&(Ut=await(await e).getCurrentUrl(),Na.supportingEvidence.AppUrl=await Ut,await Ut.toString().trim()!==await Na.url.toString().trim()&&(Na.isSuccess=!1,Na.errorMessage="Expected window Url is "+await Na.url+" however actual Url is "+await Ut+"."),Na.errorMessage="Expected window Url is "+await Na.url+" and actual Url is "+await Ut+".");break;case"AssertUrlNotContains":Na=await zt(await o),await Na.isSuccess&&(Ut=await(await e).getCurrentUrl(),Na.supportingEvidence.AppUrl=await Ut,await Ut.toString().toLowerCase().trim().includes(await Na.url.toString().toLowerCase().trim())?(Na.isSuccess=!1,Na.errorMessage="Expected window Url "+await Na.url+" is present in actual Url "+await Ut+"."):Na.errorMessage="Expected window Url "+await Na.url+" is not present in actual Url "+await Ut+".");break;case"AssertWindowCountEquals":if(Na=await $t(await o),await Na.isSuccess){var Vt=await(await e).getAllWindowHandles();Na.supportingEvidence.TotalWindowsCount=await Vt.length,await Vt.length!==Number(await Na.expectedcount)&&(Na.isSuccess=!1,Na.errorMessage="Expected Window count is "+await Na.expectedcount+" however actual count is "+await Vt.length+".")}break;case"IsDisabled":await e.isElementEnabled(await r)&&(Na.isSuccess=!1,Na.errorMessage="Element is not disabled.");break;case"IsDisplayed":ft=await e.isElementDisplayed(await r),await ft||(Na.isSuccess=!1,Na.errorMessage="Element is not displayed.");break;case"IsEnabled":var Rt=await e.isElementEnabled(await r);await Rt||(Na.isSuccess=!1,Na.errorMessage="Element is not enabled.");break;case"IsNotDisplayed":try{ft=await e.isElementDisplayed(await r),await ft&&(Na.isSuccess=!1,Na.errorMessage="Element is displayed.")}catch(a){}break;case"IsSelected":var Jt=await e.isElementSelected(await r);await Jt&&(Na.isSuccess=!1,Na.errorMessage="Element is not in selected state.");break;case"GetContext":const t=await e.getContexts();x.output=await t,Na.errorMessage="Result "+await x.output,Na.additionaldata=await x.output,Na.supportingEvidence.AppContext=await t;break;case"SwitchContext":if(Na=await await async function(a){var t={isSuccess:!0,errorMessage:"",index:0,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a||"{}"==await a.toString().trim())return t.isSuccess=!0,await t;try{var e=await JSON.parse(await a);if(void 0===await e.index)return t.index='Provided value is invalid,  index should be numeric. e.g. {"index":0}',t.isSuccess=!1,await t;var i=await _t(await e.index);if(!await i)return t.errorMessage='Provided value is invalid, index should be numeric. e.g. {"index":0}',t.isSuccess=!1,await t;t.index=await e.index}catch(a){return t.errorMessage='Provided value is invalid,  index should be numeric. e.g. {"index":0}',t.isSuccess=!1,await t}return await t}(await o),await Na.isSuccess){var Xt=await e.getContexts(),Wt=await Xt[Number(await Na.index)];Na.supportingEvidence.ContextName=await Wt,await e.switchContext(await Wt)}else Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage;break;case"IsAppInstalled":Na=await oe(await o),await Na.isSuccess&&(Jt=e.isAppInstalled(await Na.valuetobesend),await Jt||(Na.isSuccess=!1,Na.errorMessage="App "+await Na.valuetobesend+" is not installed on mobile app."));break;case"SaveSessionVariable":if(Na=await pe(await o),await Na.isSuccess){var Yt=await x.output;try{ka=await JSON.parse(await Yt),Yt=await ka.valuetobesend,void 0===await Yt&&(Yt=await ka)}catch(a){}M[await Na.variablename]=await Yt,Na.additionaldata=await Yt,Na.supportingEvidence.SessionVariableValue=await Yt}else{Na.supportingEvidence.SessionVariableValue={};var Gt=await JSON.parse(await o);St=await Object.keys(await Gt);for(let a=0;a<await St.length;a++){var Qt=await St[a],qt=await Gt[await Qt];M[await Qt]=await qt,Na.supportingEvidence.SessionVariableValue[await Qt]=await qt}x.output=await JSON.stringify(await Gt),Na.additionaldata=await JSON.stringify(await Gt),Na.isSuccess=!0}break;case"SaveGlobalVariable":if(Na=await pe(await o),await Na.isSuccess){Yt=await x.output;try{ka=await JSON.parse(await Yt),Yt=await ka.valuetobesend,void 0===await Yt&&(Yt=await ka)}catch(a){}void 0!==await Yt&&await async function(a,t,e,r){try{var n=await a+"/"+await t+"/Mobile/Misc/";await c(await n)||await u(await n);var w=await n+"GlobalVariable.Json";if(!await c(await w)){const a={},t=await JSON.stringify(await a,null,2);await s.writeFileSync(await i+await w,await t)}if(void 0!==await r&&void 0!==await e){var o=await l(await w);o[await e]=await r,await s.writeFileSync(await i+await w,JSON.stringify(await o))}}catch(a){}}(await a,await T,await Na.variablename,await Yt),Ma[await Na.variablename]=await Yt,Na.additionaldata=await Yt,Na.supportingEvidence.GlobalVariableValue=await Yt}else{Na.supportingEvidence.GlobalVariableValue={},Gt=await JSON.parse(await o),St=await Object.keys(await Gt);for(let a=0;a<await St.length;a++)Qt=await St[a],qt=await Gt[await Qt],Ma[await Qt]=await qt,Na.supportingEvidence.GlobalVariableValue[await Qt]=await qt;x.output=await JSON.stringify(await Gt),Na.additionaldata=await JSON.stringify(await Gt),Na.isSuccess=!0}break;case"CreateRequestParametersInSessionVariable":if(Na=await async function(a){var t={isSuccess:!0,totalLength:1,listOfParameters:[],listOfParametersValue:[],variableName:""};if(""===await a.toString().trim()||void 0===await a||"{}"===await a)return t.errorMessage="Provided value is invalid, loopCounter,listOfParameters,listOfParametersValue and variableName keys are expected in value section.",t.isSuccess=!1,await t;try{var e=await JSON.parse(await a),i=await e.totalLength;if(void 0===await i)return t.errorMessage="loopCounter key should be present in value section.",t.isSuccess=!1,await t;if(isNaN(await Number(i)))return t.errorMessage="loopCounter should be a number.",t.isSuccess=!1,t;t.totalLength=await Number(await i);var r=await e.listOfParameters;if(void 0===await r)return t.errorMessage="listOfParameters key should be present in value section.",t.isSuccess=!1,await t;if(!await Array.isArray(await r))return t.errorMessage="listOfParameters key should be list.",t.isSuccess=!1,await t;var s=await r.length;t.listOfParameters=await r;var n=await e.listOfParametersValue;if(void 0===await n)return t.errorMessage="listOfParametersValue key should be present in value section.",t.isSuccess=!1,await t;if(!await Array.isArray(await n))return t.errorMessage="listOfParametersValue key should be list.",t.isSuccess=!1,await t;var w=await n.length;if(await w!==await s)return t.errorMessage="count of listOfParameters and listOfParametersValue is not same.",t.isSuccess=!1,await t;t.listOfParametersValue=await n;var o=await e.variableName;if(void 0===await o)return t.errorMessage="variableName key should be present in value section.",t.isSuccess=!1,await t;t.variableName=await o}catch(a){return t.errorMessage="Provided value is invalid, loopCounter,listOfParameters,listOfParametersValue and variableName keys are expected in value section.",t.isSuccess=!1,await t}return await t}(await o),await Na.isSuccess){Na.supportingEvidence={};var Zt=[],Kt=await Na.variableName,ce=await Na.totalLength;for(let a=0;a<await ce;a++){var le={},me=(St=await Na.listOfParameters,await Na.listOfParametersValue);for(let t=0;t<await St.length;t++){var ve=await St[t],Te=await me[t];try{var Ee=await JSON.parse(await Te);"object"===await typeof await Ee?le[await ve]=await Ee[a]:le[await ve]=await Te}catch(a){le[await ve]=await Te}}Zt.push(await le)}M[await Kt]=await Zt,Na.supportingEvidence[await Kt]=await Zt}else Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage;break;case"GenerateUtilityValue":var Ae,Pe=await typeof await o;if("string"===await Pe)try{Ae=await JSON.parse(await o),Ae=await Ae.valuetobesend,void 0===await Ae&&(Ae=await await o)}catch(a){Ae=await o}x.output=await Ae,Na.additionaldata=await Ae,Na.errorMessage="Result "+await x.output;break;case"CallAPI":Na=await async function(a){var t={isSuccess:!0,errorMessage:"",component:"",testId:"",apiinput:{},supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid,  component and testId should be provided in the value section. e.g. {"component":"MyComponent","testId":"TC-01"}.',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(void 0===await e.component)return t.errorMessage='Provided value is invalid,  component and testId should be provided in the value section. e.g. {"component":"MyComponent","testId":"TC-01"}.',t.isSuccess=!1,await t;if(t.component=await e.component,void 0===await e.testId)return t.errorMessage='Provided value is invalid,  component and testId should be provided in the value section. e.g. {"component":"MyComponent","testId":"TC-01"}.',t.isSuccess=!1,await t;t.testId=await e.testId;var i=await Object.keys(await e);for(let a=0;a<await i.length;a++){var r=await i[a];if("component"!==await r&&"testId"!==await r){var s=await r.toString().toLocaleLowerCase();if(!(await s.startsWith("relativeurl")||await s.startsWith("requestheader")||await s.startsWith("requestbody")))return t.errorMessage='Provided value is invalid,  you can only override the requestUrl , requestHeader and requestBody key , example {"component":"MyComponent","testId":"TC-01","relativeUrl":"/mytestid/testid","requestHeader[Accept]","application/json","requestBody[id]":"myUser"}',t.isSuccess=!1,await t;t.apiinput[await r]=await e[await r]}}}catch(a){return t.errorMessage="Provided value is invalid . "+await a.toString(),t.isSuccess=!1,await t}return await t}(await o),await Na.isSuccess?(Na=await f(await T,await Na.component,await Na.testId,await ya,await Na.apiinput),x.output=JSON.stringify(await Na.output),Na.supportingEvidence.APIResponseData=await Na.output):(Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage);break;case"SaveAPIResponseInSessionVariable":if(Na=await async function(a){var t={isSuccess:!0,errorMessage:"",variable:{},supportingEvidence:{}},e=[];if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid,  variable name should be provided. e.g. {"myVar":"ResponseHeader[KeyName]","myVar2":"ResponseBody[KeyName]"}.',t.isSuccess=!1,await t;try{var i=await JSON.parse(await a),r=await Object.keys(await i);if(0===await r.length)return t.errorMessage='Provided value is invalid,  variable name should be provided. e.g. {"myVar":"ResponseHeader[KeyName]","myVar2":"ResponseBody[KeyName]"}.',t.isSuccess=!1,await t;for(let a=0;a<await r.length;a++){var s=await r[a];if("testId"!==await s&&"component"!==await s){if(await e.includes(await s))return t.errorMessage="Provided value is invalid,  Duplicate variable "+await s+" are found.}.",t.isSuccess=!1,await t;await e.push(await await s);var n=await i[await s];if(!(await n.toLocaleLowerCase().startsWith("responseheader")||await n.toLocaleLowerCase().startsWith("responsebody")||await n.toLocaleLowerCase().startsWith("requestheader")||await n.toLocaleLowerCase().startsWith("requestbody")))return t.errorMessage="Provided value is invalid,  Session variable either can be extracted from ResponseHeader or ResponseBody key}.",t.isSuccess=!1,await t;t.variable[await s]="",t.variable[await s]=await n}}}catch(a){return t.errorMessage="Provided value is invalid . "+await a.toString(),t.isSuccess=!1,await t}return await t}(await o),await Na.isSuccess){var Ce=await JSON.parse(await x.output),ke=(Ua=await Na.variable,await Object.keys(await Ua));Na.supportingEvidence.APIResponseVariableData={};for(let a=0;a<await ke.length;a++){var je=await ke[await a],Oe=await Ua[await je],Ie=await y(await Oe);if(qt=await b(await Ce,await Ie),void 0===await qt){Na.isSuccess=!1,Na.errorMessage=await qt+" does not exist in API Response";break}M[await je]=await qt,Na.supportingEvidence.APIResponseVariableData[await je]=await qt}}else Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage;break;case"AssertIsNumberInAscendingOrder":if(Na=await oe(await o),await Na.isSuccess){var Le=Na.valuetobesend;Na=await async function(a){var t={isSuccess:!0,errorMessage:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage="Provided value is invalid, valuetobesend should be provided in value section e.g. [1,2.3,4]",t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);try{var i=await e.length,r=[];for(let a=0;a<await i.length;a++){var s=await Se(i[a]);if(isNaN(await s))return t.errorMessage="Provided value is invalid, it takes number only e.g. [1,2.3,4]",t.isSuccess=!1,await t;s=await Number(await s),r.push(await s)}var n=await async function(a){for(let t=0;t<await a.length-1;t++)if(a[t]>a[t+1])return!1;return!0}(await r);if(!await n)return t.errorMessage="Numbers  "+await JSON.stringify(await r)+" are in list are not in AscendingOrder.",t.isSuccess=!1,await t}catch(a){return t.errorMessage="Provided value is invalid, valuetobesend should be provided in value section e.g. [1,2.3,4]",t.isSuccess=!1,await t}}catch(a){return t.errorMessage="Provided value is invalid, valuetobesend should be provided in value section e.g. [1,2.3,4]",t.isSuccess=!1,await t}return await t}(await Le)}else Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage;break;case"AssertIsNumberInDescendingOrder":Na=await oe(await o),await Na.isSuccess?(Le=Na.valuetobesend,Na=await async function(a){var t={isSuccess:!0,errorMessage:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage="Provided value is invalid, valuetobesend should be provided in value section e.g. [1,2.3,4]",t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);try{var i=await e.length,r=[];for(let a=0;a<await i.length;a++){var s=await Se(i[a]);if(isNaN(await s))return t.errorMessage="Provided value is invalid, it takes number only e.g. [1,2.3,4]",t.isSuccess=!1,await t;s=await Number(await s),r.push(await s)}var n=await async function(a){for(let t=0;t<await a.length-1;t++)if(a[t]<a[t+1])return!1;return!0}(await r);if(!await n)return t.errorMessage="Numbers  "+await JSON.stringify(await r)+" are in list are not in Descending Order.",t.isSuccess=!1,await t}catch(a){return t.errorMessage="Provided value is invalid, valuetobesend should be provided in value section e.g. [1,2.3,4]",t.isSuccess=!1,await t}}catch(a){return t.errorMessage="Provided value is invalid, valuetobesend should be provided in value section e.g. [1,2.3,4]",t.isSuccess=!1,await t}return await t}(await Le)):(Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage);break;case"AssertIsListSorted":Na=await oe(await o),await Na.isSuccess?(Le=Na.valuetobesend,Na=await async function(a){var t={isSuccess:!0,errorMessage:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, valuetobesend should be provided in value section e.g. ["a","b"]',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);try{var i=await e.length,r=[];for(let a=0;a<await i.length;a++)r.push(await numberToPush);var s=await async function(a){const t=await[...a].sort();return JSON.stringify(await a)===await JSON.stringify(await t)}(await r);if(!await s)return t.errorMessage="value  "+await JSON.stringify(await r)+" are in list are not sorted.",t.isSuccess=!1,await t}catch(a){return t.errorMessage='Provided value is invalid, valuetobesend should be provided in value section e.g. ["a","b"]',t.isSuccess=!1,await t}}catch(a){return t.errorMessage='Provided value is invalid, valuetobesend should be provided in value section e.g. ["a","b"]',t.isSuccess=!1,await t}return await t}(await Le)):(Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage);break;case"ReadPdfFile":Na=await te(await o,await T),await Na.isSuccess?(Na=await p(await T,"Web",await Na.filename),x.output=await Na.output,Na.supportingEvidence.PDFData=await x.output):(Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage);break;case"PdfTotalPageCountShouldBe":Na=await async function(a){var t={isSuccess:!0,errorMessage:"",filename:"",expectedCount:0,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"mydoc.pdf","expectedCount":1}',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(void 0===await e.filename)return t.errorMessage='Provided value is invalid, filename key is missing.correct format is {"filename":"mydoc.pdf","expectedCount":1}',t.isSuccess=!1,await t;if(t.filename=await e.filename.toString().trim(),void 0===await e.expectedCount)return t.errorMessage='Provided value is invalid, expectedCount key is missing.correct format is {"filename":"mydoc.pdf","expectedCount":1}',t.isSuccess=!1,await t;var i=await Number(await e.expectedCount);if(NaN===await i)return t.errorMessage='Provided value is invalid, expectedCount key should be number.correct format is {"filename":"mydoc.pdf","expectedCount":1}',t.isSuccess=!1,await t;t.expectedCount=Number(await i)}catch(a){return t.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"mydoc.pdf","expectedCount":1}',t.isSuccess=!1,await t}return await t}(await o),await Na.isSuccess?Na=await m(await T,"Web",await Na.filename,await Na.expectedCount):(Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage);break;case"ExcelRowCountShouldBe":if(Na=await xe(await o),await Na.isSuccess){var Fe=await Na.expectedCount;Na=await v(await T,"Web",await Na.filename,await Na.sheetname),await Na.isSuccess&&(Na.supportingEvidence.ActualExcelRowCount=Number(await Na.output),Number(await Fe)!==Number(await Na.output)&&(Na.isSuccess=!1,Na.errorMessage="Expected row count "+await Fe+" does not match with actual row count "+await Na.output))}else Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage;break;case"ExcelRowCountShouldBeGreaterThan":Na=await xe(await o),await Na.isSuccess?(Fe=await Na.expectedCount,Na=await v(await T,"Web",await Na.filename,await Na.sheetname),await Na.isSuccess&&(Na.supportingEvidence.ActualExcelRowCount=Number(await Na.output),Number(await Fe)>Number(await Na.output)||(Na.isSuccess=!1),Na.errorMessage="Expected row count is "+await Fe+" and actual row count "+await Na.output)):(Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage);break;case"ExcelRowCountShouldBeLessThan":Na=await xe(await o),await Na.isSuccess?(Fe=await Na.expectedCount,Na=await v(await T,"Web",await Na.filename,await Na.sheetname),await Na.isSuccess&&(Na.supportingEvidence.ActualExcelRowCount=Number(await Na.output),Number(await Fe)<Number(await Na.output)||(Na.isSuccess=!1),Na.errorMessage="Expected row count is "+await Fe+" and actual row count "+await Na.output)):(Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage);break;case"SaveExcelColumnValueInSessionVariable":if(Na=await xe(await o,!1),await Na.isSuccess){var Ue=await Na.filename,Ve=await Na.sheetname;if(Na=await async function(a){var t={isSuccess:!0,errorMessage:"",rowIndex:0,excelcolumn:{},supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"rowIndex":1,"ColumnName":"Your Variable name"}',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(void 0===await e.rowIndex)return t.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"rowIndex":1,"ColumnName":"Your Variable name"}',t.isSuccess=!1,await t;var i=await Number(await e.rowIndex);if(await Number(NaN===await e.rowIndex))return t.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"rowIndex":1,"ColumnName":"Your Variable name"}',t.isSuccess=!1,await t;t.rowIndex=Number(await i);var r=await Object.keys(await e);for(let a=0;a<await r.length;a++){var s=await r[a],n=await s.toString().toLocaleLowerCase();"filename"!==await n&&"sheetname"!==await n&&"rowindex"!==await n&&(t.excelcolumn[await s]=await e[await s])}if(0===Object.keys(await t.excelcolumn).length)return t.errorMessage='Provided value is invalid, Provide atleast one excel column name which need to be fetched e.g. {"ColumnName":"Your Variable name"}',t.isSuccess=!1,await t}catch(a){return t.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"rowIndex":1,"ColumnName":"Your Variable name"}',t.isSuccess=!1,await t}return await t}(await o),await Na.isSuccess){Ia=await Na.rowIndex;var Be=await Na.excelcolumn;if(Na=await g(await T,"Web",await Ue,await Ve),await Na.isSuccess){Na.supportingEvidence.ExcelColumnData={},ut=await Na.output,St=await Object.keys(await Be);for(let a=0;a<await St.length;a++){var Re=await St[a],Je=await Be[await Re];const t=await h(await Ia,await Re,await ut);void 0===await t&&(Na.isSuccess=!1,Na.errorMessage="Excel column "+await Re+" does not existing in Excel file."),M[await Je]=await t,Na.supportingEvidence.ExcelColumnData[await Re]=await t}try{x.output=await JSON.stringify(await M)}catch(a){}}}}else Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage;break;case"SaveColumnValuesBasedOnConditionalColumnAndValue":if(Na=await getValueForExcelFileForConditionalColumn(await o),await Na.isSuccess){Ue=await Na.filename,Ve=await Na.sheetname;var Xe=await await Na.conditionalcolumnname,We=await await Na.conditionalcolumnvalues,Ye=await await Na.columnnametofetch;if(Na=await g(await T,"Web",await Ue,await Ve),await Na.isSuccess){Na.supportingEvidence.ExcelColumnData={},ut=await Na.output;const a=await d(await ut,await Xe,await We,await Ye);for(let t=0;t<await Ye.length;t++){var Ge=await Ye[t];Na.supportingEvidence.ExcelColumnData[await Ge]=[],M[await Ge]=await a[await Ge],Na.supportingEvidence.ExcelColumnData[await Ge]=await a[await Ge]}try{x.output=await JSON.stringify(await M)}catch(a){}}}else Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage;break;case"AssertStringLengthShouldBe":if(Na=await async function(a){var t={isSuccess:!0,supportingEvidence:{},inputstring:"",expectedlength:0};if(""===await a.toString().trim()||void 0===await a||"{}"===await a)return t.errorMessage="Provided value is invalid, inputstring and expectedlength keys are expected in value section.",t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(0==await Object.keys(await e).length)return t.errorMessage="Provided value is invalid, inputstring and expectedlength keys are expected in value section.",t.isSuccess=!1,await t;var i=await e.inputstring;if(void 0===await i)return t.errorMessage="Provided value is invalid, inputstring and expectedlength keys are expected in value section.",t.isSuccess=!1,await t;t.inputstring=await i;var r=await e.expectedlength;if(void 0===await r)return t.errorMessage="Provided value is invalid, inputstring and expectedlength keys are expected in value section.",t.isSuccess=!1,await t;if(isNaN(await r))return t.errorMessage="Provided value is invalid, expectedlength should be number",t.isSuccess=!1,await t;t.expectedlength=await r}catch(a){return t.errorMessage="Provided value is invalid, inputstring and expectedlength keys are expected in value section.",t.isSuccess=!1,await t}return await t}(await o),await Na.isSuccess){var Qe=await Na.inputstring.toString().length;Na.supportingEvidence.ActualStringLength=await Qe;var qe=await Number(await Na.expectedlength);await Qe!==qe&&(Na.isSuccess=!1,Na.errorMessage="Actual string length "+await Qe+" does not match with expected String length "+await qe)}else Na.isSuccess=!1,Na.errorMessage=await Na.errorMessage;break;case"Array.DeleteItem":x.output=[];var Ze=await De(await o);if(!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;o=await JSON.parse(await o);var Ke=await o.userInput;if("string"===await typeof await Ke&&(Ke=await JSON.parse(await Ke)),void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if("object"!==await typeof await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput should be array in value section.",await Na;var He=await o.itemToDelete;if(void 0===await He)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.itemToDelete key is missing in value section.",await Na;x.output=await ca(await Ke,await He),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Array.DeleteItemBasedOnIndex":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,"string"===await typeof await Ke&&(Ke=await JSON.parse(await Ke)),void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if("object"!==await typeof await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput should be array in value section.",await Na;if(He=await o.indexPosition,void 0===await He)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. indexPosition key is missing in value section.",await Na;if(He=await Number(await He),await isNaN(await He))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. indexPosition value should be number in value section.",await Na;if(await He>=await Ke.length)return Na.isSuccess=!1,Na.errorMessage="indexPosition value "+await He+"  is greater than array size "+await Ke.length,await Na;x.output=await ua(await Ke,await He),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Array.GetValueBasedOnIndex":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,"string"===await typeof await Ke&&(Ke=await JSON.parse(await Ke)),void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if("object"!==await typeof await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput should be array in value section.",await Na;if(He=await o.indexPosition,void 0===await He)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. indexPosition key is missing in value section.",await Na;if(He=await Number(await He),await isNaN(await He))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. indexPosition value should be number in value section.",await Na;if(await He>=await Ke.length)return Na.isSuccess=!1,Na.errorMessage="indexPosition value "+await He+"  is greater than array size "+await Ke.length,await Na;x.output=await la(await Ke,await He),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Array.Length":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,"string"===await typeof await Ke&&(Ke=await JSON.parse(await Ke)),void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if("object"!==await typeof await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput should be array in value section.",await Na;x.output=await q(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Array.ExcludeCharacters":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;var _e=await o.excludeCharacters;if(!Array.isArray(await _e))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.excludeCharacters should be array in value section.",await Na;x.output=await j(await Ke,await _e),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Array.Sort":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,"string"===await typeof await Ke&&(Ke=await JSON.parse(await Ke)),void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if("object"!==await typeof await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput should be array in value section.",await Na;x.output=await ma(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Array.Push":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,"string"===await typeof await Ke&&(Ke=await JSON.parse(await Ke)),void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if("object"!==await typeof await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput should be array in value section.",await Na;var ze=await o.newElement;if(void 0===await ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. newElement key is missing in value section.",await Na;x.output=await da(await Ke,await ze),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Array.Search":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,"string"===await typeof await Ke&&(Ke=await JSON.parse(await Ke)),void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if("object"!==await typeof await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput should be array in value section.",await Na;var $e=await o.searchItem;if(void 0===await $e)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. searchItem key is missing in value section.",await Na;x.output=await pa(await Ke,await $e),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Array.Sort":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,"string"===await typeof await Ke&&(Ke=await JSON.parse(await Ke)),void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if("object"!==await typeof await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput should be array in value section.",await Na;x.output=await ma(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Array.SortDesc":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,"string"===await typeof await Ke&&(Ke=await JSON.parse(await Ke)),void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if("object"!==await typeof await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput should be array in value section.",await Na;x.output=await va(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Array.SumOfArray":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,"string"===await typeof await Ke&&(Ke=await JSON.parse(await Ke)),void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if("object"!==await typeof await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput should be array in value section.",await Na;x.output=await ga(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Date.getDate":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;o=await JSON.parse(await o);var ai=await o.addorDaysfromPresentDate;if(void 0===await ai)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.addorDaysfromPresentDate key is missing in value section.",await Na;if(ai=await Number(await ai),await isNaN(await ai))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. addorDaysfromPresentDate value should be number in value section.",await Na;var ti=await o.dateTemplate;if(void 0===await ti)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.dateTemplate key is missing in value section.",await Na;x.output=await na(await ai,await ti),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Date.FormatDateTemplate":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;var ei=await o.initialDateTemplate;if(void 0===await ei)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.initialDateTemplate key is missing in value section.",await Na;var ii=await o.expectedDateTemplate;if(void 0===await ii)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.expectedDateTemplate key is missing in value section.",await Na;x.output=await oa(await Ke,await ei,await ii),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Date.GetDateDifference":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;o=await JSON.parse(await o);var ri=await o.startDate;if(void 0===await ri)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.startDate key is missing in value section.",await Na;var si=await o.startDateTemplate;if(void 0===await si)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.startDateTemplate key is missing in value section.",await Na;var ni=await o.endDate;if(void 0===await ni)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.endDate key is missing in value section.",await Na;var wi=await o.endDateTemplate;if(void 0===await wi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.endDateTemplate key is missing in value section.",await Na;var oi=await o.diffIn;if(void 0===await oi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.diffIn key is missing in value section.",await Na;x.output=await wa(await ri,await si,await ni,await wi,await oi),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Math.Abs":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if(Ke=await Number(await Ke),await isNaN(await Ke))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. userInput value should be number in value section.",await Na;x.output=await ra(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Math.AddPercentage":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if(Ke=await Number(await Ke),await isNaN(await Ke))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. userInput value should be number in value section.",await Na;var ci=await o.percentageValue;if(void 0===await ci)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.percentageValue key is missing in value section.",await Na;if(ci=await Number(await ci),await isNaN(await ci))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. percentageValue value should be number in value section.",await Na;var ui=await o.numberToShowafterDecimal;if(void 0===await ui)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await Na;if(ui=await Number(await ui),await isNaN(await ui))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await Na;x.output=await sa(await Ke,await ci,await ui),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Math.AddTwoNumber":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if(Ke=await Number(await Ke),await isNaN(await Ke))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. userInput value should be number in value section.",await Na;var li=await o.userInput2;if(void 0===await li)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput2 key is missing in value section.",await Na;if(li=await Number(await li),await isNaN(await li))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. userInput2 value should be number in value section.",await Na;if(ui=await o.numberToShowafterDecimal,void 0===await ui)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await Na;if(ui=await Number(await ui),await isNaN(await ui))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await Na;x.output=await ia(await Ke,await li,await ui),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Math.Ceil":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if(Ke=await Number(await Ke),await isNaN(await Ke))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. userInput value should be number in value section.",await Na;x.output=await ea(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Math.DivideTwoNumber":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;o=await JSON.parse(await o);var di=await o.dividend;if(void 0===await di)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.dividend key is missing in value section.",await Na;if(di=await Number(await di),await isNaN(await di))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. dividend value should be number in value section.",await Na;var pi=await o.divisor;if(void 0===await pi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.divisor key is missing in value section.",await Na;if(pi=await Number(await pi),await isNaN(await pi))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. divisor value should be number in value section.",await Na;if(ui=await o.numberToShowafterDecimal,void 0===await ui)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await Na;if(ui=await Number(await ui),await isNaN(await ui))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await Na;x.output=await ta(await di,await pi,await ui),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Math.Floor":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if(Ke=await Number(await Ke),await isNaN(await Ke))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. userInput value should be number in value section.",await Na;x.output=await aa(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Math.GetPercentage":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if(Ke=await Number(await Ke),await isNaN(await Ke))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. userInput value should be number in value section.",await Na;var mi=await o.percentageToCalculate;if(void 0===await mi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.percentageToCalculate key is missing in value section.",await Na;if(mi=await Number(await mi),await isNaN(await mi))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. percentageToCalculate value should be number in value section.",await Na;if(ui=await o.numberToShowafterDecimal,void 0===await ui)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await Na;if(ui=await Number(await ui),await isNaN(await ui))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await Na;x.output=await $(await Ke,await mi,await ui),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Math.MultiplyTwoNumber":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if(Ke=await Number(await Ke),await isNaN(await Ke))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. userInput value should be number in value section.",await Na;if(li=await o.userInput2,void 0===await li)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput2 key is missing in value section.",await Na;if(li=await Number(await li),await isNaN(await li))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. userInput2 value should be number in value section.",await Na;if(ui=await o.numberToShowafterDecimal,void 0===await ui)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await Na;if(ui=await Number(await ui),await isNaN(await ui))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await Na;x.output=await z(await Ke,await li,await ui),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Math.Reminder":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),di=await o.dividend,void 0===await di)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.dividend key is missing in value section.",await Na;if(di=await Number(await di),await isNaN(await di))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. dividend value should be number in value section.",await Na;if(pi=await o.divisor,void 0===await pi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.divisor key is missing in value section.",await Na;if(pi=await Number(await pi),await isNaN(await pi))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. divisor value should be number in value section.",await Na;x.output=await _(await di,await pi),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Math.Round":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if(Ke=await Number(await Ke),await isNaN(await Ke))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. userInput value should be number in value section.",await Na;if(ui=await o.numberToShowafterDecimal,void 0===await ui)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await Na;if(ui=await Number(await ui),await isNaN(await ui))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await Na;x.output=await H(await Ke,await ui),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Math.SubtractPercentage":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if(Ke=await Number(await Ke),await isNaN(await Ke))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. userInput value should be number in value section.",await Na;if(ci=await o.percentageValue,void 0===await ci)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.percentageValue key is missing in value section.",await Na;if(ci=await Number(await ci),await isNaN(await ci))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. percentageValue value should be number in value section.",await Na;if(ui=await o.numberToShowafterDecimal,void 0===await ui)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await Na;if(ui=await Number(await ui),await isNaN(await ui))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await Na;x.output=await K(await Ke,await ci,await ui),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"Math.SubtractTwoNumber":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if(Ke=await Number(await Ke),await isNaN(await Ke))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. userInput value should be number in value section.",await Na;if(li=await o.userInput2,void 0===await li)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput2 key is missing in value section.",await Na;if(li=await Number(await li),await isNaN(await li))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. userInput2 value should be number in value section.",await Na;if(ui=await o.numberToShowafterDecimal,void 0===await ui)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await Na;if(ui=await Number(await ui),await isNaN(await ui))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await Na;x.output=await Z(await Ke,await li,await ui),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"String.Concat":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if(li=await o.userInput2,void 0===await li)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput2 key is missing in value section.",await Na;x.output=await Q(await Ke,await li),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"String.EndsWith":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;var vi=await o.searchString;if(void 0===await vi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.searchString key is missing in value section.",await Na;x.output=await G(await Ke,await vi),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"List.GetUniqueValues":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;x.output=await D(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"String.ExtractNumberFromTheString":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;var gi=await o.willYouremoveDot;if(void 0===await gi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.willYouremoveDot key is missing in value section.",await Na;x.output=await Y(await Ke,await gi),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"String.Length":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;x.output=await W(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"String.RemoveNumberFromTheString":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;x.output=await X(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"String.Replace":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;var hi=await o.valueToReplace;if(void 0===await hi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.valueToReplace key is missing in value section.",await Na;var fi=await o.replaceBy;if(void 0===await fi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.valueToReplace key is missing in value section.",await Na;x.output=await J(await Ke,await hi,await fi),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"String.Split":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;var yi=await o.delimiter;if(void 0===await yi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.delimiter key is missing in value section.",await Na;x.output=await R(await Ke,await yi),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"String.SplitandSaveValueAsPerIndex":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if(yi=await o.delimiter,void 0===await yi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.delimiter key is missing in value section.",await Na;var bi=await o.indexToSave;if(void 0===await bi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.indexToSave key is missing in value section.",await Na;if(bi=await Number(await bi),await isNaN(await bi))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. indexToSave value should be number in value section.",await Na;x.output=await B(await Ke,await yi,await bi),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"String.StartsWith":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;if(vi=await o.searchString,void 0===await vi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.searchString key is missing in value section.",await Na;x.output=await V(await Ke,await vi),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"String.Substring":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;var Si=await o.startPosition;if(void 0===await Si)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.startPosition key is missing in value section.",await Na;if(Si=await Number(await Si),await isNaN(await Si))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. startPosition value should be number in value section.",await Na;var xi=await o.endPosition;if(void 0!==await vi&&(xi=await Number(await xi),await isNaN(await xi)))return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid. endPosition value should be number in value section.",await Na;x.output=await U(await Ke,await Si,await xi),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"String.ToLowerCase":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;x.output=await F(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"String.ToUpperCase":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;x.output=await L(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"String.Trim":if(x.output="",Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Ke=await o.userInput,void 0===await Ke)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.userInput key is missing in value section.",await Na;x.output=await I(await Ke),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"JSON.getKeyValue":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;o=await JSON.parse(await o);var Mi=await o.JsonData;if(void 0===await Mi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.JsonData key is missing in value section.",await Na;if("object"!==await typeof await Mi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.JsonData should be Json Object in value section.",await Na;var Ni=await o.keyName;if(void 0===await Ni)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.keyName key is missing in value section.",await Na;x.output=await O(await Mi,await Ni),Na.supportingEvidence.UtilityFunctionOutput=await x.output;break;case"PushFile":if(Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;o=await JSON.parse(await o);var Ti=await o.devicePath;if(void 0===await Ti)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.devicePath key is missing in value section.",await Na;if(Ue=await o.fileName,void 0===await Ue)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.fileName key is missing in value section.",await Na;var Ei=await i+await T+"/Mobile/Uploads/*"+await Ue+"*";if(jt=await n.sync(await Ei),0===await jt.length)return Na.isSuccess=!1,Na.errorMessage="Provided file name does not exist on the server.",await Na;var Ai=await jt[await jt.length-1];const Pi=await s.readFileSync(await Ai,{encoding:"base64"});await e.pushFile(await Ti,await Pi);break;case"LaunchMobileApplication":if(x.output=[],Ze=await De(await o),!await Ze)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await Na;if(o=await JSON.parse(await o),Mi=await o.JsonData,"object"!==await typeof await Mi)return Na.isSuccess=!1,Na.errorMessage="Provided value is invalid.JsonData should be Json Object in value section.",await Na;break;default:Na.isSuccess=!1,Na.errorMessage="Method not found."}}catch(a){void 0===Na.supportingEvidence&&(Na.supportingEvidence={}),Na.isSuccess=!1,Na.errorMessage=await a.toString(),Na.supportingEvidence.errorMessage=await a.toString()}return void 0===Na.supportingEvidence&&(Na.supportingEvidence={},Na.isSuccess||(Na.supportingEvidence.errorMessage=Na.errorMessage)),await Na}async function Ot(a,t,e,i,r,s,n,w,o){try{"{}"===await a&&(a="");var c=await JSON.parse(await a),u=await Object.keys(await c)[0];if(void 0===await u){a=await Rt(await a,await s,await t,await e,await i,await r,await n,await w,await o),a=await It(await a);try{await a.toString().includes("{{+}}")&&(a=await a.toString().replace(/\{\{\+\}\}/g,"+"))}catch(a){}return await a}var l={},d=await Object.keys(await c);for(let a=0;a<await d.length;a++){var p=await d[a],m=await c[await p];if("object"==typeof await m){if(await Array.isArray(await m)){var v=[],g=await m.length;for(let a=0;a<await g;a++){var h=await m[await a];h=await Ot(await h,await t,await e,await i,await r,await s,await n,await w,await o),v.push(await h)}}else{v={};var f=await Object.keys(await m);for(let a=0;a<await f.length;a++){var y=await f[a];h=await m[await y],y=await Ot(await y,await t,await e,await i,await r,await s,await n,await w,await o),h=await Ot(await h,await t,await e,await i,await r,await s,await n,await w,await o),v[await y]=await h}}try{await Array.isArray(await v)||await v,l[await p.toString()]=await v}catch(a){l[await p.toString()]=await v}}else{try{m=await Rt(await m,await s,await t,await e,await i,await r,await n,await w,await o),m=await It(await m)}catch(a){}try{await m.toString().includes("{{+}}")&&(m=await m.toString().replace(/\{\{\+\}\}/g,"+"))}catch(a){}try{await Array.isArray(await m)||await m,l[await p.toString()]=await m}catch(a){l[await p.toString()]=await m}}}return await JSON.stringify(await l)}catch(c){a=await Rt(await a,await s,await t,await e,await i,await r,await n,await w,await o),a=await It(await a);try{await a.toString().includes("{{+}}")&&(a=await a.toString().replace(/\{\{\+\}\}/g,"+"))}catch(a){}return a=await Oe(await a),await a}}async function It(a){var t=await async function(a){return a=await a.toString().toLocaleLowerCase(),!!await a.includes("utility.")}(await a);if(!await t)return await a;var e="";let i=await a.split(/\+(?!\})|(?<=\{\{)\+\+(?=\}\})/);for(let a=0;a<await i.length;a++){var r=await i[a];e=await e+await Kt(await r)}return await e}async function Lt(a){var t=await a.split("||"),e=await t[0].split("(")[0];switch(await e){case"firstName":return await Ma();case"url":return await Sa();case"sumOfArray":var i=await t[1];return i=await i.split(")")[0],await Qa(await i);case"lastName":return await Na();case"address":return await Ta();case"email":return await xa();case"uuid":return await Ea();case"country":return await Aa();case"state":return await Ca();case"city":return await ka();case"zipCode":return await ja();case"phoneNumber":return await Pa();case"phoneimei":return await Mt();case"word":return i=await t[1],i=void 0===(i=await i.split(")")[0])?1:await Number(i),await Da(await i);case"string":return i=await t[1],i=void 0===(i=await i.split(")")[0])?10:await Number(i),await La(await i);case"number":i=await t[1];var r=1,s=99999;return void 0!==(i=await i.split(")")[0])&&(r=await Number(i.split(",")[0]),s=await Number(i.split(",")[1])),await Oa(await r,await s);case"date":i=await t[1];var n=0,w="DD MMM yyyy";if(void 0!==(i=await i.split(")")[0])){n=await Number(i.split(",")[0]),w=await i.split(",")[1];try{var o=await i.split(",")[2]}catch(a){o=void 0}}var c=await Ia(await n,await w,await o);return await c;case"getDateDifference":i=await t[1],n=0;var u="",l="",d="",p="DD-MMM-yyyy",m="DD-MMM-yyyy";if(void 0!==(i=await i.split(")")[0])){u=await i.split(",")[0],l=await i.split(",")[1];try{d=await i.split(",")[2],void 0===await d&&(d="days")}catch(a){d="days"}try{p=await i.split(",")[3],void 0===await p&&(p="DD-MMM-yyyy")}catch(a){p="DD-MMM-yyyy"}try{m=await i.split(",")[4],void 0===await m&&(m="DD-MMM-yyyy")}catch(a){m="DD-MMM-yyyy"}}return c=await xt(await u,await l,await d,await p,await m),await c;case"extractNumberFromString":i=await t[1];var v="",g=!0;if(void 0===(i=await i.split(",")))return 0;v=await await i[0];try{g=await i[1],g="true"===await g.toLocaleLowerCase()}catch(a){g=!0}return await Fa(await v,await g);case"splitAndSaveIndexValue":i=await t[1],v="";var h="",f="";if(void 0===(i=await i.split(",")))return"Error-Provide correct Input";v=await i[0];try{h=await i[1]}catch(a){h=""}try{f=await Number(await i[2])}catch(a){f=0}return await Ua(await v,await h,await f);case"addTwoNumber":i=await t[1];var y=0,b=0,S=0;if(g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await Va(await y,await b,await S);case"subtractTwoNumber":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await Ba(await y,await b,await S);case"multiplyTwoNumber":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await Ra(await y,await b,await S);case"devideTwoNumber":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await Ra(await y,await b,await S);case"reminderTwoNumber":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await Ra(await y,await b,await S);case"getPercentage":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await Wa(await y,await b,await S);case"addPercentageInNumber":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await Ya(await y,await b,await S);case"subtractPercentageInNumber":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await Ga(await y,await b,await S);case"ipv4":return await qa();case"ipv6":return await Za();case"airline":return await Ka();case"airplane":return await Ha();case"flightNumber":return await _a();case"accountName":return await za();case"accountNumber":return await $a();case"creditCardCVV":return await at();case"creditCardIssuer":return await tt();case"creditCardNumber(cardtype)":return i=await t[1],void 0===(i=await i.split(")")[0])&&(i="visa"),await et(await i);case"bicycle":return awaitgetbicycle();case"color":return await rt();case"fuel":return await st();case"model":return await nt();case"vehicle":return await wt();case"vin":return await ot();case"vrm":return await ct();case"department":return await ut();case"product":return await lt();case"productDescription":return await dt();case"productMaterial":return await pt();case"productName":return await mt();case"jobTitle":return await vt();case"jobType":return await gt();case"zodiacSign":return await ht();case"mac":return await ft();case"userAgent":return await yt();case"domainName":return await bt();case"avatar":return await St();default:return""}}async function Ft(a,t){}async function Ut(a){try{var t=await(await a).switchTo().alert(),e=await t.getText(),i=await r.generate(await e);return i=await i.split(",")[1],await i}catch(t){try{return e=await(await a).takeScreenshot(),await e}catch(a){}}return""}async function Vt(a,t,e,r,n,w,u){var l="",d=!1;try{var p=" ";p=await w?await(await t).getAttribute("outerHTML"):await(await t[0]).getAttribute("outerHTML"),r=await r.concat(await(["maxlength","type","role","autocomplete","tabindex","aria-invalid","rows","class"]));var m=await p.split(" ");for(let t=1;t<await m.length;t++)try{var v=await m[t],g=await v.split("=")[0];if(!await r.includes(await g)){var h=await v.split("=")[1];h=await h.replace(/(^"|"$)/g,""),l="//*[@"+await g+"='"+await h+"']";var f=await(await a).findElements(N.xpath(await l));if(await w){if(1==await f.length){d=!0;break}if(await f.length>1){l=await l+"[1]",d=!0;break}}else if(await f.length>0){d=!0;break}}}catch(a){}if(!await d)try{var y=await(await t).getText();l="//*[contains(text(),'"+await y+"')]",f=await(await a).findElements(N.xpath(await l)),await w?1==await f.length?d=!0:await f.length>1&&(l=await l+"[1]",d=!0):await f.length>0&&(d=!0)}catch(a){}await d||(l="")}catch(a){}if(""!==await l&&void 0!==await l&&null!==await l){var b={};try{var S=await c(await n+"/Mobile/OR.json");if(await S){var x=await i+await n+"/Mobile/OR.json";b=await JSON.parse(await s.readFileSync(await x,"utf8")),void 0!==await b[await e]&&(b[await e].alternatexpath=await l,await o(await n+"/Mobile/OR.json",await b))}}catch(a){}}return await l}async function Bt(a,t,e,i){var r={isElementInOr:!1,isElementPresent:!1,errorMessage:""},s=null;r.webElement=s,await Ft(await a);try{var n=await e[await t.toString().toUpperCase()];if(void 0===await n)return r.errorMessage=await t+" does not exist in OR repository.",await r;r.isElementInOr=!0;var w=await n.locator;if("Android"===await i)var o=await n.locatorproperty,c=await n.alternatexpath;else o=await n.ioslocatorproperty,c=await n.iosalternatexpath;if("xpath"===await w.toString().trim().toLowerCase())s=await a.findElement("xpath",await o);else{if(w=await w.toString().toLocaleLowerCase(),await w.includes("accessibility"))var u="//*[@*[contains(.,'"+await o+"')]]";else u="//*[contains(@"+w+",'"+o+"')]";s=await a.findElement("xpath",await u)}s=await s["element-6066-11e4-a52e-4f735466cecf"],r.isElementPresent=!0}catch(t){var l=await t.message;if(""!==await c.trim())try{s=await a.findElement("xpath",await c),s=await s["element-6066-11e4-a52e-4f735466cecf"],r.isElementPresent=!0}catch(a){r.errorMessage=await l}else r.isElementPresent=!1,r.errorMessage=await l}return r.webElement=await s,await r}async function Rt(a,t,e,i,r,s,n,w,o){try{var c=await a;if(await typeof await a,""===await a.trim())return await a;var u=await a.toLocaleLowerCase(),l=await Zt(await u);if(!await l)return await a;var d=await a.split("||");for(let c=0;c<await d.length;c++){var p=await d[c].split(",");for(let c=0;c<await p.length;c++){var m=await p[c].split("+");for(let c=0;c<await m.length;c++){var v=await m[c].split("=");for(let c=0;c<await v.length;c++){var g=await v[c];await Zt(await g)&&(a=await Jt(await a,await g,await t),a=await Wt(await a,await g,await e,await w),a=await Yt(await a,await g,await i,await s),a=await Wt(await a,await a,await e,await w),a=await Gt(await a,await g,await r),a=await Qt(await a,await g,await o),a=await Xt(await a,await g,await n))}}}}}catch(t){void 0===await a&&(a=await c)}return await a}async function Jt(a,t,e){if(await t.toLocaleLowerCase().startsWith("args.")){var i=await t;await a.includes("+"+i+"+")&&(i="+"+await t+"+"),await a.includes("+"+i)&&(i="+"+await t);var r=await e[await t];r=await Oe(await r),void 0!==await r&&(a=await qt(await a,await i,await r))}return await a}async function Xt(a,t,e){if(await t.toLocaleLowerCase().startsWith("args.")){var i=await t;await a.includes("+"+i+"+")&&(i="+"+await t+"+");try{e=await JSON.parse(await e)}catch(a){e={}}var r=await e[await t];r=await Oe(await r),void 0!==await r&&(a=await qt(await a,await i,await r))}return await a}async function Wt(a,t,e,i){if(await t.toLocaleLowerCase().startsWith("c.")){var r=await t;await a.includes("+"+r+"+")&&(r="+"+await t+"+"),await a.includes("+"+r)&&(r="+"+await t);var s=await e[await t.substring(2)][await i];s=await Oe(await s),void 0!==await s&&(a=await qt(await a,await r,await s))}return await a}async function Yt(a,t,e,i){if(await t.toLocaleLowerCase().startsWith("t.")){var r=await t;await a.includes("+"+r+"+")&&(r="+"+await t+"+"),await a.includes("+"+r)&&(r="+"+await t);var s=await e[await i][await t.substring(2)];s=await Oe(await s),void 0!==await s&&(a=await qt(await a,await r,await s))}return await a}async function Gt(a,t,e){if(await t.toLocaleLowerCase().startsWith("session.")){var i=await t;await a.includes("+"+i+"+")&&(i="+"+await t+"+"),await a.includes("+"+i)&&(i="+"+await t);var r=await e[await t.substring(8)];void 0===r&&(r=await e[await t]),r=await Oe(await r),void 0!==await r&&(a=await qt(await a,await i,await r))}return await a}async function Qt(a,t,e){if(await t.toLocaleLowerCase().startsWith("global.")){var i=await t;await a.includes("+"+i+"+")&&(i="+"+await t+"+"),await a.includes("+"+i)&&(i="+"+await t);var r=await e[await t.substring(7)];void 0===r&&(r=await e[await t]),r=await Oe(await r),void 0!==await r&&(a=await qt(await a,await i,await r))}return await a}async function qt(a,t,e){try{if(await a===await t)return await e;"object"===await typeof await await e&&(e=await JSON.stringify(await e));var i=await new RegExp(t,"gi");return await a.replace(await i,await e)}catch(i){try{return await a.replace(await t,await e)}catch(t){return await a}}}async function Zt(a){return a=await a.toLocaleLowerCase(),!!(await a.includes("c.")||await a.includes("t.")||await a.includes("args.")||await a.includes("session.")||await a.includes("global."))}async function Kt(a){var t=await a.split("Utility.");for(let u=0;u<await t.length;u++){var e=await t[u],i="Utility."+e;if(""!==await e)if(await e.includes("(")&&await e.includes(")")){var r=(await e.split("(")[1].split(")")[0]).split(","),s=await e.split("||")[1],n=await s.split(",");if(await n.length===await r.length){var w=await Lt(await e);void 0!==await w&&""!==await w&&(a=await a.replace("Utility."+await e,await w))}else if(await n>await r){var o="";for(let a=0;a<await r.length;a++)o=await o+","+await n[a];o=await o.substring(1);var c=await e.split("||")[0]+"||"+await o;w=await Lt(await c),void 0!==await w&&""!==await w&&(a=await a.replace("Utility."+await c,await w))}else try{await JSON.parse(await s),c=await e.split("||")[0]+"||"+await s,w=await Lt(await c),void 0!==await w&&""!==await w&&(a=await a.replace("Utility."+await c,await w))}catch(a){}}else w=await Lt(await e),void 0!==await w&&""!==await w&&(a=await qt(await a,await i,await w))}return await a}async function Ht(a){var t={isSuccess:!0,errorMessage:"",timeout:1,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)t.timeout=30;else try{try{var e=await JSON.parse(await a)}catch(t){e=await a}var i=await Object.keys(await e)[0];if(void 0===await i&&((e={}).timeout=await a),void 0===await e.timeout)return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"timeout":30}',t.isSuccess=!1,await t;var r=await _t(await e.timeout);if(!await r)return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"timeout":30}',t.isSuccess=!1,await t;t.timeout=await e.timeout}catch(a){return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"timeout":30}',t.isSuccess=!1,await t}return await t}async function _t(a){var t=await Number(await a.toString().trim());return!await isNaN(await t)}async function zt(a){var t={isSuccess:!0,errorMessage:"",url:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, Url should be provided in value section e.g. {"url":"https://qabunch.com/"}',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];void 0===await i&&((e={}).url=await a)}catch(t){(e={}).url=await a}if(void 0===await e.url||""===await e.url.toString().trim())return t.errorMessage='Provided value is invalid, Url should be provided in value section e.g. {"url":"https://qabunch.com/"}',t.isSuccess=!1,await t;t.url=await e.url.toString().trim()}catch(a){return t.errorMessage='Provided value is invalid, Url should be provided in value section e.g. {"url":"https://qabunch.com/"}',t.isSuccess=!1,await t}return await t}async function $t(a){var t={isSuccess:!0,errorMessage:"",expectedcount:0,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"expectedcount":2}',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];if(void 0===await i&&((e={}).expectedcount=await a),void 0===await e.expectedcount)return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"expectedcount":2}',t.isSuccess=!1,await t;var r=await _t(await e.expectedcount);if(!await r)return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"expectedcount":2}',t.isSuccess=!1,await t;t.expectedcount=await e.expectedcount}catch(a){return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"expectedcount":2}',t.isSuccess=!1,await t}return await t}async function ae(a){var t={isSuccess:!0,errorMessage:"",title:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, title should be provided in value section e.g. {"title":"QaBUnch"}',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];void 0===await i&&((e={}).title=await a)}catch(t){(e={}).title=await a}if(void 0===await e.title||""===await e.title.toString().trim())return t.errorMessage='Provided value is invalid, title should be provided in value section e.g. {"title":"QaBUnch"}',t.isSuccess=!1,await t;t.title=await e.title.toString().trim()}catch(a){return t.errorMessage='Provided value is invalid, title should be provided in value section e.g. {"title":"QaBUnch"}',t.isSuccess=!1,await t}return await t}async function te(a,t){var e={isSuccess:!0,errorMessage:"",filename:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return e.errorMessage='Provided value is invalid, filename should be provided in value section e.g. {"filename":"users"}',e.isSuccess=!1,await e;try{try{var i=await JSON.parse(await a),r=await Object.keys(await i)[0];void 0===await r&&((i={}).filename=await a)}catch(t){(i={}).filename=await a}if(void 0===await i.filename||""===await i.filename.toString().trim())return e.errorMessage='Provided value is invalid, filename should be provided in value section e.g. {"filename":"users"}',e.isSuccess=!1,await e;var s=await i.filename.toString().trim();e.filename=await s}catch(a){return e.errorMessage='Provided value is invalid, filename should be provided in value section e.g. {"filename":"users"}',e.isSuccess=!1,await e}return await e}async function ee(a){var t={isSuccess:!0,errorMessage:"",expectedtext:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, expectedtext should be provided in value section e.g. {"expectedtext":"users"}',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];void 0===await i&&((e={}).expectedtext=await a)}catch(t){(e={}).expectedtext=await a}if(void 0===await e.expectedtext||""===await e.expectedtext.toString().trim())return t.errorMessage='Provided value is invalid, expectedtext should be provided in value section e.g. {"expectedtext":"users"}',t.isSuccess=!1,await t;t.expectedtext=await e.expectedtext.toString().trim()}catch(a){return t.errorMessage='Provided value is invalid, expectedtext should be provided in value section e.g. {"expectedtext":"users"}',t.isSuccess=!1,await t}return await t}async function ie(a){var t={isSuccess:!0,errorMessage:"",actualvalue:"",expectedvalue:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, actualvalue and expectedvalue are expected in value section e.g {"actualvalue":"[QAautoMATER"]","expectedvalue":"QAautoMATER"}.',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];if(void 0===await i){e={};var r=await a.split(",")[0],s=await a.split(",")[1];e.actualvalue=await r,e.expectedvalue=await s}}catch(t){e={},r=await a.split(",")[0],s=await a.split(",")[1],e.actualvalue=await r,e.expectedvalue=await s}if(r=await e.actualvalue,s=await e.expectedvalue,void 0===await r||void 0===await s)return t.errorMessage='Provided value is invalid, actualvalue and expectedvalue are expected in value section e.g {"actualvalue":"[QAautoMATER"]","expectedvalue":"QAautoMATER"}.',t.isSuccess=!1,await t;t.actualvalue=await r,t.expectedvalue=await s}catch(a){return t.errorMessage='Provided value is invalid, actualvalue and expectedvalue are expected in value section e.g {"actualvalue":"[QAautoMATER"]","expectedvalue":"QAautoMATER"}.',t.isSuccess=!1,await t}return await t}async function re(a,t){var e={isSuccess:!0,errorMessage:"",supportingEvidence:{}};try{var i=await typeof await a,r=await typeof await t;if("object"!==await r&&"string"===await i)await a.toString().toLowerCase().trim().includes(await t.toString().toLowerCase().trim())||(e.isSuccess=!1,e.errorMessage="Expected value is "+await t+" however actual value is "+await a+".");else if("object"!==await r&&"object"==await i)await a.includes(await t)||(e.isSuccess=!1,e.errorMessage="Expected value is "+await t+" however actual value is "+await a+".");else if("object"===await r&&"object"==await i){var s=await se(t),n=!1;await s?(n=await async function(a,t){var e=await Object.keys(await t);for(let r=0;r<await e.length;r++){var i=await t[r];if(!await a.includes(await i))return!1}return!0}(await a,await t),await n||(e.isSuccess=!1,e.errorMessage="Expected value is "+await t+" however actual value is "+await a+".")):(n=await ne(await a,await t),await n||(e.isSuccess=!1,e.errorMessage="Expected value is "+await JSON.stringify(await t)+" however actual value is "+await JSON.stringify(await a)+"."))}}catch(a){}return await e}async function se(a){var t=await Object.keys(await a),e=await t[0];return!isNaN(await e)}async function ne(a,t){var e=await Object.keys(await t);for(let n=0;n<await e.length;n++){var i=await e[n],r=await t[await i],s=await a[await i];if(await r!==await s)return!1}return!0}async function we(a){var t={isSuccess:!0,errorMessage:"",attributename:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, attributename should be provided in value section e.g. {"attributename":"id"}.',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];void 0===await i&&((e={}).attributename=await a)}catch(t){a=await a.attributename,(e={}).attributename=await a}if(void 0===await e.attributename||""===await e.attributename.toString().trim())return t.errorMessage='Provided value is invalid, attributename should be provided in value section e.g. {"attributename":"id"}.',t.isSuccess=!1,await t;t.attributename=await e.attributename.toString().trim()}catch(a){return t.errorMessage='Provided value is invalid, attributename should be provided in value section e.g. {"attributename":"id"}.',t.isSuccess=!1,await t}return await t}async function oe(a){var t={isSuccess:!0,errorMessage:"",valuetobesend:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, valuetobesend should be provided in value section e.g. {"valuetobesend":"QAautoMATER"}.',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];void 0===await i&&((e={}).valuetobesend=await a)}catch(t){(e={}).valuetobesend=await a}if(void 0===await e.valuetobesend)return t.errorMessage='Provided value is invalid, valuetobesend should be provided in value section e.g. {"valuetobesend":"QAautoMATER"}.',t.isSuccess=!1,await t;t.valuetobesend=await e.valuetobesend.toString().trim()}catch(a){return t.errorMessage='Provided value is invalid, valuetobesend should be provided in value section e.g. {"valuetobesend":"QAautoMATER"}.',t.isSuccess=!1,await t}return await t}async function ce(a,t,e,r,n,w,u,d,p,m,v,g=!1,h,f={},y,b,S,x,M,N){var T={isElementPresent:!0,errorMessage:"",element:null,elements:null,elementIndex:0,primaryLocator:"",primaryLocatorProperty:"",secondaryXPath:""};if(await m.includes(await n))return await Ft(await t),await T;switch(await Ft(await t),await n){case"IsAppInstalled":case"Close":case"Back":case"Forward":case"AlertAccept":case"AlertDismiss":case"AlertSendKeys":case"AlertText":case"GetCurrentPackage":case"GetCurrentActivity":case"Launch":case"SwitchTo":case"HideKeyboard":case"RestartApp":case"SwipeLeft":case"SwipeRight":case"SwipeUp":case"SwipeDown":case"Refresh":case"RunADBCommand":case"RunShellCommand":case"Wait":case"SaveSessionVariable":case"SaveGlobalVariable":case"GenerateUtilityValue":case"RunDBQuery":case"SaveDBColumnValueInSessionVariable":case"DBRecordCountShouldBe":case"DBRecordCountShouldBeGreaterThan":case"DBRecordCountShouldBeLessThan":case"DBRecordsCount":case"CallAPI":case"SaveAPIResponseInSessionVariable":case"ReadPdfFile":case"PdfTotalPageCountShouldBe":case"ExcelRowCountShouldBe":case"ExcelRowCountShouldBeGreaterThan":case"ExcelRowCountShouldBeLessThan":case"SaveExcelColumnValueInSessionVariable":case"SaveColumnValuesBasedOnConditionalColumnAndValue":case"AssertIsNumberInAscendingOrder":case"AssertIsNumberInDescendingOrder":case"AssertIsListSorted":case"AssertEquals":case"AssertGreaterThan":case"AssertLessThan":case"AssertContains":case"AssertNotContains":case"GetContext":case"PushFile":case"SwitchContext":case"ExecuteScript":case"AssertStringLengthShouldBe":case"Array.DeleteItem":case"Array.DeleteItemBasedOnIndex":case"Array.GetValueBasedOnIndex":case"Array.Length":case"Array.ExcludeCharacters":case"Array.Push":case"Array.Search":case"Array.Sort":case"Array.SortDesc":case"Array.SumOfArray":case"Date.FormatDateTemplate":case"Date.GetDateDifference":case"Date.getDate":case"Math.Abs":case"Math.AddPercentage":case"Math.AddTwoNumber":case"Math.Ceil":case"Math.DivideTwoNumber":case"Math.Floor":case"Math.GetPercentage":case"Math.MultiplyTwoNumber":case"Math.Reminder":case"Math.Round":case"Math.SubtractPercentage":case"Math.SubtractTwoNumber":case"String.Concat":case"String.EndsWith":case"String.ExtractNumberFromTheString":case"String.Length":case"String.RemoveNumberFromTheString":case"String.Replace":case"String.Split":case"String.SplitandSaveValueAsPerIndex":case"String.StartsWith":case"String.Substring":case"String.ToLowerCase":case"String.ToUpperCase":case"String.Trim":case"JSON.getKeyValue":case"List.GetUniqueValues":case"LaunchMobileApplication":case"Wait":return await T;case"WaitForElementIsDisabled":case"WaitForElementIsEnabled":case"WaitForElementTillDisplayed":case"WaitForElementTillTextContains":T=await le(await t,await e,await r,await w,await u,await d,await p,await v,await g,await f,await h,!1,await y,await b,await x,await M);break;case"WaitForElementTillNotDisplayed":T=await le(await t,await e,await r,await w,await u,await d,await p,await v,await g,await f,await h,!0,await y,await b,await x,await M);break;case"SendKeysUsingKeyPad":var E=await oe(await h);if(await E.isSuccess){var A=await async function(a,t,e,i,r){var s={isSuccess:!1,errorMessage:""},n="",w=await a+"/"+await t+"/Mobile/Configuration.json";try{var o=await l(await w)}catch(a){o={}}if(void 0===await o.ELEMENTTAGDATA)"android"===await r.toLocaleLowerCase()?n="//android.widget.FrameLayout":"ios"===await r.toLocaleLowerCase()&&(n="//XCUIElementTypeKey");else{if("android"===await r.toLocaleLowerCase())try{n=await o.ELEMENTTAGDATA.KEYPAD.TAG}catch(a){n="//android.widget.FrameLayout"}if("ios"===await r.toLocaleLowerCase())try{n=await o.ELEMENTTAGDATA.KEYPAD.IOSTAG}catch(a){n="//XCUIElementTypeKey"}}try{var c=await i.toString();for(let a=0;a<await c.length;a++){var u="",d=await c.charAt(await a);"ios"===await r.toLocaleLowerCase()&&(u=await n+"[@name='"+await d+"']"),"android"===await r.toLocaleLowerCase()&&(u=await n+"[contains(@content-desc,'"+await d+"')]");var p=await e.findElement("xpath",await u);p=await p["element-6066-11e4-a52e-4f735466cecf"],await e.elementClick(await p),await new Promise(a=>setTimeout(a,300))}"ios"===await r.toLocaleLowerCase()&&(p=await e.findElement("xpath",'//XCUIElementTypeKey//*[@name="Done"]'),p=await p["element-6066-11e4-a52e-4f735466cecf"],await e.elementClick(await p)),"android"===await r.toLocaleLowerCase()&&await e.hideKeyboard(),s.isSuccess=!0}catch(a){s.errorMessage=await a.message}return await s}(await a,await v,await t,await E.valuetobesend,await y);T.isElementPresent=await A.isSuccess,T.errorMessage=await A.errorMessage}else T.isElementPresent=!1,T.errorMessage=await E.errorMessage;break;case"RestartAppTillElementIsPresent":var P=0,C="";try{var k={timeout:3};try{h=await JSON.parse(await h),P=Number(await h.totalAttempt),C=await h.packageName}catch(a){P=Number(await h.totalAttempt),C=await h.packageName}}catch(a){P=0,k.timeout=3}k=JSON.stringify(await k);for(let a=0;a<await P;a++){await new Promise(a=>setTimeout(a,5e3));try{var j="//*[@text='Allow']",D=await t.findElements("xpath",await j);D=await D[0]["element-6066-11e4-a52e-4f735466cecf"],await t.elementClick(await D)}catch(a){}try{j="//*[@text='Allow']",D=await t.findElements("xpath",await j),D=await D[0]["element-6066-11e4-a52e-4f735466cecf"],await t.elementClick(await D)}catch(a){}if(T=await le(await t,await e,await r,await w,await u,await d,await p,await v,await g,await f,await k,!1,await y,await b,await x,await M),null!==await T.element)break;await t.terminateApp(await C),await new Promise(a=>setTimeout(a,1e4)),await t.activateApp(await C)}break;default:if(void 0!==await S){try{var O=await Number(await S);if(await O>0){var I={timeout:await O};I=await JSON.stringify(await I),T=await le(await t,await e,await r,await w,await u,await d,await p,await v,0,await f,await I,!1,await y,await b,await x,await M)}}catch(a){}try{var L=await N.length,F=Number(await S)/L;F=Number(await F),await F<1&&await F>0&&(F=1);for(let a=0;a<await L;a++){var U=await N[a].xpath;await Ie(await t,await U,await F)}}catch(a){console.log(await a)}}null===await T.element&&(T=await async function(a,t,e,r,n,w,u,l,d,p,m,v,g,h,f,y,b){var S={},x="",M=!1,N="",T="";S.isElementPresent=!0,S.errorMessage="";var E=null;if(S.element=null,S.elements=E,S.elementIndex=0,S.primaryLocator="",S.primaryLocatorProperty="",S.secondaryXPath="",""===await e.toString().trim())return S.isElementPresent=!1,S.errorMessage="The mobile element cannot be blank. Please provide the mobile element details. If you are using a custom function, it's possible that your function name has been renamed.",await S;await Ft(await t);try{var A=await r[await e.toString().toUpperCase()];if(void 0===await A)return S.isElementPresent=!1,S.errorMessage="Element "+await e.toString()+" does not exist on server. Please add this locator with its property for android and ios from Object Repository page.",await S;var P=await A.locator;S.primaryLocator=await P;var C="";if("Android"===await h){var k=await A.locatorproperty;C=await A.alternatexpath,S.secondaryXPath=await C}else{if("iOS"!==await h)return S.isElementPresent=!1,S.errorMessage="Platform can not be blank. Please select Android or iOS",await S;k=await A.ioslocatorproperty,C=await A.alternatexpathios,S.secondaryXPathiOS=await C}await k.toLocaleLowerCase().includes("args.")&&(M=!0,N=await P,T=await k),S.primaryLocatorProperty=await k,k=await Rt(await k,await m,await n,await w,await u,await l,await v,await f,await b);var j=await k,D=await P.toString().toLocaleLowerCase();if(D=await D.replace(/[^a-zA-Z]/g,""),"Scroll"===await g){var O=await async function(a){var t=0;if(""===await a.toString().trim()||void 0===await a)return await t;try{var e=await JSON.parse(await a);return t=await e.index,void 0===await t&&(t=0),t=await Number(await t),await isNaN(await t)&&(t=0),t}catch(a){t=0}return await t}(await v);return S.isElementPresent=await async function(a,t,e){try{await isNaN(await e)&&(e=0);var i=!1,r="";if(await t.toString().includes("@text")){var s=await t.split("@text")[1];const a=/'([^']*)'[^']*$/,e=await s.match(await a);r=await e?await e[1]:null}if(null!==await r&&""!==await r){var n=`new UiScrollable(new UiSelector().scrollable(true)).scrollIntoView(new UiSelector().textContains("${await r}").instance(${e}))`;await a.executeScript("mobile: scroll",[{strategy:"-android uiautomator",selector:n}]),i=!0}else await r.toString().includes("//")||(r=await t,n=`new UiScrollable(new UiSelector().scrollable(true)).scrollIntoView(new UiSelector().textContains("${await r}").instance(${e}))`,await a.executeScript("mobile: scroll",[{strategy:"-android uiautomator",selector:n}]),i=!0)}catch(a){i=!1}return i}(await t,await j,await O),S.element=await S.element,S.elements=E,await S}switch(await D){case"id":E=await t.findElements("id",await k);break;case"name":E=await t.findElements("name",await k);break;case"xpath":E=await t.findElements("xpath",await k);break;case"text":var I="//*[@text='"+await k+"']";E=await t.findElements("xpath",await I);break;case"accessibilityid":E=await t.findElements("accessibility id",await k);break;case"resourceid":I="//*[@resource-id='"+await k+"']",E=await t.findElements("xpath",await I);break;case"class":case"classname":E=await t.findElements("class name",await k);break;case"contentdesc":I="//*[@content-desc='"+await k+"']",E=await t.findElements("xpath",await I);break;default:I="//*[contains(translate(@"+await P+", 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'),'"+await k.toLocaleLowerCase()+"')]",E=await t.findElements("xpath",await I)}if("Yes"===await y&&await p){var L=await E.length;if(Number(await L)>0)if(""===await C)"Android"===await h?S.secondaryXPath=await me(await a,await t,await E[0],await e,await d,await k,await M,await N,await T,await h):S.secondaryXPathiOS=await me(await a,await t,await E[0],await e,await d,await k,await M,await N,await T,await h);else if(""!==await C){var F=await t.findElements("xpath",await C);0===await F.length&&("Android"===await h?S.secondaryXPath=await me(await a,await t,await E[0],await e,await d,await k,await M,await N,await T,await h):S.secondaryXPathiOS=await me(await a,await t,await E[0],await e,await d,await k,await M,await N,await T,await h))}}var U={};if(U[await P]=await k,x=await JSON.stringify(await U),0===await E.length){var V="Element "+await e+" does not exist in the mobile app source code.";if("Yes"===await y&&""!==await C.trim()){var B=await C;C=await Rt(await C,await m,await n,await w,await u,await l,await v,await f,await b),""!==await C&&(E=await t.findElements("xpath",await C)),await p&&await E.length>0&&"Yes"===await y&&(S.primaryLocator="xpath",await M?S.primaryLocatorProperty=await B:S.primaryLocatorProperty=await C,await async function(a,t,e,r,n){if(""!==await r){var w={};try{var u=await c(await a+"/Mobile/OR.json");if(await u){var l=await i+await a+"/Mobile/OR.json";w=await JSON.parse(await s.readFileSync(await l,"utf8")),void 0!==await w[await t]&&("Android"===await n?(w[await t].locator=await e,w[await t].locatorproperty=await r):(w[await t].ioslocator=await e,w[await t].ioslocatorproperty=await r),await o(await a+"/Mobile/OR.json",await w))}}catch(a){}}}(await d,await await e,"xpath",await S.primaryLocatorProperty,await h),"Android"===await h?S.secondaryXPath=await me(await a,await t,await E[0],await e,await d,await C,await M,await N,await T,await h):S.secondaryXPathiOS=await me(await a,await t,await E[0],await e,await d,await C,await M,await N,await T,await h))}if(0===await E.length){S.isElementPresent=!1;var R={};R.applicationErrorMessage=await V,void 0!==await P&&""!==await P&&(R.locator=await P),void 0!==await k&&""!==await k&&(R.locatorproperty=await k),S.errorMessage=await JSON.stringify(await R)}}}catch(a){S.isElementPresent=!1,S.errorMessage="Unable to Find element because of "+await a}if("IsNotDisplayed"===await g)S.isElementPresent=!0,S.element=await S.element;else if(!0===await S.isElementPresent&&"TypeAll"!==await g){var J=await async function(a,t,e,i){var r={isElementPresent:!0,element:null,errorMessage:"",elementindex:-1};if(""===await t.toString().trim())r.isElementPresent=!0,r.element=await await e[0],r.elementindex=0;else try{var s=await JSON.parse(await t),n=await async function(a){var t=[],e=["countofclick","filename","attributename","keyname","valuetobesend","url","actualvalue","expectedvalue","expectedcount","expectedtext","title","andoperation","nextelement","browserindex","timeout","loopcounter","methodparameters","iftrue","iffalse"],i=await Object.keys(await a);for(let a=0;a<await i.length;a++){var r=await i[a].toString().toLocaleLowerCase();await e.includes(await r)||await r.toString().startsWith("args.")||await t.includes(await r)||t.push(await r)}return await t.includes("index")&&(t=[]).push("index"),await t}(await s);if(0===await n.length)r.isElementPresent=!0,r.element=await await e[0];else if(await n.includes("index")){var w=Number(await s.index);await e.length>await w?(r.isElementPresent=!0,r.element=await e[await w]):(r.isElementPresent=!1,r.errorMessage="Provided Element Index "+await w+" is greater than or equals elements count "+await e.length+". Please note index is started with 0")}else if("AssertElementAttributeNotContains"===await i)r.isElementPresent=!0,r.element=await await e[0];else{if(await["AssertElementAttributeEquals","AssertElementAttributeContains","AssertElementAttributeNotContains"].includes(await i))r.isElementPresent=!0,r.element=await await e[0];else{var o=await async function(a,t,e,i){for(let a=0;a<await t.length;a++){var r=!1,s=await i.andoperation;void 0===await s&&(r=!0);var n=[];for(let r=0;r<await e.length;r++){var w=await e[r],o=await i[await w];try{if("text"===await w)var c=await(await t[a]).getText();else c=await(await t[a]).getAttribute(await w);await c.toString().toLowerCase().trim().includes(await o.toString().toLocaleLowerCase().trim())?await n.push(!0):await n.push(!1)}catch(a){await n.push(!1)}}if(await r){var u=await ue(await n);if(await u)return a}else if(await n.includes(!0))return a}return await-1}(await a,await e,await n,await s);-1===await o?(r.isElementPresent=!1,r.errorMessage="Attribute does not match as per provided value "+await t):(r.elementindex=await o,r.element=await e[await o])}}}catch(a){r.isElementPresent=!1,r.errorMessage="Attribute does not match as per provided value "+await t+" error "+await a}return await r}(await t,await v,await E,await g);!0===await J.isElementPresent?(S.element=await J.element,S.elementIndex=J.elementindex):S.errorMessage=await e+" "+await x+" "+J.errorMessage}return"Count"===await g&&(S.isElementPresent=!0,S.element=await S.element),S.elements=E,await S}(await a,await t,await e,await r,await w,await u,await d,await p,await v,await g,await f,await h,await n,await y,await b,await x,await M))}return await T}async function ue(a){for(let t=0;t<await a.length;t++)if(!await a[t])return!1;return!0}async function le(a,t,e,i,r,s,n,w,o,c,u,l,d,p,m,v){var g={isElementPresent:!1,errorMessage:"",elements:null,element:null,primaryLocatorProperty:"",secondaryXPath:""};if(""===await t.toString().trim())return g.isElementPresent=!1,g.errorMessage="Mobile Element can not be blank , Please add the Mobile Element details.",await g;await Ft(await a);try{var h=await e[await t.toString().toUpperCase()];if(void 0===await h)return g.isElementPresent=!1,g.errorMessage="Element "+await t.toString()+" does not exist on server. Please add this locator from Object Repository page.",await g;var f="",y="",b="";if("Android"===await d)f=await h.locator,y=await h.locatorproperty,b=await h.alternatexpath;else{if("iOS"!==await d)return g.isElementPresent=!1,g.errorMessage="Plarform can not be blank. please select Android or iOS",await g;f=await h.ioslocator,y=await h.ioslocatorproperty,b=await h.alternatexpathios}y=await Rt(await y,await c,await i,await r,await s,await n,await u,await p,await v),g.secondaryXPath=await Rt(await b,await c,await i,await r,await s,await n,await u,await p,await v);var S=await async function(a,t,e,i,r,s){var n={isElementPresent:!1,errorMessage:"",element:null,elements:null};try{var w=await Ht(await r);if(await w.isSuccess){var o=await e.toString().toLocaleLowerCase();o=await o.replace(/[^a-zA-Z]/g,"");var c,u=await Number(await w.timeout);for(let t=0;t<await u;t++){try{switch(await o){case"id":d=await a.findElements("id",await i);break;case"name":d=await a.findElements("name",await i);break;case"xpath":d=await a.findElements("xpath",await i);break;case"text":var l="//*[@text='"+await i+"']";d=await a.findElements("xpath",await l);break;case"accessibilityid":d=await a.findElements("accessibility id",await i);break;case"resourceid":l="//*[@resource-id='"+await i+"']",d=await a.findElements("xpath",await l);break;case"class":case"classname":d=await a.findElements("class name",await i);break;case"contentdesc":l="//*[@content-desc='"+await i+"']",d=await a.findElements("xpath",await l);break;default:l="//*[contains(translate(@"+await e+", 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'),'"+await i.toLocaleLowerCase()+"')]",d=await a.findElements("xpath",await l)}}catch(a){var d=[]}if(await d.length>0){if(!await s){if(n.isElementPresent=!0,n.elements=await d,""!==await r)try{var p=await JSON.parse(await r),m=await p.index;void 0===await m?n.element=await d[0]:(m=await Number(await m),n.element=await d[await m])}catch(a){n.element=await d[0]}else n.element=await d[0];break}await new Promise(a=>setTimeout(a,500))}else{if(await s){n.element=null,n.elements=null,n.isElementPresent=!0;break}await new Promise(a=>setTimeout(a,500))}}await s?await n.isElementPresent?(n.isElementPresent=!1,(c={}).applicationErrorMessage="Element "+await t+" is displayeds on mobile app after waiting "+await w.timeout+" seconds.",""!==await e&&void 0!==await e&&(c.locator=await e),""!==await i&&void 0!==await i&&(c.locatorproperty=await i)):(n.isElementPresent=!0,(c={}).applicationErrorMessage="Element "+await t+" does not exist on mobile app after waiting "+await w.timeout+" seconds.",""!==await e&&void 0!==await e&&(c.locator=await e),""!==await i&&void 0!==await i&&(c.locatorproperty=await i)):await n.isElementPresent||((c={}).applicationErrorMessage="Element "+await t+" does not exist on mobile app after waiting "+await w.timeout+" seconds.",""!==await e&&void 0!==await e&&(c.locator=await e),""!==await i&&void 0!==await i&&(c.locatorproperty=await i),n.errorMessage=await JSON.stringify(await c))}else n.errorMessage=await w.errorMessage}catch(a){n.errorMessage=await a.toString()}return await n}(await a,await t,await f,await y,await u,await l,await m);await S.isElementPresent?(g.isElementPresent=!0,g.elements=await S.elements,g.element=await S.element):g.errorMessage=await S.errorMessage}catch(a){g.isElementPresent=!1,g.errorMessage="Unable to Find element because of "+await a}return await g}async function de(a){var t={isSuccess:!0,errorMessage:"",attributeNames:{},supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage="Provided value is invalid, PLease see the example.",t.isSuccess=!1,await t;try{var e=await JSON.parse(await a),i=await e.attributeNames;void 0===await i&&(i=await e);var r=await Object.keys(i);for(let a=0;a<await r.length;a++){var s=await r[await a].toString(),n=await r[await a].toString().toLocaleLowerCase();if(void 0===await n||""===await n.toString().trim())return t.errorMessage="Provided value is invalid, PLease refre the example.",t.isSuccess=!1,await t;await n.toString().startsWith("args.")&&delete i[await s]}t.attributeNames=await i}catch(a){return t.errorMessage="Provided value is invalid, attributeNames should be provided as json object, please see the example "+await a,t.isSuccess=!1,await t}return await t}async function pe(a){var t={isSuccess:!0,errorMessage:"",variablename:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, variablename should be provided in the value section. e.g. {"variablename":"orderId"}.',t.isSuccess=!1,await t;try{if("object"!==await typeof await a)var e=await JSON.parse(await a);else e=await a;if(void 0===await e.variablename)return t.errorMessage='Provided value is invalid, variablename should be provided in the value section. e.g. {"variablename":"orderId"}.',t.isSuccess=!1,await t;if(t.variablename=await e.variablename.toString().trim(),""===await t.variablename.toString().trim())return t.errorMessage='Provided value is invalid, variablename should be provided in the value section. e.g. {"variablename":"orderId"}.',t.isSuccess=!1,await t}catch(a){return t.errorMessage='Provided value is invalid, variablename should be provided in the value section. e.g. {"variablename":"orderId"}.',t.isSuccess=!1,await t}return await t}async function me(a,t,e,i,r,s,n,w,o,c){var u="";try{if(e=await e["element-6066-11e4-a52e-4f735466cecf"],await n)return w=await w.toString().toLocaleLowerCase(),"xpath"!==await w?(u="//*[contains(translate(@"+await w+", 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'),'"+await o.toLocaleLowerCase()+"')]",await ve(await a,await r,await i,await u,await c),await u):(await ve(await r,await i,await o,await c),await o);try{var l=await t.getElementAttribute(await e,"accessibility id");if(null!==await l&&void 0!==await l&&""!==l&&(u="//*[@*[contains(.,'"+await l+"')]]",await s!==u))return await ve(await r,await i,await u,await c),await u}catch(a){}try{if(l=await t.getElementAttribute(await e,"resource-id"),null!==await l&&void 0!==await l&&""!==l&&(u="//*[@*[contains(.,'"+await l+"')]]",await s!==u))return await ve(await r,await i,await u,await c),await u}catch(a){}try{var d=await t.getElementText(await e);if(null!==await d&&void 0!==await d&&""!==d){await d.includes("/")&&(d=await d.split("/")[1]);var p="[@text='"+await d+"']";if(u="//"+await"*"+await p,await s!==u)return await ve(await r,await i,await u,await c),await u}}catch(a){}}catch(a){await a.message}return await u}async function ve(a,t,e,r,n){if(""!==await r&&void 0!==await r&&null!==await r){var w={};try{var u=await c(await a+"/"+await t+"/Mobile/OR.json");if(await u){var l=await i+await a+"/"+await t+"/Mobile/OR.json";w=await JSON.parse(await s.readFileSync(await l,"utf8")),void 0!==await w[await e]&&("Android"===await n?w[await e].alternatexpath=await r:w[await e].alternatexpathios=await r,await o(await a+"/"+await t+"/Mobile/OR.json",await w))}}catch(a){}}}async function ge(a,t){return await a.getElementText(await t)}async function he(a,t,e,i){try{await a.elementClear(await t)}catch(a){}await a.elementSendKeys(await t,await e),await Ne(await i,await a)}async function fe(a){return a=await a.toString().toLocaleLowerCase(),a=await a.replace(/_/g,""),a=await a.replace(/-/g,""),a=await a.replace(/ /g,""),await a.includes("first")&&await a.includes("last")&&await a.includes("name")?await Ma()+" "+await Na():await a.includes("lastname")?await Na():await a.includes("firstname")?await Ma():await a.includes("username")?await ba():await a.includes("fullname")||await a.includes("name")?await Ma()+" "+await Na():await a.includes("phone")||await a.includes("mobile")||await a.includes("tel")?await Pa():await a.includes("email")?await xa():await a.includes("country")?await Aa():await a.includes("city")?await ka():await a.includes("state")?await Ca():await a.includes("zip")||await a.includes("pin")?await ja():await a.includes("address")?await Ta():await a.includes("title")?await ya():await a.includes("password")?await fa():await a.includes("cvv")||await a.includes("securitycode")?await at():await a.includes("cardnumber")?await et():await a.includes("expirationdate")?await generateExpiryDate():await a.includes("=name")?await Ma()+" "+await Na():""}async function ye(a){var t={isSuccess:!0,errorMessage:"",Query:"",database:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid,  Query should be provided in the value section. e.g. {"Query":"Select * from table1"}.',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(void 0===await e.Query)return t.errorMessage='Provided value is invalid, Query should be provided in the value section. e.g. {"Query":"Select * from table"}.',t.isSuccess=!1,await t;t.Query=await e.Query,t.database=await e.database}catch(a){return t.errorMessage='Provided value is invalid, Query should be provided in the value section. e.g. {"Query":"Select * from table1"}.',t.isSuccess=!1,await t}return await t}async function be(a){var t={isSuccess:!0,errorMessage:"",rowsCount:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid,  rowsCount should be provided in the value section. e.g. {"rowsCount":1}.',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(void 0===await e.rowsCount)return t.errorMessage='Provided value is invalid, rowsCount should be provided in the value section. e.g. {"rowsCount":1}.',t.isSuccess=!1,await t;t.rowsCount=await e.rowsCount}catch(a){return t.errorMessage='Provided value is invalid, rowsCount should be provided in the value section. e.g. {"rowsCount":1}.',t.isSuccess=!1,await t}return await t}async function Se(a){return await a.replace(/[^0-9.]/g,"")}async function xe(a,t=!0){var e={isSuccess:!0,errorMessage:"",filename:"",sheetname:"",expectedCount:0,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return e.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"myexcel.xlsx","expectedCount":1,"sheetname":"mysheet"}',e.isSuccess=!1,await e;try{var i=await JSON.parse(await a);if(void 0===await i.filename)return e.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"myexcel.xlsx","expectedCount":1,"sheetname":"mysheet"}',e.isSuccess=!1,await e;if(e.filename=await i.filename.toString().trim(),await t){if(void 0===await i.expectedCount)return e.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"myexcel.xlsx","expectedCount":1,"sheetname":"mysheet"}',e.isSuccess=!1,await e;var r=await Number(await i.expectedCount);if(await Number(NaN===await i.expectedCount))return e.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"myexcel.xlsx","expectedCount":1,"sheetname":"mysheet"}',e.isSuccess=!1,await e;e.expectedCount=Number(await r)}e.sheetname=await i.sheetname,void 0===await e.sheetname&&(e.sheetname="")}catch(a){return e.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"myexcel.xlsx","expectedCount":1,"sheetname":"mysheet"}',e.isSuccess=!1,await e}return await e}async function Me(a){var t={isSuccess:!0,errorMessage:"",totalSwipeCount:1,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.isSuccess=!0,await t;try{try{var e=await JSON.parse(await a);t.totalSwipeCount=await e.totalSwipeCount}catch(a){return t.errorMessage='Provided value is invalid, totalSwipeCount should be provided in value section e.g. {"totalSwipeCount":1}.',t.isSuccess=!1,await t}}catch(a){return t.errorMessage='Provided value is invalid, totalSwipeCount should be provided in value section e.g. {"totalSwipeCount":1}.',t.isSuccess=!1,await t}return await t}async function Ne(a,t){try{if("android"===await a.toLocaleLowerCase())await t.hideKeyboard();else{var e=await t.findElement("xpath",'//XCUIElementTypeKey//*[@name="Done"]');e=await e["element-6066-11e4-a52e-4f735466cecf"],await t.elementClick(await e)}}catch(a){}}async function Te(a){var t={};try{var e=await typeof await a;t="string"===await e?await JSON.parse(await a):await a}catch(a){t={}}return await t}async function Ee(a){var t="{}";try{var e=await typeof await a;t="object"===await e?await JSON.stringify(await a):await a}catch(a){t="{}"}return await t}async function Ae(a,t,e,i,r,s,n,w,o,c,u,l,d,p,m,v,g,h,f,y,b,S,x,M,N){var T={isSuccess:!0,status:"Pass",testData:{},supportingData:{},errorMessage:""},E=await async function(a,t){try{var e=await JSON.parse(await a),i=await Object.keys(await e);if(await i.length>0){var r=await i[0],s=e[await r];if(void 0!==await s&&await s.toString().toLocaleLowerCase().startsWith("args.")){var n=await t[await s];if(void 0===await n)return!0;if(await n.toString().toLocaleLowerCase().startsWith("args."))return!0}}}catch(a){}return await!1}(await s,await u);if(await E)return T.status="Warning",T.testData=await Te(await s),T.supportingData=await async function(){return await{warningMessage:"Test step skipped because a required argument was not provided."}}(),p[await n]=!1,await T;var A=await Te(await s);s=await Ot(await s,await w,await o,await c,0,await u,await s,await l,await N),A=await Te(await s),t=await jt(await A),await t&&(d=await kt(await A,await n,await d));var P=!1,C=await Ct(await n,await d);if(await C.isStepInvolved&&(P=await ke(await C,await p)),await P)return T.status="Warning",T.testData=await A,T.supportingData=await Pe(),p[await n]=!1,await T;var k=await async function(a){var t=1;try{var e=await a;t=await e.loopCounter,void 0===await t&&(t=1),t=await isNaN(await t)?1:await Number(await t)}catch(a){t=1}return await t}(await A);if(0===await k)return T.testData=await A,T.supportingData=await getWarningMessageWhenLoopCountisZeros(),p[await n]=!0,T.status="Warning",await T;for(let e=0;e<await k;e++){try{var j=await A.methodParameters;if(void 0!==await j&&await Array.isArray(await j)&&await j.length>0){var D=await j[e];s=await Ee(await D)}}catch(a){s=await Ee(await A)}var O=await ce(await a,await m,await r,await v,await i,await w,await o,await c,await g,await h,await f,!1,await s,await u,await x,await l,await b,await M,await N,await y);if(!await O.isElementPresent){p[await n]=!1;var I=await O.errorMessage;return await t?(T.supportingData=await Pe(),T.status="Warning"):(T.supportingData=await Ce(await I),T.isSuccess=!1,T.status="Fail"),T.testData=await Te(await s),T.errorMessage=await I,await T}void 0!==await O.shadowDriver&&(m=await O.shadowDriver);var L=await O.element,F=await O.elements,U=await O.elementIndex;if(resultDetails=await Dt(await a,await i,await m,await L,await s,await S,await c,await v,await f,await F,await U,await l,await x,await N),p[await n]=await resultDetails.isSuccess,!await resultDetails.isSuccess)return I=await resultDetails.errorMessage,await t?(T.supportingData=await Pe(),T.status="Warning"):(T.supportingData=await Ce(await I),T.isSuccess=!1,T.status="Fail"),T.testData=await Te(await s),T.errorMessage=await I,await T}return T.testData=await Te(await s),T.supportingData=await resultDetails.supportingEvidence,await T}async function Pe(){return await{warningMessage:"Conditional statement found.Hence test step execution skipped."}}async function Ce(a){var t={};return t.errorMessage=await a,await t}async function ke(a,t){var e=[],i=await a.parentSteps,r=await Object.keys(await i);for(let a=0;a<await r.length;a++){var s=await r[a],n=await i[await s],w=await t[await s];await n.toString()===await w.toString()?e.push("true"):e.push("false")}return!!await e.includes("false")}async function je(a,t,e,n,w,o,c,l){try{var d=await Ea(),p=await Ia(0),m=await a+"/"+await t+"/"+await n+"/Reports/Screenshot/"+await w+"/"+await p+"/";await u(await m);var v=await o+"_"+await c+"_"+await l+"_"+await d,g=await i+await m+await v+".png",h=await g;h=await Nt.AES.encrypt(await h,await"QW@#$#%%%%#CFGH").toString();try{var f=await(await e).switchTo().alert(),y=await f.getText(),b=await r.generate(await y);return b=await b.split(",")[1],await s.writeFile(await g,await b,{encoding:"base64"}),await h}catch(a){try{return y=await(await e).takeScreenshot(),await s.writeFileSync(await g,await y,{encoding:"base64"}),await h}catch(a){console.log(await a)}}}catch(a){}return""}async function De(a){var t=!1;try{JSON.parse(await a),t=!0}catch(a){}return await t}async function Oe(a){try{"number"==typeof await a&&(await Number.isSafeInteger(a)||(a=(a=await BigInt(await a)).toString()))}catch(a){}return await a}async function Ie(a,t,e){if(void 0!==await t){if(e=await Number(await e),0===await e)return;try{for(let r=0;r<await e;r++){var i=await a.findElements("xpath",await t);if(!(await i.length>0))return;await new Promise(a=>setTimeout(a,1e3))}}catch(a){}}}a.exports={executeTestStep:Tt,evaluateValuecomingfromTestScript:Ot,createElementandElements:async function(a,t,e,i,r,s,n,w,o,c,u=!1,l,d={},p,m){var v={isElementPresent:!0,errorMessage:"",element:null};if(""===await t.toString().trim())return await Ft(await a),await v;if(await o.includes(await i))return await v;switch(await Ft(await a),await i){case"ClickSimilarElements":case"TypeSimilarElements":case"CheckSimilarElements":case"UncheckSimilarElements":case"SelectByVisibleTextSimilarElements":case"SelectByIndexSimilarElements":case"SelectByValueSimilarElements":case"GetAttributeForAllSimilarElements":case"GetAttributeForSimilarElements":case"AssertElementCountEquals":case"AssertElementCountGreaterThan":case"AssertElementCountLessThan":case"Count":case"ClickOnAllListOfWebElement":case"GetIndexOfTheElement":return await async function(a,t,e,i,r,s,n,w,o,c,u,l,d){var p={isElementPresent:!0,errorMessage:""},m=null;if(p.element=m,""===await t.toString().trim())return await p;await Ft(await a);try{var v=await e[await t.toString().toUpperCase()];if(void 0===await v)return p.isElementPresent=!1,p.errorMessage="Element "+await t.toString()+" does not exist on OR. Please add the locator.",await p;var g=await v.locator,h=await v.locatorproperty;h=await Rt(await h,await c,await i,await r,await s,await n,await"",await l,await d);var f=await v.alternatexpath,y=[];switch(await g.toString().trim().toLowerCase()){case"id":var b=await N.id(await h);m=await(await a).findElements()(await b),await y.push("id");break;case"name":b=await N.name(await h),m=await(await a).findElements(await b),await y.push("name");break;case"linktext":b=await N.linkText(await h),m=await(await a).findElements(await b);break;case"partiallinktext":b=await N.partialLinkText(await h),m=await(await a).findElements(await b);break;case"classname":case"class":b=await N.className(await h),m=await(await a).findElements(await b),await y.push("class");break;case"css":case"cssselector":b=await N.css(await h),m=await(await a).findElements(await b);break;case"xpath":b=await N.xpath(await h),m=await(await a).findElements(await b)}await o&&""===await f.toString().trim()&&await Vt(await a,await m,await t,await y,await w,!1,await e)}catch(t){var S=await t.mesage;if(""!==await f.trim())try{b=await N.xpath(await f),m=await(await a).findElements(await b)}catch(a){p.isElementPresent=!1,p.errorMessage=await S}else p.isElementPresent=!1,p.errorMessage=await S}return p.element=await m,await p}(await a,await t,await e,await r,await s,await n,await w,await c,await u,await await d,0,await p,await m);case"Navigate":case"Close":case"GetCurrentUrl":case"GetTitle":case"SwitchToWindow":case"Maximize":case"Minimize":case"FullScreen":case"Refresh":case"Back":case"Forward":case"AlertAccept":case"AlertText":case"AlertDismiss":case"AlertSendKeys":case"NewWindow":case"NewTab":case"AssertWindowCountEquals":case"SaveSessionVariable":case"SaveGlobalVariable":case"CreateRequestParametersInSessionVariable":case"GenerateUtilityValue":case"Wait":case"IsFileExistOnDownloadFolder":case"FileCountOnDownloadFolder":return await v;default:return await async function(a,t,e,i,r,s,n,w,o,c,u,l,d,p){var m={isElementPresent:!0,errorMessage:""},v=null;m.element=v,await Ft(await a);var g=!1;await["WaitForElementTillNotDisplayed","WaitForElementTillDisplayed","WaitForElementTillTextContains","WaitForElementIsEnabled","WaitForElementIsDisabled","WaitForAlertIsPresent","WaitForTitleContains"].includes(await c)&&(g=!0);try{var h=await e[await t.toString().toUpperCase()];if(void 0===await h)return m.isElementPresent=!1,m.errorMessage="Element "+await t.toString()+" does not exist on OR. Please add the locator.",await m;var f=await h.locator,y=await h.locatorproperty;y=await Rt(await y,await l,await i,await r,await s,await n,await u,await d,await p);var b=await h.alternatexpath,S=[],x=null;switch(await f.toString().trim().toLowerCase()){case"id":x=await N.id(await y),await g||(v=await(await a).findElement(await x),S.push("id"));break;case"name":x=await N.name(await y),await g||(v=await(await a).findElement(await x),S.push("name"));break;case"linktext":x=await N.linkText(await y),await g||(v=await(await a).findElement(await x));break;case"partiallinktext":x=await N.partialLinkText(await y),await g||(v=await(await a).findElement(await x));break;case"classname":case"class":x=await N.className(await y),await g||(v=await(await a).findElement(await x),S.push("class"));break;case"css":case"cssselector":x=await N.css(await y),await g||(v=await(await a).findElement(await x));break;case"xpath":x=await N.xpath(await y),await g||(v=await(await a).findElement(await x))}await o&&""===await b.toString().trim()&&await Vt(await a,await v,await t,await S,await w,!0,await e)}catch(t){var M=await t.message;if(""!==await b.trim())try{x=await N.xpath(await b),v=await(await a).findElement(await x)}catch(a){"IsNotDisplayed"===await c?m.isElementPresent=!0:(m.isElementPresent=!1,m.errorMessage=await M)}else"IsNotDisplayed"===await c?m.isElementPresent=!0:(m.isElementPresent=!1,m.errorMessage=await M)}return await g?(m.isElementPresent=!0,m.element=await x):m.element=await v,await m}(await a,await t,await e,await r,await s,await n,await w,await c,await u,await i,await l,await d,await p,await m)}},executeDependendtPageFunction:async function(a,t,e,r,n,w,o,c,u,l,d,p,m,v,g,h,f,y){for(var b={isSuccess:!0,errorMessage:"",supportingEvidence:{},testData:{}},S=[],x=[],M=await e[0].customfunction,N=await e[0].parameter,T={},E=[];0!==e.length;){S.push(await M);var A=await i+await a+"/"+await t+"/Mobile/CustomPageFunction/Page/"+await M+".json",P=await s.existsSync(await A);if(!await P){b.isSuccess=!1,b.errorMessage="Page "+await M+" method does not exist . Either create Page method or remove from the test script file";var C=await N;C=await JSON.stringify(await C);var k={id:"#",stepdefinition:await S[0],action:"",testdata:await C+"."+await b.errorMessage,status:"Fail",screenshot:""};return b.stepAssertion=await k,b}var j=await JSON.parse(await s.readFileSync(await A,"utf8"));E.push(await j);var D=await j.argumentlist;try{var O=await Object.keys(await D);for(let a=0;a<await O.length;a++){var I=await O[a];void 0===await T[await I]&&(T[await I]=await D[await I])}}catch(a){}if(e=await j.dependentpage,await e.length>0){try{var L=await e[0].parameter,F=await JSON.parse(await L),U=await Object.keys(await F);for(let a=0;a<await U.length;a++){var V=await U[a];void 0===await T[await V]&&(T[await V]=await F[await V])}}catch(a){}M=await e[0].customfunction}}var B={},R=await N;if(""!==await R&&""!==await N){var J=await Object.keys(await T);if(""!==await R&&0!==await J.length)try{R=await JSON.parse(await R);for(let a=0;a<await J.length;a++){var X=await J[a],W=await R[await X];if(void 0===await W&&await X.toLocaleLowerCase().toString().startsWith("args.")){var Y="ARGS."+await X.substring(5);W=await R[await Y],void 0===await W&&(W=await T[await Y]),void 0!==await W&&(B[await Y]=await W)}if(void 0===await W)return b.isSuccess=!1,b.errorMessage="Key "+await X+" is missing , This key is required while calling selected page/function method",k={id:"#",stepdefinition:await S[0],action:"",testdata:await R+"."+await b.errorMessage,status:"Fail",screenshot:""},b.stepAssertion=await k,b;W=await Ot(await W,await n,await w,await o,await m,await B,await W,await p,await f),B[await X]=await W}}catch(a){return b.isSuccess=!1,C=await B,C=await JSON.stringify(await C),b.errorMessage="Provided data in value section is invalid. data should be in JSON format "+await a,k={id:"#",stepdefinition:await S[0],action:"",testdata:await C+"."+await b.errorMessage,status:"Fail",screenshot:""},b.stepAssertion=await k,b}}try{b.testData=await JSON.stringify(await R)}catch(a){b.testData="{}"}var G=await S.length,Q={},q={};for(let e=0;e<await G;e++){var Z=await E[await G-(e+1)].allsteps;for(let e=0;e<await Z.length;e++)try{var K={},H=!1,_=await Z[e].stepdefinition,z=await Z[e].isreporting,$=await Z[e].action,aa=await Z[e].element,ta=await Z[e].value,ea=await Z[e].id;if(K={Step:"",Stepdefinition:await _,Action:await $,locator:await aa,Status:"",TestData:{},SupportingData:{}},ta=await Ot(await ta,await n,await w,await o,0,await B,await ta,await p,await f),""!==await ta&&"{}"!==await ta)try{ta=await JSON.parse(await ta);var ia=await Object.keys(await ta);for(let a=0;a<await ia.length;a++){if(X=await ia[a],W=await B[await X],void 0===await W&&(W=B[await ta[await X]],void 0===await W&&(W=await ta[await X],await W===await X&&(W=await R[await X]))),void 0===await W)return b.isSuccess=!1,b.errorMessage="Key "+await X+" is missing , This key is required while calling selected page/function method",k={id:"#",stepdefinition:await S[0],action:"",testdata:await R+"."+await b.errorMessage,status:"Fail",screenshot:""},b.stepAssertion=await k,b;ta[await X]=await W}}catch(a){return b.isSuccess=!1,b.errorMessage="Provided data is in not valid . it should be in JSON format "+await a,C=await B,C=await JSON.stringify(await C),k={id:"#",stepdefinition:await S[0],action:"",testdata:await C+"."+await b.errorMessage,status:"Fail",screenshot:""},b.stepAssertion=await k,b}ta=await Ot(await ta,await n,await w,await o,0,await B,await ta,await p,await f);var ra=await typeof await ta;"string"!==await ra&&(ta=await JSON.stringify(await ta));var sa=!1,na=await Ct(await ea,await Q);if(await na.isStepInvolved&&(sa=await ke(await na,await q)),await sa)da.isSuccess=!0,K.Step=await x.length+1,K.Status="Warning",K.TestData=await Te(await ta),K.SupportingData=await Pe(),q[await ea]=!1,x.push(await K);else{var wa=await ce(await a,await r,await aa,await c,await $,await n,await w,await o,0,await u,await t,!1,await ta,await B,await d,await p,await h,await v,await f,await y);if(await wa.isElementPresent){var oa=await wa.element,ca=await wa.elements,ua=await wa.elementIndex;if(da=await Tt(await a,await t,await $,await r,await oa,await ta,await l,await o,await u,await c,await n,await w,await ca,await ua,await d,await p,await aa,0,await B,await v,await f,await h,await y),void 0!==await da.supportingEvidence){var la=await da.supportingEvidence.ListOfTestSteps;void 0!==await la?await la.length>0&&(K.SupportingData=await da.supportingEvidence):K.SupportingData=await da.supportingEvidence}K.Step=await x.length+1,K.Status="Fail",await da.isSuccess&&(K.Status="Pass"),H=await jt(await Te(await ta)),await H&&(Q=await kt(await Te(await ta),await ea,await Q),q[await ea]=await da.isSuccess,await da.isSuccess||(K.Status="Warning",da.isSuccess=!0,K.SupportingData=await da.errorMessage)),K.TestData=await Te(await ta),x.push(await K)}else{var da={};if(""===await z||"Yes"===await z){if(K.Step=await x.length+1,K.Status="Fail",K.TestData=await Te(await ta),(ma={}).errorMessage=await wa.errorMessage,K.SupportingData=await ma,b.errorMessage=await wa.errorMessage,H=await jt(await Te(await ta)),!await H){b.isSuccess=!1,x.push(await K),da.isSuccess=!1;break}Q=await kt(await Te(await ta),await ea,await Q),q[await ea]=!1,K.Status="Warning",b.isSuccess=!0,x.push(await K),da.isSuccess=!0}}}if(!da.isSuccess&&(""===await z||"Yes"===await z)){b.isSuccess=!1,b.errorMessage=await da.errorMessage;break}}catch(a){if(""===await z||"Yes"===await z){var pa,ma,va=await x.length+1;try{var ga=await JSON.parse(await ta)}catch(a){ga={}}(ma={}).errorMessage=await a.toString(),pa={Step:await va,Stepdefinition:await _,Action:await $,locator:await aa,Status:await"Fail",TestData:await ga,SupportingData:await ma},x.push(await pa),b.isSuccess=!1,b.errorMessage=await a.toString();break}}}var ha;return ha="Yes"===await g?await je(await a,await t,await r,"Mobile",await p,await M,await m,"precondition"):await Ut(await r),C=await B,C=await JSON.stringify(await C),k=await b.isSuccess?{id:"#",stepdefinition:await S[0],action:"",testdata:await C,status:"Pass",screenshot:ha}:{id:"#",stepdefinition:await S[0],action:"",testdata:await C+"."+await b.errorMessage,status:"Fail",screenshot:ha},b.stepAssertion=await k,b.supportingEvidence=await async function(a){for(let t=0;t<await a.length;t++)a[t].Step=Number(await t)+1;return await a}(await x),b},takeScreenshot:Ut,callSeleniumMethod:Dt,getUtilityData:Lt,createElementForExistingLocator:Bt,createElementasPerProvidedValue:ce,saveScreenshot:je,GetCommonDataFromParam:Wt}},4973:a=>{"use strict";a.exports=require("selenium-webdriver")},4982:(a,t,e)=>{const i=e(7252),{isSpaceFreeOnAccount:r,addLogMessageInConsole:s}=e(7229),n=i.Router(),{getAllCustomFunction:w}=e(6777),{getActiveThreadCounter:o,getPlanForAccount:c,deleteUserThread:u,addActiveThreadByUser:l}=e(5843),{launchBrowser:d,acceptCookies:p}=e(8505),{takeScreenshot:m,executeTestStep:v,evaluateValuecomingfromTestScript:g,executeDependendtPageFunction:h,createElementasPerProvidedValue:f,waitForPageLoad:y}=e(6221);var b={},S={};const{authCheck:x}=e(2258),{Builder:M,Browser:N,By:T,Key:E,until:A,Select:P,Capabilities:C}=e(4973);n.post("/debuggerwindow",async(a,t)=>{var e={},i=await x(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var n=await i.totalStorage,w=await a.headers.accountlabel;try{var v={status:"Pass",supportingEvidence:{},message:"",screenshot:"",browserVersion:"0.0.0",mainDriver:null},g=await a.body.browser,h=await a.body.runat,f=await a.body.screen,M=await a.body.applicationurl,N=await a.body.userEmail.toString().toLowerCase().trim(),T=await a.body.projectName,E=await a.body.PageLoaderXpath,A=await a.body.SelectedHeadlessOption,P=await r(await w,await T,await n);if(!await P.isSuccess)return v.message=await P.errorMessage,t.json(v);var C=await a.body.capabilitydata;if(void 0!==await b[await N]){try{await(await b[await N]).close(),await(await b[await N]).quit()}catch(a){}try{await delete b[await N]}catch(a){}}if(void 0===await h&&(h="Server"),"Server"===await h){await u(await w,await T,await N,"Web");var k=await o(await T,"Web"),j=await c(await i),D=Number(await j.maxThreadForUI);if(await k>=Number(await j.maxThreadForUI))return v.status="Fail",v.message=await D+" thread are already active for project "+await T+", as per your plan max "+await D+" thread can be active at a time, Please wait till thread get released.",await s(await v.message),t.json(await v)}v.supportingEvidence.Browser=await g,b[await N]=await d(await h,await g,await f,await C,await T,await A);try{await b[await N].getCapabilities().then(a=>{const t=a.get("browserVersion");v.browserVersion=t,v.supportingEvidence.browserVersion=t})}catch(a){}S[await N]=b[await N],await(await(await b[await N]).manage().window()).maximize(),await(await b[await N]).get(await M),await new Promise(a=>setTimeout(a,2e3)),await p(await b[await N]),await y(await b[await N],60,await E);var O=await m(await b[await N]);v.mainDriver=await b[await N],v.screenshot=await O,"Server"===await h&&await l(await T,await N,"Web")}catch(a){v.status="Fail",v.message=a.message,v.supportingEvidence.errorMessage=await a.message;try{if(void 0!==await b[await N])try{await(await b[await N]).close(),await(await b[await N]).quit()}catch(a){}}catch(a){}"Server"===await h&&await u(await w,await T,await N,"Web")}t.json(await v)}),n.post("/debuggerwindow/quit",async(a,t)=>{var e={},i=await x(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var r=await a.headers.accountlabel,s=await a.body.userEmail.toLowerCase().trim(),n=await a.body.projectName,w=await a.body.runAt,o={isSuccess:!0};if(void 0!==await b[await s]){try{await(await b[await s]).close(),await(await b[await s]).quit()}catch(a){}try{delete b[await s]}catch(a){}try{delete S[await s]}catch(a){}}"Server"===await w&&await u(await r,await n,await s,"Web")}catch(a){o.isSuccess=!1,"Server"===await w&&await u(await r,await n,await s,"Web")}t.json(o)}),n.post("/debugstep",async(a,t)=>{var e={},i=await x(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage;try{var n={status:"Pass",message:"",screenshot:"",isSuccess:!0,primaryLocator:"",primaryLocatorProperty:"",secondaryXPath:"",supportingEvidence:{},testData:{}},o=[],c="",u="",l="",d=await a.body.isPageFunction,p=await a.body.projectName,y=await a.headers.accountlabel,M=await r(await y,await p,await s);if(!await M.isSuccess)return n.message=await M.errorMessage,t.json(n);await d?o=await a.body.testStep:(c=await a.body.testStep.action,u=await a.body.testStep.value,l=await a.body.testStep.element);var N=await a.body.userEmail.toLowerCase().trim(),T=await a.body.orData,E=await a.body.commonTestDataEnvironment,A=await w(await p),P=await a.body.commonTestData,C=await a.body.testSpecificData,k=await a.body.PageLoaderXpath,j=await a.body.defaultTimeOut,D=await a.body.SelectedSelfHealingOption,O={},I={},L={},F={};mainDriver=await S[await N];var U={};U.mainDriver=await mainDriver;var V=await b[await N];if(u=await g(await u,await P,await C,await I,0,await L,await u,await E,await F),await d){var B=await h(await y,await p,await o,await V,await P,await C,await I,await T,await A,await O,await E,await k,0,await j,await D,"No",await F,await U);n.supportingEvidence=await B.supportingEvidence,await B.isSuccess||(n.status="Fail",n.supportingEvidence.errorMessage=await B.errorMessage),n.testData=await B.testData,n.message=await B.errorMessage}else{var R=await f(await y,await V,await l,await T,await c,await P,await C,await I,0,await A,await p,!0,await u,await L,await E,await k,await j,await D,await F);if(await R.isElementPresent){void 0!==await R.shadowDriver&&(V=await R.shadowDriver),n.primaryLocator=await R.primaryLocator,n.primaryLocatorProperty=await R.primaryLocatorProperty,n.secondaryXPath=await R.secondaryXPath;var J=await v(await y,await p,await c,await V,await R.element,await u,O,I,await A,await T,await P,await C,await R.elements,await R.elementIndex,await E,await k,await j,await l,0,!0,await L,await D,await F,await U);n.supportingEvidence=await J.supportingEvidence,void 0!==await O.output&&""!==await O.output&&(n.message="Result : "+await O.output),await J.isSuccess||(n.status="Fail",n.message=await J.errorMessage,n.supportingEvidence.errorMessage=await J.errorMessage);try{void 0!==await J.additionaldata&&""!==await J.additionaldata&&(n.message=n.message+"\n "+JSON.stringify(await J.additionaldata))}catch(a){}n.testData=await u,void 0!==await J.shadowDriver&&(b[await N]=await J.shadowDriver,V=await b[await N])}else{n.status="Fail",n.testData=await u;var X=await R.errorMessage;n.message=await X;var W="";try{W=await JSON.parse(await X)}catch(a){W=await X}n.supportingEvidence.errorMessage=await W}}}catch(a){void 0===await n.supportingEvidence&&(n.supportingEvidence={}),n.status="Fail",n.message=await a.message,n.supportingEvidence.errorMessage=await a.message,n.testData=await u}try{if(await new Promise(a=>setTimeout(a,1e3)),"CallMobileTestScript"===await c){if(await J.errorMessage.length>0){var Y=await J.errorMessage.length-1;n.screenshot=await await J.errorMessage[await Y].screenshot}}else{var G=await m(await mainDriver);n.screenshot=await G}}catch(a){}t.json(n)}),a.exports=n},5158:(a,t,e)=>{const i=e(7252).Router(),{saveFile:r,isDirectoryExist:s,createDirectory:n,isSpaceFreeOnAccount:w}=e(7229),{authCheck:o}=e(2258);var c="./dataHub/",u=e(9896);const l=e(4716),d=e(2410);async function p(a,t,e,i,s,w){switch(await e){case"Web":case"Mobile":break;default:return}try{var o=await c+await a+"/"+t+"/"+e+"/Logger/"+await e+"OR.json";await n(await a+"/"+await t+"/"+e+"/Logger");var d=await JSON.parse(await u.readFileSync(await o,"utf8"))}catch(a){d={}}try{void 0===await d[await i]&&(d[await i]={}),void 0===await d[await i].Logs&&(d[await i].Logs=[]);const n=l().format("DD MMM YYYY hh:mm A Z");var p={id:1,update:await s,date:await n,new:await w},m=await d[await i].Logs.length;p.id=await m+1,await m>=10?(await d[await i].Logs.shift(),d[await i].Logs.push(await p),d[await i].Logs.forEach((a,t)=>{a.id=t+1})):d[await i].Logs.push(await p),await r(await a+"/"+await t+"/"+e+"/Logger/"+await e+"OR.json",await d)}catch(a){}}e(6212),i.post("/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await o(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var d=await a.headers.accountlabel,m=await i.totalStorage,v={isFileSaved:!1,errorMessage:""};try{const e=await l().format("DD MMM YYYY hh:mm:ss A Z");var g=a.params.projectName,h=await a.headers.useremail;g=await g.toString().trim(),h=await h.toString().trim();var f=await w(await d,await g,await m);if(!await f.isSuccess)return v.errorMessage=await f.errorMessage,t.json(v);var y=a.params.testingtype;switch(y=await y.toString().trim(),await y){case"Web":case"Mobile":break;default:return v.errorMessage="Invalid Testing Type provided.",t.json(v)}await s(await d+"/"+g+"/"+y)||await n(await d+"/"+g+"/"+y);var b={};try{var S=await c+await d+"/"+g+"/"+y+"/OR.json";if(!await u.existsSync(await S)){console.log(await e+" OR.Json file does not found for project, hence created OR file for "+await g+" by user "+await h);const a={},t=JSON.stringify(await a,null,2);await u.writeFileSync(await S,await t)}if(await u.existsSync(await S))try{b=await JSON.parse(await u.readFileSync(await S,"utf8"));var x=await Object.keys(await b).length;console.log(await e+" Total "+x+" elements are found in OR.json file. user "+await h)}catch(a){return console.log(await e+" Unable to read OR.json file by user "+await h+". we are getting error "+await a.toString()),v.errorMessage=await e+" Unable to read OR.json file by user "+await h+". we are getting error "+await a.toString(),t.json(v)}}catch(a){return console.log(await e+" OR.Json file Unable to read the data by user "+await h+" because of "+await a.toString()),v.errorMessage="OR.Json file Unable to read the data by user "+await h+" because of "+await a.toString(),t.json(v)}var M=await await a.body.keyForAddandUpdate,N=await Object.keys(await M);if(void 0!==await N)for(let a=0;a<await N.length;a++){var T={},E=await N[a].toString().trim();if(void 0!==await E&&""!==await E&&null!==await E){try{var A=await b[await E].locator,P=await b[await E].locatorproperty;if("Mobile"===await y)var C=await b[await E].ioslocator,k=await b[await E].ioslocatorproperty}catch(a){A="",P="","Mobile"===await y&&(C="",k="")}void 0===await b[await E.toString().toUpperCase()]?(b[await E.toString().toUpperCase()]={},M[await E].createdby=await h,console.log(e+" element "+await E+" gets added in OR.json fiile by user "+await h)):M[await E].alternatexpath=b[await E.toString().toUpperCase()].alternatexpath;var j=await M[await E];if(void 0!==await j){var D=j.locator,O=j.locatorproperty;""!==await D&&""!==await O&&(b[await E.toString().toUpperCase()]=await M[await E],void 0===await b[await E.toString().toUpperCase()].createdby&&(b[await E.toString().toUpperCase()].createdby=await h))}var I=await M[await E].locator,L=await M[await E].locatorproperty;if("Mobile"===await y)var F=await M[await E].ioslocator,U=await M[await E].ioslocatorproperty;"Web"===await y?await A===await I&&await P===await L||(T.locator=await I,T.locatorproperty=await L,await p(await d,await g,await y,await E,await h,await T),console.log(e+" element "+await E+" gets updated in OR.json fiile by user "+await h)):"Mobile"===await y&&(await A===await I&&await P===await L||(T.Android={},T.Android.locator=await I,T.Android.locatorproperty=await L,console.log(e+" Mobile android element "+await E+" gets updated in OR.json fiile by user "+await h)),await C===await F&&await k===await U||(T.iOS={},T.iOS.locator=await F,T.iOS.locatorproperty=await U,console.log(e+" Mobile ios element "+await E+" gets updated in OR.json fiile by user "+await h)),await p(await d,await g,await y,await E,await h,await T))}}var V=await await a.body.keyForDelete;if(void 0!==await V)for(let a=0;a<await V.length;a++)try{var B=await V[a];if(console.log("element "+await B+" gets deleted in OR.json fiile by user "+await h),void 0!==await B&&""!==await B&&null!==await B){const{[B]:a,...t}=await b;b=await t;var R={message:"Element "+await B+" is deleted from the server."};await p(await d,await g,await y,await B,await h,await R)}}catch(a){}var J=await r(await d+"/"+g+"/"+y+"/OR.json",await b);v.isFileSaved=await J}catch(a){v.errorMessage=a.toString(),console.log(orOpeartionTime+" "+a.toString()+" occred after saving OR.json")}t.json(v)}),i.get("/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await o(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.headers.accountlabel,s={},n=a.params.projectName,w=a.params.testingtype;switch(n=await n.toString().trim(),w=await w.toString().trim(),await w){case"Web":case"Mobile":break;default:return t.json(s)}try{var l=await c+await r+"/"+await n+"/"+await w+"/OR.json";s=await JSON.parse(await u.readFileSync(await l,"utf8"))}catch(a){}t.json(s)}),i.post("/project/:projectName/testingtype/:testingtype/getlogsoftheelement",async(a,t)=>{var e={message:"No Information Available.",tableData:[]},i=await o(await a);if(!await i.isSuccess)return e.errorMessage=i.errorMessage,t.json(await e);var r=await a.headers.accountlabel,s=a.params.projectName,n=a.params.testingtype,w=await a.body.element;switch(s=await s.toString().trim(),n=await n.toString().trim(),await n){case"Web":case"Mobile":break;default:return e.message="Invalid Testing Type provided.",t.json(await e)}try{var l=await c+await r+"/"+await s+"/"+await n+"/Logger/"+await n+"OR.json",d=await JSON.parse(await u.readFileSync(await l,"utf8"));if(void 0!==await d[await w]){var p=await d[await w].Logs;if(void 0!==await p){var m=await p.length;await m>0&&(e.message=await m+" Log Records.",e.tableData=await d[await w].Logs)}}}catch(a){}t.json(e)}),i.delete("/project/:projectName/testingtype/:testingtype/removeunusedelement",async(a,t)=>{var e={message:"No Information Available."},i=await o(await a);if(!await i.isSuccess)return e.errorMessage=i.errorMessage,t.json(await e);if(!await i.isSuperAdmin)return e.message="User does not have permission to delete unused elements from the OR.",t.json(await e);var s=await a.headers.accountlabel,n=a.params.projectName,w=a.params.testingtype;switch(await w){case"Web":case"Mobile":break;default:return e.message="Invalid Testing Type provided.",t.json(await e)}try{var l=await c+await s+"/"+await n+"/"+await w+"/OR.json",p=await JSON.parse(await u.readFileSync(await l,"utf8")),m=await Object.keys(await p);0===await m.length&&(e.message="No element found on Or File");var v=0,g=[];const a=await c+await s+"/"+await n+"/"+await w+"/TestScripts/**/*.json";var h=await d.sync(await a);const t=await c+await s+"/"+await n+"/"+await w+"/CustomPageFunction/Function/*.json";var f=await d.sync(await t);const i=await c+await s+"/"+await n+"/"+await w+"/CustomPageFunction/Page/*.json";var y=await d.sync(await i);for(let a=0;a<await m.length;a++){var b=await m[a],S=!1;for(let a=0;a<await h.length;a++){var x=await JSON.parse(await u.readFileSync(await h[a],"utf8"));if(await JSON.stringify(await x).includes(await b)){S=!0;break}}if(!await S)for(let a=0;a<await f.length;a++){var M=await JSON.parse(await u.readFileSync(await f[a],"utf8"));if(await JSON.stringify(await M).includes(await b)){S=!0;break}}if(!await S)for(let a=0;a<await y.length;a++){var N=await JSON.parse(await u.readFileSync(await y[a],"utf8"));if(await JSON.stringify(await N).includes(await b)){S=!0;break}}await S||g.push(await b)}if(await g.length>0){v=await g.length;for(let a=0;a<await g.length;a++){var T=await g[a];void 0!==await p[await T]&&delete p[await T]}await r(await s+"/"+n+"/"+w+"/OR.json",await p),e.message=await v+" unused elements are successfully deleted from the OR file."}else e.message="There is no element in OR which is unused."}catch(a){e.message="OR File not found for account "+await n}t.json(e)}),i.post("/project/:projectName/testingtype/:testingtype/getdepoftheelement",async(a,t)=>{var e={message:"No Refrences Available.",tableData:[]},i=await o(await a);if(!await i.isSuccess)return e.errorMessage=i.errorMessage,t.json(await e);var r=await a.headers.accountlabel,s=a.params.projectName,n=a.params.testingtype,w=await a.body.element;switch(await n){case"Web":case"Mobile":break;default:return e.message="Invalid Testing Type provided.",t.json(await e)}try{var l=await c+await r+"/"+await s+"/"+await n+"/OR.json",p=await JSON.parse(await u.readFileSync(await l,"utf8"));if(void 0!==await p[await w]){var m,v=0,g=0,h=0,f=0;const a=await c+await r+"/"+await s+"/"+await n+"/TestScripts/**/*.json";var y=await d.sync(await a);for(let a=0;a<await y.length;a++){var b=await JSON.parse(await u.readFileSync(await y[a],"utf8")),S=await JSON.stringify(await b);if(await S.includes(await w)){v=Number(await v)+1;var x=await S.split(await w),M=await x.length-1;h=Number(await h)+Number(await M)}}const t=await c+await r+"/"+await s+"/"+await n+"/CustomPageFunction/Page/*.json";var N=await d.sync(await t);for(let a=0;a<await N.length;a++)b=await JSON.parse(await u.readFileSync(await N[a],"utf8")),S=await JSON.stringify(await b),await S.includes(await w)&&(v=Number(await v)+1,x=await S.split(await w),M=await x.length-1,h=Number(await h)+Number(await M));const i=await c+await r+"/"+await s+"/"+await n+"/CustomPageFunction/Function/*.json";var T=await d.sync(await i);for(let a=0;a<await T.length;a++){var E=await JSON.parse(await u.readFileSync(await T[a],"utf8")),A=await JSON.stringify(await E);await A.includes(await w)&&(g=Number(await g)+1,x=await A.split(await w),M=await x.length-1,f=Number(f)+Number(await M))}m=Number(await h)+Number(await f),e.message=await m+" Refrences found.";var P={id:1,references:await m,testscriptreference:await v,teststepreference:await h,customfunctionrefrences:await g,customstepreference:await f};e.tableData.push(await P)}}catch(a){}t.json(e)}),a.exports=i},5347:(a,t,e)=>{const i=e(9896),r=e(7252).Router();var s="./dataHub/";const{authCheck:n}=e(2258);r.get("/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},r=await n(await a);if(!await r.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=r.errorMessage,t.status=await r.responseCode,t.json(await e);var w=await a.headers.accountlabel,o=a.params.projectName,c=a.params.testingtype,u=[];switch(await c){case"Web":case"Mobile":case"Api":break;default:return t.json(await u)}try{u=await i.readdirSync(s+await w+"/"+o+"/"+c+"/TestScripts")}catch(a){}t.json(u)}),r.get("/:componentName/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},r=await n(await a);if(!await r.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=r.errorMessage,t.status=await r.responseCode,t.json(await e);var w=[];try{var o=a.params.projectName,c=a.params.testingtype,u=await a.headers.accountlabel;switch(await c){case"Web":case"Mobile":case"Api":break;default:return t.json(w)}var l=a.params.componentName,d=await i.readdirSync(await s+await u+"/"+await o+"/"+await c+"/TestScripts/"+await l);for(let a=0;a<d.length;a++){var p=d[a];if(p.toLocaleLowerCase().includes(".json")&&p.includes("@")){var m={testid:"",testname:""},v=await p.split("@")[0];m.testid=await v;var g=await p.substring(Number(await v.length)+1);m.testname=await g.replace(".json",""),w.push(await m)}}}catch(a){}t.json(await w)}),a.exports=r},5460:(a,t,e)=>{e(9896);const i=e(2410),{executeApiTestScript:r}=e(645),{readJSONFile:s}=e(7229);a.exports={apiCall:async function(a,t,e,n,w,o){var c={isSuccess:!0,errorMessage:"",output:{},supportingEvidence:{}};try{var u=await"./dataHub/"+await a+"/"+await t+"/Api/TestScripts/"+await e+"/"+await n+"@*.json",l=await i.sync(await u);if(0===await l.length)return c.isSuccess=!1,c.errorMessage="API test script id "+await n+" does not exist under component "+await e,await c;var d=await l[0].split("\\"),p=await d[await d.length-1].replace(".json","");try{var m=await a+"/"+await t+"/Api/Configuration.json",v=await s(await m)}catch(a){return c.isSuccess=!1,c.errorMessage="API Configuration fle does not exist on server. Please make sure account should have configuration file with environment details.",await c}var g={};try{var h=await a+"/"+await t+"/Api/CommonTestData.json";g=await s(await h),g=await g.CommonTestData}catch(a){g={}}var f=await v.Environment;if(void 0===await f)return c.isSuccess=!1,c.errorMessage="No Environment details found on API Configuration file",await c;if(0===await f.length)return c.isSuccess=!1,c.errorMessage="No Environment details found on API Configuration file",await c;var y=!1;for(let a=0;a<await f.length;a++)if(await f[a].name===await w){y=!0;break}if(!await y)return c.isSuccess=!1,c.errorMessage="Environment "+await w+" does not exist on API configuration file.",await c;var b={};b[await n]={};var S=await r(await a,await t,await e,1,await p,await n,await w,await v,await b,"Integration Testing",await o,await g);"Fail"===await await S.isSuccess?(c.isSuccess=!1,c.output=await S.responseData[1],void 0===await await S.responseData[1].errorMessage?c.errorMessage=await S.responseData[1]:c.errorMessage=await S.responseData[1].errorMessage):(c.isSuccess=!0,c.output=await S.responseData[1],c.errorMessage=await S.responseData[1])}catch(a){c.isSuccess=!1,c.errorMessage=await a.toString()}return await c}}},5504:a=>{"use strict";a.exports=require("oracledb")},5692:a=>{"use strict";a.exports=require("https")},5751:a=>{"use strict";a.exports=require("xlsx")},5811:(a,t,e)=>{const i="./dataHub/";e(9896);const r=e(2410),s=e(6928),{executeTestScript:n}=e(861),{readJSONFile:w}=e(7229);a.exports={mobileTestScriptCall:async function(a,t,e,o,c,u,l,d,p,m){var v={isSuccess:!0,errorMessage:"",output:{},supportingEvidence:{}};v.supportingEvidence.Component=await e,v.supportingEvidence.TestId=await o;try{var g=await i+await t+"/Mobile/TestScripts/"+await e+"/"+await o+"@*.json",h=await r.sync(await g);if(0===await h.length)return v.isSuccess=!1,v.errorMessage="Mobile test script id "+await o+" does not exist under component "+await e,v.supportingEvidence.errorMessage=await v.errorMessage,await v;var f=await h[0].split("\\"),y=await f[await f.length-1].replace(".json","");try{var b=await t+"/Mobile/Configuration.json",S=await w(await b),x=await S.DefaultRunAtOption;if(void 0===await x||""===await x)return v.isSuccess=!1,v.errorMessage="Please add DefaultRunAtOption on Mobile Configuration file.",v.supportingEvidence.errorMessage=await v.errorMessage,await v;var M=await S.DefaultExecutionPlatform;if(void 0===await M||""===await x)return v.isSuccess=!1,v.errorMessage="Please add DefaultExecutionPlatform on Mobile Configuration file.",v.supportingEvidence.errorMessage=await v.errorMessage,await v;var N=await S.DefaultScreenshotOption;if(void 0===await M||""===await x)return v.isSuccess=!1,v.errorMessage="Please add DefaultScreenshotOption on Mobile Configuration file.",v.supportingEvidence.errorMessage=await v.errorMessage,await v}catch(a){return v.isSuccess=!1,v.errorMessage="Mobile Configuration fle does not exist on server. Please make sure account should have configuration file with environment details.",v.supportingEvidence.errorMessage=await v.errorMessage,await v}try{var T=await t+"/Mobile/CommonTestData.json",E=await w(await T)}catch(a){E={}}var A=await S.Environment;if(void 0===await A)return v.isSuccess=!1,v.errorMessage="No Environment details found on Mobile Configuration file",v.supportingEvidence.errorMessage=await v.errorMessage,await v;if(0===await A.length)return v.isSuccess=!1,v.errorMessage="No Environment details found on Mobile Configuration file",v.supportingEvidence.errorMessage=await v.errorMessage,await v;var P=!1;for(let a=0;a<await A.length;a++)if(await A[a].name===await c){P=!0;break}if(!await P)return v.isSuccess=!1,v.errorMessage="Environment "+await c+" does not exist on Mobile configuration file.",v.supportingEvidence.errorMessage=await v.errorMessage,await v;var C="",k=[],j=await i+await t+"/Mobile/CustomPageFunction/Function/*",D=await r.sync(await j);if(await D.length>0)for(let a=0;a<await D.length;a++){var O=await D[a],I=await s.basename(await O);I=await I.replace(".json",""),k.push(await I)}if("Server"===await x||"Client"===await x){var L=await S.Emulator;if(void 0===await L)return v.isSuccess=!1,v.errorMessage="No Device details is found on Mobile configuration file.",v.supportingEvidence.errorMessage=await v.errorMessage,await v;if(0===await L.length)return v.isSuccess=!1,v.errorMessage="No Device details is found on Mobile configuration file.",v.supportingEvidence.errorMessage=await v.errorMessage,await v;var F=!1;for(let a=0;a<await await L.length;a++){var U=await L[a].platform;if(await U===await M){C=await L[a].name,F=!0;break}}if(!await F)return v.isSuccess=!1,v.errorMessage="No Device details is found on Mobile configuration file for platform "+await M,v.supportingEvidence.errorMessage=await v.errorMessage,await v}else try{var V=await S.ExecutionCapabilities,B=await V[await x][await M],R=await Object.keys(await B);if(!(await R.length>0))return v.isSuccess=!1,v.errorMessage="No Device details is found on Mobile configuration file for platform "+await M,v.supportingEvidence.errorMessage=await v.errorMessage,await v;C=await R[0]}catch(a){return v.isSuccess=!1,v.errorMessage="No Device details is found on Mobile configuration file for platform "+await M,v.supportingEvidence.errorMessage=await v.errorMessage,await v}({})[await o]={},testResults=await n(await a,await t,await e,await y,await c,await x,await M,await C,await E,await k,await N,await S,await c,await u,await defaultTimeOut,"No","Yes",await l,await d,await p,await m),await testResults.isSuccess?(v.isSuccess=!0,v.supportingEvidence.ListOfTestSteps=await testResults.assertionData,v.output=await testResults.assertionData):(v.isSuccess=!1,v.supportingEvidence.ListOfTestSteps=await testResults.assertionData,v.errorMessage=await testResults.assertionData)}catch(a){v.isSuccess=!1,v.errorMessage=await a.toString()}return await v}}},5843:(a,t,e)=>{const{isDirectoryExist:i,createDirectory:r,saveFile:s}=e(7229),n="./dataHub/";var w=e(9896);async function o(a){try{var t=0,e=await Object.keys(await a);for(let i=0;i<await e.length;i++)t=Number(await t)+Number(await a[await e[i]])}catch(a){}return await t}a.exports={getActiveThreadCounter:async function(a,t,e){var c=0;try{var u=await i("AccountDetails/"+await a);await u||await r("AccountDetails/"+await a);var l=await i("AccountDetails/"+await a+"/ActiveThreadDetails.json");if(!await l){var d={};d[await t]={},d[await t][await e]={},d[await t][await e].uiExecutionThread={},d[await t][await e].cicdThread={},d[await t][await e].userthread={},await s("AccountDetails/"+await a+"/ActiveThreadDetails.json",await d)}var p=await n+"/AccountDetails/"+await a+"/ActiveThreadDetails.json",m=await JSON.parse(await w.readFileSync(await p,"utf8")),v=await m[await t];void 0===await v&&(m[await t]={},m[await t][await e]={},m[await t][await e].uiExecutionThread={},m[await t][await e].cicdThread={},m[await t][await e].userthread={},await s("AccountDetails/"+await a+"/ActiveThreadDetails.json",await m));var g=await o(await v[await e].uiExecutionThread),h=await o(await v[await e].cicdThread),f=await v[await e].userthread,y=await Object.keys(await f).length;c=await Number(Number(await g)+Number(await h)+Number(await y))}catch(a){}return await c},getPlanForAccount:async function(a){var t={};try{t.maxUsers=await a.maxUsers,t.maxThreadForUI=await a.maxThreadForUI,t.maxThreadForMobile=await a.maxThreadForMobile,t.maxThreadForAPI=await a.maxThreadForAPI}catch(a){}return await t},deleteUserThread:async function(a,t,e,i){try{e=await e.toString().toLowerCase().trim();var r=await n+"/AccountDetails/"+await a+"/ActiveThreadDetails.json",o=await JSON.parse(await w.readFileSync(await r,"utf8")),c=await o[await t];if(void 0!==await c){var u=o[await t][await i].userthread;if(void 0!==await u){var l=o[await t][await i].userthread[await e];void 0!==await l&&(delete u[await e],o[await t][await i].userthread=await u,await s("AccountDetails/"+await a+"/ActiveThreadDetails.json",await o))}}}catch(a){}},addActiveThreadByUser:async function(a,t,e){try{t=await t.toString().toLowerCase();try{var i=await n+"/AccountDetails/ActiveThreadDetails.json",r=await JSON.parse(await w.readFileSync(await i,"utf8"))}catch(a){r={}}var o=await r[await a];if(void 0===await o&&(r[await a]={}),void 0!==await o){var c=r[await a][await e].userthread;if(void 0!==await c){var u=r[await a][await e].userthread[await t];void 0===await u&&(r[await a][await e].userthread[[await t]]=1,await s("AccountDetails/ActiveThreadDetails.json",await r))}}}catch(a){}},addUIExecutionThread:async function(a,t,e,i,r){try{e=await e.toString().toLowerCase();var o=await n+"/AccountDetails/"+await a+"/ActiveThreadDetails.json",c=await JSON.parse(await w.readFileSync(await o,"utf8")),u=await c[await t];if(void 0!==await u){var l=c[await t][await r].uiExecutionThread;if(void 0===await l)c[await t][await r].uiExecutionThread={},c[await t][await r].uiExecutionThread[await e]=await i;else{var d=c[await t][await r].uiExecutionThread[await e];void 0===await d&&(d=0),c[await t][await r].uiExecutionThread[await e]=Number(await i)+Number(await d)}await s("AccountDetails/"+await a+"/ActiveThreadDetails.json",await c)}else c[await t]={},c[await t].uiExecutionThread={},c[await t].uiExecutionThread[await e]=await i,await s("AccountDetails/"+await a+"/ActiveThreadDetails.json",await c)}catch(a){}},resetUIExecutionThread:async function(a,t,e,i,r){try{e=await e.toString().toLowerCase();var o=await n+"/AccountDetails/"+await a+"/ActiveThreadDetails.json",c=await JSON.parse(await w.readFileSync(await o,"utf8")),u=await c[await t];if(void 0!==await u){var l=await c[await t][await r].uiExecutionThread;void 0===await l&&(c[await t][await r].uiExecutionThread={});var d=await c[await t][await r].uiExecutionThread[await e];void 0===await d&&(d=0);var p=Number(await d)-await Number(await i);await Number(await p)<0&&(p=0),c[await t][await r].uiExecutionThread[await e]=await p,await s("AccountDetails/"+await a+"/ActiveThreadDetails.json",await c)}else c[await t]={},c[await t][await r]={},c[await t][await r].uiExecutionThread={},c[await t][await r].uiExecutionThread[await e]=0,await s("AccountDetails/"+await a+"/ActiveThreadDetails.json",await c)}catch(a){}}}},5941:a=>{"use strict";a.exports=require("@faker-js/faker")},5949:a=>{"use strict";a.exports=require("process")},6024:(a,t,e)=>{const i=e(7252),r=e(9896),s=e(6928),n=e(5692),w=e(8611),o=e(8577),c=e(3268),u=e(2096),l=process.env.PORT||3001,d=e(6045),p=e(5347),m=e(9015),v=e(3150),g=e(4355),h=e(7685),f=e(9611),y=e(729),b=e(8011),S=e(5158),x=e(1500),M=e(4982),N=e(8062),T=e(3123),E=e(8870),A=e(6856),P=e(6158),C=e(4403),k=e(6787),j=e(9155),D=e(7565),O=e(3506),I=e(3644),L=e(7449),F=e(7576),U=e(473),V=e(8659),B=e(2072),R=e(9094),J=e(9023),X=e(557),W=e(4623),Y=e(9466),G=e(7582),Q=e(24),q=e(9908),Z=e(4033),K=e(1715),H=e(8688),_=s.join(__dirname,"qaautomater-cert.crt"),z=s.join(__dirname,"qaautomater.com_key.txt"),$=s.join(__dirname,"qaautomater-cert.pfx"),aa=s.join(__dirname,"passphrase.txt"),ta=i(),ea=e(6376);let ia;ta.use(ea({limits:{fileSize:104857600}})),ta.use(u("dev")),ta.use(o()),ta.set("etag",!0),ta.use(i.static(s.join(__dirname,"dataHub"))),ta.use(c.json({limit:"100mb"})),ta.use(c.urlencoded({limit:"100mb",extended:!0})),ta.use("/configuration",d),ta.use("/components",p),ta.use("/users",m),ta.use("/usersession",v),ta.use("/testscripts",g),ta.use("/mockrepo",h),ta.use("/dashboard",f),ta.use("/execution",y),ta.use("/testdata",b),ta.use("/or",S),ta.use("/cicd",x),ta.use("/uidebug",M),ta.use("/seleniummethod",N),ta.use("/customfunction",T),ta.use("/executor",E),ta.use("/cleanup",A),ta.use("/apiexecutor",P),ta.use("/swagger",C),ta.use("/aistep",k),ta.use("/manualconfiguration",j),ta.use("/manualtestcase",D),ta.use("/defect",O),ta.use("/testplan",I),ta.use("/manualdashboard",L),ta.use("/fileupload",F),ta.use("/testtooltestinfo",U),ta.use("/webaction",V),ta.use("/mobileexecutor",B),ta.use("/mobiledebug",R),ta.use("/mobileaction",J),ta.use("/mobileaistep",X),ta.use("/testsuite",W),ta.use("/aboutus",Y),ta.use("/jiraint",G),ta.use("/emailreader",Q),ta.use("/apidebug",q),ta.use("/productupdate",Z),ta.use("/signup",K),ta.use("/license",H),ta.use(i.static(s.join(__dirname,"../ui/build"))),ta.get("*",(a,t)=>{["/configuration","/components","/users","/usersession","/testscripts","/mockrepo","/dashboard","/execution","/testdata","/or","/cicd","/uidebug","/seleniummethod","/customfunction","/executor","/cleanup","/apiexecutor","/swagger","/aistep","/manualconfiguration","/manualtestcase","/defect","/testplan","/manualdashboard","/fileupload","/testtooltestinfo","/webaction","/mobileexecutor","/mobiledebug","/mobileaction","/mobileaistep","/testsuite","/aboutus","/jiraint","/emailreader","/apidebug","/productupdate"].some(t=>a.path.startsWith(t))?t.status(404).send("API route not found"):t.sendFile(s.join(__dirname,"../ui/build/index.html"))});try{const a={cert:r.readFileSync(_),key:r.readFileSync(z,"utf8")};ia=n.createServer(a,ta),console.log("✅ Using CRT + KEY")}catch(a){try{const a={pfx:r.readFileSync($),passphrase:r.readFileSync(aa,"utf8").trim()};ia=n.createServer(a,ta),console.log("✅ Using PFX certificate")}catch(a){console.warn("⚠️ No SSL found, falling back to HTTP"),ia=w.createServer(ta)}}ia.listen(l,()=>{const a=ia instanceof n.Server?"https":"http";console.log(`🚀 QAautoMATER server running on ${a}://localhost:${l}`)}),a.exports=ta},6045:(a,t,e)=>{const i=e(7252).Router(),{saveFile:r,isDirectoryExist:s,createDirectory:n,deleteAllFileFromFolder:w,deleteAllSubfolders:o,isSpaceFreeOnAccount:c,deleteFile:u,readJSONFile:l,saveFileAsEncyptedContent:d}=e(7229);var p="./dataHub/";const m="./dataHub/",{authCheck:v}=e(2258);var g=e(9896);const h=e(2410),f=e(6928),y=e(8215),b="QW@#$#%%%%#CFGH",S=e(2103),x=e(6212);i.get("/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.params.projectName,s=await a.params.testingtype,n=await a.headers.accountlabel,w={};switch(await s){case"Web":case"Mobile":case"Api":break;default:return t.json(w)}try{var o=await n+"/"+await r+"/"+s+"/Configuration.json";try{w=await l(await o)}catch(a){w={}}void 0!==await w.ELEMENTTAGDATA&&0!==await Object.keys(await w.ELEMENTTAGDATA).length||("Web"===await s?(w.ELEMENTTAGDATA={},w.ELEMENTTAGDATA.LINK="//*[self::a]",w.ELEMENTTAGDATA.BUTTON="//*[self::input[@type='submit'] or self::button]",w.ELEMENTTAGDATA.TEXTBOX="//input[not(contains(@type, 'hidden')) and not(contains(@type, 'submit')) and not(contains(@type, 'checkbox')) and not(contains(@type, 'radio'))]",w.ELEMENTTAGDATA.IMAGE="//*[local-name()='svg' or self::img]",w.ELEMENTTAGDATA.CHECKBOX="//input[not(contains(@type, 'hidden')) and @type='checkbox']",w.ELEMENTTAGDATA.RADIOBUTTON="//input[not(contains(@type, 'hidden')) and @type='radio']",w.ELEMENTTAGDATA.LISTBOX="//*[self::select]",w.ELEMENTTAGDATA.TEXTAREA="//textarea[not(contains(@type, 'hidden'))]",w.ELEMENTTAGDATA.LABEL="//*[self::label]",w.ELEMENTTAGDATA.DEFAULT="//*"):"Mobile"===await s&&(w.ELEMENTTAGDATA={},w.ELEMENTTAGDATA.BUTTON={},w.ELEMENTTAGDATA.BUTTON.TAG="//*[self::android.widget.Button]",w.ELEMENTTAGDATA.BUTTON.IOSTAG="//*[self::XCUIElementTypeButton]",w.ELEMENTTAGDATA.TEXTBOX={},w.ELEMENTTAGDATA.TEXTBOX.TAG="//*[self::android.widget.EditText]",w.ELEMENTTAGDATA.TEXTBOX.IOSTAG="//*[self::XCUIElementTypeTextField]",w.ELEMENTTAGDATA.LINK={},w.ELEMENTTAGDATA.LINK.TAG="//*[self::android.widget.TextView]",w.ELEMENTTAGDATA.LINK.IOSTAG="//*[self::XCUIElementType]",w.ELEMENTTAGDATA.IMAGE={},w.ELEMENTTAGDATA.IMAGE.TAG="//*[self::android.widget.ImageView]",w.ELEMENTTAGDATA.IMAGE.IOSTAG="//*[self::XCUIElementTypeImage]",w.ELEMENTTAGDATA.CHECKBOX={},w.ELEMENTTAGDATA.CHECKBOX.TAG="//*[self::android.widget.CheckBox]",w.ELEMENTTAGDATA.CHECKBOX.IOSTAG="//*[self::XCUIElementTypeSwitch]",w.ELEMENTTAGDATA.RADIOBUTTON={},w.ELEMENTTAGDATA.RADIOBUTTON.TAG="//*[self::android.widget.RadioButton]",w.ELEMENTTAGDATA.RADIOBUTTON.IOSTAG="//*[self::XCUIElementTypeSegmentedControl]",w.ELEMENTTAGDATA.LISTBOX={},w.ELEMENTTAGDATA.LISTBOX.TAG="//*[self::android.widget.ListView]",w.ELEMENTTAGDATA.LISTBOX.IOSTAG="//*[self::XCUIElementTypePickerWheel",w.ELEMENTTAGDATA.TEXTAREA={},w.ELEMENTTAGDATA.TEXTAREA.TAG="//*[self::android.widget.EditText]",w.ELEMENTTAGDATA.TEXTAREA.IOSTAG="//*[self::XCUIElementTypeTextField]",w.ELEMENTTAGDATA.LABEL={},w.ELEMENTTAGDATA.LABEL.TAG="//*[self::android.widget.TextView]",w.ELEMENTTAGDATA.LABEL.IOSTAG="//*[self::XCUIElementType]",w.ELEMENTTAGDATA.KEYPAD={},w.ELEMENTTAGDATA.KEYPAD.TAG="//*[self::android.widget.FrameLayout]",w.ELEMENTTAGDATA.KEYPAD.IOSTAG="//*[self::XCUIElementTypeKey]",w.ELEMENTTAGDATA.DEFAULT={},w.ELEMENTTAGDATA.DEFAULT.TAG="//*",w.ELEMENTTAGDATA.DEFAULT.IOSTAG="//*"),"Mobile"===await s&&(void 0===w.ExecutionCapabilities&&(w.ExecutionCapabilities={}),void 0===w.Locator&&(w.Locator=["id","name","xpath","text","resource-id","accessibility id","class","content-desc"])))}catch(a){}t.json(await w)}),i.post("/project/:projectName/testingtype/:testingtype/envlist",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w=await a.headers.accountlabel,o={isFileSaved:!1,errorMessage:""};try{var u=a.params.projectName,p=await c(await w,await u,await r);if(!await p.isSuccess)return o.errorMessage=await p.errorMessage,t.json(o);var m=a.params.testingtype;switch(await m){case"Web":case"Api":case"Mobile":break;default:return o.errorMessage="Invalid Testing Type provided.",t.json(o)}var g=await i.maxNumberOfEnvPerAccount,h=await a.body;if(await h.length>await g)return o.errorMessage="Only "+await g+" environment are allowed per project.If you need add more environment,Please connect with QaBunch support team.",t.json(o);await s(await w+"/"+await u+"/"+await m)||await n(await w+"/"+u+"/"+m);var f={};try{var y=await w+"/"+await u+"/"+m+"/Configuration.json";f=await l(await y)}catch(a){f={}}var b="";if(void 0===await f.DefaultSelectedEnvironment?f.DefaultSelectedEnvironment="":b=await f.DefaultSelectedEnvironment,f.Environment=await h,"Api"===await m){var S=[];for(let a=0;a<await h.length;a++){var x=await h[a].name;await S.push(await x)}var M=await f.Url;if(void 0!==await M)try{var N=await Object.keys(await M);for(let a=0;a<await N.length;a++){var T=await N[a];await S.includes(await T)||delete M[await T]}f.Url=await M}catch(a){}}var E=[];for(let a=0;a<await h.length;a++)x=await h[a].name,await E.push(await x);await E.includes(await b)||await E.length>0&&(f.DefaultSelectedEnvironment=await E[0]),await d(await w+"/"+await u+"/"+await m+"/Configuration.json",await f),o.isFileSaved=!0}catch(a){o.errorMessage=a.toString()}t.json(o)}),i.post("/project/:projectName/testingtype/:testingtype/defaultconfiguration",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w={isFileSaved:!1,errorMessage:""};try{var o={},u=a.params.testingtype,p=a.params.projectName,m=await a.headers.accountlabel,g=await c(await m,await p,await r);if(!await g.isSuccess)return w.errorMessage=await g.errorMessage,t.json(w);await s(await m+"/"+p+"/"+u)||await n(await m+"/"+p+"/"+u);try{var h=await m+"/"+await p+"/"+u+"/Configuration.json";o=await l(await h)}catch(a){}o.DefaultSelectedEnvironment=await a.body.DefaultSelectedEnvironment,o.DefaultReportTrailCount=await a.body.DefaultReportTrailCount,o.DefaultSaveDaysToReport=await a.body.DefaultSaveDaysToReport,o.DefaultSaveDaysToDevelopment=await a.body.DefaultSaveDaysToDevelopment,"Web"===await u&&(o.defaultTimeOut=await a.body.defaultTimeOut,o.SelectedSelfHealingOption=await a.body.SelectedSelfHealingOption,o.SelectedHeadlessOption=await a.body.SelectedHeadlessOption),"Api"!==await u&&(o.DefaultScreenshotOption=await a.body.DefaultScreenshotOption),"Mobile"===await u&&(o.DefaultRunAtOption=await a.body.DefaultRunAtOption,o.DefaultExecutionPlatform=await a.body.DefaultExecutionPlatform,o.defaultTimeOut=await a.body.defaultTimeOut,o.SelectedSelfHealingOption=await a.body.SelectedSelfHealingOption),await d(await m+"/"+p+"/"+u+"/Configuration.json",o),w.isFileSaved=!0}catch(a){w.errorMessage=a.toString()}t.json(w)}),i.post("/project/:projectName/testingtype/:testingtype/env/:envName/envurl",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w={isFileSaved:!1,errorMessage:""};try{var o=a.params.projectName,u=await a.headers.accountlabel,p=await c(await u,await o,await r);if(!await p.isSuccess)return w.errorMessage=await p.errorMessage,t.json(w);var m=a.params.testingtype,g=a.params.envName;await s(await u+"/"+o+"/"+m)||await n(await u+"/"+o+"/"+m);var h={};try{var f=await u+"/"+await o+"/"+m+"/Configuration.json";h=await l(await f)}catch(a){}void 0===h.Url&&(h.Url={}),void 0===h.Url[g]&&(h.Url[g]={}),h.Url[g]=await a.body,await d(await u+"/"+o+"/"+m+"/Configuration.json",h),w.isFileSaved=!0}catch(a){w.errorMessage=a.toString()}t.json(w)}),i.post("/project/:projectName/testingtype/:testingtype/httpheader",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w=await a.headers.accountlabel,o={isFileSaved:!1,errorMessage:""};try{var u=a.params.projectName,p=await c(await w,await u,await r);if(!await p.isSuccess)return o.errorMessage=await p.errorMessage,t.json(o);var m=a.params.testingtype;await s(await w+"/"+u+"/"+m)||await n(await w+"/"+u+"/"+m);var g={};try{var h=await w+"/"+await u+"/"+m+"/Configuration.json";g=await l(await h)}catch(a){}g.HttpHeader=await a.body,await d(await w+"/"+u+"/"+m+"/Configuration.json",g),o.isFileSaved=!0}catch(a){o.errorMessage=a.toString()}t.json(o)}),i.post("/project/:projectName/testingtype/:testingtype/auth",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w=await a.headers.accountlabel,o={isFileSaved:!1,errorMessage:""};try{var u=a.params.projectName,p=await c(await w,await u,await r);if(!await p.isSuccess)return o.errorMessage=await p.errorMessage,t.json(o);var m=a.params.testingtype;await s(await w+"/"+u+"/"+m)||await n(await w+"/"+u+"/"+m);var g={};try{var h=await w+"/"+await u+"/"+m+"/Configuration.json";g=await l(await h)}catch(a){}g.Authorization=await a.body,await d(await w+"/"+u+"/"+m+"/Configuration.json",g),o.isFileSaved=!0}catch(a){o.errorMessage=a.toString()}t.json(o)}),i.post("/project/:projectName/testingtype/:testingtype/emulator",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w=await a.headers.accountlabel,o={isFileSaved:!1,errorMessage:""};try{var u=a.params.projectName,p=await c(await w,await u,await r);if(!await p.isSuccess)return o.errorMessage=await p.errorMessage,t.json(o);var m=a.params.testingtype;switch(await m){case"Web":case"Mobile":break;default:return o.errorMessage="Invalid testing type provided",t.json(o)}await s(await w+"/"+u+"/"+m)||await n(await w+"/"+u+"/"+m);var g={};try{var h=await w+"/"+await u+"/"+m+"/Configuration.json";g=await l(await h)}catch(a){}g.Emulator=await a.body,await d(await w+"/"+u+"/"+m+"/Configuration.json",g),o.isFileSaved=!0}catch(a){o.errorMessage=a.toString()}t.json(o)}),i.post("/project/:projectName/testingtype/:testingtype/defaultscreen",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w=await a.headers.accountlabel,o={isFileSaved:!1,errorMessage:""};try{var u=a.params.projectName,p=await c(await w,await u,await r);if(!await p.isSuccess)return o.errorMessage=await p.errorMessage,t.json(o);var m=a.params.testingtype;await s(await w+"/"+u+"/"+m)||await n(await w+"/"+u+"/"+m);var g={};try{var h=await w+"/"+await u+"/"+m+"/Configuration.json";g=await l(await h)}catch(a){}switch(g.DefaultExecutionPlatform=await a.body.DefaultExecutionPlatform,await g.DefaultExecutionPlatform){case"Desktop":g.DefaultBrowser=await a.body.DefaultBrowser;break;case"Mobile":g.DefaultMobileEmulator=await a.body.DefaultMobileEmulator;break;case"Tablet":g.DefaultTabletEmulator=await a.body.DefaultTabletEmulator;break;default:return o.errorMessage="Wrong platform provided",await t.json(o)}await d(await w+"/"+u+"/"+m+"/Configuration.json",g),o.isFileSaved=!0}catch(a){o.errorMessage=a.toString()}t.json(o)}),i.post("/project/:projectName/testingtype/:testingtype/testingtools",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w=await a.headers.accountlabel,o={isFileSaved:!1,errorMessage:""};try{var u=a.params.projectName,p=await c(await w,await u,await r);if(!await p.isSuccess)return o.errorMessage=await p.errorMessage,t.json(o);var m=a.params.testingtype;switch(await m){case"Web":case"Mobile":break;default:return o.errorMessage="Invalid testing type provided",t.json(o)}await s(await w+"/"+u+"/"+m)||await n(await w+"/"+u+"/"+m);var g={};try{var h=await w+"/"+await u+"/"+m+"/Configuration.json";g=await l(await h)}catch(a){}g.Tools=await a.body,await d(await w+"/"+u+"/"+m+"/Configuration.json",g),o.isFileSaved=!0}catch(a){o.errorMessage=a.toString()}t.json(o)}),i.post("/project/:projectName/testingtype/:testingtype/capability/:capabilityFor",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w=await a.headers.accountlabel,o={isFileSaved:!1,errorMessage:""};try{var u=a.params.projectName,p=await c(await w,await u,await r);if(!await p.isSuccess)return o.errorMessage=await p.errorMessage,t.json(o);var m=a.params.testingtype;switch(await m){case"Web":case"Mobile":break;default:return o.errorMessage="Invalid testing type provided",t.json(o)}var g=a.params.capabilityFor;await s(await w+"/"+u+"/"+m)||await n(await w+"/"+u+"/"+m);var h={};try{var f=await w+"/"+await u+"/"+m+"/Configuration.json";h=await l(await f)}catch(a){}void 0===h.ExecutionCapabilities&&(h.ExecutionCapabilities={}),h.ExecutionCapabilities[g]={},"Web"===await m?h.ExecutionCapabilities[g]=await a.body:h.ExecutionCapabilities[await g]=await await a.body[await g],await d(await w+"/"+u+"/"+m+"/Configuration.json",h),o.isFileSaved=!0}catch(a){o.errorMessage=a.toString()}t.json(o)}),i.post("/project/:projectName/testingtype/:testingtype/deletecomponent",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);if(!await i.isSuperAdmin)return e.errorMessage="The user does not have permission to delete the file",t.status=403,t.json(await e);var r={isFileSaved:!1,errorMessage:""};try{var s=a.body.component;if(""===await s.toString().trim())return r.errorMessage="Please provide correct component name.",t.json(await r);var n=await a.headers.accountlabel,c=await a.params.projectName,u=await a.params.testingtype;switch(await u){case"Web":case"Mobile":case"Api":break;default:return r.errorMessage="Invalid testing type provided",t.json(r)}var l=await p+await n+"/"+await c+"/"+await u+"/TestScripts/"+await s;await w(await n+"/"+await c+"/"+await u+"/TestScripts/"+await s+"/"),await o(await l),await o(await l),r.isFileSaved=!0;try{const a=await m+await n+"/"+await c+"/"+await u+"/TestSuite/*.json";var d=await h.sync(await a);if(await d.length>0)for(let a=0;a<await d.length;a++){var f,y=await d[a];try{await g.existsSync(await y)&&(f=await x.lock(await y,{retries:{retries:10,minTimeout:2e3,maxTimeout:6e4,factor:2}}))}catch(a){return r.errorMessage="Unbale to read file "+y+" because Lock file is already being held "+await a.toString(),console.log("Unbale to read file "+y+" because Lock file is already being held"),t.json(r)}var b=await JSON.parse(await g.readFileSync(await y,"utf8"));if(await JSON.stringify(await b).includes(await s)){var S=await b.testsuite;for(let a=0;a<await S.length;a++){var M=await S[a].component;await s===await M&&(await S.splice(a,1),a--)}if(await S.length>0)for(let a=0;a<await S.length;a++)S[a].id=await Number(a)+1;b.testsuite=await S;var N=await JSON.stringify(await b);await g.writeFileSync(await y,await N)}try{await f()}catch(a){}}}catch(a){try{await f()}catch(a){}}}catch(a){r.errorMessage=a.toString()}t.json(r)}),i.get("/project/:projectName/accountdetails",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={};try{r.maxUsers=await i.maxUsers,r.maxThreadForUI=await i.maxThreadForUI,r.maxThreadForAPI=await i.maxThreadForAPI}catch(a){}t.json(r)}),i.post("/project/:projectName/testingtype/:testingtype/savelocatordata",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,s=a.params.projectName,n=await a.headers.accountlabel,w={isFileSaved:!1,errorMessage:!1},o=await c(await n,await s,await r);if(!await o.isSuccess)return w.errorMessage=await o.errorMessage,t.json(w);var u=await a.params.testingtype;switch(await u){case"Web":case"Mobile":break;default:return w.errorMessage="Invalid testing type provided",t.json(w)}try{var p=await a.body.alllocator;if(0===await p.length)return w.errorMessage="No Locator are found.",t.json(w);var m=await n+"/"+await s+"/"+await u+"/Configuration.json",g=await l(await m),h=await g.Locator;void 0===await h&&(g.Locator=[]),g.Locator=await p,await d(await n+"/"+await s+"/"+await u+"/Configuration.json",await g),w.isFileSaved=!0}catch(a){w.errorMessage=a.toString()}t.json(w)}),i.post("/project/:projectName/testingtype/:testingtype/renamecomponent",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,n=await a.headers.accountlabel,w=(await a.headers.useremail,await a.params.projectName);if(!await i.isSuperAdmin)return e.errorMessage="The user does not have permission to delete the file",t.status=403,t.json(await e);var o={isFileSaved:!1,errorMessage:""},u=await c(await n,await w,await r);if(!await u.isSuccess)return o.errorMessage=await u.errorMessage,t.json(o);try{var l=a.body.oldcomponent;if(""===await l.toString().trim())return o.errorMessage="Incorrect component name.",t.json(await o);var d=a.body.newcomponent;if(""===await d.toString().trim())return o.errorMessage="Incorrect new component name.",t.json(await o);const e=/[\\/:*?"<>|]/;var f=!await e.test(await d);if(!await f)return o.errorMessage="Incorrect new component name.New component name only accepts alphabets",t.json(await o);d=await d.trim();var y=await a.params.testingtype;switch(await y){case"Web":case"Mobile":case"Api":break;default:return o.errorMessage="Invalid testing type provided",t.json(o)}var b=await p+await n+"/"+await w+"/"+await y+"/TestScripts/"+await l,S=await p+await n+"/"+await w+"/"+await y+"/TestScripts/"+await d,M=await s(await n+"/"+await w+"/"+await y+"/TestScripts/"+await l);if(!await M)return o.errorMessage="Component does not found on the server.Please refresh the page",t.json(await o);if(M=await s(await n+"/"+await w+"/"+await y+"/TestScripts/"+await d),await M)return o.errorMessage="New Component name is already exist on the server, Please choose different name.",t.json(await o);await g.renameSync(await b,await S),o.isFileSaved=!0;try{const a=await m+await n+"/"+await w+"/"+await y+"/TestSuite/*.json";var N=await h.sync(await a);if(await N.length>0)for(let a=0;a<await N.length;a++){var T,E=await N[a];try{await g.existsSync(await E)&&(T=await x.lock(await E,{retries:{retries:10,minTimeout:500,maxTimeout:2e3,factor:2}}))}catch(a){return o.errorMessage="Unbale to read file "+E+" because Lock file is already being held "+await a.toString(),console.log("Unbale to read file "+E+" because Lock file is already being held"),t.json(o)}var A=await JSON.parse(await g.readFileSync(await E,"utf8"));if(await JSON.stringify(await A).includes(await l)){var P=await A.testsuite;for(let a=0;a<await P.length;a++){var C=await P[a].component;await l===await C&&(P[await a].component=await d)}A.testsuite=await P;var k=await JSON.stringify(await A);await g.writeFileSync(await E,await k)}try{await T()}catch(a){}}}catch(a){}}catch(a){o.errorMessage=a.toString();try{await T()}catch(a){}}t.json(o)}),i.post("/project/:projectName/testingtype/:testingtype/movetestscripts",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileSaved:!1,errorMessage:!1},n=await a.params.projectName,w=await a.params.testingtype,o=await a.headers.accountlabel;switch(await w){case"Web":case"Mobile":case"Api":break;default:return r.errorMessage="Invalid testing type provided",t.json(r)}try{var c=await a.body.sourceComponent;if(""===await c)return r.errorMessage="source Component can not be blank.",t.json(r);var u=await a.body.destinationComponent;if(""===await u)return r.errorMessage="destination Component can not be blank.",t.json(r);var l=await a.body.listOfTestId;if(0===await l.length)return r.errorMessage="Please select test id to move.",t.json(r);var d=await o+"/"+await n+"/"+await w+"/TestScripts/"+await c,f=await o+"/"+await n+"/"+await w+"/TestScripts/"+await u;if(!await s(await d))return r.errorMessage="source Component "+await c+" does not exist on the server.",t.json(r);if(!await s(await f))return r.errorMessage="Destination Component "+await u+" does not exist on the server.",t.json(r);for(let a=0;a<await l.length;a++){var y=await l[a].value+".json";await g.renameSync(await p+await d+"/"+await y,await p+await f+"/"+await y)}r.isFileSaved=!0;try{const a=await m+await o+"/"+await n+"/"+await w+"/TestSuite/*.json";var b=await h.sync(await a);if(await b.length>0)for(let a=0;a<await b.length;a++){var S,M=await b[a];try{await g.existsSync(await M)&&(S=await x.lock(await M,{retries:{retries:10,minTimeout:500,maxTimeout:2e3,factor:2}}))}catch(a){return fileSaved.errorMessage="Unbale to read file "+M+" because Lock file is already being held "+await a.toString(),console.log("Unbale to read file "+M+" because Lock file is already being held"),t.json(fileSaved)}var N=await JSON.parse(await g.readFileSync(await M,"utf8"));if(await JSON.stringify(await N).includes(await c)){var T=await N.testsuite;for(let a=0;a<await l.length;a++){var E=await l[a].value,A=await E;const t=await A.indexOf("@"),e=await A.substring(0,await t),i=await A.substring(await t+1);if(await JSON.stringify(await N).includes(await i))for(let a=0;a<await T.length;a++){var P=await T[a].component,C=await T[a].testid,k=await T[a].testname;if(await c===await P&&await C===await e&&await k===await i){T[await a].component=await u;break}}}N.testsuite=await T;var j=await JSON.stringify(await N);await g.writeFileSync(await M,await j)}try{await S()}catch(a){}}}catch(a){}}catch(a){r.errorMessage=a.toString();try{await S()}catch(a){}}t.json(r)}),i.post("/project/:projectName/testingtype/:testingtype/updatetag",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w=await a.headers.accountlabel,o={isFileSaved:!1,errorMessage:""};try{var u=a.params.projectName,p=await c(await w,await u,await r);if(!await p.isSuccess)return o.errorMessage=await p.errorMessage,t.json(o);var m=a.params.testingtype;switch(await m){case"Mobile":case"Web":break;default:return o.errorMessage="Invalid Testing Type provided.",t.json(o)}await s(await w+"/"+u+"/"+m)||await n(await w+"/"+u+"/"+m);var g={};try{var h=await w+"/"+await u+"/"+m+"/Configuration.json";g=await l(await h)}catch(a){}void 0===await g.ELEMENTTAGDATA&&("Web"===await m?(g.ELEMENTTAGDATA={},g.ELEMENTTAGDATA.LINK="//*[self::a]",g.ELEMENTTAGDATA.BUTTON="//*[self::input[@type='submit'] or self::button]",g.ELEMENTTAGDATA.TEXTBOX="//input[not(contains(@type, 'hidden')) and not(contains(@type, 'submit')) and not(contains(@type, 'checkbox')) and not(contains(@type, 'radio'))]",g.ELEMENTTAGDATA.IMAGE="//*[local-name()='svg' or self::img]",g.ELEMENTTAGDATA.CHECKBOX="//input[not(contains(@type, 'hidden')) and @type='checkbox']",g.ELEMENTTAGDATA.RADIOBUTTON="//input[not(contains(@type, 'hidden')) and @type='radio']",g.ELEMENTTAGDATA.LISTBOX="//*[self::select]",g.ELEMENTTAGDATA.TEXTAREA="//textarea[not(contains(@type, 'hidden'))]",g.ELEMENTTAGDATA.LABEL="//*[self::label]",g.ELEMENTTAGDATA.DEFAULT="//*"):"Mobile"===await m&&(g.ELEMENTTAGDATA={},g.ELEMENTTAGDATA.BUTTON={},g.ELEMENTTAGDATA.BUTTON.TAG="//android.widget.Button",g.ELEMENTTAGDATA.BUTTON.IOSTAG="//*",g.ELEMENTTAGDATA.TEXTBOX={},g.ELEMENTTAGDATA.TEXTBOX.TAG="//android.widget.TextView",g.ELEMENTTAGDATA.TEXTBOX.IOSTAG="//*",g.ELEMENTTAGDATA.LINK={},g.ELEMENTTAGDATA.LINK.TAG="//android.widget.Button",g.ELEMENTTAGDATA.LINK.IOSTAG="//*",g.ELEMENTTAGDATA.IMAGE={},g.ELEMENTTAGDATA.IMAGE.TAG="//android.widget.Image",g.ELEMENTTAGDATA.IMAGE.IOSTAG="//*",g.ELEMENTTAGDATA.CHECKBOX={},g.ELEMENTTAGDATA.CHECKBOX.TAG="//android.widget.TextView",g.ELEMENTTAGDATA.CHECKBOX.IOSTAG="//*",g.ELEMENTTAGDATA.RADIOBUTTON={},g.ELEMENTTAGDATA.RADIOBUTTON.TAG="//android.widget.TextView",g.ELEMENTTAGDATA.RADIOBUTTON.IOSTAG="//*",g.ELEMENTTAGDATA.LISTBOX={},g.ELEMENTTAGDATA.LISTBOX.TAG="//android.widget.Select",g.ELEMENTTAGDATA.LISTBOX.IOSTAG="//*",g.ELEMENTTAGDATA.TEXTAREA={},g.ELEMENTTAGDATA.TEXTAREA.TAG="//android.widget.TextArea",g.ELEMENTTAGDATA.TEXTAREA.IOSTAG="//*",g.ELEMENTTAGDATA.LABEL={},g.ELEMENTTAGDATA.LABEL.TAG="//android.view.View",g.ELEMENTTAGDATA.LABEL.IOSTAG="//*",g.ELEMENTTAGDATA.DEFAULT={},g.ELEMENTTAGDATA.DEFAULT.TAG="//*",g.ELEMENTTAGDATA.DEFAULT.IOSTAG="//*"));var f=await await a.body.elementtag,y=await Object.keys(await f);for(let a=0;a<await y.length;a++){var b=await y[a].toString().trim().toUpperCase();g.ELEMENTTAGDATA[await b]=await f[await b]}await d(await w+"/"+await u+"/"+m+"/Configuration.json",await g),o.isFileSaved=!0}catch(a){o.errorMessage=a.toString()}t.json(o)}),i.post("/project/:projectName/testingtype/:testingtype/savedbdetails",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w=await a.headers.accountlabel,o={isFileSaved:!1,errorMessage:""};try{var u=a.params.projectName,p=await c(await w,await u,await r);if(!await p.isSuccess)return o.errorMessage=await p.errorMessage,t.json(o);var m=a.params.testingtype,g=await a.body.env.toString().trim(),h=await a.body.server.toString().trim(),f=await a.body.host.toString().trim(),y=await a.body.user.toString().trim(),b=await a.body.password.toString().trim(),S=await a.body.databasename.toString().trim(),x=await a.body.port.toString().trim();switch(await m){case"Mobile":case"Web":break;default:return o.errorMessage="Invalid Testing Type provided.",t.json(o)}if(""===await g||""===await h||""===await f||""===await y||""===await b||""===await S)return o.errorMessage="Please provide the correct test data in request body.",t.json(o);await s(await u+"/"+await m)||await n(await u+"/"+await m);var M={};try{var N=await w+"/"+await u+"/"+await m+"/Configuration.json";M=await l(await N)}catch(a){}void 0===await M.DBDETAILS&&(M.DBDETAILS={}),void 0===await M.DBDETAILS[await g]&&(M.DBDETAILS[await g]={}),M.DBDETAILS[await g]={},void 0===await M.DBDETAILS[await g][await h]&&(M.DBDETAILS[await g][await h]={}),M.DBDETAILS[await g][await h].host=await f,M.DBDETAILS[await g][await h].user=await y,M.DBDETAILS[await g][await h].password=await b,M.DBDETAILS[await g][await h].databasename=await S,M.DBDETAILS[await g][await h].port=await x,await d(await w+"/"+u+"/"+m+"/Configuration.json",await M),o.isFileSaved=!0}catch(a){o.errorMessage=a.toString()}t.json(o)}),i.post("/project/:projectName/testingtype/:testingtype/deletedbdetails",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileSaved:!1,errorMessage:""};try{var n=a.params.projectName,w=a.params.testingtype,o=await a.body.env.toString().trim(),c=await a.headers.accountlabel;switch(await w){case"Mobile":case"Web":break;default:return r.errorMessage="Invalid Testing Type provided.",t.json(r)}if(""===await o)return r.errorMessage="Please provide the correct test data in request body.",t.json(r);var u=await s(await c+"/"+await n+"/"+await w);if(!await u)return r.errorMessage="Configuration file does not found for account "+await n,t.json(r);var p={};try{var m=await c+"/"+await n+"/"+await w+"/Configuration.json";p=await l(await m)}catch(a){return r.errorMessage="Configuration file does not found for account "+await n,t.json(r)}var g=await p.DBDETAILS;delete g[await o],p.DBDETAILS=await g,await d(await c+"/"+n+"/"+w+"/Configuration.json",await p),r.isFileSaved=!0}catch(a){r.errorMessage=a.toString()}t.json(r)}),i.post("/project/:projectName/testingtype/:testingtype/pageloaderxpath",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w=a.params.projectName,o=await a.headers.accountlabel,u={isFileSaved:!1,errorMessage:!1},p=await c(await o,await w,await r);if(!await p.isSuccess)return u.errorMessage=await p.errorMessage,t.json(u);var m=await a.params.testingtype;switch(await m){case"Web":var g=await a.body.allxpath;break;case"Mobile":var h=await a.body,f=await Object.keys(await h)[0];if(void 0===f)return u.errorMessage="Platform Can not be blank.",t.json(u);g=await h[await f].allxpath;break;default:return u.errorMessage="Invalid testing type provided",t.json(u)}try{if(void 0===await g.length)return u.errorMessage="Bad Input provided.",t.json(u);for(let a=0;a<await g.length;a++){var y=await g[a].xpath;if(y=await y.toString().trim(),""===await y||!await y.startsWith("//"))return u.errorMessage="Please provide the correct Xpath Information Xpath should be started with //.",t.json(u)}var b=await o+"/"+await w+"/"+await m+"/Configuration.json",S=await s(await o+"/"+await w+"/"+await m);await S||await n(await o+"/"+w+"/"+await m);try{configData=await l(await b)}catch(a){configData={}}var x=await configData.PageLoaderXpath;void 0===await x&&("Web"===await m&&(configData.PageLoaderXpath=[]),"Mobile"===await m&&(configData.PageLoaderXpath={},configData.PageLoaderXpath[await f]=[])),"Web"===await m&&(configData.PageLoaderXpath=await g),"Mobile"===await m&&(configData.PageLoaderXpath[await f]=await g),await d(await o+"/"+await w+"/"+await m+"/Configuration.json",await configData),u.isFileSaved=!0}catch(a){u.errorMessage=a.toString()}t.json(u)}),i.post("/project/:projectName/testingtype/:testingtype/deletecloudserverdetails",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,n=await a.headers.accountlabel,w={isFileSaved:!1,errorMessage:""};try{var o=a.params.projectName,u=await c(await n,await o,await r);if(!await u.isSuccess)return w.errorMessage=await u.errorMessage,t.json(w);var p=a.params.testingtype;switch(await p){case"Web":case"Mobile":break;default:return w.errorMessage="Invalid testing type provided",t.json(w)}if(!await s(await n+"/"+o+"/"+p))return w.isFileSaved=!0,w.errorMessage="Configuration file is not found on the server",t.json(w);var m=await a.body.cloudservername;if(""===await m.toString().trim())return w.isFileSaved=!1,w.errorMessage="Please provide the correct cloud server name",t.json(w);var g={};try{var h=await n+"/"+await o+"/"+p+"/Configuration.json";g=await l(await h)}catch(a){return w.isFileSaved=!0,w.errorMessage="Configuration file is not found on the server",t.json(w)}var f=await g.ExecutionCapabilities;if(void 0===await f)return w.isFileSaved=!0,w.errorMessage="There is no cloud details are found on the server.",t.json(w);var y=await Object.keys(await f),b=!1;for(let a=0;a<await y.length;a++)await y[a]===await m&&(b=!0);if(!await b)return w.isFileSaved=!0,w.errorMessage=await m+" cloud details is not found on the server.",t.json(w);delete f[await m],g.ExecutionCapabilities=await f,await d(await n+"/"+o+"/"+p+"/Configuration.json",g),w.isFileSaved=!0}catch(a){w.errorMessage=a.toString()}t.json(w)}),i.post("/project/:projectName/testingtype/:testingtype/gettestsuitenamelist",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=[];try{var n=a.params.projectName,w=a.params.testingtype,o=a.body.envName,c=await a.headers.accountlabel;if(!await s(await c+"/"+n+"/"+w))return t.json(r);var u=await p+await c+"/"+await n+"/"+await w+"/Reports/"+await o+"/*.json",l=await h.sync(await u);if(await l.length>0){var d=await l.map(a=>f.parse(a).name),m=[];for(let a=0;a<await d.length;a++){var g=await d[a];const t=await g.lastIndexOf("-");var y=-1!==await t?await g.substring(0,t):g;await m.includes(await y)||m.push(await y)}for(let a=0;a<await m.length;a++){var b=await m[a];await r.includes(await b)||r.push(await b)}}}catch(a){r=[]}t.json(r)}),i.post("/project/:projectName/testingtype/:testingtype/getexecutedbylist",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=[];try{var n=a.params.projectName,w=a.params.testingtype,o=a.body.envName,c=a.body.testSuiteName,u=await a.headers.accountlabel;if(!await s(await u+"/"+n+"/"+w))return t.json(r);var l=await p+await u+"/"+await n+"/"+await w+"/Reports/"+await o+"/"+await c+"-*.json",d=await h.sync(await l);if(await d.length>0)for(let a=0;a<await d.length;a++){var m=await JSON.parse(await g.readFileSync(await d[a],"utf8")),f=await m.executedBy;void 0!==await f&&(await r.includes(await f)||r.push(await f))}}catch(a){r=[]}t.json(r)}),i.post("/project/:projectName/testingtype/:testingtype/getexecutiondateandtime",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=[];try{var n=await a.headers.accountlabel,w=a.params.projectName,o=a.params.testingtype,c=a.body.envName,u=a.body.executedBy,l=a.body.testSuiteName;if(!await s(await n+"/"+w+"/"+o))return t.json(r);var d=await p+await n+"/"+await w+"/"+await o+"/Reports/"+await c+"/"+await l+"-*.json",m=await h.sync(await d);if(await m.length>0)for(let a=0;a<await m.length;a++){var y=await JSON.parse(await g.readFileSync(await m[a],"utf8"));if(await y.executedBy===await u){const t=await f.parse(await m[a]),e=await t.name;var b=await e.split(await l+"-")[1];r.push(await b)}}}catch(a){r=[]}t.json(r)}),i.post("/project/:projectName/testingtype/:testingtype/gettestsuitereports",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={};try{var n=await a.headers.accountlabel,w=a.params.projectName,o=a.params.testingtype,c=a.body.envName,u=a.body.executionTime,l=a.body.testSuiteName;if(!await s(await n+"/"+w+"/"+o))return t.json(r);var d=await p+await n+"/"+await w+"/"+await o+"/Reports/"+await c+"/"+await l+"-"+await u+".json",m=await h.sync(await d);if(await m.length>0){r=await JSON.parse(await g.readFileSync(await m[0],"utf8"));try{var f=await r.listOfExecutedTestScripts;if(await f.length>0){for(let a=0;a<await f.length;a++)f[await a].id=Number(a)+1;r.listOfExecutedTestScripts=await f}}catch(a){}}}catch(a){r={}}t.json(r)}),i.get("/project/:projectName/testingtype/:testingtype/getuploadedfiles",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=[];try{var s=await a.headers.accountlabel,n=await a.params.projectName,w=await a.params.testingtype;switch(await w){case"Web":case"Mobile":case"Api":break;default:return t.json(uploadDetails)}var o=await p+await s+"/"+await n+"/"+await w+"/Uploads/*",c=await h.sync(await o);if(await c.length>0)for(let a=0;a<await c.length;a++){var u=await c[a],l=await f.basename(await u);await r.push(await l)}}catch(a){r=[]}t.json(r)}),i.post("/project/:projectName/testingtype/:testingtype/deleteuploadedfiles",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isSuccess:!1,errorMessage:""};try{var s=await a.headers.accountlabel,n=await a.params.projectName,w=await a.params.testingtype,o=await a.body.fileName;switch(await w){case"Web":case"Mobile":case"Api":break;default:return t.json(r)}var c=await p+await s+"/"+await n+"/"+await w+"/Uploads/"+await o,l=await h.sync(await c);await l.length>0?(await u(await s+"/"+await n+"/"+await w+"/Uploads/"+await o),r.isSuccess=!0):(r.isSuccess=!0,r.errorMessage="File already has been deleted.")}catch(a){r.errorMessage=await a}t.json(r)}),i.post("/testingtype/:testingtype/getscreenshot",async(a,t)=>{var e={errorMessage:"",screenshotdata:""},i=await v(await a);if(!await i.isSuccess)return e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var r=await a.params.testingtype,s=await a.body.screenshotpath;switch(await a.headers.accountlabel,await r){case"Web":case"Mobile":break;default:return e.errorMessage="Invalid testing type provided.",t.json(e)}const i=await S.AES.decrypt(await s,await b);var n=await i.toString(S.enc.Utf8),w=await g.readFileSync(await n,{encoding:"binary"});const o=Buffer.from(await w,"binary").toString("base64");e.screenshotdata=await o}catch(a){var o=await y.generate(await a.toString());o=await o.split(",")[1],e.screenshotdata=await o}t.json(e)}),i.post("/project/:projectName/testingtype/:testingtype/savethirdpartyaitoolsdata",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w=await a.headers.accountlabel,o={isFileSaved:!1,errorMessage:""};try{var u={},p=a.params.testingtype,m=a.params.projectName;switch(await p){case"Web":case"Mobile":break;default:return o.errorMessage="Invalid testing type provided.",t.json(o)}var g=await c(await w,await m,await r);if(!await g.isSuccess)return o.errorMessage=await g.errorMessage,t.json(o);await s(await w+"/"+m+"/"+p)||await n(await w+"/"+m+"/"+p);try{var h=await w+"/"+await m+"/"+p+"/Configuration.json";u=await l(await h)}catch(a){u={}}var f=await a.body.ThirdPartyAiToolsData;if(void 0===await f)return o.errorMessage="Request body is invalid.",t.json(o);if(await f.length>1)return o.errorMessage="Request body is invalid.",t.json(o);var y=await f[0].token;if(void 0===await y)return o.errorMessage="Request body is invalid.",t.json(o);void 0===await u.ThirdPartyAiToolsData&&(u.ThirdPartyAiToolsData=[]),u.ThirdPartyAiToolsData=await f,await d(await w+"/"+m+"/"+p+"/Configuration.json",u),o.isFileSaved=!0}catch(a){o.errorMessage=a.toString()}t.json(o)}),i.post("/project/:projectName/testingtype/:testingtype/saveemaildetails",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w=await a.headers.accountlabel,o={isFileSaved:!1,errorMessage:""};try{var u=a.params.projectName,p=await c(await w,await u,await r);if(!await p.isSuccess)return o.errorMessage=await p.errorMessage,t.json(o);var m=a.params.testingtype,g=await a.body.protocol.toString().trim(),h=await a.body.host.toString().trim(),f=await a.body.port.toString().trim(),y=await a.body.senderEmail.toString().trim(),b=await a.body.password.toString().trim(),S=await a.body.recipientEmail.toString().trim();switch(await m){case"Mobile":case"Web":case"Api":break;default:return o.errorMessage="Invalid Testing Type provided.",t.json(o)}if(""===await g||""===await h||""===await f||""===await y||""===await S)return o.errorMessage="Please provide the correct test data in request body.",t.json(o);const e=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;if(!await e.test(await y))return o.errorMessage="Sender email is not valid.",t.json(o);try{if(!S.split(/[\s,;]+/).filter(a=>""!==a.trim()).every(a=>e.test(a.trim())))return o.errorMessage="Recipient Email email is not valid.",t.json(o)}catch(a){}await s(await w+"/"+await u+"/"+await m)||await n(await w+"/"+await u+"/"+await m);var x={};try{var M=await w+"/"+await u+"/"+await m+"/Configuration.json";x=await l(await M)}catch(a){x={}}void 0===await x.EMAILDETAILS&&(x.EMAILDETAILS={}),x.EMAILDETAILS.DefaultEmailProtocol=await g,void 0===await x.EMAILDETAILS[await g]&&(x.EMAILDETAILS[await g]={}),x.EMAILDETAILS[await g].host=await h,x.EMAILDETAILS[await g].port=await Number(await f),x.EMAILDETAILS[await g].senderEmail=await y,x.EMAILDETAILS[await g].password=await b,x.EMAILDETAILS[await g].recipientEmail=await S,await d(await w+"/"+u+"/"+m+"/Configuration.json",await x),o.isFileSaved=!0}catch(a){o.errorMessage=a.toString()}t.json(o)}),i.post("/project/:projectName/testingtype/:testingtype/deleteemaildetails",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileSaved:!1,errorMessage:""};try{var n=a.params.projectName,w=a.params.testingtype,o=await a.body.protocol.toString().trim(),c=await a.headers.accountlabel;switch(await w){case"Mobile":case"Web":case"Api":break;default:return r.errorMessage="Invalid Testing Type provided.",t.json(r)}if(void 0===await o||""===await o)return r.errorMessage="Please provide the correct test data in request body.",t.json(r);var u=await s(await c+"/"+await n+"/"+await w);if(!await u)return r.errorMessage="Configuration file does not found for account "+await n,t.json(r);var p={};try{var m=await c+"/"+await n+"/"+await w+"/Configuration.json";p=await l(await m)}catch(a){return r.errorMessage="Configuration file does not found for account "+await n,t.json(r)}var g=await p.EMAILDETAILS;g.DefaultEmailProtocol="",delete g[await o],p.EMAILDETAILS=await g,await d(await c+"/"+n+"/"+w+"/Configuration.json",await p),r.isFileSaved=!0}catch(a){r.errorMessage=a.toString()}t.json(r)}),i.post("/project/:projectName/testingtype/:testingtype/mobileapplicationdetails",async(a,t)=>{var e={},i=await v(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.headers.accountlabel,w=await i.totalStorage,o={isFileSaved:!1,errorMessage:""};try{var u={},p=a.params.projectName,m=a.params.testingtype;if("Mobile"!==await m)return o.errorMessage="Invalid Testing Type provided.",t.json(o);var g=await c(await r,await p,await w);if(!await g.isSuccess)return o.errorMessage=await g.errorMessage,t.json(o);if(void 0===await p)return o.errorMessage="Project name can not be blank.",t.json(o);var h=await a.body;if(void 0===await h)return o.errorMessage="Request body has incorrect data",t.json(o);var f=await Object.keys(await h)[0];if(void 0===await f)return o.errorMessage="Request body has incorrect data",t.json(o);await s(await r+"/"+p+"/"+m)||await n(await r+"/"+p+"/"+m);try{var y=await r+"/"+await p+"/"+m+"/Configuration.json";u=await l(await y)}catch(a){u={}}void 0===await u.ApplicationDetails&&(u.ApplicationDetails={},u.ApplicationDetails[await f]=[]),void 0===await u.ApplicationDetails[await f]&&(u.ApplicationDetails[await f]=[]),u.ApplicationDetails[await f]=await h[await f],await d(await r+"/"+p+"/"+m+"/Configuration.json",u),o.isFileSaved=!0}catch(a){o.errorMessage=a.toString()}t.json(o)}),i.post("/getscreenshotfortestcaseintotestplan",async(a,t)=>{var e={errorMessage:"",screenshotdata:""},i=await v(await a);if(!await i.isSuccess)return e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var r=await a.params.testingtype,s=await a.body.screenshotpath;switch(await a.headers.accountlabel,await r){case"Web":case"Mobile":break;default:return e.errorMessage="Invalid testing type provided.",t.json(e)}const i=await S.AES.decrypt(await s,await b);var n=await i.toString(S.enc.Utf8),w=await g.readFileSync(await n,{encoding:"binary"});const o=Buffer.from(await w,"binary").toString("base64");e.screenshotdata=await o}catch(a){var o=await y.generate(await a.toString());o=await o.split(",")[1],e.screenshotdata=await o}t.json(e)}),a.exports=i},6158:(a,t,e)=>{const i=e(7252).Router(),{executeApiTestScript:r}=e(645),{getActiveThreadCounter:s,getPlanForAccount:n,addUIExecutionThread:w,resetUIExecutionThread:o}=e(5843),{saveFile:c,isDirectoryExist:u,createDirectory:l,addOrSubtractDaysToCurrentDate:d,addLogMessageInConsole:p,isSpaceFreeOnAccount:m,readJSONFile:v}=e(7229),g="./dataHub/",{authCheck:h}=e(2258),{sendEmail:f,sendEmailUsingSMTPRelay:y}=e(1751);var b=e(9896);const S=e(2410);async function x(a,t,e){for(let s=0;s<await a.length;s++){var i=await a[s].component,r=await a[s].testid;if(await i===await t&&await r===await e)return s}return-1}async function M(a,t,e,i,r,s,n,w,o,c,u,l,d){try{if(void 0!==await a&&"Yes"===await a&&void 0!==await t&&""!==await t&&void 0!==await e&&void 0!==await e.EMAILDETAILS){var p=await e.EMAILDETAILS.DefaultEmailProtocol;if(void 0!==await p&&""!==await p){var m=await e.EMAILDETAILS[await p],v={};v.host=await m.host,v.port=await m.port,v.senderEmail=await m.senderEmail,v.password=await m.password,v.recipientEmail=await t,v.TitlePrefix=await i,v.env=await r,v.executionDate=await s,v.executionTime=await n,v.totalPass=await w,v.totalFail=await o,v.suiteName=await u,v.executedBy=await l,v.resultOfTestScripts=await d,v.totalExecutionTime=await async function(a){try{a=await Number(await a);let t=Math.floor(await a/3600),e=Math.floor(await a%3600/60),i=await a%60,r=[];return await t>0&&r.push(`${t} hour${t>1?"s":""}`),await e>0&&r.push(`${e} minute${e>1?"s":""}`),await i>0&&r.push(`${i} second${i>1?"s":""}`),r.length>0?r.join(" "):"0 seconds"}catch(t){return a+" seconds"}}(await c),"SMTP Relay"===await p?await y(await v):await f(await v)}}}catch(a){console.log("Email Sent exception ocuured "+await a.toString())}}i.post("/project/:projectName",async(a,t)=>{var e={},i=await h(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var f=await i.totalStorage,y=await a.headers.accountlabel,N=!1;try{var T=await a.params.projectName,E=await a.headers.useremail,A={listOfTestScipts:[],testscriptAssertionData:[],executionTimeForTestScripts:{},globalError:""},P=await m(await y,await T,await f);if(!await P.isSuccess)return A.globalError=await P.errorMessage,console.log("********* Execution is triggered by the user "+await E+"unsufficient space "+await P.errorMessage),t.json(A);var C={},k={},j=0,D=0,O={},I=new Date,L=await d(0,"DD MMM YYYY"),F=await d(0,"hh mm A"),U=await a.body.environment,V=await Number(await a.body.threadCount),B=await a.body.testingType,R=await a.body.reportInDashBoard,J=await a.body.testscriptforExecution,X=await a.body.emailTriggerValue,W=await a.body.recipientEmail,Y=await a.body.suiteName,G=!0;void 0!==await Y&&"CustomTestScriptSelection"!==await Y||(Y="CustomTestScriptSelection",G=!1);var Q=[],q={};try{var Z=await y+"/"+await T+"/Api/Configuration.json";q=await v(await Z)}catch(a){}var K={};try{Z=await y+"/"+await T+"/Api/CommonTestData.json";var H=await v(await Z);K=await H.CommonTestData}catch(a){K={}}var _=await J.length;_<=V&&(V=await _);var z=await s(await y,await T,"Api"),$=await n(await i),aa=Number(await $.maxThreadForAPI);if(await z>=Number(await $.maxThreadForAPI))return A.globalError=await aa+" thread are already active, as per your plan max "+await aa+" thread can be active at a time, Please release the thread or wait till thread get released.",console.log("********* Execution is triggered by the user "+await E+"unsufficient thread "+await A.globalError),t.json(await A);var ta=Number(await aa)-Number(await z);if(Number(await V)>Number(await ta))return A.globalError="Only "+await ta+" thread is/are available.Please update Thread count* as per availability",console.log("********* Execution is triggered by the user "+await E+"unsufficient thread "+await A.globalError),t.json(await A);await w(await y,await T,await E,await V,"Api"),N=!0,console.log("********* Execution is triggered by the user "+await E+" with Environment "+await U+", thread count "+await V+", Report to be saved in Dashboard value "+await R+",testsuite,"+await Y+" and test script count "+await _);var ea=[],ia=[];for(let a=0;a<await J.length;a++){var ra={},sa=await a+1;try{var na=await J[a].component;if(void 0!==await na&&null!==await na&&""!==await na){var wa=await J[a].testid,oa=await J[a].testname,ca=await wa+"@"+await oa;ra[await wa]={};var ua=r(await y,await T,await na,await sa,await ca,await wa,await U,await q,await ra,await B,void 0,await K);ea.push(ua),await new Promise(a=>setTimeout(a,1e3)),ia.push(ua),await ia.length===await V&&await Promise.any(ia.map((a,t)=>a.then(a=>[a,t]))).then(([a,t])=>{ia.splice(t,1)})}}catch(t){console.log("Exception: for reading component for test script index "+await a+" , hence skipping this test script "+JSON.stringify(await J))}}await Promise.all(await ea).then(a=>{var t=a;for(let a=0;a<t.length;a++){var e=Number(a+1);J[a].id=e,"Pass"===t[a].isSuccess?(J[a].status="Pass",j+=1):(J[a].status="Fail",D+=1),C[e.toString()]=t[a].assertionData[e],k[e.toString()]=t[a].responseData[e],O[Number(e)]=t[a].executiontime;var i={component:J[a].component,duration:t[a].executiontime};Q.push(i)}}),A.executionTimeForTestScripts=await O,A.listOfTestScipts=await J,A.testscriptAssertionData=await C,A.testscriptResponseData=await k;var la={};for(let a=0;a<await Q.length;a++){var da=await Q[a].component,pa=await Q[a].duration;void 0===await la[da]?la[await da]=Number(await pa):la[await da]=Number(la[da])+Number(await pa),await la[await da].toString().includes(".")&&(la[await da]=await la[await da].toFixed(2))}if(A.executionTimeForComponent=await la,"yes"===await R.toString().toLowerCase()){G=!0,Y=await a.body.suiteName;var ma=await A.listOfTestScipts;void 0!==await Y&&"CustomTestScriptSelection"!==await Y||(Y="CustomTestScriptSelection",G=!1);var va={},ga=await a.body.existingSuiteName,ha=await g+await y+"/"+T+"/Api/Reports/"+await U+"/"+ga+".json",fa=await b.existsSync(await ha);if(""!==await ga&&void 0!==await ga&&await fa){var ya=((new Date).getTime()-I.getTime())/1e3;ya=await Number(await ya.toString().split(".")[0]),va={TimeStamp:await L+" "+await F,TotalTestScripts:await ma.length,Duration:await ya+" seconds",ExecutedBy:await E},Z=await g+await y+"/"+T+"/Api/Reports/"+await U+"/"+ga+".json";var ba=await JSON.parse(await b.readFileSync(await Z,"utf8"));for(let a=0;a<await ma.length;a++){var Sa=await ma[a].component,xa=await ma[a].testid,Ma=await ma[a].status,Na=await x(await ba.listOfExecutedTestScripts,await Sa,await xa);if(await Na>=0){var Ta=await ba.listOfExecutedTestScripts[await Na].status;if(ma[a].id=Number(await Na)+1,ba.listOfExecutedTestScripts[await Na]=await ma[a],ba.assertionResultsForAllTestScripts[Number(await Na+1).toString()]=await A.testscriptAssertionData[Number(await a+1).toString()],await Ma!==await Ta)if("pass"===await Ma.toLowerCase()){var Ea=Number(ba.totalPass),Aa=Number(ba.totalFail);ba.totalPass=await Ea+1,""!==await Ta&&(ba.totalFail=await Aa-1);var Pa=Number(ba.componentPassFail[0][await Sa]),Ca=Number(ba.componentPassFail[1][await Sa]);ba.componentPassFail[0][await Sa]=await Pa+1,""!==await Ta&&(ba.componentPassFail[1][await Sa]=await Ca-1)}else"fail"===await Ma.toLowerCase()&&(Ea=Number(ba.totalPass),Aa=Number(ba.totalFail),""!==await Ta&&(ba.totalPass=await Ea-1),ba.totalFail=await Aa+1,Pa=Number(ba.componentPassFail[0][await Sa]),Ca=Number(ba.componentPassFail[1][await Sa]),""!==await Ta&&(ba.componentPassFail[0][await Sa]=await Pa-1),ba.componentPassFail[1][await Sa]=await Ca+1)}}void 0===await ba.testSuiteReExecutionHistory&&(ba.testSuiteReExecutionHistory=[]),ba.testSuiteReExecutionHistory.push(await va),await c(await y+"/"+T+"/Api/Reports/"+await U+"/"+ga+".json",await ba);try{ya=((new Date).getTime()-I.getTime())/1e3,ya=await Number(await ya.toString().split(".")[0]);var ka=await ga;await ka.includes("-")&&(ka=await ka.split("-")[0]),await M(await X,await W,await q,"Api",await U,await L,await F,await j,await D,await ya,await ka,await E,await A),await p(await E+" Total "+await j+" scripts get passed.  "+await D+" scripts get failed and total execution time is "+await ya+" seconds.")}catch(a){}}else{var ja=[],Da={},Oa={};for(let a=0;a<await ma.length;a++){Sa=await ma[a].component,void 0===Da[await Sa]&&(Da[await Sa]=0),void 0===Oa[await Sa]&&(Oa[await Sa]=0);var Ia=await ma[a].status;"Pass"===await Ia?Da[await Sa]=await Da[await Sa]+1:"Fail"===await Ia&&(Oa[await Sa]=await Oa[await Sa]+1)}ja.push(await Da),ja.push(await Oa);var La={};La.executedBy=await E,La.executionStartDate=await L,La.executionStartTime=await F,La.testingType=await B,La.listOfExecutedTestScripts=await A.listOfTestScipts,La.assertionResultsForAllTestScripts=await A.testscriptAssertionData,La.testResultsDataForAllTestScripts=await A.testscriptResponseData,La.environment=await U,La.totalPass=await j,La.totalFail=await D,La.componentPassFail=await ja,La.executionTimeData=await A.executionTimeForComponent;var Fa=await a.body.triggerFrom;void 0===await Fa&&(Fa="QAautoMATER UI"),La.triggerFrom=await Fa,ya=((new Date).getTime()-I.getTime())/1e3,ya=Number(await ya.toString().split(".")[0]),La.totalExecutionTime=await ya,await u(await y+"/"+T+"/Api/Reports/"+U)||await l(await y+"/"+T+"/Api/Reports/"+await U);var Ua=La.executionStartDate.toString().trim()+"_"+La.executionStartTime.toString().trim(),Va=await La.executionStartTime.toString().trim(),Ba=await Va.split(" "),Ra=Number(await Ba[1]);for(let a=0;a<60;a++){var Ja=await y+"/"+T+"/Api/Reports/"+await U+"/*"+await Ua+".json";if(0==(await S.sync(await Ja)).length)break;if(59==await Ra){Ra=0;var Xa=Number(await Ba[0]);Xa=Number(await Xa)+1;var Wa=await Xa.toString();1===await Wa.toString().length&&(Wa="0"+await Wa),Ba[0]=await Wa}else Ra=Number(await Ra)+1;var Ya=await Ra.toString();1===await Ya.toString().length&&(Ya="0"+await Ya),Va=await Ba[0]+" "+await Ya+" "+Ba[2],Ua=await La.executionStartDate.toString().trim()+"_"+await Va.toString().trim()}if(await fa||""===ga)Ua=await Y+"-"+await Ua;else{try{await ga.includes("-")&&(ga=await ga.split("-")[0])}catch(a){ga=await Y}Y=await ga,Ua=await ga+"-"+await Ua}if(La.suiteName=await Y,await G||"CustomTestScriptSelection"!==await Y)try{var Ga=await Y,Qa=await g+await y+"/"+T+"/Api/TestSuite/"+Ga+".json",qa=await b.existsSync(await Qa);if(await qa){var Za=await JSON.parse(await b.readFileSync(await Qa,"utf8")),Ka=await Za.testsuite;if(await Ka.length!==await _){var Ha=await A.testscriptAssertionData,_a=await A.listOfTestScipts,za=[],$a={};for(let a=0;a<await Ka.length;a++){var at=await Ka[a];at.status="";var tt=await at.id,et=await at.component,it=await at.testid;for(let a=0;a<await _a.length;a++){var rt=await _a[a].component,st=await _a[a].testid;if(await rt==await et&&await st==await it){at.status=await _a[a].status,$a[await tt.toString()]=await Ha[await _a[a].id.toString()];break}}za.push(await at)}La.assertionResultsForAllTestScripts=await $a,La.listOfExecutedTestScripts=await za}}}catch(a){}await c(await y+"/"+T+"/Api/Reports/"+await U+"/"+Ua+".json",await La),console.log("********* Test Reports is successfully saved to the server where execution is triggered by the user "+await E),await M(await X,await W,await q,"Api",await U,await La.executionStartDate,await La.executionStartTime,await j,await D,await La.totalExecutionTime,await Y,await E,await A)}}else try{ya=((new Date).getTime()-I.getTime())/1e3,ya=await Number(await ya.toString().split(".")[0]),await M(await X,await W,await q,"Api",await U,await L,await F,await j,await D,await ya,await Y,await E,await A)}catch(a){}}catch(a){console.log("********* Execution is triggered by the user "+await E+" Test suite execution throw exception in between , hence report is not saved into the server "+await a.toString())}await N&&await o(await y,await T,await E,await V,"Api"),t.json(await A)}),a.exports=i},6212:a=>{"use strict";a.exports=require("proper-lockfile")},6221:(a,t,e)=>{const i="./dataHub/",r=e(8215);var s=e(9896);const n=e(2410),w=e(6928),{createNameSpaceFromExpression:o,getValueFromJsonUsingNameSpace:c}=e(645),{saveFile:u,createDirectory:l,isDirectoryExist:d,readJSONFile:p}=e(7229),{runDBQuery:m}=e(8786),{apiCall:v}=e(5460),{mobileTestScriptCall:g}=e(5811),{getColumnValuesBasedOnConditions:h,readPdfFile:f,verifyPdfPageCount:y,getRowCountFromExcel:b,readExcelFile:S,getCellCalueFromExcel:x}=e(9147),{Builder:M,Browser:N,By:T,Key:E,until:A,Select:P,Capabilities:C}=e(4973),{generateRandomNumberWithNDigits:k,getPassword:j,getTitle:D,getUserName:O,getURl:I,getEmail:L,getFirstName:F,getLastName:U,getAddress:V,getUuid:B,getCountry:R,getPhoneNumber:J,getState:X,getCity:W,getZipCode:Y,getWords:G,getNumberFromRange:Q,addOrSubtractDaysToCurrentDate:q,getString:Z,extractNumberFromString:K,splitAndSaveIndexValue:H,addTwoNumber:_,subtractTwoNumber:z,multiplyTwoNumber:$,devideTwoNumber:aa,reminderTwoNumber:ta,getPercentage:ea,addPercentageInNumber:ia,subtractPercentageInNumber:ra,sumOfArray:sa,getipv4:na,getipv6:wa,getAirline:oa,getAirPlane:ca,getFlightNumber:ua,getAccountName:la,getAccountNumber:da,getCardCVV:pa,getCardIssuer:ma,getCardNumber:va,getbicycle:ga,getcolor:ha,getfuel:fa,getmodel:ya,getvehicle:ba,getvin:Sa,getvrm:xa,getdepartment:Ma,getdproduct:Na,getdproductDescription:Ta,getproductMaterial:Ea,getproductName:Aa,getjobTitle:Pa,getjobType:Ca,getzodiacSign:ka,getmac:ja,getuserAgent:Da,getdomainName:Oa,getavatar:Ia,getDateDifference:La,getPhoneImEI:Fa}=e(6777),Ua=e(2103),{Array_ExcludeCharacters:Va,List_GetUniqueValues:Ba,JSON_getKeyValue:Ra,String_Trim:Ja,String_ToUpperCase:Xa,String_ToLowerCase:Wa,String_Substring:Ya,String_StartsWith:Ga,String_SplitandSaveValueAsPerIndex:Qa,String_Split:qa,String_Replace:Za,String_RemoveNumberFromTheString:Ka,String_Length:Ha,String_ExtractNumberFromTheString:_a,String_EndsWith:za,String_Concat:$a,Array_Length:at,Math_SubtractTwoNumber:tt,Math_SubtractPercentage:et,Math_Round:it,Math_Reminder:rt,Math_MultiplyTwoNumber:st,Math_GetPercentage:nt,Math_Floor:wt,Math_DivideTwoNumber:ot,Math_Ceil:ct,Math_AddTwoNumber:ut,Math_Abs:lt,Math_AddPercentage:dt,Date_getDate:pt,Date_GetDateDifference:mt,Date_FormatDateTemplate:vt,Array_DeleteItem:gt,Array_DeleteItemBasedOnIndex:ht,Array_GetValueBasedOnIndex:ft,Array_Push:yt,Array_Search:bt,Array_Sort:St,Array_SortDesc:xt,Array_SumOfArray:Mt}=e(8220),Nt=e(3851),{NUMBER:Tt}=e(5504);async function Et(a,t,e,i,r,s,n,w,o,c,u,l,d,p,m,v,g,h,f,y,b,S,x,M){var N={isSuccess:!1,errorMessage:""};if(await o.includes(await e))if(E=[],0===(T=await At(await s)))N.isSuccess=!0;else for(let A=0;A<await T;A++){if(P=await Pt(await s,A,await T),P=await Ut(await P,await u,await l,await w,0,await b,await P,await m,await x),await A>0){if(C=await ve(await a,await i,await h,await c,await e,await u,await l,await w,await f,await o,await t,await y,await P,await b,await m,await v,await g,await S,await x),!await C.isElementPresent){N.isSuccess=!1,N.isSuccess=await C.errorMessage;break}void 0!==await C.shadowDriver&&(i=await C.shadowDriver),r=await C.element,d=await C.elements,p=await C.elementIndex}if(N=await Ct(await a,await t,await e,await P,await i,await c,await u,await l,await w,0,await o,await n,await m,await v,await g,await S,await x,await M),await T>1&&(k=await N.supportingEvidence,void 0!==await k&&(E.push(await k),N.supportingEvidence=await E)),!N.isSuccess)break}else{var T,E=[],A=[];if(0===(T=await At(await s)))N.isSuccess=!0;else for(let D=0;D<await T;D++){var P=await Pt(await s,D,await T);if(P=await Ut(await P,await u,await l,await w,0,await b,await P,await m,await x),await D>0){var C=await ve(await a,await i,await h,await c,await e,await u,await l,await w,await f,await o,await t,await y,await P,await b,await m,await v,await g,await S,await x);if(!await C.isElementPresent){N.isSuccess=!1,N.isSuccess=await C.errorMessage;break}r=await C.element,d=await C.elements,p=await C.elementIndex;void 0!==await C.shadowDriver&&(i=await C.shadowDriver)}if(N=await Ft(await a,await e,await i,await r,await P,await n,await w,await c,await t,await d,await p,await m,await v,await x,await M),await T>1){var k=await N.supportingEvidence;try{void 0!==await k&&0!==await Object.keys(await k).length&&E.push(await k)}catch(a){}var j=await N.valuetobesend;try{void 0!==await j&&A.push(await j)}catch(a){}await E.length>0?N.supportingEvidence=await E:N.supportingEvidence=await A}if(!N.isSuccess)break}}return N}async function At(a){var t=1;try{var e=await JSON.parse(await a);t=await e.loopCounter,void 0===await t&&(t=1),t=await isNaN(await t)?1:await Number(await t)}catch(a){t=1}return await t}async function Pt(a,t,e){try{if(await e>1){var i=await JSON.parse(await a),r={},s=await Object.keys(await i);for(let a=0;a<await s.length;a++){var n=await s[a],w=await i[await n],o=await typeof await w;switch(await o){case"object":var c=await w;break;case"number":c=await w;break;case"string":try{c=await JSON.parse(await w)}catch(a){c=await w}}if("methodParameters"===await n){if(await Array.isArray(await c))return w=await c[await t],await w}else if(void 0!==await c.methodParameters){var u=await c.methodParameters;try{var l=await JSON.parse(await u);u=await l}catch(a){}await Array.isArray(await u)&&(w=await u[await t])}r[await n]=await w}a=await JSON.stringify(await r)}}catch(a){}return await a}async function Ct(a,t,e,r,n,w,o,c,u,l,d,p,m,v,g,h,f,y){var b={},S={isSuccess:!1,errorMessage:"",additionaldata:"",supportingEvidence:{}},x=await i+await a+"/"+await t+"/Web/CustomPageFunction/Function/"+await e+".json",M=await JSON.parse(await s.readFileSync(await x,"utf8")),N=await M.argumentlist,T=await r;if(""!==await N&&""!==T)try{if("object"!=typeof await r)var E=await JSON.parse(await r);else E=await T;var A=await Object.keys(await N);for(let a=0;a<await A.length;a++){var P=await A[a],C=await E[await P];if(void 0===await C&&await P.toLocaleLowerCase().toString().startsWith("args.")){var k="ARGS."+await P.substring(5);C=await E[await k],void 0!==await C&&(b[await k]=await C)}void 0===await C?b[await P]=void 0:(C=await Ut(await C,await o,await c,await u,0,await b,await C,await m,await f),b[await P]=await C)}}catch(a){return S.isSuccess=!1,S.errorMessage="Provided data is invalid. data should be send in JSON format "+await a,await S}var j=await M.allsteps,D=[],O={},I={},L={};for(let e=0;e<await j.length;e++){L={Stepdefinition:"",Action:"",locator:"",Status:"",TestData:{},SupportingData:{}};var F=!1,U=await j[e].stepdefinition,V=await j[e].action,B=await j[e].element,R=await j[e].value,J=await j[e].isreporting;R=await Ut(await R,await o,await c,await u,0,await b,await R,await m,await f);var X=await j[e].id;L={Stepdefinition:await U,Action:await V,locator:await B,Status:"",TestData:{},SupportingData:{}};var W=!1,Y=await Ot(await X,await O);if(await Y.isStepInvolved&&(W=await kt(await Y,await I)),await W)L.Status="Warning",L.TestData=await jt(await R),L.SupportingData=await je(),I[await X]=!1,D.push(await L);else if(L={Stepdefinition:await U,Action:await V,locator:await B,Status:"",TestData:{},SupportingData:{}},await d.includes(await V)){var G=await At(await R);for(let e=0;e<await G;e++){L={},L={Stepdefinition:await U,Action:await V,locator:await B,Status:"",TestData:{},SupportingData:{}};var Q=await Pt(await R,await e,await G);Q=await Ut(await Q,await o,await c,await u,0,await b,await Q,await m,await f);var q=await Ct(await a,await t,await V,await Q,await n,await w,await o,await c,await u,0,await d,await p,await m,await v,await g,await h,await f,await y);if(await q.isSuccess?L.Status="Pass":L.Status="Fail",void 0!==await q.shadowDriver&&(n=await q.shadowDriver),F=await Lt(await jt(await R)),await F&&(O=await It(await jt(await R),await X,await O),I[await X]=await q.isSuccess,await q.isSuccess||(L.Status="Warning",q.isSuccess=!0)),L.TestData=await jt(await Q),L.SupportingData=await q.supportingEvidence,"no"!==await J.toString().toLocaleLowerCase()&&(D.push(await L),!await q.isSuccess))break}}else if(q=await ke(await a,await F,await U,await V,await B,await R,await X,await o,await c,await u,await b,await m,await O,await I,await n,await w,await e,await d,await t,await v,await g,await p,await h,await f,await y),void 0!==await q.shadowDriver&&(S.shadowDriver=await q.shadowDriver,n=await q.shadowDriver),F=await Lt(await jt(await R)),await F&&(O=await It(await jt(await R),await X,await O),"Warning"===await q.status?(I[await X]=!1,q.supportingData={},q.supportingData.errorMessage=await q.errorMessage):I[await X]=!0,await q.isSuccess||(L.Status="Warning",q.isSuccess=!0)),L.Status=await q.status,L.TestData=await q.testData,L.SupportingData=await await q.supportingData,"no"!==await J.toString().toLocaleLowerCase()&&(D.push(await L),!await q.isSuccess))break}return S.isSuccess=await q.isSuccess,S.supportingEvidence.ListOfTestSteps=await D,S.errorMessage=await q.errorMessage,await S}async function kt(a,t){var e=[],i=await a.parentSteps,r=await Object.keys(await i);for(let a=0;a<await r.length;a++){var s=await r[a],n=await i[await s],w=await t[await s];await n.toString()===await w.toString()?e.push("true"):e.push("false")}return!!await e.includes("false")}async function jt(a){var t={};try{var e=await typeof await a;t="string"===await e?await JSON.parse(await a):await a}catch(a){t={}}return await t}async function Dt(a){var t="{}";try{var e=await typeof await a;t="object"===await e?await JSON.stringify(await a):await a}catch(a){t="{}"}return await t}async function Ot(a,t){var e={isStepInvolved:!1,parentSteps:{}};try{var i=await Object.keys(await t);if(await i.length>0)for(let o=0;o<await i.length;o++){var r=await i[o],s=await t[await r],n=await Object.keys(await s);for(let t=0;t<await n.length;t++){var w=await n[t];(await s[await w]).includes(await a)&&(e.isStepInvolved=!0,e.parentSteps[await r]=w)}}}catch(a){}return await e}async function It(a,t,e){try{void 0!==await a[await t]&&(e[await t]={});var i=await a.ifTrue;void 0!==await i&&await Array.isArray(await i)&&(e[await t]={},e[await t].true=await i)}catch(a){}try{i=await a.ifFalse,void 0!==await i&&await Array.isArray(await i)&&(void 0===e[await t]&&(e[await t]={}),e[await t].false=await i)}catch(a){}return await e}async function Lt(a){try{var t=await a.ifTrue;if(void 0!==await t)return!0}catch(a){}try{if(t=await a.ifFalse,void 0!==await t)return!0}catch(a){}return await!1}async function Ft(a,t,e,r,u,M,N,C,D,O,F,U,B,R,X){var W={isSuccess:!0,errorMessage:"",additionaldata:"",supportingEvidence:{}};"IsNotDisplayed"!==await t&&null===await r&&null!==await O&&await O.length>0&&(r=await O[0]),await Jt(await e,60,await B),await Rt(await e,await r);try{switch(await t){case"Check":var G=await(await r).isSelected();await G||await(await e).executeScript("arguments[0].click();",await r);break;case"CheckAll":W=await async function(a,t){var e={isSuccess:!0,errorMessage:"",supportingEvidence:{}};try{var i=await await t;for(let t=0;t<await i.length;t++){var r=await(await i[t]).isSelected();await r||await(await a).executeScript("arguments[0].click();",await i[t])}}catch(a){return e.isSuccess=!1,e.errorMessage=await a.toString(),await e}return await e}(await e,await O);break;case"Click":await(await r).click();break;case"ClickAll":await new Promise(a=>setTimeout(a,1e3));var q=await await O;for(let a=0;a<await q.length;a++)await new Promise(a=>setTimeout(a,300)),await(await q[a]).click(),await Jt(await e,60,await B);break;case"ClickNTimes":if(W=await async function(a){var t={isSuccess:!0,errorMessage:"",countofclick:0,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid. countofclick should be provided in value section e.g. {"countofclick":2}',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];if(void 0===await i&&((e={}).countofclick=await a),void 0===await e.countofclick)return t.errorMessage='Provided value is invalid. countofclick should be provided in value section e.g. {"countofclick":2}',t.isSuccess=!1,await t;var r=await ee(await e.countofclick);if(!await r)return t.errorMessage='Provided value is invalid. countofclick should be provided in value section e.g. {"countofclick":2}',t.isSuccess=!1,await t;t.countofclick=await e.countofclick}catch(a){return t.errorMessage='Provided value is invalid. countofclick should be provided in value section e.g. {"countofclick":2}',t.isSuccess=!1,await t}return await t}(await u),await W.isSuccess){for(let a=0;a<await Number(W.countofclick);a++)await new Promise(a=>setTimeout(a,500)),await(await r).click(),await Jt(await e,60,await B);break}break;case"Count":try{M.output=await(await O).length}catch(a){M.output=0}W.errorMessage="Result "+await M.output,W.additionaldata=await M.output,W.supportingEvidence.Count=await M.output;break;case"DoubleClick":await(await e).actions().doubleClick(await r).perform();break;case"DragandDropByJavascript":if(W=await me(await u),await W.isSuccess){var K=null,H=await Wt(await e,await W.nextelement,await C);if(!await H.isElementInOr)return W.isSuccess=!1,W.errorMessage=W.nextelement+" does not exist in Object Repository.",W;if(!await H.isElementPresent)return W.isSuccess=!1,W.errorMessage=await H.errorMessage,W;K=await H.webElement,await e.executeScript("arguments[0].scrollIntoView({behavior: 'smooth', block: 'center'});",await r),await e.executeScript("arguments[0].scrollIntoView({behavior: 'smooth', block: 'center'});",await K);try{await e.actions().move({origin:await r}).press().pause(500).move({origin:await K}).release().perform()}catch(a){console.warn("WebDriver Actions API failed. Falling back to JavaScript."),await e.executeScript('\n                                function triggerMouseEvent(element, eventType, clientX, clientY) {\n                                    const event = new MouseEvent(eventType, {\n                                        bubbles: true,\n                                        cancelable: true,\n                                        view: window,\n                                        clientX: clientX,\n                                        clientY: clientY\n                                    });\n                                    element.dispatchEvent(event);\n                                }\n                \n                                function triggerDragAndDrop(source, target) {\n                                    if (!source || !target) {\n                                        console.error("Source or Target element is null!");\n                                        return;\n                                    }\n                \n                                    const rectSource = source.getBoundingClientRect();\n                                    const rectTarget = target.getBoundingClientRect();\n                \n                                    const startX = rectSource.x + rectSource.width / 2;\n                                    const startY = rectSource.y + rectSource.height / 2;\n                                    const endX = rectTarget.x + rectTarget.width / 2;\n                                    const endY = rectTarget.y + rectTarget.height / 2;\n                \n                                    // Step 1: Fire DragStart Event\n                                    source.dispatchEvent(new DragEvent("dragstart", { bubbles: true }));\n                \n                                    // Step 2: Simulate Mouse Movements\n                                    setTimeout(() => {\n                                        triggerMouseEvent(source, "mousemove", startX + 10, startY + 10);\n                                        triggerMouseEvent(source, "mousemove", endX - 10, endY - 10);\n                                        triggerMouseEvent(target, "mousemove", endX, endY);\n                                    }, 300);\n                \n                                    // Step 3: Fire DragOver & Drop Events\n                                    setTimeout(() => {\n                                        target.dispatchEvent(new DragEvent("dragover", { bubbles: true }));\n                                        target.dispatchEvent(new DragEvent("drop", { bubbles: true }));\n                                    }, 400);\n                \n                                    // Step 4: Mouse Up on Target\n                                    setTimeout(() => {\n                                        triggerMouseEvent(target, "mouseup", endX, endY);\n                                    }, 500);\n                                }\n                \n                                triggerDragAndDrop(arguments[0], arguments[1]);\n                            ',await r,await K)}}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"DragandDrop":if(W=await me(await u),await W.isSuccess){if(K=null,H=await Wt(await e,await W.nextelement,await C),await H.isElementInOr){if(!await H.isElementPresent)return W.isSuccess=!1,W.errorMessage=await H.errorMessage,await W;K=await H.webElement}else W.isSuccess=!1,W.errorMessage=await W.nextelement+" does not exist in Object Repository.";await(await e).actions().move({origin:await r}).perform();const a=await e.actions({async:!0});await a.move({origin:await r}).press().move({origin:await K}).release().perform()}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"DragByOffset":M.output=[];var _=await Ie(await u);if(!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;u=await JSON.parse(await u);var z=await u.offset;if(void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.offset key is missing in value section.",await W;var $=await z.x;void 0===await $&&($=0);var aa=await z.y;void 0===await aa&&(aa=0),$=await Number($),aa=await Number(aa),await(await e).actions().move({origin:await r}).perform(),await(await e).actions().dragAndDrop(await r,{x:await $,y:await aa}).perform();break;case"HoverandClick":if(W=await me(await u),await W.isSuccess)if(K=null,await(await e).actions().move({origin:await r}).perform(),await new Promise(a=>setTimeout(a,1e3)),H=await Wt(await e,await W.nextelement,await C),await H.isElementInOr){if(!await H.isElementPresent)return W.isSuccess=!1,W.errorMessage=await H.errorMessage,await W;K=await H.webElement,await(await e).actions().click(await K).perform()}else W.isSuccess=!1,W.errorMessage=await W.nextelement+" does not exist in Object Repository.";else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"SequentialClick":if(W=await me(await u),await W.isSuccess)if(K=null,await(await r).click(),await new Promise(a=>setTimeout(a,1e3)),H=await Wt(await e,await W.nextelement,await C),await H.isElementInOr){if(!await H.isElementPresent)return W.isSuccess=!1,W.errorMessage=await H.errorMessage,await W;K=await H.webElement,await(await e).actions().click(await K).perform()}else W.isSuccess=!1,W.errorMessage=await W.nextelement+" does not exist in Object Repository.";else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"FileUpload":if(W=await ne(await u,await D),await W.isSuccess)try{var ta=await w.parse(await W.filename).name,ea=await w.parse(await W.filename).ext,ia=await i+await D+"/Web/Uploads/*"+await ta+"*"+await ea,ra=await n.sync(await ia),sa=await ra.length;if(0===await sa)W.isSuccess=!1,W.errorMessage="File name "+await W.filename+" does not exist on Server.";else{var na=await w.resolve(await ra[Number(await sa)-1]);await(await r).sendKeys(await na)}}catch(a){W.isSuccess=!1,W.errorMessage=await a.toString()}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"Focus":await(await e).actions().move({origin:await r}).perform();break;case"GetAttribute":M.output="",W=await de(await u),await W.isSuccess?("text"===await W.attributename.toLocaleLowerCase()?M.output=await(await r).getText():"innertext"===await W.attributename.toLocaleLowerCase()?M.output=(await e).executeScript("return arguments[0].innerText;",await r):M.output=await(await r).getAttribute(await W.attributename),W.errorMessage="Result "+await M.output,W.additionaldata=await M.output):(W.isSuccess=!1,W.errorMessage=await W.errorMessage),W.supportingEvidence.ApplicationData=await M.output;break;case"GetAttributeForAllElements":W=await de(await u);var wa=[];if(await W.isSuccess){var oa=await O;for(let a=0;a<await oa.length;a++)"text"===await W.attributename.toLocaleLowerCase()?(await Rt(await e,await oa[a]),runTimeText=await(await oa[a]).getText()):"innertext"===await W.attributename.toLocaleLowerCase()?(await Rt(await e,await oa[a]),runTimeText=await e.executeScript("return arguments[0].innerText;",await oa[a])):(await Rt(await e,await oa[a]),runTimeText=await(await oa[a]).getAttribute(await W.attributename)),wa.push(await runTimeText);M.output=await wa,W.errorMessage="Result "+await M.output,W.additionaldata=await M.output}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;W.supportingEvidence.ApplicationData=await wa;break;case"GetCssValue":W=await de(await u),await W.isSuccess?(M.output=await(await r).getCssValue(await W.attributename),W.errorMessage="Result "+await M.output,W.additionaldata=await M.output,W.supportingEvidence.ApplicationData=await M.output):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"GetIndexOfTheElement":M.output=await F,W.additionaldata=await M.output,W.supportingEvidence.index=await F;break;case"GetIndexOfTheVisibleElement":try{M.output=-1;for(let a=0;a<await(await O).length;a++)if(await O[a].isDisplayed()){M.output=a;break}}catch(a){M.output=-1}W.errorMessage="Result "+await M.output,W.additionaldata=await M.output,W.supportingEvidence.Count=await M.output;break;case"GetTagName":M.output=await(await r).getTagName(await u),W.errorMessage="Result "+await M.output,W.additionaldata=await M.output,W.supportingEvidence.TagName=await M.output;break;case"JSClick":await(await e).executeScript("arguments[0].click();",await r);break;case"PressKeyBoard":if(W=await async function(a){var t={isSuccess:!0,errorMessage:"",keyname:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, keyname should be provided in value section e.g. {"keyname":"TAB"}',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];void 0===await i&&((e={}).keyname=await a)}catch(t){(e={}).keyname=await a}if(void 0===await e.keyname||""===await e.keyname.toString().trim())return t.errorMessage='Provided value is invalid, keyname should be provided in value section e.g. {"keyname":"TAB"}',t.isSuccess=!1,await t;t.keyname=await e.keyname.toString().trim()}catch(a){return t.errorMessage='Provided value is invalid, keyname should be provided in value section e.g. {"keyname":"TAB"}',t.isSuccess=!1,await t}return await t}(await u),await W.isSuccess)return await async function(a,t){var e={isSuccess:!0,errorMessage:""};try{switch(t.toString().toLowerCase()){case"tab":await(await a).sendKeys(E.TAB);break;case"enter":await(await a).sendKeys(E.ENTER);break;case"arrowdown":await(await a).sendKeys(E.ARROW_DOWN);break;case"arrowdown":await(await a).sendKeys(E.ARROW_UP);break;case"arrowleft":await(await a).sendKeys(E.ARROW_LEFT);break;case"arrowright":await(await a).sendKeys(E.ARROW_RIGHT);break;case"backspace":await(await a).sendKeys(E.BACK_SPACE);break;case"cancel":await(await a).sendKeys(E.CANCEL);break;case"delete":await(await a).sendKeys(E.DELETE);break;case"escape":case"esc":await(await a).sendKeys(E.ESCAPE)}}catch(a){e.isSuccess=!1,e.errorMessage=a.message}return e}(await r,await W.keyname);break;case"RightClick":await(await e).actions().contextClick(await r).perform();break;case"SelectByIndex":if(W=await pe(await u),await W.isSuccess){var ca=new P(await r);await(await ca).selectByIndex(Number(await W.valuetobesend))}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"SelectByValue":W=await pe(await u),await W.isSuccess?(ca=new P(await r),await(await ca).selectByValue(await W.valuetobesend)):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"SelectByVisibleText":W=await pe(await u),await W.isSuccess?(ca=new P(await r),await(await ca).selectByVisibleText(await W.valuetobesend)):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"SwitchToDefaultContent":void 0!==await X&&void 0!==await X.mainDriver?(e=await await X.mainDriver,W.shadowDriver=await e):await e.switchTo().defaultContent();break;case"SwitchToFrame":await e.switchTo().frame(await r);break;case"Type":W=await pe(await u),await W.isSuccess?await xe(await e,await r,await W.valuetobesend):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"JSType":if(W=await pe(await u),await W.isSuccess){var ua=await W.valuetobesend;await e.executeScript("arguments[0].value = '"+await ua+"'",await r)}break;case"ExecuteScript":W=await pe(await u),await W.isSuccess&&(ua=await W.valuetobesend,await e.executeScript(await ua,await r));break;case"Clear":await async function(a){await(await a).click();try{await(await a).sendKeys(E.CONTROL+"a"),await(await a).sendKeys(E.DELETE)}catch(a){}}(await r);break;case"TypeAll":await new Promise(a=>setTimeout(a,1e3)),W=await async function(a){var t={isSuccess:!0,errorMessage:"",valuetobesend:[],supportingEvidence:{}};try{if(""===await a.toString().trim())return t.isSuccess=!0,await t;var e=await JSON.parse(await a),i=await Object.keys(await e);if(0===await i.length)return t.isSuccess=!0,await t;var r=[];for(let a=0;a<await i.length;a++){var s=await i[a],n=await e[await s];r.push(await n)}t.valuetobesend=await r}catch(a){t.isSuccess=!1,t.errorMessage='Incorrect value are provided, value should be passed as json array e.g. [{"providedattributename":"id","valuetobesend":"Provide value"}]'}return await t}(await u),await W.isSuccess?W=await async function(a,t,e){var i={isSuccess:!0,errorMessage:"",supportingEvidence:{}};i.supportingEvidence.ListOfTestData=[];try{var r=await await t;for(let t=0;t<await r.length;t++){var s="",n=!0;await new Promise(a=>setTimeout(a,300));var w=await(await r[t]).getAttribute("type");switch(await w.toLocaleLowerCase()){case"email":s=await L();break;case"url":s=await I();break;case"phone":case"phonenuber":case"mobile":case"mobilenumber":case"tel":s=await J();break;case"number":var o=await(await r[t]).getAttribute("minValue");null!==await o&&void 0!==o||(o=1);var c=await(await r[t]).getAttribute("maxValue");null!==await c&&void 0!==c||(c=1e3);var u=await(await r[t]).getAttribute("maxlength");null!==await u&&void 0!==u||(n=!1,u=5),s=await n?await k(await u):await Q(await o,await c);break;case"password":s=await j();break;case"address":case"street":s=await V();break;case"zip":case"pin":case"zipcode":case"pincode":s=await Y();break;case"cardnumber":s=await va();break;case"cvv":case"securitycode":s=await pa();break;case"expirationdate":s=await generateExpiryDate();break;default:s=""}if(""===await s){var l=await(await r[t]).getAttribute("outerHTML");s=await Me(await l),""===await s&&(u=await(await r[t]).getAttribute("maxlength"),null!==await u&&void 0!==u||(n=!1,u=5),s=10===await u?await J():await Z(await u))}if(0!==await e.length)for(let a=0;a<await e.length;a++){var d="",p=await e[a],m=await Object.keys(await p)[0];d="text"===await m.toLocaleLowerCase()?await(await r[t]).getText():await(await r[t]).getAttribute(await m);var v=await p[await m];try{if(await d.toString().toLocaleLowerCase().includes(await v.toString().toLocaleLowerCase())){if(s=await p.valuetobesend,void 0===await s)return i.isSuccess=!1,i.errorMessage='Incorrect value are provided, value should be passed json array e.g. [{"providedattributename":"id","valuetobesend":"Provide value"}]',await i;await e.splice(a,1);break}}catch(a){}}var g=await(await r[t]).isDisplayed();await g&&(await xe(await a,await r[t],await s),i.supportingEvidence.ListOfTestData.push(await s))}}catch(a){return i.isSuccess=!1,i.errorMessage=await a.toString(),await i}return await i}(await e,await O,await W.valuetobesend):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"Uncheck":G=await(await r).isSelected(),await G&&await(await e).executeScript("arguments[0].click();",await r);break;case"UncheckAll":W=await async function(a,t){var e={isSuccess:!0,errorMessage:"",supportingEvidence:{}};try{var i=await await t;for(let t=0;t<await i.length;t++){var r=await(await i[t]).isSelected();await r&&await(await a).executeScript("arguments[0].click();",await i[t])}}catch(a){return e.isSuccess=!1,e.errorMessage=await a.toString(),await e}return await e}(await e,await O);break;case"SwitchToShadowDriver":case"SwitchToDynamicShadowDriver":W.shadowDriver=await e;break;case"GetChildOfShadowDriver":W=await async function(a,t){var e={isElementPresent:!1,isSuccess:!1,errorMessage:""};e.shadowDriver=await a,e.childDriver=[];var i="";let r=a,s=null;try{for(let a=0;a<await t.length;a++){i=await t[a].toString(),console.log("--------child element --------------"+await await t[a].toString());var n=await r.findElements(await t[a]);if(await n.length>1&&console.log("-------- shadow host Count is "+await n.length),0===await n.length)return e.errorMessage="Element"+await i+" does not have any child or shadow root.",await e;var w=await n[0];s=await w.getShadowRoot(),r=s}var o=await s.findElements(T.css("*"));for(let a=0;a<await o.length;a++)try{var c=await o[a].getTagName();e.childDriver.push(await c)}catch(a){}return e.isElementPresent=!0,e.isSuccess=!0,e.shadowDriver=await s,e}catch(a){return e.errorMessage=await a.toString()+" for element "+await i,console.error("Error:",a),await e}}(await e,await O),M.output=await W.childDriver,void 0===W.supportingEvidence&&(W.supportingEvidence={}),void 0===W.supportingEvidence.AllChildShadowTags&&(W.supportingEvidence.AllChildShadowTags=[]),W.supportingEvidence.AllChildShadowTags=await M.output;break;case"GetTagOfChildElements":e=await X.mainDriver;let t=await e.executeScript("\n                    var element = arguments[0];  // Get the element passed from WebDriver\n                    if (element) {\n                      // Get all child elements and return their tag names\n                      return Array.from(element.querySelectorAll('*')).map(child => child.tagName);\n                    } else {\n                      return null;  // Return null if the element is not found\n                    }\n                  ",await r);var la=[];for(let a=0;a<await t.length;a++)la.push(await t[a].toLocaleLowerCase());M.output=await la,W.supportingEvidence.AllChildTags=await M.output;break;case"AlertAccept":await(await e).switchTo().alert().accept();break;case"AlertDismiss":await(await e).switchTo().alert().dismiss();break;case"AlertSendKeys":W=await pe(await u),await W.isSuccess?await(await e).switchTo().alert().sendKeys(await W.valuetobesend):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"AlertText":var da=await(await e).switchTo().alert();M.output=await da.getText(),W.errorMessage="Result "+await M.output,W.additionaldata=await M.output,W.supportingEvidence.AlertText=await M.output;break;case"Back":await(await e).navigate().back();break;case"Close":await(await e).close();break;case"Forward":await(await e).navigate().forward();break;case"FullScreen":await(await e).manage().window().fullscreen();break;case"GetCurrentUrl":M.output=await(await e).getCurrentUrl(),W.additionaldata=await M.output,W.errorMessage="Result "+await M.output,W.supportingEvidence.Url=await M.output;break;case"GetTitle":M.output=await(await e).getTitle(),W.errorMessage="Result "+await M.output,W.additionaldata=await M.output,W.supportingEvidence.Title=await M.output;break;case"Maximize":await(await e).manage().window().maximize();break;case"Minimize":await e.manage().window().minimize();break;case"Navigate":if(W=await ie(await u),await W.isSuccess)if(await await W.url.toString().toLocaleLowerCase().includes("http")||await W.url.toString().toLocaleLowerCase().includes("www")){var ma=await W.url.toString().trim();await(await e).navigate().to(await ma)}else{var ga=await(await e).getCurrentUrl();await ga.endsWith("/")?await(await e).navigate().to(await ga+await W.url):await(await e).navigate().to(await ga+"/"+await W.url)}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"NewTab":if(W=await ie(await u),await W.isSuccess){await e.executeScript("window.open('about:blank', '_blank');");var ha=await(await e).getAllWindowHandles(),fa=await ha[ha.length-1];await(await e).switchTo().window(await fa),await(await e).get(await W.url)}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"NewWindow":W=await ie(await u),await W.isSuccess?(await(await e).switchTo().newWindow("window"),await(await e).get(await W.url)):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"Refresh":await(await e).navigate().refresh();break;case"SwitchToWindow":W=await await async function(a){var t={isSuccess:!0,errorMessage:"",browserindex:0,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, Browser index should be numeric. e.g. {"browserindex":0}',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];if(void 0===await i&&((e={}).browserindex=await a),void 0===await e.browserindex)return t.errorMessage='Provided value is invalid, Browser index should be numeric. e.g. {"browserindex":0}',t.isSuccess=!1,await t;var r=await ee(await e.browserindex);if(!await r)return t.errorMessage='Provided value is invalid, Browser index should be numeric. e.g. {"browserindex":0}',t.isSuccess=!1,await t;t.browserindex=await e.browserindex}catch(a){return t.errorMessage='Provided value is invalid, Browser index should be numeric. e.g. {"browserindex":0}',t.isSuccess=!1,await t}return await t}(await u),await W.isSuccess?(ha=await(await e).getAllWindowHandles(),fa=await ha[Number(await W.browserindex)],W.supportingEvidence.WindowId=await fa,await(await e).switchTo().window(await fa)):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"Wait":W=await ae(await u),await W.isSuccess?await new Promise(a=>setTimeout(a,1e3*Number(W.timeout))):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"WaitForAlertIsPresent":W=await ae(await u),await W.isSuccess?await(await e).wait(A.alertIsPresent(),1e3*await W.timeout):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"WaitForElementIsDisabled":W=await ae(await u),await W.isSuccess?(await(await e).wait(A.elementLocated(await r),1e3*await W.timeout),await(await e).wait(A.elementIsDisabled((await e).findElement(await await r)),1e3*await W.timeout)):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"WaitForElementIsEnabled":W=await ae(await u),await W.isSuccess?(await(await e).wait(A.elementLocated(await r),1e3*await W.timeout),await(await e).wait(A.elementIsEnabled((await e).findElement(await await r)),1e3*await W.timeout)):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"WaitForElementTillDisplayed":W=await ae(await u),await W.isSuccess?await(await e).wait(A.elementLocated(await r),1e3*await Number(await W.timeout)):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"WaitForElementTillNotDisplayed":W=await ae(await u),await W.isSuccess?W=await async function(a,t,e){var i={isSuccess:!0,errorMessage:""};try{try{await(await a).wait(A.elementLocated(await t),1e3)}catch(a){}await(await a).wait(A.elementIsNotVisible((await a).findElement(await t)),1e3*await Number(await e)),i.isSuccess=!0}catch(a){if("NoSuchElementError"===await a.name||"StaleElementReferenceError"===await a.name||"ElementNotInteractableError"===await a.name||"WebDriverError"===await a.name)i.isSuccess=!0;else{var r=await t.using,s=await t.value;i.errorMessage="element "+await r+" ->"+await s+" is still displayed on the application after waiting "+await e+" seconds. "+await a.name,i.isSuccess=!1}}return await i}(await e,await r,await W.timeout):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"WaitForElementTillTextContains":W=await te(await u),await W.isSuccess?(await(await e).wait(A.elementLocated(await r),1e3*await Number(await W.timeout)),await(await e).wait(A.elementTextContains((await e).findElement(await r),await W.expectedtext),1e3*await Number(await W.timeout))):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"WaitForTitleContains":W=await te(await u),await W.isSuccess?await(await e).wait(A.titleContains(await W.expectedtext),1e3*await Number(await W.timeout)):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"AssertContains":if(W=await oe(await u),await W.isSuccess){W=await ce(await W.actualvalue,await W.expectedvalue);var ya={actualvalue:await W.actualvalue,expectedvalue:await W.expectedvalue};W.additionaldata=JSON.stringify(await ya)}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"AssertElementAttributeContains":if(W=await he(await u),await W.isSuccess){var ba=await W.attributeNames,Sa=await Object.keys(await ba);if(await Sa.length>0){var xa=[];ya="",W.supportingEvidence.AttributeDetails={};for(let a=0;a<await Sa.length;a++){var Ma=await Sa[a];try{if("text"===await Ma.toString().toLocaleLowerCase())var Na=await(await r).getText();else Na=await(await r).getAttribute(await Ma)}catch(a){Na="null"}null===await Na&&(Na="null"),Na=await Na.toLocaleLowerCase().trim().toString();var Ta=await ba[await Ma].toString().trim().toLocaleLowerCase();await Na.includes(await Ta)?xa.push(!0):xa.push(!1),W.supportingEvidence.AttributeDetails[await Ma]=await Na,ya=ya+"Expected "+await Ma+" is "+await await ba[await Ma]+", and actual it has "+await Na+" ."}var Ea=await ge(await xa);await Ea||(W.isSuccess=!1),W.errorMessage=await ya,W.additionaldata=await ya}}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"AssertElementAttributeEquals":if(W=await he(await u),await W.isSuccess){if(ba=await W.attributeNames,Sa=await Object.keys(await ba),await Sa.length>0){xa=[],ya="",W.supportingEvidence.AttributeDetails={};for(let a=0;a<await Sa.length;a++){Ma=await Sa[a];try{Na="text"===await Ma.toString().toLocaleLowerCase()?await(await r).getText():await(await r).getAttribute(await Ma)}catch(a){Na="null"}null===await Na&&(Na="null"),await Na!==await ba[await Ma]?xa.push(!1):xa.push(!0),W.supportingEvidence.AttributeDetails[await Ma]=await Na,ya=ya+"Expected "+await Ma+" is "+await await ba[await Ma]+", and actual it has "+await Na+" ."}Ea=await ge(await xa),await Ea||(W.isSuccess=!1),W.errorMessage=await ya,W.additionaldata=await ya}}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"AssertElementAttributeNotContains":if(W=await he(await u),await W.isSuccess){if(ba=await W.attributeNames,Sa=await Object.keys(await ba),await Sa.length>0){xa=[],ya="",W.supportingEvidence.AttributeDetails={};for(let a=0;a<await Sa.length;a++){try{if(Ma=await Sa[a],"text"===await Ma)Na=await(await r).getText();else try{Na=await(await r).getAttribute(await Ma)}catch(a){Na="null"}await Na.toString().toLowerCase().trim().includes(await ba[await Ma].toString().toLowerCase().trim())?xa.push(!1):xa.push(!0)}catch(a){xa.push(!0)}W.supportingEvidence.AttributeDetails[await Ma]=await Na,ya=ya+"Expected "+await Ma+" is "+await await ba[await Ma]+", and actual it has "+await Na+" ."}Ea=await ge(await xa),await Ea||(W.isSuccess=!1),W.errorMessage=await ya,W.additionaldata=await ya}}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"AssertElementCountEquals":if(W=await re(await u),await W.isSuccess){var Aa=await(await O).length;W.supportingEvidence.ActualElementCount=await Aa,Number(await Aa)!==Number(await W.expectedcount)&&(W.isSuccess=!1,W.errorMessage="Expected element count is "+await W.expectedcount+" however actual count is "+await Aa+"."),W.additionaldata=await W.errorMessage}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"AssertElementCountGreaterThan":W=await re(await u),await W.isSuccess?(Aa=await(await O).length,W.supportingEvidence.ActualElementCount=await Aa,Number(await Aa)>Number(await W.expectedcount)||(W.isSuccess=!1,W.errorMessage="Expected element count is "+await W.expectedcount+" however actual count is "+await Aa+"."),W.additionaldata=await W.errorMessage):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"AssertElementCountLessThan":W=await re(await u),await W.isSuccess?(Aa=await(await O).length,W.supportingEvidence.ActualElementCount=await Aa,Number(await Aa)<Number(await W.expectedcount)||(W.isSuccess=!1,W.errorMessage="Expected element count is "+await W.expectedcount+" however actual count is "+await Aa+"."),W.additionaldata=await W.errorMessage):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"IsFileExistOnDownloadFolder":if(W=await ne(await u,await D),await W.isSuccess)try{ta=await w.parse(await W.filename).name,ea=await w.parse(await W.filename).ext,ia=await i+await D+"/Web/Downloads/*"+await ta+"*"+await ea,ra=await n.sync(await ia),0===await ra.length&&(W.isSuccess=!1,W.errorMessage="File/Folder "+await W.filename+" does not exist on browser Downloads folder.")}catch(a){W.isSuccess=!1,W.errorMessage="File Name and extension should be required. Please pass the correct file name."}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"FileCountOnDownloadFolder":if(W=await ne(await u,await D),await W.isSuccess)try{ta=await w.parse(await W.filename).name,ea=await w.parse(await W.filename).ext,ia=await i+await D+"/Web/Downloads/*"+await ta+"*"+await ea,ra=await n.sync(await ia);var Pa=await ra.length;M.output=await Pa,W.errorMessage="Result "+await Pa,W.additionaldata="Total File count :"+await Pa,W.supportingEvidence.FileCount=await Pa}catch(a){W.isSuccess=!1,W.errorMessage="File Name and extension should be required. Please pass the correct file name."}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"AssertEquals":W=await oe(await u),await W.isSuccess?W=await async function(a,t){var e={isSuccess:!0,errorMessage:"",supportingEvidence:{}};try{var i=await typeof await a,r=await typeof await t;if("string"===await i){var s=await isNaN(await a);await s||(i="number")}if("string"===await r&&(s=await isNaN(await t),await s||(r="number")),"string"===await r&&"string"===await i)await a.toString().trim()!==await t.toString().trim()&&(e.isSuccess=!1,e.errorMessage="Expected value is "+await t+" however actual value is "+await a+".");else if("number"===await r&&"number"===await i)await Number(await a)!==await Number(await t)&&(e.isSuccess=!1,e.errorMessage="Expected value is "+await t+" however actual value is "+await a+".");else{var n=await ue(t),w=!1;await n?(w=await async function(a,t){if(!Array.isArray(await a)||!Array.isArray(await t))return!1;if(a.length!==t.length)return!1;const e=(await a).slice().sort(),i=(await t).slice().sort();return e.every((a,t)=>a===i[t])}(await a,await t),await w||(e.isSuccess=!1,e.errorMessage="Expected value is "+await t+" however actual value is "+await a+".")):(w=await async function(a,t){return await Object.keys(a).length===await Object.keys(t).length&&await le(await a,await t)}(await a,await t),await w||(e.isSuccess=!1,e.errorMessage="Expected value is "+await JSON.stringify(await t)+" however actual value is "+await JSON.stringify(await a)+"."))}}catch(i){e.isSuccess=!1,e.errorMessage="Expected value is "+await JSON.stringify(await t)+" however actual value is "+await JSON.stringify(await a)+"."}return await e}(W.actualvalue,await W.expectedvalue):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"AssertGreaterThan":W=await oe(await u),await W.isSuccess&&Number(await W.actualvalue<=await Number(await W.expectedvalue))&&(W.isSuccess=!1,W.errorMessage="Expected value is "+await Number(await W.expectedvalue)+" and actual value is "+await W.actualvalue);break;case"AssertLessThan":W=await oe(await u),await W.isSuccess&&Number(await W.actualvalue>=await Number(await W.expectedvalue))&&(W.isSuccess=!1,W.errorMessage="Expected value is "+await Number(await W.expectedvalue)+" and actual value is "+await W.actualvalue);break;case"AssertNotContains":if(W=await oe(await u),await W.isSuccess){var Ca=await ce(await W.actualvalue,await W.expectedvalue);await Ca.isSuccess?(W.errorMessage=await Ca.errorMessage,W.isSuccess=!1):(W.errorMessage=await Ca.errorMessage,W.isSuccess=!0)}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"AssertTitleContains":if(W=await se(await u),await W.isSuccess){var ka=await(await(await e).getTitle()).toString().toLocaleLowerCase();W.supportingEvidence.ActualBrowserTitle=await ka;var ja=await W.title.toString().toLocaleLowerCase().trim();await ka.includes(await ja)||(W.isSuccess=!1,W.errorMessage="Expected window Title is "+await W.title+" however actual title is "+await ka+"."),W.errorMessage="Expected window Title is "+await W.title+" and actual title is "+await ka+"."}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"AssertTitleEquals":if(W=await se(await u),await W.isSuccess){var Da=await await(await e).getTitle();W.supportingEvidence.ActualBrowserTitle="",W.supportingEvidence.ActualBrowserTitle=await Da,await Da!==await W.title&&(W.isSuccess=!1,W.errorMessage="Expected window Title is "+W.title+" however actual title is "+await Da+"."),W.errorMessage="Expected window Title is "+await W.title+" and actual title is "+await Da+"."}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"AssertAlertTextContains":W=await we(await u),await W.isSuccess?(da=await(await e).switchTo().alert(),ka=await da.getText(),W.supportingEvidence.ActualAlertText=await ka,ja=await W.expectedtext.toString().toLowerCase().trim(),await ka.includes(await ja)?W.errorMessage="Expected alert text "+await W.expectedtext+" is not present in actual text "+await ka+".":(W.isSuccess=!1,W.errorMessage="Expected alert text "+await W.expectedtext+" is present in actual text "+await ka+".")):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"AssertAlertTextEquals":W=await we(await u),await W.isSuccess?(da=await(await e).switchTo().alert(),Da=await da.getText(),W.supportingEvidence.ActualAlertText=await Da,await Da!==await W.expectedtext&&(W.isSuccess=!1,W.errorMessage="Expected alert text is "+W.expectedtext+" however actual text is "+await Da+"."),W.errorMessage="Expected alert text is "+await W.expectedtext+" and actual text is "+await Da+"."):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"AssertAlertTextNotContains":W=await we(await u),await W.isSuccess?(da=await(await e).switchTo().alert(),ka=await da.getText().toString().toLowerCase().trim(),W.supportingEvidence.ActualAlertText=await ka,ja=await W.expectedtext.toString().toLowerCase().trim(),await ka.includes(await ja)?(W.isSuccess=!1,W.errorMessage="Expected alert text "+await W.expectedtext+" is present in actual text "+await ka+"."):W.errorMessage="Expected alert text "+await W.expectedtext+" is not present in actual text "+await ka+"."):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"AssertUrlContains":if(W=await ie(await u),await W.isSuccess){var Oa=await(await e).getCurrentUrl();W.supportingEvidence.ApplicationUrl=await Oa,await Oa.toString().toLowerCase().trim().includes(await W.url.toString().toLowerCase().trim())||(W.isSuccess=!1,W.errorMessage="Expected window Url is "+await W.url+" however actual Url is "+await Oa+"."),W.errorMessage="Expected window Url is "+await W.url+" and actual Url is "+await Oa+"."}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"AssertUrlEquals":W=await ie(await u),await W.isSuccess?(Oa=await(await e).getCurrentUrl(),W.supportingEvidence.ApplicationUrl=await Oa,await Oa.toString().trim()!==await W.url.toString().trim()&&(W.isSuccess=!1,W.errorMessage="Expected window Url is "+await W.url+" however actual Url is "+await Oa+"."),W.errorMessage="Expected window Url is "+await W.url+" and actual Url is "+await Oa+"."):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"AssertUrlNotContains":W=await ie(await u),await W.isSuccess?(Oa=await(await e).getCurrentUrl(),W.supportingEvidence.ApplicationUrl=await Oa,await Oa.toString().toLowerCase().trim().includes(await W.url.toString().toLowerCase().trim())?(W.isSuccess=!1,W.errorMessage="Expected window Url "+await W.url+" is present in actual Url "+await Oa+"."):W.errorMessage="Expected window Url "+await W.url+" is not present in actual Url "+await Oa+"."):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"AssertWindowCountEquals":if(W=await re(await u),await W.isSuccess){var Ia=await(await e).getAllWindowHandles();W.supportingEvidence.TotalBrowserCount=await Ia.length,await Ia.length!==Number(await W.expectedcount)&&(W.isSuccess=!1,W.errorMessage="Expected Window count is "+await W.expectedcount+" however actual count is "+await Ia.length+".")}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"IsDisabled":await(await r).isEnabled()&&(W.isSuccess=!1,W.errorMessage="Element is not disabled.");break;case"IsDisplayed":var La=await(await r).isDisplayed();await La||(W.isSuccess=!1,W.errorMessage="Element is not displayed.");break;case"IsEnabled":var Fa=await(await r).isEnabled();await Fa||(W.isSuccess=!1,W.errorMessage="Element is not enabled.");break;case"IsNotDisplayed":try{La=await(await r).isDisplayed(),await La&&(W.isSuccess=!1,W.errorMessage="Element is displayed.")}catch(a){}break;case"IsSelected":await(await r).isSelected();break;case"SaveSessionVariable":if(W=await fe(await u),await W.isSuccess){var Ua=await M.output;try{var Tt=await JSON.parse(await Ua);Ua=await Tt.valuetobesend,void 0===await Ua&&(Ua=await Tt)}catch(a){}N[await W.variablename]=await Ua,W.additionaldata=await Ua,W.supportingEvidence.SessionVariableValue=await Ua}else{W.supportingEvidence.SessionVariableValue={};var Et=await JSON.parse(await u);Sa=await Object.keys(await Et);for(let a=0;a<await Sa.length;a++){var At=await Sa[a],Pt=await Et[await At];N[await At]=await Pt,W.supportingEvidence.SessionVariableValue[await At]=await Pt}M.output=await JSON.stringify(await Et),W.additionaldata=await JSON.stringify(await Et),W.isSuccess=!0}break;case"SaveGlobalVariable":if(W=await fe(await u),await W.isSuccess){Ua=await M.output;try{Tt=await JSON.parse(await Ua),Ua=await Tt.valuetobesend,void 0===await Ua&&(Ua=await Tt)}catch(a){}void 0!==await Ua&&await async function(a,t,e,r){try{var n=await a+"/"+await t+"/Web/Misc/";await d(await n)||await l(await n);var w=await n+"GlobalVariable.Json";if(!await d(await w)){const a={},t=await JSON.stringify(await a,null,2);await s.writeFileSync(await i+await w,await t)}if(void 0!==await r&&void 0!==await e){var o=await p(await w);o[await e]=await r,await s.writeFileSync(await i+await w,JSON.stringify(await o))}}catch(a){}}(await a,await D,await W.variablename,await Ua),R[await W.variablename]=await Ua,W.additionaldata=await Ua,W.supportingEvidence.GlobalVariableValue=await Ua}else{W.supportingEvidence.GlobalVariableValue={},Et=await JSON.parse(await u),Sa=await Object.keys(await Et);for(let a=0;a<await Sa.length;a++)At=await Sa[a],Pt=await Et[await At],R[await At]=await Pt,W.supportingEvidence.GlobalVariableValue[await At]=await Pt;M.output=await JSON.stringify(await Et),W.additionaldata=await JSON.stringify(await Et),W.isSuccess=!0}break;case"GenerateUtilityValue":var Ct,kt=await typeof await u;if("string"===await kt)try{Ct=await JSON.parse(await u),Ct=await Ct.valuetobesend,void 0===await Ct&&(Ct=await await u)}catch(a){Ct=await u}M.output=await Ct,W.errorMessage="Result "+await M.output,W.additionaldata=await Ct,W.supportingEvidence.UtilityDataValue=await Ct;break;case"RunDBQuery":W=await Ne(await u),await W.isSuccess?(W=await m(await D,"Web",await U,await W.Query,await W.database),await W.isSuccess?(M.output=await W.output,W.errorMessage="Result "+await M.output,W.supportingEvidence.SQLQueryOutput=await M.output):W.errorMessage=await W.errorMessage):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"DBRecordsCount":if(W=await Ne(await u),await W.isSuccess)if(W=await m(await D,"Web",await U,await W.Query,await W.database),await W.isSuccess)try{M.output=JSON.parse(await W.output).length,W.errorMessage="Result "+await M.output,W.supportingEvidence.SQLQueryResults=await M.output}catch(a){M.output=0,W.errorMessage=await a.toString()}else M.output=0,W.errorMessage=await W.errorMessage;else M.output=0,W.errorMessage=await W.errorMessage;break;case"DBRecordCountShouldBe":if(W=await Te(await u),await W.isSuccess){var jt=Number(await W.rowsCount),Dt=0,Ot=await M.output;try{Tt=await JSON.parse(await Ot),Dt=await Tt.length,W.supportingEvidence.DBRecordCount=await Dt}catch(a){Dt=0}await jt!==await Dt&&(W.isSuccess=!1,W.errorMessage="Expected Db Records count is "+await jt+" however actual DB record count is "+await Dt+".")}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"DBRecordCountShouldBeGreaterThan":if(W=await Te(await u),await W.isSuccess){jt=Number(await W.rowsCount),Dt=0,Ot=await M.output;try{Tt=await JSON.parse(await Ot),Dt=await Tt.length,W.supportingEvidence.DBRecordCount=await Dt}catch(a){Dt=0}await jt<await Dt||(W.isSuccess=!1,W.errorMessage="Expected Db Records count is "+await jt+" however actual DB record count is "+await Dt+".")}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"DBRecordCountShouldBeLessThan":if(W=await Te(await u),await W.isSuccess){jt=Number(await W.rowsCount),Dt=0,Ot=await M.output;try{Tt=await JSON.parse(await Ot),Dt=await Tt.length,W.supportingEvidence.DBRecordCount=await Dt}catch(a){Dt=0}await jt>await Dt||(W.isSuccess=!1,W.errorMessage="Expected Db Records count is "+await jt+" however actual DB record count is "+await Dt+".")}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"SaveDBColumnValueInSessionVariable":if(W=await async function(a){var t={isSuccess:!0,errorMessage:"",allcolumn:[],allvariable:[],rowIndex:0,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid,  rowIndex and columnname should be provided in the value section. e.g. {"rowIndex":0,"DbColumn":"MyVariable"}.',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a),i=!1;if(void 0===await e.rowIndex&&(t.rowIndex=void 0,i=!0),await i)r=await Object.keys(await e);else{t.rowIndex=await e.rowIndex;var r=await Object.keys(await e);if(1===await r.length)return t.errorMessage='Provided value is invalid,  rowIndex and columnname should be provided in the value section. e.g. {"rowIndex":0,"DbColumn":"MyVariable"}.',t.isSuccess=!1,await t}for(let a=0;a<await r.length;a++){var s=await r[a];if("rowIndex"!==await s){if(await t.allcolumn.includes(await s))return t.errorMessage="Provided value is invalid,  Duplicate column "+await s+" are found.}.",t.isSuccess=!1,await t;await t.allcolumn.push(await await s);var n=await e[await s];if(await t.allvariable.includes(await n))return t.errorMessage="Provided value is invalid,  Duplicate variable "+await n+" are found.}.",t.isSuccess=!1,await t;await t.allvariable.push(await await n)}}}catch(a){return t.errorMessage='Provided value is invalid,  rowIndex and columnname should be provided in the value section. e.g. {"rowIndex":0,"DbColumn":"MyVariable"}.',t.isSuccess=!1,await t}return await t}(await u),await W.isSuccess){var It=await JSON.parse(await M.output);if(void 0!==await W.rowIndex)var Lt=Number(await W.rowIndex);else Lt=void 0;var Ft=await W.allcolumn,Ut=await W.allvariable;W.supportingEvidence.DBTableColumnValue={};for(let a=0;a<await Ut.length;a++){var Vt=await Ut[a],Bt=await Ft[a];if(void 0===await Lt){var Xt=[];for(let a=0;a<await It.length;a++){var Yt=await It[await a][await Bt];Xt.push(await Yt)}W.supportingEvidence.DBTableColumnValue[await Vt]=await Xt,N[await Vt]=await Xt}else{if(await Lt>=await It.length){W.isSuccess=!1,W.errorMessage="Total Db Records count is "+await It.length+" and rowIndex provided in test data is "+await Lt+". Please note index is started with 0";break}if(Yt=await It[await Lt][await Bt],void 0===await Yt){W.isSuccess=!1,W.errorMessage="Column name "+await Bt+" does not exist in Records data.";break}N[await Vt]=await Yt,W.supportingEvidence.DBTableColumnValue[await Vt]=await Yt}}}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"CreateRequestParametersInSessionVariable":if(W=await async function(a){var t={isSuccess:!0,totalLength:1,listOfParameters:[],listOfParametersValue:[],variableName:""};if(""===await a.toString().trim()||void 0===await a||"{}"===await a)return t.errorMessage="Provided value is invalid, loopCounter,listOfParameters,listOfParametersValue and variableName keys are expected in value section.",t.isSuccess=!1,await t;try{var e=await JSON.parse(await a),i=await e.totalLength;if(void 0===await i)return t.errorMessage="loopCounter key should be present in value section.",t.isSuccess=!1,await t;if(isNaN(await Number(i)))return t.errorMessage="loopCounter should be a number.",t.isSuccess=!1,t;t.totalLength=await Number(await i);var r=await e.listOfParameters;if(void 0===await r)return t.errorMessage="listOfParameters key should be present in value section.",t.isSuccess=!1,await t;if(!await Array.isArray(await r))return t.errorMessage="listOfParameters key should be list.",t.isSuccess=!1,await t;var s=await r.length;t.listOfParameters=await r;var n=await e.listOfParametersValue;if(void 0===await n)return t.errorMessage="listOfParametersValue key should be present in value section.",t.isSuccess=!1,await t;if(!await Array.isArray(await n))return t.errorMessage="listOfParametersValue key should be list.",t.isSuccess=!1,await t;var w=await n.length;if(await w!==await s)return t.errorMessage="count of listOfParameters and listOfParametersValue is not same.",t.isSuccess=!1,await t;t.listOfParametersValue=await n;var o=await e.variableName;if(void 0===await o)return t.errorMessage="variableName key should be present in value section.",t.isSuccess=!1,await t;t.variableName=await o}catch(a){return t.errorMessage="Provided value is invalid, loopCounter,listOfParameters,listOfParametersValue and variableName keys are expected in value section.",t.isSuccess=!1,await t}return await t}(await u),await W.isSuccess){W.supportingEvidence={};var Gt=[],Qt=await W.variableName,qt=await W.totalLength;for(let a=0;a<await qt;a++){var Zt={},Kt=(Sa=await W.listOfParameters,await W.listOfParametersValue);for(let t=0;t<await Sa.length;t++){var Ht=await Sa[t],_t=await Kt[t];try{var zt=await JSON.parse(await _t);"object"===await typeof await zt?Zt[await Ht]=await zt[a]:Zt[await Ht]=await _t}catch(a){Zt[await Ht]=await _t}}Gt.push(await Zt)}N[await Qt]=await Gt,W.supportingEvidence[await Qt]=await Gt}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"CallAPI":W=await async function(a){var t={isSuccess:!0,errorMessage:"",component:"",testId:"",apiinput:{},supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid,  component and testId should be provided in the value section. e.g. {"component":"MyComponent","testId":"TC-01"}.',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(void 0===await e.component)return t.errorMessage='Provided value is invalid,  component and testId should be provided in the value section. e.g. {"component":"MyComponent","testId":"TC-01"}.',t.isSuccess=!1,await t;if(t.component=await e.component,void 0===await e.testId)return t.errorMessage='Provided value is invalid,  component and testId should be provided in the value section. e.g. {"component":"MyComponent","testId":"TC-01"}.',t.isSuccess=!1,await t;t.testId=await e.testId;var i=await Object.keys(await e);for(let a=0;a<await i.length;a++){var r=await i[a];if("component"!==await r&&"testId"!==await r){var s=await r.toString().toLocaleLowerCase();if(!(await s.startsWith("relativeurl")||await s.startsWith("requestheader")||await s.startsWith("requestbody")))return t.errorMessage='Provided value is invalid,  you can only override the requestUrl , requestHeader and requestBody key , example {"component":"MyComponent","testId":"TC-01","relativeUrl":"/mytestid/testid","requestHeader[Accept]","application/json","requestBody[id]":"myUser"}',t.isSuccess=!1,await t;t.apiinput[await r]=await e[await r]}}}catch(a){return t.errorMessage="Provided value is invalid . "+await a.toString(),t.isSuccess=!1,await t}return await t}(await u),await W.isSuccess?(W=await v(await D,await W.component,await W.testId,await U,await W.apiinput),M.output=JSON.stringify(await W.output),W.supportingEvidence.APIResponseData=await W.output):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"CallMobileTestScript":W=await async function(a){var t={isSuccess:!0,errorMessage:"",component:"",testId:"",testdata:{}};t.testdata[1]={},t.supportingEvidence={};try{var e=await JSON.parse(await a),i=await e.component;if(void 0===await i)return t.errorMessage="Provided value is invalid, value should be in JSON format,component and testId should be present.",t.isSuccess=!1,await t;t.component=await i;var r=await e.testId;if(void 0===await r)return t.errorMessage="Provided value is invalid, value should be in JSON format,component and testId should be present.",t.isSuccess=!1,await t;t.testId=await r;var s=await e.testdata;void 0!==await s&&(t.testdata=await s)}catch(a){return t.errorMessage="Provided value is invalid, value should be in JSON format,component and testId should be present.",t.isSuccess=!1,await t}return await t}(await u),await W.isSuccess?(W=await g(await a,await D,await W.component,await W.testId,await U,await W.testdata),M.output=JSON.stringify(await W.output)):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"SaveAPIResponseInSessionVariable":if(W=await async function(a){var t={isSuccess:!0,errorMessage:"",variable:{},supportingEvidence:{}},e=[];if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid,  variable name should be provided. e.g. {"myVar":"ResponseHeader[KeyName]","myVar2":"ResponseBody[KeyName]"}.',t.isSuccess=!1,await t;try{var i=await JSON.parse(await a),r=await Object.keys(await i);if(0===await r.length)return t.errorMessage='Provided value is invalid,  variable name should be provided. e.g. {"myVar":"ResponseHeader[KeyName]","myVar2":"ResponseBody[KeyName]"}.',t.isSuccess=!1,await t;for(let a=0;a<await r.length;a++){var s=await r[a];if("testId"!==await s&&"component"!==await s){if(await e.includes(await s))return t.errorMessage="Provided value is invalid,  Duplicate variable "+await s+" are found.}.",t.isSuccess=!1,await t;await e.push(await await s);var n=await i[await s];if(!(await n.toLocaleLowerCase().startsWith("responseheader")||await n.toLocaleLowerCase().startsWith("responsebody")||await n.toLocaleLowerCase().startsWith("requestheader")||await n.toLocaleLowerCase().startsWith("requestbody")))return t.errorMessage="Provided value is invalid,  Session variable either can be extracted from ResponseHeader or ResponseBody key}.",t.isSuccess=!1,await t;t.variable[await s]="",t.variable[await s]=await n}}}catch(a){return t.errorMessage="Provided value is invalid . "+await a.toString(),t.isSuccess=!1,await t}return await t}(await u),await W.isSuccess){var $t=await JSON.parse(await M.output),ve=(Ut=await W.variable,await Object.keys(await Ut));W.supportingEvidence.APIResponseVariableData={};for(let a=0;a<await ve.length;a++){var ye=await ve[await a],be=await Ut[await ye],Se=await o(await be);if(Pt=await c(await $t,await Se),void 0===await Pt){W.isSuccess=!1,W.errorMessage=await Pt+" does not exist in API Response";break}N[await ye]=await Pt,W.supportingEvidence.APIResponseVariableData[await ye]=await Pt}}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"AssertIsNumberInAscendingOrder":if(W=await pe(await u),await W.isSuccess){var Pe=W.valuetobesend;W=await async function(a){var t={isSuccess:!0,errorMessage:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage="Provided value is invalid, valuetobesend should be provided in value section e.g. [1,2.3,4]",t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);try{var i=await e,r=[];for(let a=0;a<await i.length;a++){var s=await Ee(i[a]);if(isNaN(await s))return t.errorMessage="Provided value is invalid, it takes number only e.g. [1,2.3,4]",t.isSuccess=!1,await t;s=await Number(await s),r.push(await s)}var n=await async function(a){for(let t=0;t<await a.length-1;t++)if(a[t]>a[t+1])return!1;return!0}(await r);if(!await n)return t.errorMessage="Numbers  "+await JSON.stringify(await r)+" are in list are not in Ascending Order.",t.isSuccess=!1,await t}catch(a){return t.errorMessage="Provided value is invalid, valuetobesend should be provided in value section e.g. [1,2.3,4]",t.isSuccess=!1,await t}}catch(a){return t.errorMessage="Provided value is invalid, valuetobesend should be provided in value section e.g. [1,2.3,4]",t.isSuccess=!1,await t}return await t}(await Pe)}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"AssertIsNumberInDescendingOrder":W=await pe(await u),await W.isSuccess?(Pe=W.valuetobesend,W=await async function(a){var t={isSuccess:!0,errorMessage:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage="Provided value is invalid, valuetobesend should be provided in value section e.g. [1,2.3,4]",t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);try{var i=await e,r=[];for(let a=0;a<await i.length;a++){var s=await Ee(i[a]);if(isNaN(await s))return t.errorMessage="Provided value is invalid, it takes number only e.g. [1,2.3,4]",t.isSuccess=!1,await t;s=await Number(await s),r.push(await s)}var n=await async function(a){for(let t=0;t<await a.length-1;t++)if(a[t]<a[t+1])return!1;return!0}(await r);if(!await n)return t.errorMessage="Numbers  "+await JSON.stringify(await r)+" are in list are not in Descending Order.",t.isSuccess=!1,await t}catch(a){return t.errorMessage="Provided value is invalid, valuetobesend should be provided in value section e.g. [1,2.3,4]",t.isSuccess=!1,await t}}catch(a){return t.errorMessage="Provided value is invalid, valuetobesend should be provided in value section e.g. [1,2.3,4]",t.isSuccess=!1,await t}return await t}(await Pe)):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"AssertIsListSorted":W=await pe(await u),await W.isSuccess?(Pe=W.valuetobesend,W=await async function(a){var t={isSuccess:!0,errorMessage:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, valuetobesend should be provided in value section e.g. ["a","b"]',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);try{var i=await e,r=[];for(let a=0;a<await i.length;a++)r.push(await numberToPush);var s=await async function(a){const t=await[...a].sort();return JSON.stringify(await a)===await JSON.stringify(await t)}(await r);if(!await s)return t.errorMessage="value  "+await JSON.stringify(await r)+" are in list are not sorted.",t.isSuccess=!1,await t}catch(a){return t.errorMessage='Provided value is invalid, valuetobesend should be provided in value section e.g. ["a","b"]',t.isSuccess=!1,await t}}catch(a){return t.errorMessage='Provided value is invalid, valuetobesend should be provided in value section e.g. ["a","b"]',t.isSuccess=!1,await t}return await t}(await Pe)):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"ReadPdfFile":W=await ne(await u,await D),await W.isSuccess?(W=await f(await D,"Web",await W.filename),M.output=await W.output,W.supportingEvidence.PDFData=await M.output):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"PdfTotalPageCountShouldBe":W=await async function(a){var t={isSuccess:!0,errorMessage:"",filename:"",expectedCount:0,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"mydoc.pdf","expectedCount":1}',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(void 0===await e.filename)return t.errorMessage='Provided value is invalid, filename key is missing.correct format is {"filename":"mydoc.pdf","expectedCount":1}',t.isSuccess=!1,await t;if(t.filename=await e.filename.toString().trim(),void 0===await e.expectedCount)return t.errorMessage='Provided value is invalid, expectedCount key is missing.correct format is {"filename":"mydoc.pdf","expectedCount":1}',t.isSuccess=!1,await t;var i=await Number(await e.expectedCount);if(await Number(NaN===await e.expectedCount))return t.errorMessage='Provided value is invalid, expectedCount key should be number.correct format is {"filename":"mydoc.pdf","expectedCount":1}',t.isSuccess=!1,await t;t.expectedCount=Number(await i)}catch(a){return t.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"mydoc.pdf","expectedCount":1}',t.isSuccess=!1,await t}return await t}(await u),await W.isSuccess?W=await y(await D,"Web",await W.filename,await W.expectedCount):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"ExcelRowCountShouldBe":if(W=await Ae(await u),await W.isSuccess){var Ce=await W.expectedCount;W=await b(await D,"Web",await W.filename,await W.sheetname),await W.isSuccess&&(W.supportingEvidence.ActualExcelRowCount=Number(await W.output),Number(await Ce)!==Number(await W.output)&&(W.isSuccess=!1,W.errorMessage="Expected row count "+await Ce+" does not match with actual row count "+await W.output))}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"ExcelRowCountShouldBeGreaterThan":W=await Ae(await u),await W.isSuccess?(Ce=await W.expectedCount,W=await b(await D,"Web",await W.filename,await W.sheetname),await W.isSuccess&&(W.supportingEvidence.ActualExcelRowCount=Number(await W.output),Number(await Ce)>Number(await W.output)||(W.isSuccess=!1),W.errorMessage="Expected row count is "+await Ce+" and actual row count "+await W.output)):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"ExcelRowCountShouldBeLessThan":W=await Ae(await u),await W.isSuccess?(Ce=await W.expectedCount,W=await b(await D,"Web",await W.filename,await W.sheetname),await W.isSuccess&&(W.supportingEvidence.ActualExcelRowCount=Number(await W.output),Number(await Ce)<Number(await W.output)||(W.isSuccess=!1),W.errorMessage="Expected row count is "+await Ce+" and actual row count "+await W.output)):(W.isSuccess=!1,W.errorMessage=await W.errorMessage);break;case"SaveExcelColumnValueInSessionVariable":if(W=await Ae(await u,!1),await W.isSuccess){var ke=await W.filename,je=await W.sheetname;if(W=await async function(a){var t={isSuccess:!0,errorMessage:"",rowIndex:0,excelcolumn:{},supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"rowIndex":1,"ColumnName":"Your Variable name"}',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(void 0!==await e.rowIndex){var i=await Number(await e.rowIndex);await Number(NaN!==await e.rowIndex)&&(t.rowIndex=Number(await i))}var r=await Object.keys(await e);for(let a=0;a<await r.length;a++){var s=await r[a],n=await s.toString().toLocaleLowerCase();"filename"!==await n&&"sheetname"!==await n&&"rowindex"!==await n&&(t.excelcolumn[await s]=await e[await s])}if(0===Object.keys(await t.excelcolumn).length)return t.errorMessage='Provided value is invalid, Provide atleast one excel column name which need to be fetched e.g. {"ColumnName":"Your Variable name"}',t.isSuccess=!1,await t}catch(a){return t.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"rowIndex":1,"ColumnName":"Your Variable name"}',t.isSuccess=!1,await t}return await t}(await u),await W.isSuccess){W.supportingEvidence.ExcelColumnData={},Lt=await W.rowIndex;var De=await W.excelcolumn;if(W=await S(await D,"Web",await ke,await je),await W.isSuccess){W.supportingEvidence.ExcelColumnData={},H=await W.output,Sa=await Object.keys(await De);for(let a=0;a<await Sa.length;a++){var Oe=await Sa[a],Le=await De[await Oe];const t=await x(await Lt,await Le,await H);void 0===await t&&(W.isSuccess=!1,W.errorMessage="Excel column "+await Oe+" does not existing in Excel file."),N[await Le]=await t,W.supportingEvidence.ExcelColumnData[await Oe]=await t}try{M.output=await JSON.stringify(await N)}catch(a){}}}}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"SaveColumnValuesBasedOnConditionalColumnAndValue":if(W=await async function(a){var t={isSuccess:!0,errorMessage:"",filename:"",sheetname:"",conditionalcolumnname:[],conditionalcolumnvalues:[],columnnametofetch:[],supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage="Provided value is invalid, filename,conditionalcolumnname,conditionalcolumnvalues and columnnametofetch is required.",t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(void 0===await e.filename)return t.errorMessage='Provided value is invalid, filename key is missing."}',t.isSuccess=!1,await t;t.filename=await e.filename.toString().trim(),t.sheetname=await e.sheetname,void 0===await t.sheetname&&(t.sheetname="");var i=await e.conditionalcolumnname;if(!await Array.isArray(await i)&&(i=await JSON.parse(await i),!await Array.isArray(await i)))return t.errorMessage="conditionalcolumnname is not in correct format.",t.isSuccess=!1,await t;t.conditionalcolumnname=await i;var r=await e.conditionalcolumnvalues;if(!await Array.isArray(await r)&&(r=await JSON.parse(await r),!await Array.isArray(await i)))return t.errorMessage="conditionalcolumnvalues is not in correct format.",t.isSuccess=!1,await t;t.conditionalcolumnvalues=await r;var s=await e.columnnametofetch;if(!await Array.isArray(await s)&&(s=await JSON.parse(await s),!await Array.isArray(await i)))return t.errorMessage="columnnametofetch is not in correct format.",t.isSuccess=!1,await t;t.columnnametofetch=await s}catch(a){return t.errorMessage="Provided value is invalid, filename,conditionalcolumnname,conditionalcolumnvalues and columnnametofetch is required.",t.isSuccess=!1,await t}return await t}(await u),await W.isSuccess){ke=await W.filename,je=await W.sheetname;var Fe=await await W.conditionalcolumnname,Ue=await await W.conditionalcolumnvalues,Ve=await await W.columnnametofetch;if(W=await S(await D,"Web",await ke,await je),await W.isSuccess){W.supportingEvidence.ExcelColumnData={},H=await W.output;const a=await h(await H,await Fe,await Ue,await Ve);for(let t=0;t<await Ve.length;t++){var Be=await Ve[t];W.supportingEvidence.ExcelColumnData[await Be]=[],N[await Be]=await a[await Be],W.supportingEvidence.ExcelColumnData[await Be]=await a[await Be]}try{M.output=await JSON.stringify(await N)}catch(a){}}}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"AssertStringLengthShouldBe":if(W=await async function(a){var t={isSuccess:!0,inputstring:"",expectedlength:0,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a||"{}"===await a)return t.errorMessage="Provided value is invalid, inputstring and expectedlength keys are expected in value section.",t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(0==await Object.keys(await e).length)return t.errorMessage="Provided value is invalid, inputstring and expectedlength keys are expected in value section.",t.isSuccess=!1,await t;var i=await e.inputstring;if(void 0===await i)return t.errorMessage="Provided value is invalid, inputstring and expectedlength keys are expected in value section.",t.isSuccess=!1,await t;t.inputstring=await i;var r=await e.expectedlength;if(void 0===await r)return t.errorMessage="Provided value is invalid, inputstring and expectedlength keys are expected in value section.",t.isSuccess=!1,await t;if(isNaN(await r))return t.errorMessage="Provided value is invalid, expectedlength should be number",t.isSuccess=!1,await t;t.expectedlength=await r}catch(a){return t.errorMessage="Provided value is invalid, inputstring and expectedlength keys are expected in value section.",t.isSuccess=!1,await t}return await t}(await u),await W.isSuccess){var Re=await W.inputstring.toString().length;W.supportingEvidence.ActualStringLength=await Re;var Je=await Number(await W.expectedlength);await Re!==Je&&(W.isSuccess=!1,W.errorMessage="Actual string length "+await Re+" does not match with expected String length "+await Je)}else W.isSuccess=!1,W.errorMessage=await W.errorMessage;break;case"Array.DeleteItem":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,"string"===await typeof await z&&(z=await JSON.parse(await z)),void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if("object"!==await typeof await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput should be array in value section.",await W;var Xe=await u.itemToDelete;if(void 0===await Xe)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.itemToDelete key is missing in value section.",await W;M.output=await gt(await z,await Xe),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Array.DeleteItemBasedOnIndex":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,"string"===await typeof await z&&(z=await JSON.parse(await z)),void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if("object"!==await typeof await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput should be array in value section.",await W;if(Xe=await u.indexPosition,void 0===await Xe)return W.isSuccess=!1,W.errorMessage="Provided value is invalid. indexPosition key is missing in value section.",await W;if(Xe=await Number(await Xe),await isNaN(await Xe))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. indexPosition value should be number in value section.",await W;if(await Xe>=await z.length)return W.isSuccess=!1,W.errorMessage="indexPosition value "+await Xe+"  is greater than array size "+await z.length,await W;M.output=await ht(await z,await Xe),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Array.GetValueBasedOnIndex":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,"string"===await typeof await z&&(z=await JSON.parse(await z)),void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if("object"!==await typeof await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput should be array in value section.",await W;if(Xe=await u.indexPosition,void 0===await Xe)return W.isSuccess=!1,W.errorMessage="Provided value is invalid. indexPosition key is missing in value section.",await W;if(Xe=await Number(await Xe),await isNaN(await Xe))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. indexPosition value should be number in value section.",await W;if(await Xe>=await z.length)return W.isSuccess=!1,W.errorMessage="indexPosition value "+await Xe+"  is greater than array size "+await z.length,await W;M.output=await ft(await z,await Xe),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Array.Length":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,"string"===await typeof await z&&(z=await JSON.parse(await z)),void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if("object"!==await typeof await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput should be array in value section.",await W;M.output=await at(await z),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Array.ExcludeCharacters":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;var We=await u.excludeCharacters;if(!Array.isArray(await We))return W.isSuccess=!1,W.errorMessage="Provided value is invalid.excludeCharacters should be array in value section.",await W;M.output=await Va(await z,await We),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Array.Sort":case"Array.Sort":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,"string"===await typeof await z&&(z=await JSON.parse(await z)),void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if("object"!==await typeof await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput should be array in value section.",await W;M.output=await St(await z),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Array.Push":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,"string"===await typeof await z&&(z=await JSON.parse(await z)),void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if("object"!==await typeof await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput should be array in value section.",await W;var Ye=await u.newElement;if(void 0===await Ye)return W.isSuccess=!1,W.errorMessage="Provided value is invalid. newElement key is missing in value section.",await W;M.output=await yt(await z,await Ye),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Array.Search":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,"string"===await typeof await z&&(z=await JSON.parse(await z)),void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if("object"!==await typeof await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput should be array in value section.",await W;var Ge=await u.searchItem;if(void 0===await Ge)return W.isSuccess=!1,W.errorMessage="Provided value is invalid. searchItem key is missing in value section.",await W;M.output=await bt(await z,await Ge),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Array.SortDesc":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,"string"===await typeof await z&&(z=await JSON.parse(await z)),void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if("object"!==await typeof await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput should be array in value section.",await W;M.output=await xt(await z),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Array.SumOfArray":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,"string"===await typeof await z&&(z=await JSON.parse(await z)),void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if("object"!==await typeof await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput should be array in value section.",await W;M.output=await Mt(await z),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Date.getDate":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;u=await JSON.parse(await u);var Qe=await u.addorDaysfromPresentDate;if(void 0===await Qe)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.addorDaysfromPresentDate key is missing in value section.",await W;if(Qe=await Number(await Qe),await isNaN(await Qe))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. addorDaysfromPresentDate value should be number in value section.",await W;var qe=await u.dateTemplate;if(void 0===await qe)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.dateTemplate key is missing in value section.",await W;M.output=await pt(await Qe,await qe),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Date.FormatDateTemplate":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;var Ze=await u.initialDateTemplate;if(void 0===await Ze)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.initialDateTemplate key is missing in value section.",await W;var Ke=await u.expectedDateTemplate;if(void 0===await Ke)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.expectedDateTemplate key is missing in value section.",await W;M.output=await vt(await z,await Ze,await Ke),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Date.GetDateDifference":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;u=await JSON.parse(await u);var He=await u.startDate;if(void 0===await He)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.startDate key is missing in value section.",await W;var _e=await u.startDateTemplate;if(void 0===await _e)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.startDateTemplate key is missing in value section.",await W;var ze=await u.endDate;if(void 0===await ze)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.endDate key is missing in value section.",await W;var $e=await u.endDateTemplate;if(void 0===await $e)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.endDateTemplate key is missing in value section.",await W;var ai=await u.diffIn;if(void 0===await ai)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.diffIn key is missing in value section.",await W;M.output=await mt(await He,await _e,await ze,await $e,await ai),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Math.Abs":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if(z=await Number(await z),await isNaN(await z))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. userInput value should be number in value section.",await W;M.output=await lt(await z),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Math.AddPercentage":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if(z=await Number(await z),await isNaN(await z))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. userInput value should be number in value section.",await W;var ti=await u.percentageValue;if(void 0===await ti)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.percentageValue key is missing in value section.",await W;if(ti=await Number(await ti),await isNaN(await ti))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. percentageValue value should be number in value section.",await W;var ei=await u.numberToShowafterDecimal;if(void 0===await ei)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await W;if(ei=await Number(await ei),await isNaN(await ei))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await W;M.output=await dt(await z,await ti,await ei),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Math.AddTwoNumber":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if(z=await Number(await z),await isNaN(await z))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. userInput value should be number in value section.",await W;var ii=await u.userInput2;if(void 0===await ii)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput2 key is missing in value section.",await W;if(ii=await Number(await ii),await isNaN(await ii))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. userInput2 value should be number in value section.",await W;if(ei=await u.numberToShowafterDecimal,void 0===await ei)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await W;if(ei=await Number(await ei),await isNaN(await ei))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await W;M.output=await ut(await z,await ii,await ei),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Math.Ceil":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if(z=await Number(await z),await isNaN(await z))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. userInput value should be number in value section.",await W;M.output=await ct(await z),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Math.DivideTwoNumber":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;u=await JSON.parse(await u);var ri=await u.dividend;if(void 0===await ri)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.dividend key is missing in value section.",await W;if(ri=await Number(await ri),await isNaN(await ri))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. dividend value should be number in value section.",await W;var si=await u.divisor;if(void 0===await si)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.divisor key is missing in value section.",await W;if(si=await Number(await si),await isNaN(await si))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. divisor value should be number in value section.",await W;if(ei=await u.numberToShowafterDecimal,void 0===await ei)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await W;if(ei=await Number(await ei),await isNaN(await ei))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await W;M.output=await ot(await ri,await si,await ei),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Math.Floor":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if(z=await Number(await z),await isNaN(await z))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. userInput value should be number in value section.",await W;M.output=await wt(await z),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Math.GetPercentage":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if(z=await Number(await z),await isNaN(await z))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. userInput value should be number in value section.",await W;var ni=await u.percentageToCalculate;if(void 0===await ni)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.percentageToCalculate key is missing in value section.",await W;if(ni=await Number(await ni),await isNaN(await ni))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. percentageToCalculate value should be number in value section.",await W;if(ei=await u.numberToShowafterDecimal,void 0===await ei)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await W;if(ei=await Number(await ei),await isNaN(await ei))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await W;M.output=await nt(await z,await ni,await ei),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Math.MultiplyTwoNumber":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if(z=await Number(await z),await isNaN(await z))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. userInput value should be number in value section.",await W;if(ii=await u.userInput2,void 0===await ii)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput2 key is missing in value section.",await W;if(ii=await Number(await ii),await isNaN(await ii))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. userInput2 value should be number in value section.",await W;if(ei=await u.numberToShowafterDecimal,void 0===await ei)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await W;if(ei=await Number(await ei),await isNaN(await ei))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await W;M.output=await st(await z,await ii,await ei),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Math.Reminder":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),ri=await u.dividend,void 0===await ri)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.dividend key is missing in value section.",await W;if(ri=await Number(await ri),await isNaN(await ri))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. dividend value should be number in value section.",await W;if(si=await u.divisor,void 0===await si)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.divisor key is missing in value section.",await W;if(si=await Number(await si),await isNaN(await si))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. divisor value should be number in value section.",await W;M.output=await rt(await ri,await si),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Math.Round":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if(z=await Number(await z),await isNaN(await z))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. userInput value should be number in value section.",await W;if(ei=await u.numberToShowafterDecimal,void 0===await ei)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await W;if(ei=await Number(await ei),await isNaN(await ei))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await W;M.output=await it(await z,await ei),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Math.SubtractPercentage":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if(z=await Number(await z),await isNaN(await z))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. userInput value should be number in value section.",await W;if(ti=await u.percentageValue,void 0===await ti)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.percentageValue key is missing in value section.",await W;if(ti=await Number(await ti),await isNaN(await ti))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. percentageValue value should be number in value section.",await W;if(ei=await u.numberToShowafterDecimal,void 0===await ei)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await W;if(ei=await Number(await ei),await isNaN(await ei))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await W;M.output=await et(await z,await ti,await ei),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"Math.SubtractTwoNumber":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if(z=await Number(await z),await isNaN(await z))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. userInput value should be number in value section.",await W;if(ii=await u.userInput2,void 0===await ii)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput2 key is missing in value section.",await W;if(ii=await Number(await ii),await isNaN(await ii))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. userInput2 value should be number in value section.",await W;if(ei=await u.numberToShowafterDecimal,void 0===await ei)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.numberToShowafterDecimal key is missing in value section.",await W;if(ei=await Number(await ei),await isNaN(await ei))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. numberToShowafterDecimal value should be number in value section.",await W;M.output=await tt(await z,await ii,await ei),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"String.Concat":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if(ii=await u.userInput2,void 0===await ii)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput2 key is missing in value section.",await W;M.output=await $a(await z,await ii),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"String.EndsWith":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;var wi=await u.searchString;if(void 0===await wi)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.searchString key is missing in value section.",await W;M.output=await za(await z,await wi),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"String.ExtractNumberFromTheString":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;var oi=await u.willYouremoveDot;if(void 0===await oi)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.willYouremoveDot key is missing in value section.",await W;M.output=await _a(await z,await oi),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"String.Length":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;M.output=await Ha(await z),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"String.RemoveNumberFromTheString":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;M.output=await Ka(await z),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"List.GetUniqueValues":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;M.output=await Ba(await z),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"String.Replace":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;var ci=await u.valueToReplace;if(void 0===await ci)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.valueToReplace key is missing in value section.",await W;var ui=await u.replaceBy;if(void 0===await ui)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.valueToReplace key is missing in value section.",await W;M.output=await Za(await z,await ci,await ui),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"String.Split":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;var li=await u.delimiter;if(void 0===await li)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.delimiter key is missing in value section.",await W;M.output=await qa(await z,await li),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"String.SplitandSaveValueAsPerIndex":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if(li=await u.delimiter,void 0===await li)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.delimiter key is missing in value section.",await W;var di=await u.indexToSave;if(void 0===await di)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.indexToSave key is missing in value section.",await W;if(di=await Number(await di),await isNaN(await di))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. indexToSave value should be number in value section.",await W;M.output=await Qa(await z,await li,await di),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"String.StartsWith":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;if(wi=await u.searchString,void 0===await wi)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.searchString key is missing in value section.",await W;M.output=await Ga(await z,await wi),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"String.Substring":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;var pi=await u.startPosition;if(void 0===await pi)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.startPosition key is missing in value section.",await W;if(pi=await Number(await pi),await isNaN(await pi))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. startPosition value should be number in value section.",await W;var mi=await u.endPosition;if(void 0!==await wi&&(mi=await Number(await mi),await isNaN(await mi)))return W.isSuccess=!1,W.errorMessage="Provided value is invalid. endPosition value should be number in value section.",await W;M.output=await Ya(await z,await pi,await mi),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"String.ToLowerCase":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;M.output=await Wa(await z),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"String.ToUpperCase":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;M.output=await Xa(await z),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"String.Trim":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;if(u=await JSON.parse(await u),z=await u.userInput,void 0===await z)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.userInput key is missing in value section.",await W;M.output=await Ja(await z),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"JSON.getKeyValue":if(M.output=[],_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await W;u=await JSON.parse(await u);var vi=await u.JsonData;if(void 0===await vi)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.JsonData key is missing in value section.",await W;if("object"!==await typeof await vi)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.JsonData should be Json Object in value section.",await W;var gi=await u.keyName;if(void 0===await gi)return W.isSuccess=!1,W.errorMessage="Provided value is invalid.keyName key is missing in value section.",await W;M.output=await Ra(await vi,await gi),W.supportingEvidence.UtilityFunctionOutput=await M.output;break;case"GetResponseFromNetworkLogs":if(M.output="",_=await Ie(await u),!await _)return W.isSuccess=!1,W.errorMessage="Provided value is invalid. Value should be in JSON Object Format.",await W;u=await JSON.parse(await u);var hi=await u.requestUrl;if(void 0===await hi)return W.isSuccess=!1,W.errorMessage="Provided value is invalid. 'requestUrl' key is missing in value section.",await W;try{var fi=!1,yi={};try{cdpConnection=await e.createCDPConnection("page"),await cdpConnection.send("Network.enable"),await cdpConnection.send("Network.setCacheDisabled",{cacheDisabled:!0})}catch(a){}const a=await e.manage().logs().get(Nt.Type.PERFORMANCE);for(let t=0;t<await a.length;t++){let e=await a[t],i=await JSON.parse(await e.message).message;if("Network.requestWillBeSent"===await i.method&&await i.params.request.url.toLowerCase().includes(await hi.toString().toLocaleLowerCase())&&(yi.request=await i.params.request),"Network.responseReceived"===await i.method&&await i.params.response.url.toLowerCase().includes(await hi.toString().toLocaleLowerCase())){yi.response=await i.params.response,fi=!0;break}}if(!await fi)return W.isSuccess=!1,W.errorMessage="No responses found for the URL: "+hi,await W;M.output=yi,W.supportingEvidence.NetworkLogResponse=M.output,W.isSuccess=!0}catch(a){return W.errorMessage="Error capturing network logs: "+a.message,W.isSuccess=!1,await W}break;default:W.isSuccess=!1,W.errorMessage="Method not found."}}catch(a){void 0===W.supportingEvidence&&(W.supportingEvidence={}),W.isSuccess=!1,W.errorMessage=await a.toString(),W.supportingEvidence.errorMessage=await a.toString()}return void 0===W.supportingEvidence&&(W.supportingEvidence={},W.isSuccess||(W.supportingEvidence.errorMessage=W.errorMessage)),await W}async function Ut(a,t,e,i,r,s,n,w,o){try{"{}"===await a&&(a="");var c=await JSON.parse(await a),u=await Object.keys(await c)[0];if(void 0===await u){a=await Yt(await a,await s,await t,await e,await i,await r,await n,await w,await o),a=await Vt(await a);try{await a.toString().includes("{{+}}")&&(a=await a.toString().replace(/\{\{\+\}\}/g,"+"))}catch(a){}return await a}var l={},d=await Object.keys(await c);for(let a=0;a<await d.length;a++){var p=await d[a],m=await c[await p];if("object"==typeof await m){if(await Array.isArray(await m)){var v=[],g=await m.length;for(let a=0;a<await g;a++){var h=await m[await a];h=await Ut(await h,await t,await e,await i,await r,await s,await n,await w,await o),v.push(await h)}}else{v={};var f=await Object.keys(await m);for(let a=0;a<await f.length;a++){var y=await f[a];h=await m[await y],y=await Ut(await y,await t,await e,await i,await r,await s,await n,await w,await o),h=await Ut(await h,await t,await e,await i,await r,await s,await n,await w,await o),v[await y]=await h}}try{await Array.isArray(await v)||await v,l[await p.toString()]=await v}catch(a){l[await p.toString()]=await v}}else{try{m=await Yt(await m,await s,await t,await e,await i,await r,await n,await w,await o),m=await Vt(await m)}catch(a){}try{await m.toString().includes("{{+}}")&&(m=await m.toString().replace(/\{\{\+\}\}/g,"+"))}catch(a){}try{await Array.isArray(await m)||await m,l[await p.toString()]=await m}catch(a){l[await p.toString()]=await m}}}return await JSON.stringify(await l)}catch(c){a=await Yt(await a,await s,await t,await e,await i,await r,await n,await w,await o),a=await Vt(await a);try{await a.toString().includes("{{+}}")&&(a=await a.toString().replace(/\{\{\+\}\}/g,"+"))}catch(a){}return a=await Le(await a),await a}}async function Vt(a){var t=await async function(a){return a=await a.toString().toLocaleLowerCase(),!!await a.includes("utility.")}(await a);if(!await t)return await a;var e="";let i=await a.split(/\+(?!\})|(?<=\{\{)\+\+(?=\}\})/);for(let a=0;a<await i.length;a++){var r=await i[a];e=await e+await $t(await r)}return await e}async function Bt(a){var t=await a.split("||"),e=await t[0].split("(")[0];switch(await e){case"firstName":return await F();case"url":return await I();case"sumOfArray":var i=await t[1];return i=await i.split(")")[0],await sa(await i);case"lastName":return await U();case"address":return await V();case"email":return await L();case"uuid":return await B();case"country":return await R();case"state":return await X();case"city":return await W();case"zipCode":return await Y();case"phoneNumber":return await J();case"phoneimei":return await Fa();case"word":return i=await t[1],i=void 0===(i=await i.split(")")[0])?1:await Number(i),await G(await i);case"string":return i=await t[1],i=void 0===(i=await i.split(")")[0])?10:await Number(i),await Z(await i);case"number":i=await t[1];var r=1,s=99999;return void 0!==(i=await i.split(")")[0])&&(r=await Number(i.split(",")[0]),s=await Number(i.split(",")[1])),await Q(await r,await s);case"date":i=await t[1];var n=0,w="DD MMM yyyy";if(void 0!==(i=await i.split(")")[0])){n=await Number(i.split(",")[0]),w=await i.split(",")[1];try{var o=await i.split(",")[2]}catch(a){o=void 0}}var c=await q(await n,await w,await o);return await c;case"getDateDifference":i=await t[1],n=0;var u="",l="",d="",p="DD-MMM-yyyy",m="DD-MMM-yyyy";if(void 0!==(i=await i.split(")")[0])){u=await i.split(",")[0],l=await i.split(",")[1];try{d=await i.split(",")[2],void 0===await d&&(d="days")}catch(a){d="days"}try{p=await i.split(",")[3],void 0===await p&&(p="DD-MMM-yyyy")}catch(a){p="DD-MMM-yyyy"}try{m=await i.split(",")[4],void 0===await m&&(m="DD-MMM-yyyy")}catch(a){m="DD-MMM-yyyy"}}return c=await La(await u,await l,await d,await p,await m),await c;case"extractNumberFromString":i=await t[1];var v="",g=!0;if(void 0===(i=await i.split(",")))return 0;v=await await i[0];try{g=await i[1],g="true"===await g.toLocaleLowerCase()}catch(a){g=!0}return await K(await v,await g);case"splitAndSaveIndexValue":i=await t[1],v="";var h="",f="";if(void 0===(i=await i.split(",")))return"Error-Provide correct Input";v=await i[0];try{h=await i[1]}catch(a){h=""}try{f=await Number(await i[2])}catch(a){f=0}return await H(await v,await h,await f);case"addTwoNumber":i=await t[1];var y=0,b=0,S=0;if(g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await _(await y,await b,await S);case"subtractTwoNumber":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await z(await y,await b,await S);case"multiplyTwoNumber":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await $(await y,await b,await S);case"devideTwoNumber":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await $(await y,await b,await S);case"reminderTwoNumber":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await $(await y,await b,await S);case"getPercentage":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await ea(await y,await b,await S);case"addPercentageInNumber":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await ia(await y,await b,await S);case"subtractPercentageInNumber":if(i=await t[1],y=0,b=0,S=0,g=!0,void 0===(i=await i.split(",")))return 0;y=await Number(await i[0].trim());try{b=await Number(await i[1].trim())}catch(a){b=0}try{S=await Number(await i[2].trim())}catch(a){S=0}return await ra(await y,await b,await S);case"ipv4":return await na();case"ipv6":return await wa();case"airline":return await oa();case"airplane":return await ca();case"flightNumber":return await ua();case"accountName":return await la();case"accountNumber":return await da();case"creditCardCVV":return await pa();case"creditCardIssuer":return await ma();case"creditCardNumber(cardtype)":return i=await t[1],void 0===(i=await i.split(")")[0])&&(i="visa"),await va(await i);case"bicycle":return awaitgetbicycle();case"color":return await ha();case"fuel":return await fa();case"model":return await ya();case"vehicle":return await ba();case"vin":return await Sa();case"vrm":return await xa();case"department":return await Ma();case"product":return await Na();case"productDescription":return await Ta();case"productMaterial":return await Ea();case"productName":return await Aa();case"jobTitle":return await Pa();case"jobType":return await Ca();case"zodiacSign":return await ka();case"mac":return await ja();case"userAgent":return await Da();case"domainName":return await Oa();case"avatar":return await Ia();default:return""}}async function Rt(a,t){try{await(await a).switchTo().alert()}catch(e){try{await a.executeScript("arguments[0].scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'center' });",await t)}catch(a){}}}async function Jt(a,t,e){try{return void await(await a).switchTo().alert()}catch(i){try{for(let e=0;e<await Number(t);e++)try{await(await a).switchTo().alert()}catch(t){if("complete"===await a.executeScript("return document.readyState")){await new Promise(a=>setTimeout(a,300));break}await new Promise(a=>setTimeout(a,1e3))}}catch(a){}await async function(a,t,e){if(void 0!==await e)try{if(await e.length>0){var i=0;await new Promise(a=>setTimeout(a,100));for(let o=0;o<await e.length;o++){var r=await e[o].xpath;try{var s=await T.xpath(await r),n=await a.findElements(await s);if(await n.length>0)for(let a=0;a<await n.length;a++)for(let e=0;e<await Number(t);e++){var w=await n[a];try{if(!await w.isDisplayed()){await new Promise(a=>setTimeout(a,200));break}if(await new Promise(a=>setTimeout(a,1e3)),i=Number(await i)+1,60===await Number(i))return}catch(a){await new Promise(a=>setTimeout(a,200));break}}}catch(a){}}}}catch(a){}}(await a,await t,await e)}}async function Xt(a){try{var t=await(await a).switchTo().alert(),e=await t.getText(),i=await r.generate(await e);return i=await i.split(",")[1],await i}catch(t){try{return e=await(await a).takeScreenshot(),await e}catch(a){console.log(await a)}}return""}async function Wt(a,t,e){var i={isElementInOr:!1,isElementPresent:!1,errorMessage:""},r=null;i.webElement=r;try{var s=await e[await t.toString().toUpperCase()];if(void 0===await s){if(!await t.toString().startsWith("//")&&!await t.toString().startsWith("(//"))return i.errorMessage=await t+" does not exist in OR repository.",await i;(s={locator:"xpath"}).locatorproperty=await t,s.alternatexpath=""}i.isElementInOr=!0;var n=await s.locator,w=await s.locatorproperty,o=await s.alternatexpath;switch(await n.toString().trim().toLowerCase()){case"id":var c=await T.id(await w);r=await(await a).findElement(await c);break;case"name":c=await T.name(await w),r=await(await a).findElement(await c);break;case"linktext":c=await T.linkText(await w),r=await(await a).findElement(await c);break;case"partiallinktext":c=await T.partialLinkText(await w),r=await(await a).findElement(await c);break;case"classname":case"class":c=await T.className(await w),r=await(await a).findElement(await c);break;case"css":case"cssselector":c=await T.css(await w),r=await(await a).findElement(await c);break;case"xpath":c=await T.xpath(await w),r=await(await a).findElement(await c)}i.isElementPresent=!0}catch(t){var u=await t.message;if(""!==await o.trim())try{c=await T.xpath(await o),r=await(await a).findElement(await c),i.isElementPresent=!0}catch(a){i.errorMessage=await u}else i.isElementPresent=!1,i.errorMessage=await u}return i.webElement=await r,await i}async function Yt(a,t,e,i,r,s,n,w,o){try{var c=await a;if(await typeof await a,""===await a.trim())return await a;var u=await a.toLocaleLowerCase(),l=await zt(await u);if(!await l)return await a;var d=await a.split("||");for(let c=0;c<await d.length;c++){var p=await d[c].split(",");for(let c=0;c<await p.length;c++){var m=await p[c].split("+");for(let c=0;c<await m.length;c++){var v=await m[c].split("=");for(let c=0;c<await v.length;c++){var g=await v[c];await zt(await g)&&(a=await Gt(await a,await g,await t),a=await qt(await a,await g,await e,await w),a=await Zt(await a,await g,await i,await s),a=await qt(await a,await a,await e,await w),a=await Kt(await a,await g,await r),a=await Ht(await a,await g,await o),a=await Qt(await a,await g,await n))}}}}}catch(t){void 0===await a&&(a=await c)}return await a}async function Gt(a,t,e){if(await t.toLocaleLowerCase().startsWith("args.")){var i=await t;await a.includes("+"+i+"+")&&(i="+"+await t+"+"),await a.includes("+"+i)&&(i="+"+await t);var r=await e[await t];r=await Le(await r),void 0!==await r&&(a=await _t(await a,await i,await r))}return await a}async function Qt(a,t,e){if(await t.toLocaleLowerCase().startsWith("args.")){var i=await t;await a.includes("+"+i+"+")&&(i="+"+await t+"+"),await a.includes("+"+i)&&(i="+"+await t);try{e=await JSON.parse(await e)}catch(a){e={}}var r=await e[await t];r=await Le(await r),void 0!==await r&&(a=await _t(await a,await i,await r))}return await a}async function qt(a,t,e,i){if(await t.toLocaleLowerCase().startsWith("c.")){var r=await t;await a.includes("+"+r+"+")&&(r="+"+await t+"+"),await a.includes("+"+r)&&(r="+"+await t);var s=await e[await t.substring(2)][await i];s=await Le(await s),void 0!==await s&&(a=await _t(await a,await r,await s))}return await a}async function Zt(a,t,e,i){if(await t.toLocaleLowerCase().startsWith("t.")){var r=await t;await a.includes("+"+r+"+")&&(r="+"+await t+"+"),await a.includes("+"+r)&&(r="+"+await t);var s=await e[await i][await t.substring(2)];s=await Le(await s),void 0!==await s&&(a=await _t(await a,await r,await s))}return await a}async function Kt(a,t,e){if(await t.toLocaleLowerCase().startsWith("session.")){var i=await t;await a.includes("+"+i+"+")&&(i="+"+await t+"+"),await a.includes("+"+i)&&(i="+"+await t);var r=await e[await t.substring(8)];void 0===r&&(r=await e[await t]),r=await Le(await r),void 0!==await r&&(a=await _t(await a,await i,await r))}return await a}async function Ht(a,t,e){if(await t.toLocaleLowerCase().startsWith("global.")){var i=await t;await a.includes("+"+i+"+")&&(i="+"+await t+"+"),await a.includes("+"+i)&&(i="+"+await t);var r=await e[await t.substring(7)];void 0===r&&(r=await e[await t]),r=await Le(await r),void 0!==await r&&(a=await _t(await a,await i,await r))}return await a}async function _t(a,t,e){try{if(await a===await t)return await e;"object"===await typeof await await e&&(e=await JSON.stringify(await e));var i=await new RegExp(t,"gi");return await a.replace(await i,await e)}catch(i){try{return await a.replace(await t,await e)}catch(t){return await a}}}async function zt(a){return a=await a.toLocaleLowerCase(),!!(await a.includes("c.")||await a.includes("t.")||await a.includes("args.")||await a.includes("session.")||await a.includes("global."))}async function $t(a){var t=await a.split("Utility.");for(let u=0;u<await t.length;u++){var e=await t[u],i="Utility."+e;if(""!==await e)if(await e.includes("(")&&await e.includes(")")){var r=(await e.split("(")[1].split(")")[0]).split(","),s=await e.split("||")[1],n=await s.split(",");if(await n.length===await r.length){var w=await Bt(await e);void 0!==await w&&""!==await w&&(a=await a.replace("Utility."+await e,await w))}else if(await n>await r){var o="";for(let a=0;a<await r.length;a++)o=await o+","+await n[a];o=await o.substring(1);var c=await e.split("||")[0]+"||"+await o;w=await Bt(await c),void 0!==await w&&""!==await w&&(a=await a.replace("Utility."+await c,await w))}else try{await JSON.parse(await s),c=await e.split("||")[0]+"||"+await s,w=await Bt(await c),void 0!==await w&&""!==await w&&(a=await a.replace("Utility."+await c,await w))}catch(a){}}else w=await Bt(await e),void 0!==await w&&""!==await w&&(a=await _t(await a,await i,await w))}return await a}async function ae(a){var t={isSuccess:!0,errorMessage:"",timeout:1,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)t.timeout=30;else try{try{var e=await JSON.parse(await a)}catch(t){e=await a}var i=await Object.keys(await e)[0];if(void 0===await i&&((e={}).timeout=await a),void 0===await e.timeout)return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"timeout":30}',t.isSuccess=!1,await t;var r=await ee(await e.timeout);if(!await r)return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"timeout":30}',t.isSuccess=!1,await t;t.timeout=await e.timeout}catch(a){return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"timeout":30}',t.isSuccess=!1,await t}return await t}async function te(a){var t={isSuccess:!0,errorMessage:"",timeout:30,expectedtext:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];if(void 0===await i){e={};var r=await await a;if(!await r.includes(","))return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t;e.timeout=await r[0].toString().trim(),e.expectedtext=await r[1].toString().trim()}}catch(i){if(e={},r=await await a,!await r.includes(","))return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t;e.timeout=await r[0].toString().trim(),e.expectedtext=await r[1].toString().trim()}if(void 0===await e.timeout)return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t;if(void 0===await e.expectedtext)return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t;var s=await ee(await e.timeout);if(!await s)return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t;t.timeout=await e.timeout,t.expectedtext=await e.expectedtext}catch(a){return t.errorMessage='Provided value is invalid. Please provide timeout with expected text e.g.{"timeout":30,"expectedtext":"Text should be QAautoMATER"}',t.isSuccess=!1,await t}return await t}async function ee(a){var t=await Number(await a.toString().trim());return!await isNaN(await t)}async function ie(a){var t={isSuccess:!0,errorMessage:"",url:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, Url should be provided in value section e.g. {"url":"https://qabunch.com/"}',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];void 0===await i&&((e={}).url=await a)}catch(t){(e={}).url=await a}if(void 0===await e.url||""===await e.url.toString().trim())return t.errorMessage='Provided value is invalid, Url should be provided in value section e.g. {"url":"https://qabunch.com/"}',t.isSuccess=!1,await t;t.url=await e.url.toString().trim()}catch(a){return t.errorMessage='Provided value is invalid, Url should be provided in value section e.g. {"url":"https://qabunch.com/"}',t.isSuccess=!1,await t}return await t}async function re(a){var t={isSuccess:!0,errorMessage:"",expectedcount:0,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"expectedcount":2}',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];if(void 0===await i&&((e={}).expectedcount=await a),void 0===await e.expectedcount)return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"expectedcount":2}',t.isSuccess=!1,await t;var r=await ee(await e.expectedcount);if(!await r)return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"expectedcount":2}',t.isSuccess=!1,await t;t.expectedcount=await e.expectedcount}catch(a){return t.errorMessage='Provided value is invalid. Please provide Numeric value e.g. {"expectedcount":2}',t.isSuccess=!1,await t}return await t}async function se(a){var t={isSuccess:!0,errorMessage:"",title:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, title should be provided in value section e.g. {"title":"QaBUnch"}',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];void 0===await i&&((e={}).title=await a)}catch(t){(e={}).title=await a}if(void 0===await e.title||""===await e.title.toString().trim())return t.errorMessage='Provided value is invalid, title should be provided in value section e.g. {"title":"QaBUnch"}',t.isSuccess=!1,await t;t.title=await e.title.toString().trim()}catch(a){return t.errorMessage='Provided value is invalid, title should be provided in value section e.g. {"title":"QaBUnch"}',t.isSuccess=!1,await t}return await t}async function ne(a,t){var e={isSuccess:!0,errorMessage:"",filename:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return e.errorMessage='Provided value is invalid, filename should be provided in value section e.g. {"filename":"users"}',e.isSuccess=!1,await e;try{try{var i=await JSON.parse(await a),r=await Object.keys(await i)[0];void 0===await r&&((i={}).filename=await a)}catch(t){(i={}).filename=await a}if(void 0===await i.filename||""===await i.filename.toString().trim())return e.errorMessage='Provided value is invalid, filename should be provided in value section e.g. {"filename":"users"}',e.isSuccess=!1,await e;var s=await i.filename.toString().trim();e.filename=await s}catch(a){return e.errorMessage='Provided value is invalid, filename should be provided in value section e.g. {"filename":"users"}',e.isSuccess=!1,await e}return await e}async function we(a){var t={isSuccess:!0,errorMessage:"",expectedtext:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, expectedtext should be provided in value section e.g. {"expectedtext":"users"}',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];void 0===await i&&((e={}).expectedtext=await a)}catch(t){(e={}).expectedtext=await a}if(void 0===await e.expectedtext||""===await e.expectedtext.toString().trim())return t.errorMessage='Provided value is invalid, expectedtext should be provided in value section e.g. {"expectedtext":"users"}',t.isSuccess=!1,await t;t.expectedtext=await e.expectedtext.toString().trim()}catch(a){return t.errorMessage='Provided value is invalid, expectedtext should be provided in value section e.g. {"expectedtext":"users"}',t.isSuccess=!1,await t}return await t}async function oe(a){var t={isSuccess:!0,errorMessage:"",actualvalue:"",expectedvalue:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, actualvalue and expectedvalue are expected in value section e.g {"actualvalue":"[QAautoMATER"]","expectedvalue":"QAautoMATER"}.',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];if(void 0===await i){e={};var r=await a.split(",")[0],s=await a.split(",")[1];e.actualvalue=await r,e.expectedvalue=await s}}catch(t){e={},r=await a.split(",")[0],s=await a.split(",")[1],e.actualvalue=await r,e.expectedvalue=await s}if(r=await e.actualvalue,s=await e.expectedvalue,void 0===await r||void 0===await s)return t.errorMessage='Provided value is invalid, actualvalue and expectedvalue are expected in value section e.g {"actualvalue":"[QAautoMATER"]","expectedvalue":"QAautoMATER"}.',t.isSuccess=!1,await t;t.actualvalue=await r,t.expectedvalue=await s}catch(a){return t.errorMessage='Provided value is invalid, actualvalue and expectedvalue are expected in value section e.g {"actualvalue":"[QAautoMATER"]","expectedvalue":"QAautoMATER"}.',t.isSuccess=!1,await t}return await t}async function ce(a,t){var e={isSuccess:!0,errorMessage:"",supportingEvidence:{}};try{var i=await typeof await a,r=await typeof await t;if("object"!==await r&&"string"===await i)await a.toString().toLowerCase().trim().includes(await t.toString().toLowerCase().trim())||(e.isSuccess=!1,e.errorMessage="Expected value is "+await t+" however actual value is "+await a+".");else if("object"!==await r&&"object"==await i)await a.includes(await t)||(e.isSuccess=!1,e.errorMessage="Expected value is "+await t+" however actual value is "+await a+".");else if("object"===await r&&"object"==await i){var s=await ue(t),n=!1;await s?(n=await async function(a,t){var e=await Object.keys(await t);for(let r=0;r<await e.length;r++){var i=await t[r];if(!await a.includes(await i))return!1}return!0}(await a,await t),await n||(e.isSuccess=!1,e.errorMessage="Expected value is "+await t+" however actual value is "+await a+".")):(n=await le(await a,await t),await n||(e.isSuccess=!1,e.errorMessage="Expected value is "+await JSON.stringify(await t)+" however actual value is "+await JSON.stringify(await a)+"."))}}catch(a){}return await e}async function ue(a){var t=await Object.keys(await a),e=await t[0];return!isNaN(await e)}async function le(a,t){var e=await Object.keys(await t);for(let n=0;n<await e.length;n++){var i=await e[n],r=await t[await i],s=await a[await i];if(await r!==await s)return!1}return!0}async function de(a){var t={isSuccess:!0,errorMessage:"",attributename:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, attributename should be provided in value section e.g. {"attributename":"id"}.',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];void 0===await i&&((e={}).attributename=await a)}catch(t){a=await a.attributename,(e={}).attributename=await a}if(void 0===await e.attributename||""===await e.attributename.toString().trim())return t.errorMessage='Provided value is invalid, attributename should be provided in value section e.g. {"attributename":"id"}.',t.isSuccess=!1,await t;t.attributename=await e.attributename.toString().trim()}catch(a){return t.errorMessage='Provided value is invalid, attributename should be provided in value section e.g. {"attributename":"id"}.',t.isSuccess=!1,await t}return await t}async function pe(a){var t={isSuccess:!0,errorMessage:"",valuetobesend:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, valuetobesend should be provided in value section e.g. {"valuetobesend":"QAautoMATER"}.',t.isSuccess=!1,await t;try{try{var e=await JSON.parse(await a),i=await Object.keys(await e)[0];void 0===await i&&(e={},a=await Le(await a),e.valuetobesend=await a)}catch(t){(e={}).valuetobesend=await a}if(void 0===await e.valuetobesend)return t.errorMessage='Provided value is invalid, valuetobesend should be provided in value section e.g. {"valuetobesend":"QAautoMATER"}.',t.isSuccess=!1,await t;var r=await Le(await e.valuetobesend);t.valuetobesend=await r.toString()}catch(a){return t.errorMessage='Provided value is invalid, valuetobesend should be provided in value section e.g. {"valuetobesend":"QAautoMATER"}.',t.isSuccess=!1,await t}return await t}async function me(a){var t={isSuccess:!0,errorMessage:"",nextelement:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, nextelement should be provided in the value section. e.g. {"nextelement":"buttonXYZ"). Next element should be in Object Repository page',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(void 0===await e.nextelement||""===await e.nextelement.toString().trim())return t.errorMessage='Provided value is invalid, nextelement should be provided in the value section. e.g. {"nextelement":"buttonXYZ"). Next element should be in Object Repository page',t.isSuccess=!1,await t;t.nextelement=await e.nextelement.toString().trim()}catch(a){return t.errorMessage='Provided value is invalid, nextelement should be provided in the value section. e.g. {"nextelement":"buttonXYZ"). Next element should be in Object Repository page',t.isSuccess=!1,await t}return await t}async function ve(a,t,e,r,n,w,o,c,l,p,m,v=!1,g,h={},f,y,b,S,x){var M={isElementPresent:!0,errorMessage:"",element:null,elements:null,elementIndex:0,primaryLocator:"",primaryLocatorProperty:"",secondaryXPath:""};if(await Jt(await t,60,await y),await p.includes(await n))return await M;switch(await n){case"AlertAccept":case"AlertDismiss":case"AlertSendKeys":case"AlertText":case"Back":case"Close":case"Forward":case"FullScreen":case"GetCurrentUrl":case"GetTitle":case"Maximize":case"Minimize":case"Navigate":case"NewTab":case"NewWindow":case"Refresh":case"SwitchToWindow":case"SwitchToDefaultContent":case"GetResponseFromNetworkLogs":case"Wait":case"WaitForAlertIsPresent":case"WaitForTitleContains":case"SaveSessionVariable":case"SaveGlobalVariable":case"CreateRequestParametersInSessionVariable":case"GenerateUtilityValue":case"AssertContains":case"AssertEquals":case"AssertGreaterThan":case"AssertLessThan":case"IsFileExistOnDownloadFolder":case"FileCountOnDownloadFolder":case"AssertNotContains":case"AssertTitleContains":case"AssertTitleEquals":case"AssertTitleNotContains":case"AssertUrlContains":case"AssertUrlEquals":case"AssertUrlNotContains":case"AssertWindowCountEquals":case"AssertWindowCountEquals":case"AssertAlertTextEquals":case"AssertAlertTextContains":case"AssertAlertTextNotContains":case"AssertIsNumberInAscendingOrder":case"AssertIsNumberInDescendingOrder":case"AssertIsListSorted":case"AssertStringLengthShouldBe":case"RunDBQuery":case"SaveDBColumnValueInSessionVariable":case"DBRecordCountShouldBe":case"DBRecordCountShouldBeGreaterThan":case"DBRecordCountShouldBeLessThan":case"DBRecordsCount":case"CallAPI":case"SaveAPIResponseInSessionVariable":case"ReadPdfFile":case"PdfTotalPageCountShouldBe":case"ExcelRowCountShouldBe":case"ExcelRowCountShouldBeGreaterThan":case"ExcelRowCountShouldBeLessThan":case"SaveExcelColumnValueInSessionVariable":case"SaveColumnValuesBasedOnConditionalColumnAndValue":case"CallMobileTestScript":case"Array.DeleteItem":case"Array.DeleteItemBasedOnIndex":case"Array.GetValueBasedOnIndex":case"Array.Length":case"Array.ExcludeCharacters":case"Array.Push":case"Array.Search":case"Array.Sort":case"Array.SortDesc":case"Array.SumOfArray":case"Date.FormatDateTemplate":case"Date.GetDateDifference":case"Date.getDate":case"Math.Abs":case"Math.AddPercentage":case"Math.AddTwoNumber":case"Math.Ceil":case"Math.DivideTwoNumber":case"Math.Floor":case"Math.GetPercentage":case"Math.MultiplyTwoNumber":case"Math.Reminder":case"Math.Round":case"Math.SubtractPercentage":case"Math.SubtractTwoNumber":case"String.Concat":case"String.EndsWith":case"String.ExtractNumberFromTheString":case"String.Length":case"String.RemoveNumberFromTheString":case"String.Replace":case"String.Split":case"String.SplitandSaveValueAsPerIndex":case"String.StartsWith":case"String.Substring":case"String.ToLowerCase":case"String.ToUpperCase":case"String.Trim":case"JSON.getKeyValue":case"List.GetUniqueValues":return await M;case"WaitForElementIsDisabled":case"WaitForElementIsEnabled":case"WaitForElementTillDisplayed":case"WaitForElementTillNotDisplayed":case"WaitForElementTillTextContains":var N=await Ce(await r,await e,await h,await w,await o,await await c,await l,await g,await f,await S,await x);""!==await N&&(M.element=await T.xpath(await N));break;case"GetChildOfShadowDriver":var E=await Ie(await g);if(!await E)return M.isSuccess=!1,M.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await M;g=await JSON.parse(await g);var P=await g.shadowRoots;if(void 0===await P)return M.isSuccess=!1,M.errorMessage="Provided value is invalid.shadowRoots key is missing in value section.",await M;try{"string"==typeof await P&&(P=JSON.parse(await P))}catch(a){return M.isSuccess=!1,M.errorMessage="Provided value is invalid.shadowRoots should have array object.",await M}var C=[];for(let a=0;a<await P.length;a++){(D=await P[a]).toString().toLowerCase().startsWith("or.")&&(D=D.toString().substring(3));var k=await Fe(await D,await r,await h,await w,await o,await c,await l,await g,await f,await x);C.push(await k)}M.elements=await C;break;case"SwitchToShadowDriver":if(E=await Ie(await g),!await E)return M.isSuccess=!1,M.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await M;if(g=await JSON.parse(await g),P=await g.shadowRoots,void 0===await P)return M.isSuccess=!1,M.errorMessage="Provided value is invalid.shadowRoots key is missing in value section.",await M;try{"string"==typeof await P&&(P=JSON.parse(await P))}catch(a){return M.isSuccess=!1,M.errorMessage="Provided value is invalid.shadowRoots should have array object.",await M}C=[];for(let a=0;a<await P.length;a++)(D=await P[a]).toString().toLowerCase().startsWith("or.")&&(D=D.toString().substring(3)),k=await Fe(await D,await r,await h,await w,await o,await c,await l,await g,await f,await x),C.push(await k);M=await async function(a,t){var e={};return e.isSuccess=e.isElementPresent=!1,e.isSuccess=!1,e.errorMessage="",e.shadowDriver=await a,await t.length>0&&(e=await async function(a,t){var e={isElementPresent:!1,isSuccess:!1,errorMessage:""};e.shadowDriver=await a;var i="";let r=a,s=null;try{for(let a=0;a<await t.length;a++){i=await t[a].toString(),console.log("--------child element --------------"+await await t[a].toString());var n=await r.findElements(await t[a]);if(await n.length>1&&console.log("-------- shadow host Count is "+await n.length),0===await n.length)return e.errorMessage="Element"+await i+" does not have any child or shadow root.",await e;var w=await n[0];s=await w.getShadowRoot(),r=s}return e.isElementPresent=!0,e.isSuccess=!0,e.shadowDriver=await s,e}catch(a){return e.errorMessage=await a.toString()+" for element "+await i,console.error("Error:",a),await e}}(await a,await t)),await e}(await await t,await C);break;case"SwitchToDynamicShadowDriver":if(E=await Ie(await g),!await E)return M.isSuccess=!1,M.errorMessage="Provided value is invalid.Value should be in Json Object Fromat.",await M;if(g=await JSON.parse(await g),P=await g.shadowRoots,void 0===await P)return M.isSuccess=!1,M.errorMessage="Provided value is invalid.shadowRoots key is missing in value section.",await M;try{"string"==typeof await P&&(P=JSON.parse(await P))}catch(a){return M.isSuccess=!1,M.errorMessage="Provided value is invalid.shadowRoots should have array object.",await actionStatus}var j=await g.webElement;if(void 0===await j||""===j)return M.isSuccess=!1,M.errorMessage="Provided value is invalid.webElement key is missing in value section.",await M;C=[];for(let a=0;a<await P.length;a++){var D;(D=await P[a]).toString().toLowerCase().startsWith("or.")&&(D=D.toString().substring(3)),k=await Fe(await D,await r,await h,await w,await o,await c,await l,await g,await f,await x),C.push(await k)}j.toString().toLowerCase().startsWith("or.")&&(j=j.toString().substring(3));var O=await Fe(await j,await r,await h,await w,await o,await c,await l,await g,await f,await x);M=await async function(a,t,e){var i={isElementPresent:!1,isSuccess:!1,errorMessage:""};i.shadowDriver=await a;let r=a;var s="";let n=null;try{for(let a=0;a<await t.length;a++){s=await await t[a].toString();var w=await r.findElements(await t[a]);if(await w.length>1){var o=!1;for(let a=0;a<await w.length;a++){var c=await w[a],u=await c.getShadowRoot(),l=await u.findElements(await e);if(await l.length>0){d=await c,o=!0;break}}if(!await o)return i.errorMessage=await e.toString()+" does not exist into the shadow driver "+await s.toString(),await i}else{if(0===await w.length)return i.errorMessage="Element"+await s+" does not have any child or shadow root.",await i;var d=await w[0]}n=await d.getShadowRoot(),l=await n.findElements(T.css("*"));for(let a=0;a<await l.length;a++)console.log("Tag Name "+await l[a].getTagName());r=n}return i.isElementPresent=!0,i.isSuccess=!0,i.shadowDriver=await n,i}catch(a){return i.errorMessage=await a.toString(),console.error("Error:",a),await i}}(await t,await C,await O),await M.isElementPresent&&(t=await M.shadowDriver);break;default:void 0!==await b&&(N=await Ce(await r,await e,await h,await w,await o,await await c,await l,await g,await f,await S,await x),await async function(a,t,e){if(e=await Number(await e),0!==await e)try{await(await a).wait(A.elementLocated(T.xpath(await t)),1e3*await e)}catch(a){}}(await t,await N,await b)),M=await async function(a,t,e,r,n,w,o,c,l,p,m,v,g,h,f,y){var b={},S=!1,x="",M="",N="";b.isElementPresent=!0,b.errorMessage="";var E=null;if(b.element=null,b.elements=E,b.elementIndex=0,b.primaryLocator="",b.primaryLocatorProperty="",b.secondaryXPath="",""===await e.toString().trim())return b.isElementPresent=!1,b.errorMessage="The web element cannot be blank. Please provide the web element details. If you are using a custom function, it's possible that your function name has been renamed.",await b;try{var A=await r[await e.toString().toUpperCase()];if(void 0===await A)return b.isElementPresent=!1,b.errorMessage="Element "+await e.toString()+" does not exist on server. Please add this locator from Object Repository page.",await b;var P=await A.locator;b.primaryLocator=await P;var C=await A.locatorproperty;await C.toLocaleLowerCase().includes("args.")&&(S=!0,x=await P,M=await C),b.primaryLocatorProperty=await C;var k=await Yt(await C,await m,await n,await w,await o,await c,await v,await h,await y);void 0!==await k&&(C=await k);var j=await A.alternatexpath;void 0===await j&&(j=""),b.secondaryXPath=await j;var D=[];switch(await P.toString().trim().toLowerCase()){case"id":var O=await T.id(await C);E=await(await t).findElements(await O),await D.push("id");break;case"name":O=await T.name(await C),E=await(await t).findElements(await O),await D.push("name");break;case"linktext":O=await T.linkText(await C),E=await(await t).findElements(await O);break;case"partiallinktext":O=await T.partialLinkText(await C),E=await(await t).findElements(await O);break;case"classname":case"class":O=await T.className(await C),E=await(await t).findElements(await O),await D.push("class");break;case"css":case"cssselector":O=await T.css(await C),E=await(await t).findElements(await O);break;case"xpath":O=await T.xpath(await C),E=await(await t).findElements(await O);break;default:P=await P.toString().toLocaleLowerCase();var I="//*[contains(translate(@"+await P+", 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'),'"+await C.toLocaleLowerCase()+"')]";O=await T.xpath(await I),E=await(await t).findElements(await O)}if("Yes"===await f&&await p){var L=await E.length;if(Number(await L)>0)if(""===await j)b.secondaryXPath=await ye(await a,await t,await E[0],await e,await l,await C,await S,await x,await M,await L);else try{var F=await(await t).findElements(await T.xpath(await j));0===await F.length&&(b.secondaryXPath=await ye(await a,await t,await E[0],await e,await l,await C,await S,await x,await M,await L))}catch(a){}}var U={};if(U[await P]=await C,N=await JSON.stringify(await U),0===await E.length){var V="Element "+await e+" does not exist in the html dom.Please update the loctor attribute.";if("Yes"===await f&&""!==await j.trim()){var B=await j;void 0!==await j&&(j=await Yt(await j,await m,await n,await w,await o,await c,await v,await h,await y),O=await T.xpath(await j),E=await(await t).findElements(await O),await E.length>=1&&await p&&"Yes"===await f&&(b.primaryLocator="xpath",await S?b.primaryLocatorProperty=await B:b.primaryLocatorProperty=await j,await async function(a,t,e,r){if(""!==await r)try{var n=await d(await a+"/Web/OR.json");if(await n){var w={},o=await i+await a+"/Web/OR.json";w=await JSON.parse(await s.readFileSync(await o,"utf8")),void 0!==await w[await t]&&(w[await t].locator=await"xpath",w[await t].locatorproperty=await r,await u(await a+"/Web/OR.json",await w),console.log("Primary locator property is updated for the locator "+await t))}}catch(a){}}(await l,await await e,0,await b.primaryLocatorProperty),b.secondaryXPath="",b.secondaryXPath=await ye(await a,await t,await E[0],await e,await l,await j,await S,await x,await M)))}if(0===await E.length){var R={};R.applicationErrorMessage=await V,void 0!==await P&&""!==await P&&(R.locator=await P),void 0!==await C&&""!==await C&&(R.locatorproperty=await C),b.isElementPresent=!1,b.errorMessage=await JSON.stringify(await R)}}}catch(a){b.isElementPresent=!1,b.errorMessage="Unable to Find element "+await e+"  because of "+await a}if("IsNotDisplayed"!==await g||""!==await v&&"{}"!==v){if(!0===await b.isElementPresent&&"TypeAll"!==await g){var J=await async function(a,t,e,i){var r={isElementPresent:!0,element:null,errorMessage:"",elementindex:-1};if(""===await t.toString().trim())r.isElementPresent=!0,r.element=await await e[0],r.elementindex=0;else try{var s=await JSON.parse(await t),n=await async function(a){var t=[],e=["countofclick","filename","attributename","keyname","valuetobesend","url","actualvalue","expectedvalue","expectedcount","expectedtext","title","andoperation","nextelement","browserindex","timeout","loopcounter","methodparameters","iftrue","iffalse","shadowroot","shadowrootreveal","offset"],i=await Object.keys(await a);for(let a=0;a<await i.length;a++){var r=await i[a].toString().toLocaleLowerCase();await e.includes(await r)||await r.toString().startsWith("args.")||await t.includes(await r)||t.push(await r)}return await t.includes("index")&&(t=[]).push("index"),await t}(await s);if(0===await n.length)r.isElementPresent=!0,r.element=await await e[0];else if(await n.includes("index")){var w=Number(await s.index);await e.length>await w?(r.isElementPresent=!0,r.element=await e[await w]):(r.isElementPresent=!1,r.errorMessage="Provided Element Index "+await w+" is greater than or equals elements count "+await e.length+". Please note index is started with 0")}else if("AssertElementAttributeNotContains"===await i)r.isElementPresent=!0,r.element=await await e[0];else{if(await["AssertElementAttributeEquals","AssertElementAttributeContains","AssertElementAttributeNotContains"].includes(await i))r.isElementPresent=!0,r.element=await await e[0];else{var o=await async function(a,t,e,i){for(let p=0;p<await t.length;p++){await Rt(await a,await t[p]);var r=!1,s=await i.andoperation;void 0===await s&&(r=!0);var n=[];for(let a=0;a<await e.length;a++){var w=await e[a],o=await i[await w];try{if("text"===await w)var c=await(await t[p]).getText();else c=await(await t[p]).getAttribute(await w);var u,l="";l=(await c)?.toString().toLowerCase().trim()??"",u=(await o)?.toString().toLowerCase().trim()??"",""===await l&&""===await u||""!==await u&&await l.includes(u)?n.push(!0):n.push(!1)}catch(a){await n.push(!1)}}if(await r){var d=await ge(await n);if(await d)return p}else if(await n.includes(!0))return p}return await-1}(await a,await e,await n,await s);-1===await o?(r.isElementPresent=!1,r.errorMessage="Attribute does not match as per provided value "+await t):(r.elementindex=await o,r.element=await e[await o])}}}catch(a){r.isElementPresent=!1,r.errorMessage="Attribute does not match as per provided value "+await t+" error "+await a}return await r}(await t,await v,await E,await g);!0===await J.isElementPresent?(b.element=await J.element,b.elementIndex=J.elementindex):"IsNotDisplayed"===await g?(b.isElementPresent=!0,b.element=await J.element,b.elementIndex=J.elementindex):(b.isElementPresent=!1,b.errorMessage=await e+" "+await N+" "+J.errorMessage)}}else b.isElementPresent=!0,b.element=await b.element;return"Count"===await g&&(b.isElementPresent=!0,b.element=await b.element),b.elements=E,await b}(await a,await t,await e,await r,await w,await o,await c,await l,await m,await v,await h,await g,await n,await f,await S,await x)}return await M}async function ge(a){for(let t=0;t<await a.length;t++)if(!await a[t])return!1;return!0}async function he(a){var t={isSuccess:!0,errorMessage:"",attributeNames:{},supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage="Provided value is invalid, PLease see the example.",t.isSuccess=!1,await t;try{var e=await JSON.parse(await a),i=await e.attributeNames;void 0===await i&&(i=await e);var r=await Object.keys(i);for(let a=0;a<await r.length;a++){var s=await r[await a].toString(),n=await r[await a].toString().toLocaleLowerCase();if(void 0===await n||""===await n.toString().trim())return t.errorMessage="Provided value is invalid, PLease refre the example.",t.isSuccess=!1,await t;await n.toString().startsWith("args.")&&delete i[await s]}t.attributeNames=await i}catch(a){return t.errorMessage="Provided value is invalid, attributeNames should be provided as json object, please see the example "+await a,t.isSuccess=!1,await t}return await t}async function fe(a){var t={isSuccess:!0,errorMessage:"",variablename:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid, variablename should be provided in the value section. e.g. {"variablename":"orderId"}.',t.isSuccess=!1,await t;try{if("object"!==await typeof await a)var e=await JSON.parse(await a);else e=await a;if(void 0===await e.variablename)return t.errorMessage='Provided value is invalid, variablename should be provided in the value section. e.g. {"variablename":"orderId"}.',t.isSuccess=!1,await t;if(t.variablename=await e.variablename.toString().trim(),""===await t.variablename.toString().trim())return t.errorMessage='Provided value is invalid, variablename should be provided in the value section. e.g. {"variablename":"orderId"}.',t.isSuccess=!1,await t}catch(a){return t.errorMessage='Provided value is invalid, variablename should be provided in the value section. e.g. {"variablename":"orderId"}.',t.isSuccess=!1,await t}return await t}async function ye(a,t,e,i,r,s,n,w,o,c){var u="",l=!1;try{var d=await(await e).getTagName(),p=await d;if(await n)return w=await w.toString().toLocaleLowerCase(),"xpath"!==await w?(u="//*[contains(translate(@"+await w+", 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'),'"+await o.toLocaleLowerCase()+"')]",await Se(await a,await r,await i,await u),await u):(await Se(await a,await r,await i,await o),await o);var m,v="";"svg"===await d?(e=await Pe(await t,await e),d=await(await e).getTagName(),v=await(await e).getAttribute("outerHTML")):v=await(await e).getAttribute("outerHTML"),m=await v;for(let a=0;a<3;a++){v=await v.split(">")[0],v=await v.replace("<"+await d,"").trim();var g=await v.split(" ");l=!1;for(let e=0;e<await g.length;e++)try{var h=await g[e];if(await h.includes("=")){var f=await h.split("=")[0];if(f=await f.replace(/"/g,""),!await be(await f)){var y=await h.split("=")[1];if(y=await y.replace(/"/g,""),null!==await y&&void 0!==await y&&""!==await y&&!await y.includes("javascript")&&(u="//"+await d+"[contains(translate(@"+await f+", 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'),'"+await y.toLocaleLowerCase()+"')]",await a>0&&("svg"===await p?u+="//*[local-name()='svg']":u=u+"//"+await p),await s!==u)){var b=await(await t).findElements(T.xpath(await u));if(await b.length===await c){var S=await(await b[0]).getAttribute("outerHTML");if(await m===await S){l=!0;break}}}}}}catch(a){}if(await l)break;e=await Pe(await t,await e),d=await(await e).getTagName(),v=await(await e).getAttribute("outerHTML")}if(await l)return await Se(await a,await r,await i,await u),await u;await Se(await a,await r,await i,""),u=""}catch(a){}return await u}async function be(a){return!!await["autocomplete","class","required","value","minlength","maxlength","pattern","type","inputmode","target","autocorrect","autocapitalize","style","fill","height","width"].includes(await a)}async function Se(a,t,e,r){try{var n=await d(await t+"/Web/OR.json");if(await n){var w=await i+await a+"/"+await t+"/Web/OR.json",o={};o=await JSON.parse(await s.readFileSync(await w,"utf8")),void 0!==await o[await e]&&(o[await e].alternatexpath=await r,await u(await a+"/"+await t+"/Web/OR.json",await o),console.log("secondary xpath is added for element "+await e))}}catch(a){}}async function xe(a,t,e){try{await(await t).clear()}catch(a){}try{await a.executeScript("arguments[0].value = '';",t)}catch(a){}try{await(await t).click()}catch(a){}await(await t).sendKeys(await e)}async function Me(a){if(a=await a.toString().toLocaleLowerCase(),a=await a.replace(/_/g,""),a=await a.replace(/-/g,""),a=await a.replace(/ /g,""),await a.includes("first")&&await a.includes("last")&&await a.includes("name"))return await F()+" "+await U();if(await a.includes("lastname"))return await U();if(await a.includes("firstname"))return await F();if(await a.includes("username"))return await O();if(await a.includes("phone")||await a.includes("mobile")||await a.includes("tel"))return await J();if(await a.includes("email"))await L();else if(await a.includes("country"))await R();else{if(await a.includes("city"))return await W();if(await a.includes("state"))await X();else{if(await a.includes("zip")||await a.includes("pin"))return await Y();if(await a.includes("address"))await V();else{if(await a.includes("title"))return await D();if(await a.includes("password"))return await j();if(await a.includes("cvv")||await a.includes("securitycode"))return await pa();if(await a.includes("cardnumber"))return await va();if(await a.includes("expirationdate"))return await generateExpiryDate()}}}return await a.includes("=name")?await F()+" "+await U():""}async function Ne(a){var t={isSuccess:!0,errorMessage:"",Query:"",database:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid,  Query should be provided in the value section. e.g. {"Query":"Select * from table1"}.',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(void 0===await e.Query)return t.errorMessage='Provided value is invalid, Query should be provided in the value section. e.g. {"Query":"Select * from table"}.',t.isSuccess=!1,await t;t.Query=await e.Query,t.database=await e.database}catch(a){return t.errorMessage='Provided value is invalid, Query should be provided in the value section. e.g. {"Query":"Select * from table1"}.',t.isSuccess=!1,await t}return await t}async function Te(a){var t={isSuccess:!0,errorMessage:"",rowsCount:"",supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return t.errorMessage='Provided value is invalid,  rowsCount should be provided in the value section. e.g. {"rowsCount":1}.',t.isSuccess=!1,await t;try{var e=await JSON.parse(await a);if(void 0===await e.rowsCount)return t.errorMessage='Provided value is invalid, rowsCount should be provided in the value section. e.g. {"rowsCount":1}.',t.isSuccess=!1,await t;t.rowsCount=await e.rowsCount}catch(a){return t.errorMessage='Provided value is invalid, rowsCount should be provided in the value section. e.g. {"rowsCount":1}.',t.isSuccess=!1,await t}return await t}async function Ee(a){return await a.replace(/[^0-9.]/g,"")}async function Ae(a,t=!0){var e={isSuccess:!0,errorMessage:"",filename:"",sheetname:"",expectedCount:0,supportingEvidence:{}};if(""===await a.toString().trim()||void 0===await a)return e.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"myexcel.xlsx","expectedCount":1,"sheetname":"mysheet"}',e.isSuccess=!1,await e;try{var i=await JSON.parse(await a);if(void 0===await i.filename)return e.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"myexcel.xlsx","expectedCount":1,"sheetname":"mysheet"}',e.isSuccess=!1,await e;if(e.filename=await i.filename.toString().trim(),await t){if(void 0===await i.expectedCount)return e.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"myexcel.xlsx","expectedCount":1,"sheetname":"mysheet"}',e.isSuccess=!1,await e;var r=await Number(await i.expectedCount);if(await Number(NaN===await i.expectedCount))return e.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"myexcel.xlsx","expectedCount":1,"sheetname":"mysheet"}',e.isSuccess=!1,await e;e.expectedCount=Number(await r)}e.sheetname=await i.sheetname,void 0===await e.sheetname&&(e.sheetname="")}catch(a){return e.errorMessage='Provided value is invalid, filename and expectedCount should be provided in value section e.g. {"filename":"myexcel.xlsx","expectedCount":1,"sheetname":"mysheet"}',e.isSuccess=!1,await e}return await e}async function Pe(a,t){try{return await a.executeScript("return arguments[0].parentNode;",await t)}catch(a){}}async function Ce(a,t,e,i,r,s,n,w,o,c,u){var l="";if(""===await t.toString().trim())return await l;try{var d=await a[await t.toString().toUpperCase()];if(void 0===await d)return await l;var p="",m=await d.locator,v=await d.locatorproperty,g=await d.alternatexpath;switch(v=await Yt(await v,await e,await i,await r,await s,await n,await w,await o,await u),g=await Yt(await g,await e,await i,await r,await s,await n,await w,await o,await u),await m.toString().trim().toLowerCase()){case"id":p="//*[@id='"+await v+"']";break;case"name":p="//*[@name='"+await v+"']";break;case"linktext":p="//a[text()='"+await v+"']";case"partiallinktext":p="//a[contains(text(),'"+await v+"')]";break;case"classname":case"class":p="//*[@class='"+await v+"']";break;case"xpath":p=await v;break;default:m=await m.toString().toLocaleLowerCase();var h="//*[contains(translate(@"+await m+", 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'),'"+await v.toLocaleLowerCase()+"')]";p=await h}void 0!==await p&&""!==await p&&(l=await p),"Yes"===await c&&void 0!==await g&&""!==await g&&(l=await l+"|"+await g)}catch(a){l=""}return await l}async function ke(a,t,e,i,r,s,n,w,o,c,u,l,d,p,m,v,g,h,f,y,b,S,x,M,N){var T={isSuccess:!0,status:"Pass",testData:{},supportingData:{},errorMessage:""},E={},A=null,P=[],C=-1,k=await async function(a,t){try{var e=await JSON.parse(await a),i=await Object.keys(await e);if(await i.length>0){var r=await i[0],s=e[await r];if(void 0!==await s&&await s.toString().toLocaleLowerCase().startsWith("args.")){var n=await t[await s];if(void 0===await n)return!0;if(await n.toString().toLocaleLowerCase().startsWith("args."))return!0}}}catch(a){}return await!1}(await s,await u);if(await k)return T.status="Warning",T.testData=await jt(await s),T.supportingData=await async function(){return await{warningMessage:"Test step skipped because a required argument was not provided."}}(),p[await n]=!1,await T;var j=await jt(await s);s=await Ut(await s,await w,await o,await c,0,await u,await s,await l,await M),j=await jt(await s),t=await Lt(await j),await t&&(d=await It(await j,await n,await d));var D=!1,O=await Ot(await n,await d);if(await O.isStepInvolved&&(D=await kt(await O,await p)),await D)return T.status="Warning",T.testData=await j,T.supportingData=await je(),p[await n]=!1,await T;var I=await async function(a){var t=1;try{var e=await a;t=await e.loopCounter,void 0===await t&&(t=1),t=await isNaN(await t)?1:await Number(await t)}catch(a){t=1}return await t}(await j);if(0===await I)return T.testData=await j,T.supportingData=await getWarningMessageWhenLoopCountisZeros(),p[await n]=!0,T.status="Warning",await T;for(let e=0;e<await I;e++){try{var L=await j.methodParameters;if(void 0!==await L&&await Array.isArray(await L)&&await L.length>0){var F=await L[e];s=await Dt(await F)}}catch(a){s=await Dt(await j)}if(E={},E=await ve(await a,await m,await r,await v,await i,await w,await o,await c,await g,await h,await f,!1,await s,await u,await l,await y,await b,await x,await M),!await E.isElementPresent){p[await n]=!1;var U=await E.errorMessage;return await t?(T.supportingData=await je(),T.status="Warning"):(T.supportingData=await De(await U),T.isSuccess=!1,T.status="Fail"),T.testData=await jt(await s),T.errorMessage=await U,await T}if(void 0!==await E.shadowDriver&&(m=await E.shadowDriver),A=null,P=[],C=-1,A=await E.element,P=await E.elements,C=await E.elementIndex,resultDetails=await Ft(await a,await i,await m,await A,await s,await S,await c,await v,await f,await P,await C,await l,await y,await M,await N),void 0!==await resultDetails.shadowDriver&&(T.shadowDriver=await resultDetails.shadowDriver),p[await n]=await resultDetails.isSuccess,!await resultDetails.isSuccess)return U=await resultDetails.errorMessage,await t?(T.supportingData=await je(),T.status="Warning"):(T.supportingData=await De(await U),T.isSuccess=!1,T.status="Fail"),T.testData=await jt(await s),T.errorMessage=await U,await T}return T.testData=await jt(await s),T.supportingData=await resultDetails.supportingEvidence,await T}async function je(){return await{warningMessage:"Conditional statement found.Hence test step execution skipped."}}async function De(a){var t={};return t.errorMessage=await a,await t}async function Oe(a,t,e,n,w,o,c,u){try{var d=await B(),p=await q(0),m=await a+"/"+await t+"/"+await n+"/Reports/Screenshot/"+await w+"/"+await p+"/";await l(await m);var v=await o+"_"+await c+"_"+await u+"_"+await d,g=await i+await m+await v+".png",h=await g;h=await Ua.AES.encrypt(await h,await"QW@#$#%%%%#CFGH").toString();try{var f=await(await e).switchTo().alert(),y=await f.getText(),b=await r.generate(await y);return b=await b.split(",")[1],await s.writeFile(await g,await b,{encoding:"base64"}),await h}catch(a){try{return y=await(await e).takeScreenshot(),await s.writeFileSync(await g,await y,{encoding:"base64"}),await h}catch(a){console.log(await a)}}}catch(a){}return""}async function Ie(a){var t=!1;try{JSON.parse(await a),t=!0}catch(a){}return await t}async function Le(a){try{"number"==typeof await a&&(await Number.isSafeInteger(a)||(a=(a=await BigInt(await a)).toString()))}catch(a){}return await a}async function Fe(a,t,e,i,r,s,n,w,o,c){var u="";if(""===await a.toString().trim())return await u;try{var l=await t[await a.toString().toUpperCase()];if(void 0===await l)return u=await T.xpath(await a),await u;var d=await l.locator,p=await l.locatorproperty;switch(p=await Yt(await p,await e,await i,await r,await s,await n,await w,await o,await c),await d.toString().trim().toLowerCase()){case"id":u=await T.id(await p);break;case"name":u=await T.name(await p);break;case"linktext":u=await T.linkText(await p);case"partiallinktext":u=await T.partialLinkText(await p);break;case"classname":case"class":u=await T.className(await p);break;case"css":case"cssselector":u=await T.css(await p);break;case"xpath":u=await T.xpath(await p)}}catch(a){u=""}return await u}a.exports={executeTestStep:Et,evaluateValuecomingfromTestScript:Ut,executeDependendtPageFunction:async function(a,t,e,r,n,w,o,c,u,l,d,p,m,v,g,h,f,y){for(var b={isSuccess:!0,errorMessage:"",supportingEvidence:{},testData:{}},S=[],x=[],M=await e[0].customfunction,N=await e[0].parameter,T={},E=[];0!==e.length;){S.push(await M);var A=await i+await a+"/"+await t+"/Web/CustomPageFunction/Page/"+await M+".json",P=await s.existsSync(await A);if(!await P){b.isSuccess=!1,b.errorMessage="Page "+await M+" method does not exist . Either create Page method or remove from the test script file";var C=await N;C=await JSON.stringify(await C);var k={id:"#",stepdefinition:await S[0],action:"",testdata:await C+"."+await b.errorMessage,status:"Fail",screenshot:""};return b.stepAssertion=await k,b}var j=await JSON.parse(await s.readFileSync(await A,"utf8"));E.push(await j);var D=await j.argumentlist;try{var O=await Object.keys(await D);for(let a=0;a<await O.length;a++){var I=await O[a];if(void 0===await T[await I]){var L=await D[await I];T[await I]=await L}}}catch(a){}if(e=await j.dependentpage,await e.length>0){try{var F=await e[0].parameter,U=await JSON.parse(await F),V=await Object.keys(await U);for(let a=0;a<await V.length;a++){var B=await V[a];void 0===await T[await B]&&(T[await B]=await U[await B])}}catch(a){}M=await e[0].customfunction}}var R={},J=await N;try{var X=await Object.keys(await J),W=await X.length}catch(a){W=0}if(""!==await J&&"{}"!==await J&&0!==await W){var Y=await Object.keys(await T);if(""!==await J&&0!==await Y.length)try{J=await JSON.parse(await J);for(let a=0;a<await Y.length;a++){var G=await Y[a],Q=await J[await G];if(void 0===await Q&&await G.toLocaleLowerCase().toString().startsWith("args.")){var q="ARGS."+await G.substring(5);Q=await J[await q],void 0===await Q&&(Q=await T[await q]),void 0!==await Q&&(R[await q]=await Q)}if(void 0===await Q)return b.isSuccess=!1,b.errorMessage="Key "+await G+" is missing , This key is required while calling selected page/function method",C=await J,C=await JSON.stringify(await J),k={id:"#",stepdefinition:await S[0],action:"",testdata:await C+"."+await b.errorMessage,status:"Fail",screenshot:""},b.stepAssertion=await k,b;Q=await Ut(await Q,await n,await w,await o,await m,await R,await await Q,await d,await f),R[await G]=await Q}}catch(a){return b.isSuccess=!1,b.errorMessage="Provided data in value section is invalid. data should be in JSON format "+await a,C=await R,C=await JSON.stringify(await C),k={id:"#",stepdefinition:await S[0],action:"",testdata:await C+"."+await b.errorMessage,status:"Fail",screenshot:""},b.stepAssertion=await k,b}}try{b.testData=await JSON.stringify(await J)}catch(a){b.testData="{}"}var Z=await S.length,K={},H={};for(let e=0;e<await Z;e++){var _=await E[await Z-(e+1)].allsteps;for(let e=0;e<await _.length;e++)try{var z={},$=!1,aa=await _[e].stepdefinition,ta=await _[e].isreporting,ea=await _[e].action,ia=await _[e].element,ra=await _[e].value,sa=await _[e].id;if(z={Step:"",Stepdefinition:await aa,Action:await ea,locator:await ia,Status:"",TestData:{},SupportingData:{}},ra=await Ut(await ra,await n,await w,await o,0,await R,await await ra,await d,await f),""!==await ra&&"{}"!==await ra)try{ra=await JSON.parse(await ra);var na=await Object.keys(await ra);for(let a=0;a<await na.length;a++){if(G=await na[a],Q=await R[await G],void 0===await Q&&(Q=R[await ra[await G]],void 0===await Q&&(Q=await J[await G],void 0===await Q&&(Q=await ra[await G],void 0!==await J[await Q]&&(Q=await J[await Q])))),void 0===await Q)return b.isSuccess=!1,b.errorMessage="Key "+await G+" is missing , This key is required while calling selected page/function method",C=await R,C=await JSON.stringify(await C),k={id:"#",stepdefinition:await S[0],action:"",testdata:await C+"."+await b.errorMessage,status:"Fail",screenshot:""},b.stepAssertion=await k,b;ra[await G]=await Q}}catch(a){return b.isSuccess=!1,b.errorMessage="Provided data is in not valid . it should be in JSON format "+await a,C=await R,C=await JSON.stringify(await C),k={id:"#",stepdefinition:await S[0],action:"",testdata:await C+"."+await b.errorMessage,status:"Fail",screenshot:""},b.stepAssertion=await k,b}ra=await Ut(await ra,await n,await w,await o,0,await R,await ra,await d,await f);var wa=await typeof await ra;"string"!==await wa&&(ra=await JSON.stringify(await ra));var oa=!1,ca=await Ot(await sa,await K);if(await ca.isStepInvolved&&(oa=await kt(await ca,await H)),await oa)va.isSuccess=!0,z.Step=await x.length+1,z.Status="Warning",z.TestData=await jt(await ra),z.SupportingData=await je(),H[await sa]=!1,x.push(await z);else{var ua=await ve(await a,await r,await ia,await c,await ea,await n,await w,await o,0,await u,await t,!1,await ra,await R,await d,await p,await v,await g,await f);if(await ua.isElementPresent){void 0!==await ua.shadowDriver&&(r=await ua.shadowDriver);var la=await ua.element,da=await ua.elements,pa=await ua.elementIndex;if(va=await Et(await a,await t,await ea,await r,await la,await ra,await l,await o,await u,await c,await n,await w,await da,await pa,await d,await p,await v,await ia,0,!1,await R,await g,await f,await y),void 0!==await va.supportingEvidence){var ma=await va.supportingEvidence.ListOfTestSteps;void 0!==await ma?await ma.length>0&&(z.SupportingData=await va.supportingEvidence):z.SupportingData=await va.supportingEvidence}z.Step=await x.length+1,z.Status="Fail",await va.isSuccess&&(z.Status="Pass"),$=await Lt(await jt(await ra)),await $&&(K=await It(await jt(await ra),await sa,await K),H[await sa]=await va.isSuccess,await va.isSuccess||(z.Status="Warning",va.isSuccess=!0,z.SupportingData=await va.errorMessage)),z.TestData=await jt(await ra),x.push(await z)}else{var va={};if(""===await ta||"Yes"===await ta){if(z.Step=await x.length+1,z.Status="Fail",z.TestData=await jt(await ra),(ha={}).errorMessage=await ua.errorMessage,z.SupportingData=await ha,b.errorMessage=await ua.errorMessage,$=await Lt(await jt(await ra)),!await $){b.isSuccess=!1,x.push(await z),va.isSuccess=!1;break}K=await It(await jt(await ra),await sa,await K),H[await sa]=!1,z.Status="Warning",b.isSuccess=!0,x.push(await z),va.isSuccess=!0}}}if(!va.isSuccess&&(""===await ta||"Yes"===await ta)){b.isSuccess=!1,b.errorMessage=await va.errorMessage;break}}catch(a){if(""===await ta||"Yes"===await ta){var ga,ha,fa=await x.length+1;try{var ya=await JSON.parse(await ra)}catch(a){ya={}}(ha={}).errorMessage=await a.toString(),ga={Step:await fa,Stepdefinition:await aa,Action:await ea,locator:await ia,Status:await"Fail",TestData:await ya,SupportingData:await ha},x.push(await ga),b.isSuccess=!1,b.errorMessage=await a.message;break}}}var ba;ba="Yes"===await h?await Oe(a,await t,await r,"Web",await d,await M,await m,"precondition"):await Xt(await r),C=await R;try{""!==await C&&"{}"!==C&&0!==await Object.keys(await C).length||(C=await J)}catch(a){}return C=await JSON.stringify(await C),k=await b.isSuccess?{id:"#",stepdefinition:await S[0],action:"",testdata:await C,status:"Pass",screenshot:ba}:{id:"#",stepdefinition:await S[0],action:"",testdata:await C+"."+await b.errorMessage,status:"Fail",screenshot:ba},b.stepAssertion=await k,b.supportingEvidence=await async function(a){for(let t=0;t<await a.length;t++)a[t].Step=Number(await t)+1;return await a}(await x),b},takeScreenshot:Xt,callSeleniumMethod:Ft,getUtilityData:Bt,createElementForExistingLocator:Wt,createElementasPerProvidedValue:ve,waitForPageLoad:Jt,saveScreenshot:Oe}},6376:a=>{"use strict";a.exports=require("express-fileupload")},6560:a=>{"use strict";a.exports=require("jira-client")},6777:(a,t,e)=>{const i=e(4716);var r=e(9896);const{faker:s}=e(5941);a.exports={generateRandomNumberWithNDigits:async function(a){const t=Math.pow(10,a-1),e=Math.pow(10,a)-1;return await Math.floor(Math.random()*(e-t+1))+t},getPassword:async function(){return s.internet.password()},getTitle:async function(){return s.person.prefix()},getUserName:async function(){return s.internet.userName()},getEmail:async function(){return s.internet.email()},getFirstName:async function(){return s.person.firstName()},getLastName:async function(){return s.person.lastName()},getAddress:async function(){return s.location.streetAddress()},getUuid:async function(){return s.string.uuid()},getCountry:async function(){return s.location.country()},getPhoneNumber:async function(){return s.number.int({min:6e9,max:9999999999}).toString()},getState:async function(){return s.location.state()},getCity:async function(){return s.location.city()},getZipCode:async function(){return s.location.zipCode()},getWords:async function(a){return s.word.words(a)},getNumberFromRange:async function(a,t){var e=s.number.int({min:a,max:t});return await async function(a){try{"number"==typeof await a&&(await Number.isSafeInteger(a)||(a=(a=await BigInt(await a)).toString()))}catch(a){}return await a}(await e)},addOrSubtractDaysToCurrentDate:async function(a=0,t="DD MMM yyyy",e=void 0){const r=new Date;if(void 0===await e){var s=await i(r).add(Number(a),"days");return i(s).format(t)}return s=await i().add(Number(await a)).utcOffset("+"+await e).format(await t),await s},getString:async function(a){return s.string.alpha(a)},getAllCustomFunction:async function(a,t,e="Web"){var i=[];try{var s=await r.readdirSync("./dataHub/"+await a+"/"+t+"/"+await e+"/CustomPageFunction/Function");for(let a=0;a<await s.length;a++){var n=await s[a];await n.includes(".json")&&(n=await n.replace(".json",""),i.push(await n))}}catch(a){}return i},extractNumberFromString:async function(a,t=!0){return void 0===await t||await t?await a.replace(/[^0-9]/g,""):await a.replace(/[^0-9.]/g,"")},splitAndSaveIndexValue:async function(a,t,e){return await a.split(await t)[await e]},addTwoNumber:async function(a,t,e=0){a=await parseFloat(a),t=await parseFloat(t);let i=await a+await t,r=await Number(await i.toFixed(await e));return await r},subtractTwoNumber:async function(a,t,e=0){a=await parseFloat(a),t=await parseFloat(t);let i=await a-await t,r=await Number(await i.toFixed(await e));return await r},multiplyTwoNumber:async function(a,t,e=0){a=await parseFloat(a),t=await parseFloat(t);let i=await a*await t,r=await Number(await i.toFixed(await e));return await r},devideTwoNumber:async function(a,t,e=0){a=await parseFloat(a),t=await parseFloat(t);let i=await a/await t,r=await Number(await i.toFixed(await e));return await r},reminderTwoNumber:async function(a,t,e=0){a=await parseFloat(a),t=await parseFloat(t);let i=await a%await t,r=await Number(await i.toFixed(await e));return await r},getPercentage:async function(a,t,e=0){let i=await parseFloat(await a),r=await parseFloat(await t),s=100*await(r/i);return await s.toFixed(await e)},addPercentageInNumber:async function(a,t,e=0){let i=await parseFloat(await a),r=await parseFloat(await t),s=100*await(r/i),n=await i+await s,w=await Number(await n.toFixed(await e));return await w},subtractPercentageInNumber:async function(a,t,e=0){let i=await parseFloat(await a),r=await parseFloat(await t),s=100*await(r/i),n=await i-await s,w=await Number(await n.toFixed(await e));return await w},getURl:async function(){return s.internet.url()},sumOfArray:async function(a){try{a=await JSON.parse(await a)}catch(a){return await a.toSting()}try{const t=await a.map(a=>parseFloat(a)),e=await async function(a){const t=await a.reduce((a,t)=>a+t,0),e=await Math.max(...a.map(a=>(a.toString().split(".")[1]||"").length));return await t.toFixed(await e)}(await t);return await e}catch(a){return await a.toSting()}},getipv4:async function(){return await s.internet.ipv4()},getipv6:async function(){return s.internet.ipv6()},getAirline:async function(){var a=s.airline.airline();return await a.name},getAirPlane:async function(){var a=s.airline.airplane();return await a.name},getFlightNumber:async function(){return`${s.airline.airline().iataCode}${s.airline.flightNumber({addLeadingZeros:!0})}`},getAccountName:async function(){return s.finance.accountName()},getAccountNumber:async function(){return s.finance.accountNumber()},getCardCVV:async function(){return s.finance.creditCardCVV()},getCardIssuer:async function(){return s.finance.creditCardIssuer()},getCardNumber:async function(a){return void 0!==await a&&""!==await a||(a="visa"),a=await a.toString().trim(),s.finance.creditCardNumber(await a)},getbicycle:async function(){return s.vehicle.bicycle()},getcolor:async function(){return s.vehicle.color()},getfuel:async function(){return s.vehicle.fuel()},getmodel:async function(){return s.vehicle.model()},getvehicle:async function(){return s.vehicle.vehicle()},getvin:async function(){return s.vehicle.vin()},getvrm:async function(){return s.vehicle.vrm()},getdepartment:async function(){return s.commerce.department()},getdproduct:async function(){return s.commerce.product()},getdproductDescription:async function(){return s.commerce.productDescription()},getproductMaterial:async function(){return s.commerce.productMaterial()},getproductName:async function(){return s.commerce.productName()},getjobTitle:async function(){return s.person.jobTitle()},getjobType:async function(){return s.person.jobType()},getzodiacSign:async function(){return s.person.zodiacSign()},getmac:async function(){return s.internet.mac()},getuserAgent:async function(){return s.internet.userAgent()},getdomainName:async function(){return s.internet.domainName()},getavatar:async function(){return s.image.avatar()},getDateDifference:async function(a,t,e,r,s){var n=await i(a,r),w=await i(t,s);switch(await e.toLocaleLowerCase()){case"month":case"months":return await w.diff(n,"months",!0);case"day":case"days":return await w.diff(n,"days",!0);case"year":case"years":return await w.diff(n,"years",!0);default:return null}},generateExpiryDate:async function(){const a=await Math.floor(12*Math.random())+1,t=(new Date).getFullYear(),e=await t,i=await t+10,r=Math.floor(Math.random()*(i-e+1))+e;return(a<10?"0"+a:a.toString())+"/"+r.toString().slice(-2)},getPhoneImEI:async function(){return s.phone.imei()}}},6787:(a,t,e)=>{const i=e(7252);e(9896);const r=i.Router(),{authCheck:s}=e(2258),n=e(3618),w=e(8938);async function o(a){const t=await n(await a);let e=null,i=null,r=null;const s=await t.match("#verb").first();await s&&(e=await s.verbs().first().text());const w=await t.match("#Noun").first();return await w&&(i=await w.nouns().first().text()),r=await t.match("#Email").first().text(),""===await r&&(r=await t.match("#Url").first().text(),""===await r&&(r=await t.match("#Date").first().text(),""===await r&&(r=await t.match("#Product").first().text(),""===await r&&(r=await t.match("#Place").first().text(),""===await r&&(r=await t.match("#Person").first().text()),""===await r&&(r=await t.match("#Organization").first().text(),""===await r&&(r=await t.match("#Value").first().text())))))),{action:e,object:i,value:r}}async function c(a){return!(!await a.includes("browser")&&!await a.includes("window")||!(await a.includes("alert")||await a.includes("popup")||await a.includes("notification")))}async function u(a){return!(!await a.includes("browser")&&!await a.includes("window")||!await a.includes("url"))}async function l(a){return!(!(await a.includes("browser")||await a.includes("window")||await a.includes("page")||await a.includes("app"))||!(await a.includes("title")||await a.includes("head")||await a.includes("directed")))}async function d(a){var t=await n(await a).values(0).toNumber().out();let e=await n(await t).values().toCardinal().out("text");return await e}async function p(a){return!(!await a.includes("generate")&&!await a.includes("random"))}async function m(a){const t=await n(await a);return await t.match("#Noun").out("array")}async function v(a){const t=await n(await a);return await t.match("#Pronoun").out("array")}async function g(a,t){if(0===await t.length)return await a;for(let i=0;i<await t.length;i++){var e=await t[i];if(await a.includes(await e)){const t=await a.indexOf(await e);await t>-1&&await a.splice(t,1)}}return await a}async function h(a,t,e){var i={primaryLocatorProperty:"",secondaryXPath:"",orLogicalName:"",actionvalue:""},r=await a.toLocaleLowerCase(),s=await async function(a){var t=await a.split(" ").join("");t=await a.toLocaleLowerCase();var e=await async function(a){return!(!await a.includes("button")&&!await a.includes("Presser"))}(await t);return await e?"BUTTON":(e=await async function(a){return!!await a.includes("link")}(await t),await e?"LINK":(e=await async function(a){const t=await a.includes("textbox")||await a.includes("field")||await a.includes("editbox")||await a.includes("inputbox")||await a.includes("inputfield")||await a.includes("databox")||await a.includes("searchbox")||await a.includes("searchbar")||await a.includes("provide")||await a.includes("input")||await a.includes("type")||await a.includes("sendkey")||await a.includes("enter")||await a.includes("set"),e=await a.includes("leave")||await a.includes("area");return!(!await t||await e)}(await t),await e?"TEXTBOX":(e=await async function(a){return!!(await a.includes("image")||await a.includes("icon")||await a.includes("logo")||await a.includes("visual"))}(await t),await e?"IMAGE":(e=await async function(a){return!!(await a.includes("checkbox")||await a.includes("tickbox")||await a.includes("choicebox"))}(await t),await e?"CHECKBOX":(e=await async function(a){return!!(await a.includes("radiobutton")||await a.includes("radiochoice")||await a.includes("radioswitch")||await a.includes("radiostogg")||await a.includes("toggle"))}(await t),await e?"RADIOBUTTON":(e=await async function(a){return!!(await a.includes("listbox")||await a.includes("dropdown")||await a.includes("combobox")||await a.includes("selectbox")||await a.includes("listcontrol")||await a.includes("select")&&await a.includes("from"))}(await t),await e?"LISTBOX":(e=await async function(a){return!!(await a.includes("textarea")||await a.includes("inputarea")||await a.includes("commentbox"))}(await t),await e?"TEXTAREA":(e=await async function(a){return!!await a.includes("label")}(await t),await e?"LABEL":"TEXT"))))))))}(await a),w=await M(await r);if(await w.length>0){var o=await w[await w.length-1],c=await(await s+await o.toUpperCase()).trim();i.orLogicalName=await c.split(" ").join("").trim();var u=await S(await s,t,await o);if(i.primaryLocatorProperty=await u.primaryLocatorProperty,i.secondaryXPath=await u.secondaryXPath,"Type"!==await e.toLocaleLowerCase()){var l=await f(await a);if(""!==await l){var p=await d(await l);if(""!==await p){var m=await Number(await p);if(!await isNaN(await m))if(await r.includes("mobile")||await r.includes("phone")||await r.includes("quant"))(v={valuetobesend:"ProvideValue"}).valuetobesend=await m.toString(),i.actionvalue=await JSON.stringify(await v);else{var v,g=await Number(await p)-1;(v={index:0}).index=await g,i.actionvalue=await JSON.stringify(await v)}}}}return await i}var h=await async function(a,t){switch(await a){case"Click":case"ClickNTimes":case"ClickAll":case"DoubleClick":case"RightClick":case"Tap":case"LongClick":return await async function(a){return await a.includes("clicked")?"(clicked)":await a.includes("clicks")?"(clicks)":await a.includes("click")?"(click)":await a.includes("press")?"(press)":await a.includes("hits")?"(hits)":await a.includes("hit")?"(hit)":await a.includes("triggered")?"(triggered)":await a.includes("triggers")?"(triggers)":await a.includes("trigger")?"(trigger)":await a.includes("choosen")?"(choosen)":await a.includes("chooses")?"(chooses)":await a.includes("choose")?"(choose)":await a.includes("taped")?"(taped)":await a.includes("taps")?"(taps)":await a.includes("tap")?"(tap)":await"(clicked|clicks|click|press|hit|trigger|choose|tap)"}(await t);case"DragandDrop":return await async function(a){return await a.includes("dragging")?"(dragging)":await a.includes("dragged")?"(dragged)":await a.includes("dragger")?"(dragger)":await a.includes("drags")?"(drags)":await a.includes("drag")?"(drag)":await a.includes("pulling")?"(pulling)":await a.includes("pulled")?"(pulled)":await a.includes("pulls")?"(pulls)":await a.includes("pull")?"(pull)":await a.includes("towing")?"(towing)":await a.includes("towed")?"(towed)":await a.includes("tows")?"(tows)":await a.includes("tow")?"(tow)":await"(drag|pull|tow|schlep)"}(await t);case"FileUpload":return await async function(a){return await a.includes("uploading")?"(uploading)":await a.includes("uploaded")?"(uploaded)":await a.includes("uploads")?"(uploads)":await a.includes("transferring")?"(transferring)":await a.includes("transferred")?"(transferred)":await a.includes("transfers")?"(transfers)":await a.includes("transfer")?"(transfer)":await a.includes("transmits")||await a.includes("transmit")?"(transmits)":await a.includes("posts")?"(posts)":await a.includes("post")?"(post)":await a.includes("importing")?"(importing)":await a.includes("imported")?"(imported)":await a.includes("imports")?"(imports)":await a.includes("import")?"(import)":await"(upload|transfer|transmit|post|import)"}(await t);case"Focus":return await async function(a){return await a.includes("focusing")?"(focusing)":await a.includes("focused")?"(focused)":await a.includes("focuses")?"(focuses)":await a.includes("focus")?"(focus)":await a.includes("scroller")?"(scroller)":await a.includes("scrolling")?"(scrolling)":await a.includes("scrolled")?"(scrolled)":await a.includes("scrolls")?"(scrolls)":await a.includes("scroll")?"(scroll)":await a.includes("moveto")?"(moveto)":await a.includes("movesto")?"(movesto)":await a.includes("highlighting")?"(highlighting)":await a.includes("highlighted")?"(highlighted)":await a.includes("highlights")?"(highlights)":await a.includes("highlight")?"(highlight)":await"(focus|scroll|moveto|highlight|movesto)"}(await t);case"GetAttribute":case"GetAttributeForAllElements":return await async function(a){return await a.includes("retrieving")?"(retrieving)":await a.includes("retrieved")?"(retrieved)":await a.includes("retrieves")?"(retrieves)":await a.includes("retrieve")?"(retrieve)":await a.includes("obtaining")?"(obtaining)":await a.includes("obtained")?"(obtained)":await a.includes("obtains")?"(obtains)":await a.includes("obtain")?"(obtain)":await a.includes("fetching")?"(fetching)":await a.includes("fetched")?"(fetched)":await a.includes("fetches")?"(fetches)":await a.includes("fetchs")?"(fetchs)":await a.includes("fetch")?"(fetch)":await a.includes("extracting")?"(extracting)":await a.includes("extracted")?"(extracted)":await a.includes("extracts")?"(extracts)":await a.includes("extract")?"(extract)":await a.includes("capturing")?"(capturing)":await a.includes("captured")?"(captured)":await a.includes("captures")?"(captures)":await a.includes("capture")?"(capture)":await a.includes("getting")?"(getting)":await a.includes("gets")?"(gets)":await a.includes("get")?"(get)":await"(retrieve|obtain|fetch|extract|capture|get)"}(await t);case"GetIndexOfTheElement":return await async function(a){return await a.includes("indexing")?"(indexing)":await a.includes("indexed")?"(indexed)":await a.includes("indexes")?"(indexes)":await a.includes("index")?"(index)":await a.includes("positioning")?"(positioning)":await a.includes("positioned")?"(positioned)":await a.includes("positions")?"(positions)":await a.includes("position")?"(position)":await"(index|position)"}(await t);case"GetTagName":return"(tags|tag|tagnames|tagname)";case"PressKeyBoard":return"(keys|key|keyname|keyboard)";case"Count":return await async function(a){return await a.includes("counting")?"(counting)":await a.includes("counted")?"(counted)":await a.includes("counts")?"(counts)":await a.includes("count")?"(count)":await a.includes("tally")?"(tally)":await a.includes("totaling")?"(totaling)":await a.includes("totaled")?"(totaled)":await"(count|tally|total)"}(await t);case"WaitForElementIsEnabled":case"WaitForElementIsDisabled":case"WaitForElementTillDisplayed":case"WaitForElementTillNotDisplayed":case"WaitForElementTillTextContains":return await async function(a){return await a.includes("waiting")?"(waiting)":await a.includes("waited")?"(waited)":await a.includes("waits")?"(waits)":await a.includes("wait")?"(wait)":await a.includes("pausing")?"(pausing)":await a.includes("paused")?"(paused)":await a.includes("pauses")?"(pauses)":await a.includes("pause")?"(pause)":await a.includes("delaying")?"(delaying)":await a.includes("delayed")?"(delayed)":await a.includes("delays")?"(delays)":await a.includes("delay")?"(delay)":await a.includes("holding")?"(holding)":await a.includes("held")?"(held)":await a.includes("holds")?"(holds)":await a.includes("hold")?"(hold)":await a.includes("timeouts")?"(timeouts)":await a.includes("timeout")?"(timeout)":await a.includes("timedouts")?"(timedouts)":await a.includes("timedout")?"(timedout)":await"(wait|pause|delay|hold|timeout)"}(await t);case"Check":case"CheckAll":case"UncheckAll":return await async function(a){return await a.includes("checkable")?"(checkable)":await a.includes("checker")?"(checker)":await a.includes("checking")?"(checking)":await a.includes("checked")?"(checked)":await a.includes("checks")?"(checks)":await a.includes("check")?"(check)":await a.includes("ticking")?"(ticking)":await a.includes("ticked")?"(ticked)":await a.includes("tickmark")?"(tickmark)":await a.includes("ticks")?"(ticks)":await a.includes("tick")?"(tick)":await"(check|tick|checked|checking|checkable)"}(await t);case"SelectByVisibleText":return await async function(a){return await a.includes("selecting")?"(selecting)":await a.includes("selected")?"(selected)":await a.includes("selects")?"(selects)":await a.includes("select")?"(select)":await a.includes("choosing")?"(choosing)":await a.includes("choice")?"(choice)":await a.includes("chooses")?"(chooses)":await a.includes("choose")?"(choose)":await a.includes("pickings")?"(pickings)":await a.includes("picking")?"(picking)":await a.includes("picker")?"(picker)":await a.includes("picked")?"(picked)":await a.includes("picks")?"(picks)":await a.includes("pick")?"(pick)":await"(select|choose|pick)"}(await t);case"SwitchToFrame":return"(frame|iframe)";case"Type":case"TypeAll":return await async function(a){return await a.includes("textboxes")?"(textboxes)":await a.includes("textboxs")?"(textboxs)":await a.includes("textbox")?"(textbox)":await a.includes("searchboxes")?"(searchboxes)":await a.includes("searchboxs")?"(searchboxs)":await a.includes("searchbox")?"(searchbox)":await a.includes("searchbars")?"(searchbars)":await a.includes("searchbar")?"(searchbar)":await a.includes("typed")?"(typed)":await a.includes("types")?"(types)":await a.includes("typing")?"(typing)":await a.includes("type")?"(type)":await a.includes("enters")?"(enters)":await a.includes("entered")?"(entered)":await a.includes("entering")?"(entering)":await a.includes("enter")?"(enter)":await a.includes("sendkeys")?"(sendkeys)":await a.includes("sendingkeys")?"(sendingkeys)":await a.includes("sentkeys")?"(sentkeys)":await a.includes("sendkey")?"(sendkey)":await a.includes("sentkey")?"(sentkey)":await a.includes("providing")?"(providing)":await a.includes("provided")?"(provided)":await a.includes("provides")?"(provides)":await a.includes("provide")?"(provide)":await a.includes("leaving")?"(leaving)":await a.includes("leaves")?"(leaves)":await a.includes("leave")?"(leave)":await a.includes("inputs")?"(inputs)":await a.includes("inputted")?"(inputted)":await a.includes("inputting")?"(inputting)":await a.includes("input")?"(input)":await"(textbox|searchbox|searchbar|type|enter|sendkeys|provide|leave|sendkey|inputs)"}(await t);case"IsSelected":return"(checked|selected|checks|checkable)";case"AssertElementCountEquals":case"AssertElementCountGreaterThan":case"AssertElementCountLessThan":case"AssertElementAttributeContains":case"AssertElementAttributeNotContains":return await async function(a){return await a.includes("verification")?"(verification)":await a.includes("verifier")?"(verifier)":await a.includes("verifying")?"(verifying)":await a.includes("verified")?"(verified)":await a.includes("verifies")?"(verifies)":await a.includes("verify")?"(verify)":await a.includes("validating")?"(validating)":await a.includes("validation")?"(validation)":await a.includes("validator")?"(validator)":await a.includes("validated")?"(validated)":await a.includes("validates")?"(validates)":await a.includes("validate")?"(validate)":await a.includes("ensuring")?"(ensuring)":await a.includes("ensured")?"(ensured)":await a.includes("ensures")?"(ensures)":await a.includes("ensure")?"(ensure)":await a.includes("counting")?"(counting)":await a.includes("counted")?"(counted)":await a.includes("counts")?"(counts)":await a.includes("count")?"(count)":await"(verify|validate|ensure|count)"}(await t);case"IsDisplayed":case"IsNotDisplayed":return await async function(a){return await a.includes("displaying")?"(displaying)":await a.includes("displayed")?"(displayed)":await a.includes("displays")?"(displays)":await a.includes("display")?"(display)":await a.includes("visibled")?"(visibled)":await a.includes("visibles")?"(visibles)":await a.includes("visible")?"(visible)":await a.includes("visibility")?"(visibility)":await a.includes("presently")?"(presently)":await a.includes("presented")?"(presented)":await a.includes("presents")?"(presents)":await a.includes("present")?"(present)":await"(displayed|displays|display|visible|present)"}(await t);case"IsDisabled":case"IsEnabled":return await async function(a){return await a.includes("enabling")?"(enabling)":await a.includes("enabled")?"(enabled)":await a.includes("enables")?"(enables)":await a.includes("enable")?"(enable)":await a.includes("disabling")?"(disabling)":await a.includes("disabled")?"(disabled)":await a.includes("disables")?"(disables)":await a.includes("disable")?"(disable)":await"(enable|disable)"}(await t);case"Pinch":return"(pinch)";case"ZoomIn":case"ZoomOut":return"(zoom)";default:return""}}(await e,await r);let y=await n(await r);var x="",N="";if(x=await y.match(await h).before().text(),N=await y.match(await h).after().text(),x=await x.replace("empty",""),N=await N.replace("empty",""),""===await x&&""===await N){var T=await async function(a,t){var e="",i="";if(""===await a)return{beforeKeyword:e,afterKeyword:i};a=await a.toString().replace("(",""),a=await a.toString().replace(")","");var r=await a.split("|");for(let a=0;a<await r.length;a++){var s=await r[a];if(await t.includes(await s)){var n=await t.split(await s);e=await n[0],i=await n[await n.length-1],e=await e.replace("empty","").trim(),i=await i.replace("empty","").trim();break}}return{beforeKeyword:e,afterKeyword:i}}(await h,await r);if(x=await T.beforeKeyword,N=await T.afterKeyword,""===await x&&""===await N){if(await r.includes(" ")){const a=r.split(" ");if(await a.length>=2){const t=await a.slice(1),e=await t.join(" ");r=await e}}x=await r}}return i=await b(await N,await t,await s),""===await i.orLogicalName&&(i=await b(await x,await t,await s)),await i}async function f(a){var t="";const e=await n(await a);return t=await e.match("#Email").first().text(),""===await t&&(t=await e.match("#Url").first().text(),""===await t&&(t=await e.match("#Date").first().text(),""===await t&&(t=await e.match("#Product").first().text(),""===await t&&(t=await e.match("#Place").first().text(),""===await t&&(t=await e.match("#Person").first().text()),""===await t&&(t=await e.match("#Date").first().text(),""===await t&&(t=await e.match("#People").first().text(),""===await t&&(t=await e.match("#FirstName").first().text(),""===await t&&(t=await e.match("#Country").first().text(),""===await t&&(t=await e.match("#Address").first().text(),""===await t&&(t=await e.match("#Value").first().text(),""===await t&&(t=await e.match("#Username").first().text()))))))))))),await t}async function y(a){const t=await n(await a);var e=await t.not("#Preposition").text(),i=await m(await e),r=await v(await e),s=await g(await i,await r);return await s.length>0&&(e=("index"===await s[0]||"value"===await s[0])&&await s.length>1?s[1]:s[0]),await{first:e}}async function b(a,t,e){var i={orLogicalName:"",primaryLocatorProperty:"",secondaryXPath:"",actionvalue:""};if(""!==await a){var r=await a.split(" ");if(1===await r.length){var s=await y(await r[0]);if(""===await s.first||"empty"===await s.first)return await i;var w=await await r[0];""!==await e?i.orLogicalName=await e.toUpperCase()+await w.toUpperCase():i.orLogicalName=await w.toUpperCase();var o=await S(await e,t,await w);return i.primaryLocatorProperty=await o.primaryLocatorProperty,i.secondaryXPath=await o.secondaryXPath,await i}var c="";c=await t[await e],void 0===await c&&(c=await t.DEFAULT);var u=await async function(a){switch(await a.toUpperCase()){case"BUTTON":return"(webbutton|button)";case"LINK":return"(hyperlink|weblink|link)";case"TEXTBOX":return"(textbox|editbox|searchbox|searchbar|inputfield|searchfield|inputs|sendkeys)";case"IMAGE":return"(image|icon|logo)";case"CHECKBOX":return"(checkbox|tickbox)";case"RADIOBUTTON":return"(radiobutton|radio)";case"LISTBOX":return"(listbox|dropdown|select)";case"TEXTAREA":return"(textarea|areabox)";case"LABEL":return"(label)";default:return""}}(await e),l=await async function(a,t){var e,i=await a.toLocaleLowerCase(),r="";if(""===await t)return r=await a,await{sentenseBeforeKeyword:r,sentenseBeforeKeyword:r};let s=await n(await i);return r=await s.match(await t).before().text(),e=await s.match(await t).after().text(),""===await r&&""===await e&&(r=await a),await{sentenseBeforeKeyword:r,sentenseAfteKeyword:e}}(await a,await u),p=await l.sentenseBeforeKeyword;p=await p.toString().replace(" the "," "),p=await p.toString().replace(" field "," "),p=await p.toString().replace("leave ",""),p=await p.toString().replace("empty ","");var m=await y(await p);p=await m.first,""===await p&&(p=await l.sentenseAfteKeyword,""===await p&&(p=await a.split(" ")[0]));var v=await l.sentenseBeforeKeyword,g=await l.sentenseAfteKeyword;void 0!==await g&&""!==await g||(g=await v);var h="";if(await p.split(" ").length>2)var b=await async function(a){const t=await n(await a);if(verbs=await t.nouns(),verbs.length>0){const a=await verbs.first().match("#Noun").text(),t=await verbs.first().match("#Noun #Noun").text(),e=await verbs.first().match("#Noun #Noun").text();return await{first:a,second:t,third:e}}{const t=await a,e="",i="";return await{first:t,second:e,third:i}}}(await p);else b=await y(await p);if(null!==await b&&""!==await b.first){h=await b.first,await h.split(" ").length>3&&(h=await b.second,await h.split(" ").length>3&&(h=await b.third));var M=await f(await a);if(""===await M){var N=await h.split(" "),T=await N.length;await T>3&&(text=await N[await T-2]+" "+await N[await T-1],h=await N[0]);var E=await(await e+await h.toUpperCase()).trim();return w=await h.toLocaleLowerCase(),i.orLogicalName=await E.split(" ").join("").trim(),o=await S(await e,t,await w),i.primaryLocatorProperty=await o.primaryLocatorProperty,i.secondaryXPath=await o.secondaryXPath,await i}if(await h.includes(await M)){var A="";await M.includes(" ")||(A=await M);var P=await x(await h,await M);if("name"!==await P&&""!==await P){var C=await M,k={index:"0"},j=await d(await h);if(""!==await j){var D=await Number(await j);await isNaN(await D)||(M=await Number(await j)-1,await a.includes("mobile")||await a.includes("phone")||await a.includes("quant")?((k={valuetobesend:"ProvideValue"}).valuetobesend=await D.toString(),i.actionvalue=await JSON.stringify(await k)):(k.index=await M,i.actionvalue=await JSON.stringify(await k)))}}if(await h.includes(" ")||(h=await x(await a,await M)),N=await h.split(" "),T=await N.length,await T>3){text=await N[await T-2]+" "+await N[await T-1];var O=await y(await text);h=""!==await O.first?await O.first:await N[0]}else O=await y(await h),h=""!==await O.first?await O.first:await N[0];return h=await h.replace(await C,"").trim(),E=await(await e+await h.toUpperCase()).trim(),w=await h.toLocaleLowerCase(),o=await S(await e,t,await w),i.primaryLocatorProperty=await o.primaryLocatorProperty,i.secondaryXPath=await o.secondaryXPath,i.orLogicalName=await E.split(" ").join("").trim(),""!==await A&&((k={valuetobesend:"ProvideValue"}).valuetobesend=await M,i.actionvalue=await JSON.stringify(await k)),await i}return E=await(await e+await h.toUpperCase()).trim(),w=await h.toLocaleLowerCase(),i.orLogicalName=await E.split(" ").join("").trim(),o=await S(await e,t,await w),i.primaryLocatorProperty=await o.primaryLocatorProperty,i.secondaryXPath=await o.secondaryXPath,j=await d(await M),""!==await j?(k={index:"0"},D=await Number(await j),await isNaN(await D)||(await D>100?((k={valuetobesend:"ProvideValue"}).valuetobesend=await D,i.actionvalue=await JSON.stringify(await k)):(M=await Number(await j)-1,k.index=await M,i.actionvalue=await JSON.stringify(await k)))):((k={valuetobesend:"ProvideValue"}).valuetobesend=await M,i.actionvalue=await JSON.stringify(await k)),await i}}return await i}async function S(a,t,e){var i={primaryLocatorProperty:"",secondaryXPath:""};i.primaryLocatorProperty=await T(await e,await a,await t);var r=await a.toLocaleLowerCase();return"button"===await r?(i.primaryLocatorProperty=await async function(a,t,e){if(void 0===await a||""===a.toString().trim())return"";a=await a.toString().trim().toLocaleLowerCase();var i=await N(await a),r=await P(await t,e);return"//*"===await r||""===await r?"//*["+await i+"]":await r+"//*["+await i+"]"}(await e,await a,await t),i.secondaryXPath=await T(await e,await a,await t)):i.secondaryXPath=await async function(a,t,e){if(void 0===await a||""===a.toString().trim())return"";a=await a.toString().trim().toLocaleLowerCase();var i=await N(await a),r=await P(await t,e);return"//*"===await r||""===await r?"//*["+await i+"]":("textbox"!==await t.toLocaleLowerCase()&&"textarea"!==await t.toLocaleLowerCase()||await r.toString().startsWith("//*")&&(r="/following::*"+await r.substring(3)+"[1]"),"//*["+await i+"]"+await r)}(await e,await a,await t),await i}async function x(a,t){try{var e=await a.split(await t);return await e[1].trim()}catch(a){}return""}async function M(a){const t=[];try{var e=/"([^"]*)"/g;let i;for(;null!==(i=await e.exec(await a));)t.push(await i[1]);if(0===await t.length)for(e=/'([^"]*)'/g;null!==(i=await e.exec(await a));)t.push(await i[1]);if(0===await t.length)for(e=/‘(.*?)’/;null!==(i=await e.exec(await a));)t.push(await i[1])}catch(a){}return t}async function N(a){var t=await E(await a),e=await A(await a);if(await a.includes(" ")){var i=await a.split(" ").join("-"),r=await a.split(" ").join(""),s=await a.split(" ").join("_");t=await t+" or "+await E(await i),t=await t+" or "+await E(await r),t=await t+" or "+await E(await s),e=await e+" or "+await A(await i),e=await e+" or "+await A(await r),e=await e+" or "+await A(await s)}t="["+await t+"]",e="["+await e+"]";var n="(self::*"+await t+" or @*"+await e+")";return await n}async function T(a,t,e){if(void 0===await a||""===a.toString().trim())return"";a=await a.toString().trim().toLocaleLowerCase();var i=await N(await a),r=await P(await t,e);if("//*"===await r||""===await r)return"//*["+await i+"]";if(await r.startsWith("//")){var s=await r.substring(2);return"//*["+await i+" and (self::"+await s+")]"}return"//*["+await i+"]"}async function E(a){if(""!==await a)return"contains(translate(text(), 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'),'"+await a+"')"}async function A(a){if(""!==await a)return"contains(translate(., 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', 'abcdefghijklmnopqrstuvwxyz'),'"+await a+"')"}async function P(a,t){var e="";switch(await a){case"BUTTON":e=await t.BUTTON;break;case"LINK":e=await t.LINK;break;case"TEXTBOX":e=await t.TEXTBOX;break;case"IMAGE":e=await t.IMAGE;break;case"CHECKBOX":e=await t.CHECKBOX;break;case"RADIOBUTTON":e=await t.RADIOBUTTON;break;case"LISTBOX":e=await t.LISTBOX;break;case"TEXTAREA":e=await t.TEXTAREA;break;case"LABEL":e=await t.LABEL;break;default:e=await t.DEFAULT}return await e}r.post("/step",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var r={},m=await a.body.step,v=await m,g=await a.body.elementtag,y=await a.body.aitoolname,b=await a.body.aitotken;g=await async function(a){var t={};return void 0===await a||""===a?(t.LINK="//a",t.BUTTON="//button",t.TEXTBOX="//input",t.IMAGE="//img",t.CHECKBOX="//input",t.RADIOBUTTON="//input",t.LISTBOX="//select",t.TEXTAREA="//textarea",t.LABEL="//label",t.DEFAULT="//*",await t):(void 0===await a.LINK&&(a.LINK="//a"),void 0===await a.BUTTON&&(a.LINK="//button"),void 0===await a.TEXTBOX&&(a.TEXTBOX="//input"),void 0===await a.IMAGE&&(a.IMAGE="//img"),void 0===await a.CHECKBOX&&(a.CHECKBOX="//input"),void 0===await a.RADIOBUTTON&&(a.RADIOBUTTON="//input"),void 0===await a.LISTBOX&&(a.LISTBOX="//select"),void 0===await a.TEXTAREA&&(a.TEXTAREA="//textarea"),void 0===await a.LABEL&&(a.LABEL="//label"),void 0===await a.DEFAULT&&(a.DEFAULT="//*"),await a)}(await g);try{let a=await n(await m);m=await a.normalize().out("text");let t=await n(await m);await t.normalize(),await t.contractions().expand(),m=await t.text()}catch(t){m=await a.body.step}const t=await m.match(/[a-zA-Z0-9._,@'"]+/g);m=await t?await t.join(" "):"",r.actionName="",r.orLogicalName="",r.primaryLocator="xpath",r.primaryLocatorProperty="",r.secondaryXPath="",r.actionvalue="";var x={};void 0!==await y&&""!==await y&&"chatGPT"===await y&&void 0!==await b&&""!==await b&&(x=await async function(a,t,e){var i={};try{i.actionName="",i.orLogicalName="",i.primaryLocator="xpath",i.primaryLocatorProperty="",i.secondaryXPath="",i.actionvalue={};const d=`\n    I have a sentence: "${a}"\n    Based on the following actions and their descriptions, please return the details strictly in JSON format with no additional text:\n    \n    Actions and Descriptions:\n    ${Object.entries(C).map(([a,t])=>`- ${a}: ${t}`).join("\n")}\n    \n    For the given sentence, extract and provide the following details in JSON format:\n    1. Action: The action that best matches the sentence.\n    2. Object: The core object name (e.g., 'Menu' from 'Menu link', 'Login' from 'Login button', 'Username' from 'username textbox', 'Add to cart' from 'add to cart button').\n    3. ObjectType: The type or category of the object (e.g., 'BUTTON', 'LINK', 'TEXTBOX','IMAGE','CHECKBOX','RADIOBUTTON','LISTBOX','TEXTAREA','LABEL').\n    4. Value: Any value that is being provided or sent (e.g., 'username', 'password', '12345'). If no value is provided, return an empty string.\n    5. Verification Item: The text or object that needs to be validated. For example:\n       - "Verify success message 'testing'" should return "testing".\n       - "Verify error message 'this is an error message'" should return "this is an error message".\n       If no verification item is specified, return an empty string.\n    6. Index: The index or position of the action within the context, including handling ordinal indicators like 'first', 'second', 'third'. Convert 'first' to '1', 'second' to '2', etc. If no explicit index is given, default to '0'. \n    \n    Ensure that the response is a valid JSON object with the following keys:\n    - action\n    - object\n    - objectType\n    - value\n    - verificationItem\n    - index\n    \n    If the output cannot be parsed as JSON, return a JSON object with empty strings for all fields.\n    `;try{const a=(await w.post("https://api.openai.com/v1/chat/completions",{model:"gpt-4",messages:[{role:"system",content:"You are a helpful assistant."},{role:"user",content:d}],max_tokens:200},{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}})).data.choices[0].message.content.trim();let p;try{p=JSON.parse(a)}catch(t){const e=a.match(/\{[^]*\}/);p=e?JSON.parse(e[0]):{action:"",object:"",objectType:"",value:"",verificationItem:"",index:"0"}}Object.keys(C).includes(p.action)||(p.action="");var r={action:p.action||"",object:p.object||"",objectType:p.objectType||"",value:p.value||"",verificationItem:p.verificationItem||"",index:p.index||""};if(""!==r.action){i.actionName=r.action;var s=r.value||"Provide your value",n=Number(r.index)||0,o=r.verificationItem||"Provide your value",c=r.object||"",u=r.objectType||"";if(!u)switch(r.action){case"Type":case"TypeAll":u="TEXTBOX";break;case"SelectByIndex":case"SelectByValue":case"SelectByVisibleText":u="LISTBOX";break;default:u="TEXT"}var l=await async function(a,t,e,i,r,s,n){var w={actionvalue:"{}",orLogicalName:"",primaryLocatorProperty:"",secondaryXPath:""},o={};try{switch(await a){case"AlertAccept":case"AlertDismiss":case"AlertText":case"Back":case"Close":case"Forward":case"FullScreen":case"GetCurrentUrl":case"GetTitle":case"Maximize":case"Minimize":case"Refresh":default:break;case"AlertSendKeys":case"AssertIsListSorted":case"AssertIsNumberInAscendingOrder":case"AssertIsNumberInDescendingOrder":case"GenerateUtilityValue":o.valuetobesend=await t;break;case"Navigate":case"NewTab":case"NewWindow":o.url=await t;break;case"SwitchToWindow":o.browserindex=Number(await e)-1;break;case"Wait":case"WaitForAlertIsPresent":case"WaitForTitleContains":try{var c=await Number(await t);isNaN(await c)&&(c=30)}catch(a){c=30}o.timeout=c;break;case"AssertAlertTextContains":case"AssertAlertTextEquals":case"AssertAlertTextNotContains":o.expectedtext=await i;break;case"AssertContains":case"AssertEquals":case"AssertGreaterThan":case"AssertLessThan":case"AssertNotContains":o.actualvalue="Please Provide value",o.expectedvalue="Please Provide value";break;case"AssertStringLengthShouldBe":o.inputstring=await t,o.expectedlength=await i;break;case"AssertTitleContains":case"AssertTitleEquals":case"AssertTitleNotContains":o.title=await i;break;case"AssertUrlContains":case"AssertUrlEquals":case"AssertUrlNotContains":o.url=await i;break;case"AssertWindowCountEquals":case"SaveGlobalVariable":case"SaveSessionVariable":o.expectedcount=await i;break;case"CallMobileTestScript":o.component="Provide component",o.testId="Provide TestId";o.testdata=await{1:{}};break;case"CallAPI":o.component="Provide component",o.testId="Provide TestId";break;case"SaveAPIResponseInSessionVariable":o.myVar="ResponseHeader[KeyName]",o.myVar2="ResponseBody[KeyName]";break;case"ExcelRowCountShouldBe":case"ExcelRowCountShouldBeGreaterThan":case"ExcelRowCountShouldBeLessThan":case"PdfTotalPageCountShouldBe":o.filename=await t,o.expectedCount=await i;break;case"FileCountOnDownloadFolder":case"ReadPdfFile":o.filename=await t;break;case"IsFileExistOnDownloadFolder":o.filename=await i;break;case"SaveExcelColumnValueInSessionVariable":o.filename=await t,o.rowIndex=await e,o.ColumnName=await i;break;case"DBRecordCountShouldBe":case"DBRecordCountShouldBeGreaterThan":case"DBRecordCountShouldBeLessThan":o.rowsCount=await i;break;case"DBRecordsCount":case"RunDBQuery":o.Query=await t;break;case"SaveDBColumnValueInSessionVariable":o.rowIndex=0,o.ColumnName="Your Variable name";break;case"Check":case"CheckAll":case"Clear":case"Click":case"ClickAll":case"ClickNTimes":case"Count":case"DoubleClick":case"Focus":case"GetIndexOfTheElement":case"GetTagName":case"JSClick":case"RightClick":case"SwitchToFrame":case"Uncheck":case"UncheckAll":case"IsSelected":case"IsNotDisplayed":case"IsEnabled":case"IsDisplayed":case"IsDisabled":case"TypeAll":if(""!==await r.toString().trim()){var u=await s+await r;u=await u.toString().trim().toUpperCase().replace(/\s+/g,""),w.orLogicalName=await u;var l=await r.toString().trim().toLocaleLowerCase(),d=await S(await s,await n,await l);w.primaryLocatorProperty=await d.primaryLocatorProperty,w.secondaryXPath=await d.secondaryXPath;try{Number(await e)>1&&(o.index=await Number(await e)-1)}catch(a){}}break;case"ExecuteScript":case"JSType":case"SelectByIndex":case"SelectByValue":case"SelectByVisibleText":case"Type":if(""!==await r.toString().trim()){u=await s+await r,u=await u.toString().trim().toUpperCase().replace(/\s+/g,""),w.orLogicalName=await u,l=await r.toString().trim().toLocaleLowerCase(),d=await S(await s,await n,await l),w.primaryLocatorProperty=await d.primaryLocatorProperty,w.secondaryXPath=await d.secondaryXPath;try{Number(await e)>1&&(o.index=await Number(await e)-1)}catch(a){}o.valuetobesend=await t}break;case"DragandDrop":case"HoverandClick":case"HoverandClick":case"SequentialClick":if(""!==await r.toString().trim()){u=await s+await r,u=await u.toString().trim().toUpperCase().replace(/\s+/g,""),w.orLogicalName=await u,l=await r.toString().trim().toLocaleLowerCase(),d=await S(await s,await n,await l),w.primaryLocatorProperty=await d.primaryLocatorProperty,w.secondaryXPath=await d.secondaryXPath;try{Number(await e)>1&&(o.index=await Number(await e)-1)}catch(a){}o.nextelement=await t}break;case"FileUpload":if(""!==await r.toString().trim()){u=await s+await r,u=await u.toString().trim().toUpperCase().replace(/\s+/g,""),w.orLogicalName=await u,l=await r.toString().trim().toLocaleLowerCase(),d=await S(await s,await n,await l),w.primaryLocatorProperty=await d.primaryLocatorProperty,w.secondaryXPath=await d.secondaryXPath;try{Number(await e)>1&&(o.index=await Number(await e)-1)}catch(a){}o.filename=await t}break;case"GetAttribute":case"GetAttributeForAllElements":case"GetCssValue":if(""!==await r.toString().trim()){u=await s+await r,u=await u.toString().trim().toUpperCase().replace(/\s+/g,""),w.orLogicalName=await u,l=await r.toString().trim().toLocaleLowerCase(),d=await S(await s,await n,await l),w.primaryLocatorProperty=await d.primaryLocatorProperty,w.secondaryXPath=await d.secondaryXPath;try{Number(await e)>1&&(o.index=await Number(await e)-1)}catch(a){}o.attributename=await t}break;case"PressKeyBoard":if(""!==await r.toString().trim()){u=await s+await r,u=await u.toString().trim().toUpperCase().replace(/\s+/g,""),w.orLogicalName=await u,l=await r.toString().trim().toLocaleLowerCase(),d=await S(await s,await n,await l),w.primaryLocatorProperty=await d.primaryLocatorProperty,w.secondaryXPath=await d.secondaryXPath;try{Number(await e)>1&&(o.index=await Number(await e)-1)}catch(a){}o.keyname=await t}break;case"WaitForElementIsDisabled":case"WaitForElementIsEnabled":case"WaitForElementTillDisplayed":case"WaitForElementTillNotDisplayed":if(""!==await r.toString().trim()){u=await s+await r,u=await u.toString().trim().toUpperCase().replace(/\s+/g,""),w.orLogicalName=await u,l=await r.toString().trim().toLocaleLowerCase(),d=await S(await s,await n,await l),w.primaryLocatorProperty=await d.primaryLocatorProperty,w.secondaryXPath=await d.secondaryXPath;try{Number(await e)>1&&(o.index=await Number(await e)-1)}catch(a){}try{c=await Number(await t),isNaN(await c)&&(c=30)}catch(a){c=30}o.timeout=await c}break;case"WaitForElementTillTextContains":if(""!==await r.toString().trim()){u=await s+await r,u=await u.toString().trim().toUpperCase().replace(/\s+/g,""),w.orLogicalName=await u,l=await r.toString().trim().toLocaleLowerCase(),d=await S(await s,await n,await l),w.primaryLocatorProperty=await d.primaryLocatorProperty,w.secondaryXPath=await d.secondaryXPath;try{Number(await e)>1&&(o.index=await Number(await e)-1)}catch(a){}try{c=await Number(await t),isNaN(await c)&&(c=30)}catch(a){c=30}o.timeout=await c,o.expectedtext=await i}break;case"AssertElementAttributeContains":case"AssertElementAttributeEquals":case"AssertElementAttributeNotContains":if(""!==await r.toString().trim()){u=await s+await r,u=await u.toString().trim().toUpperCase().replace(/\s+/g,""),w.orLogicalName=await u,l=await r.toString().trim().toLocaleLowerCase(),d=await S(await s,await n,await l),w.primaryLocatorProperty=await d.primaryLocatorProperty,w.secondaryXPath=await d.secondaryXPath;var p={};""!==await i&&(p[await p]=await t),o.attributeNames=await p}break;case"AssertElementCountEquals":case"AssertElementCountGreaterThan":case"AssertElementCountLessThan":""!==await r.toString().trim()&&(u=await s+await r,u=await u.toString().trim().toUpperCase().replace(/\s+/g,""),w.orLogicalName=await u,l=await r.toString().trim().toLocaleLowerCase(),d=await S(await s,await n,await l),w.primaryLocatorProperty=await d.primaryLocatorProperty,w.secondaryXPath=await d.secondaryXPath,o.expectedcount=await t)}w.actionvalue=await JSON.stringify(await o)}catch(a){}return await w}(r.action,s,n,o,c,u,e);i.actionvalue=l.actionvalue,i.orLogicalName=l.orLogicalName,i.primaryLocatorProperty=l.primaryLocatorProperty,i.secondaryXPath=l.secondaryXPath}}catch(a){console.error("Error during API call or parsing:",a)}}catch(a){console.error("Unexpected error:",a)}return i}(await v,await b,await g)),""!==await x.actionName&&void 0!==await x.actionName||(x=await async function(a,t){var e={actionName:"",orLogicalName:"",primaryLocator:"Xpath",primaryLocatorProperty:"",secondaryXPath:"",actionvalue:""},i=await a.split(" ").join("");i=await i.toLocaleLowerCase();var r=await async function(a){return!(!(await a.includes("run")||await a.includes("hit")||await a.includes("execute")||await a.includes("trigger")||await a.includes("command"))||!await a.includes("query"))}(await i);if(await r){e.actionName="RunDBQuery";var s={Query:"WriteyourQueryhere"},w=await M(await a);if(await w.length>0){var m=await w[0];s.Query=await m}return e.actionvalue=await JSON.stringify(await s),await e}var v=await async function(a){return!!(await a.includes("wait")||await a.includes("pause")||await a.includes("delay")||await a.includes("timeout"))}(await i);if(await v){var g=await async function(a){return!!(await a.includes("alert")||await a.includes("dialog")||await a.includes("notification")||await a.includes("popup")||await a.includes("prompt"))}(await i);if(await g)return e.actionName="WaitForAlertIsPresent",e.actionvalue='{"timeout":30}',await e;if(g=await async function(a){return!(!await a.includes("browser")&&!await a.includes("window")||!(await a.includes("title")||await a.includes("header")||await a.includes("heading")||await a.includes("caption")))}(await i),await g){e.actionName="WaitForTitleContains";var y={timeout:30,expectedtext:"Provide browser title"},b=await o(await a);return""!==await b.value&&(y.expectedtext=await b.value),e.actionvalue=await JSON.stringify(await y),await e}if(g=await async function(a){return!!(await a.includes("enable")||await a.includes("disable")&&await a.includes("not"))}(await i),await g){e.actionName="WaitForElementIsEnabled",e.actionvalue='{"timeout": 30}';var x=await h(await a,await t,"WaitForElementIsEnabled");return e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,await e}if(g=await async function(a){return!!(await a.includes("disable")||await a.includes("enable")&&await a.includes("not"))}(await i),await g)return e.actionName="WaitForElementIsDisabled",e.actionvalue='{"timeout": 30}',x=await h(await a,await t,"WaitForElementIsDisabled"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,await e;if(g=await async function(a){return!!(await a.includes("display")||await a.includes("visible")||await a.includes("notice")||await a.includes("evident")&&!await a.includes("not"))}(await i),await g)return e.actionName="WaitForElementTillDisplayed",e.actionvalue='{"timeout": 30}',x=await h(await a,await t,"WaitForElementTillDisplayed"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,await e;if(g=await async function(a){return!!(await a.includes("display")||await a.includes("visible")||await a.includes("notice")||await a.includes("evident")&&await a.includes("not"))}(await i),await g)return e.actionName="WaitForElementTillNotDisplayed",e.actionvalue='{"timeout": 30}',x=await h(await a,await t,"WaitForElementTillNotDisplayed"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,await e;if(g=await async function(a){return!(!await a.includes("text")||!await a.includes("should")&&!await a.includes("contain"))}(await i),await g)return e.actionName="WaitForElementTillTextContains",e.actionvalue='{"timeout":30,"expectedtext":"provide expected text"}',x=await h(await a,await t,"WaitForElementTillTextContains"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,await e;var N=await f(await a);if(""===await N)return e.actionName="WaitForElementTillDisplayed",e.actionvalue='{"timeout": 30}',x=await h(await a,await t,"WaitForElementTillDisplayed"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,await e;try{var T=await Number(await N);e.actionName="Wait";var E={timeout:5};return E.timeout=await T,e.actionvalue=await JSON.stringify(await E),await e}catch(i){e.actionName="WaitForElementTillDisplayed",e.actionvalue='{"timeout": 30}';x=await h(await a,await t,"WaitForElementTillDisplayed");return e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,await e}}var A=await async function(a){return!!((await a.includes("verify")||await a.includes("validate")||await a.includes("ensure")||await a.includes("should")||await a.includes("tothe")||await a.includes("display")||await a.includes("enable")||await a.includes("disable"))&&!await a.includes("navigate")||await a.includes("check")&&await a.includes("each"))}(await i);if(await A){var P=await async function(a){return!(!await c(await a)||await a.includes("not"))}(await i);if(await P)return e.actionName="AssertAlertTextContains",y={expectedtext:"provide expected text"},b=await o(await a),""!==await b.value&&(y.expectedtext=await b.value),e.actionvalue=await JSON.stringify(await y),await e;if(P=await async function(a){return!(!await c(await a)||!await a.includes("not"))}(await i),await P)return e.actionName="AssertAlertTextNotContains",y={expectedtext:"provide expected text"},b=await o(await a),""!==await b.value&&(y.expectedtext=await b.value),e.actionvalue=await JSON.stringify(await y),await e;if(P=await async function(a){return!(!await l(await a)||await a.includes("not"))}(await i),await P)return e.actionName="AssertTitleContains",y={title:"Provide expected title"},b=await o(await a),""!==await b.value&&(y.title=await b.value),e.actionvalue=await JSON.stringify(await y),await e;if(P=await async function(a){return!(!await l(await a)||!await a.includes("not"))}(await i),await P)return e.actionName="AssertTitleNotContains",y={title:"Provide expected title"},b=await o(await a),""!==await b.value&&(y.title=await b.value),e.actionvalue=await JSON.stringify(await y),await e;if(P=await async function(a){return!(!await u(await a)||await a.includes("not"))}(await i),await P)return e.actionName="AssertUrlContains",y={url:"Provide Url Address"},b=await o(await a),""!==await b.value&&(y.url=await b.value),e.actionvalue=await JSON.stringify(await y),await e;if(P=await async function(a){return!(!await u(await a)||!await a.includes("not"))}(await i),await P)return e.actionName="AssertUrlNotContains",y={url:"Provide Url Address"},b=await o(await a),""!==await b.value&&(y.url=await b.value),e.actionvalue=await JSON.stringify(await y),await e;if(P=await async function(a){return!(!(await a.includes("browser")||await a.includes("window")||await a.includes("tab"))||!await a.includes("count"))}(await i),await P)return e.actionName="AssertWindowCountEquals",y={expectedcount:"Provide browser count"},b=await o(await a),""!==await b.value&&(y.expectedcount=await b.value),e.actionvalue=await JSON.stringify(await y),await e;if(P=await async function(a){return!!(await a.includes("disable")||await a.includes("enable")&&await a.includes("not"))}(await i),await P)return e.actionName="IsDisabled",e.actionvalue="",x=await h(await a,await t,"IsDisabled"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,await e;if(P=await async function(a){return!(!(await a.includes("display")||await a.includes("visible")||await a.includes("present")||await a.includes("observable")||await a.includes("viewable"))||await a.includes("not"))}(await i),await P){if(e.actionName="IsDisplayed",e.actionvalue="",x=await h(await a,await t,"IsDisplayed"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,await a.toLocaleLowerCase().includes("message")||await a.toLocaleLowerCase().includes("information")){var C=await n(await a.toLocaleLowerCase());const i=await C.match("#Noun+ #Verb #Adjective+");if(await i.found){var k=await i.text();if(""!==await k&&void 0!==await k&&(k=await k.toString().replace("text","").trim(),""!==await k)){var j=await S("TEXT",await t,await k);e.primaryLocatorProperty=await j.primaryLocatorProperty,e.secondaryXPath=await j.secondaryXPath,k=await k.split(" ").join("").trim().toUpperCase(),e.orLogicalName="TEXT"+await k}}else{var D=await a.split(" message")[0].trim();""!==await D&&void 0!==await D&&(j=await S("TEXT",await t,await D),e.primaryLocatorProperty=await j.primaryLocatorProperty,e.secondaryXPath=await j.secondaryXPath,D=await D.split(" ").join("").trim().toUpperCase(),e.orLogicalName="TEXT"+await D)}}return await e}if(P=await async function(a){return!(!(await a.includes("disapp")||await a.includes("display")||await a.includes("visible")||await a.includes("present")||await a.includes("observable")||await a.includes("viewable"))||!await a.includes("not"))}(await i),await P){e.actionName="IsNotDisplayed",e.actionvalue="",x=await h(await a,await t,"IsNotDisplayed"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,C=await n(await a.toLocaleLowerCase());const i=await C.match("#Noun+ #Verb #Adjective+");return await i.found&&(k=await i.text(),""!==await k&&void 0!==await k&&(k=await k.toString().replace("text","").trim(),""!==await k)&&(j=await S("TEXT",await t,await k),e.primaryLocatorProperty=await j.primaryLocatorProperty,e.secondaryXPath=await j.secondaryXPath,k=await k.split(" ").join("").trim().toUpperCase(),e.orLogicalName="TEXT"+await k)),await e}if(P=await async function(a){return!!(await a.includes("enable")||await a.includes("disable")&&await a.includes("not"))}(await i),await P)return e.actionName="IsEnabled",e.actionvalue="",x=await h(await a,await t,"IsEnabled"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,await e;if(P=await async function(a){return!!(await a.includes("selected")||await a.includes("checked")||await a.includes("ticked"))}(await i),await P&&(e.actionName="IsSelected",e.actionvalue="",x=await h(await a,await t,"IsSelected"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName),P=await async function(a){return!(!await a.includes("count")||await a.includes("less")&&!await a.includes("greater"))}(await i),await P){e.actionName="AssertElementCountEquals",e.actionvalue="",x=await h(await a,await t,"AssertElementCountEquals"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName;var O=await x.actionvalue;if(""!==await O.trim()){if(O=await JSON.parse(await O),void 0!==await O.index){var I=O.index;await isNaN(await I)?(delete O.index,O.expectedcount="Provide Expected count here",e.actionvalue=JSON.stringify(await O)):(delete O.index,I=Number(await I)+1,O.expectedcount=await I)}}else e.actionvalue='{ "expectedcount": "Provide Expected count here" }';return await e}if(P=await async function(a){return!!(await a.includes("count")&&await a.includes("greater")||await a.includes("check")&&await a.includes("each"))}(await i),await P)return e.actionName="AssertElementCountGreaterThan",x=await h(await a,await t,"AssertElementCountGreaterThan"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,O=await x.actionvalue,""!==await O.trim()?(O=await JSON.parse(await O),void 0!==await O.index&&(I=O.index,await isNaN(await I)?(delete O.index,O.expectedcount="Provide Expected count here",e.actionvalue=JSON.stringify(await O)):(delete O.index,I=Number(await I)+1,O.expectedcount=await I))):e.actionvalue='{ "expectedcount": "0" }',await e;if(P=await async function(a){return!(!await a.includes("count")||!await a.includes("less"))}(await i),await P)return e.actionName="AssertElementCountLessThan",x=await h(await a,await t,"AssertElementCountLessThan"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,O=await x.actionvalue,""!==await O.trim()?(O=await JSON.parse(await O),void 0!==await O.index&&(I=O.index,await isNaN(await I)?(delete O.index,O.expectedcount="Provide Expected count here",e.actionvalue=JSON.stringify(await O)):(delete O.index,I=Number(await I)+1,O.expectedcount=await I))):e.actionvalue='{ "expectedcount": "Provide Expected count here" }',await e;if(P=await async function(a){return!!await a.includes("not")}(await i),await P){e.actionName="AssertElementAttributeNotContains",y={attributeNames:"{}"},e.actionvalue=await JSON.stringify(await y),x=await h(await a,await t,"AssertElementAttributeNotContains"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,C=await n(await a.toLocaleLowerCase());const i=await C.match("#Noun+ #Verb #Adjective+");if(await i.found&&(k=await i.text(),""!==await k&&void 0!==await k&&(k=await k.toString().replace("text",""),""!==await k))){var L={attributeNames:{}};y={text:await k},L.attributeNames=await y,e.actionvalue=await JSON.stringify(await L)}return await e}{e.actionName="AssertElementAttributeContains",y={attributeNames:"{}"},e.actionvalue=await JSON.stringify(await y),x=await h(await a,await t,"AssertElementAttributeContains"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,C=await n(await a.toLocaleLowerCase());const i=await C.match("#Noun+ #Verb #Adjective+");return await i.found?(k=await i.text(),""!==await k&&void 0!==await k&&(k=await k.toString().replace("text",""),""!==await k)&&(L={attributeNames:{}},y={text:await k},L.attributeNames=await y,e.actionvalue=await JSON.stringify(await L))):(await a.toLocaleLowerCase().includes("message")||await a.toLocaleLowerCase().includes("text"))&&(y={text:"ProvideExpectedValue"},(L={attributeNames:{}}).attributeNames=await y,e.actionvalue=await JSON.stringify(await L)),await e}}var F=await async function(a){return!!(await a.includes("browser")||await a.includes("window")||await a.includes("tab")||await a.includes("webpage")||await a.includes("homepage"))}(await i);if(await F){if(r=await async function(a){return!(!await a.includes("browser")||!(await a.includes("acknowledge")||await a.includes("confirm")||await a.includes("respond")||await a.includes("approve")||await a.includes("agree")||await a.includes("allow")||await a.includes("grant")||await a.includes("admit")||await a.includes("accept")))}(await i),await r)return e.actionName="AlertAccept",await e;if(r=await async function(a){return!(!await a.includes("browser")||!(await a.includes("cancel")||await a.includes("dismis")||await a.includes("reject")||await a.includes("decline")||await a.includes("ignore")||await a.includes("refuse")||await a.includes("deny")||await a.includes("block")||await a.includes("disallow")||await a.includes("denounce")||await a.includes("negate")||await a.includes("invalidate ")))}(await i),await r)return e.actionName="AlertDismiss",await e;if(r=await async function(a){return!(!await a.includes("browser")||!await a.includes("provide")&&!await a.includes("send"))}(await i),await r){var U={valuetobesend:"Provide your value"},V=await o(await a);return""!==await V.value&&(U.valuetobesend=await await V.value),e.actionvalue=await JSON.stringify(await U),e.actionName="AlertSendKeys",await e}if(r=await async function(a){return!(!await c(await a)||!(await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("extract")||await a.includes("capture")||await a.includes("get")))}(await i),await r)return e.actionName="AlertText",await e;if(r=await async function(a){return!(!await a.includes("browser")&&!await a.includes("app")||!(await a.includes("back")||await a.includes("previous")||await a.includes("return")||await a.includes("reverse")||await a.includes("backward")||await a.includes("return")))}(await i),await r)return e.actionName="Back",await e;if(r=await async function(a){return!(!await a.includes("browser")||!(await a.includes("close")||await a.includes("exit")||await a.includes("quit")||await a.includes("terminate")||await a.includes("end")||await a.includes("shutdown")))}(await i),await r)return e.actionName="Close",await e;if(r=await async function(a){return!(!await a.includes("browser")||!(await a.includes("forwards")||await a.includes("next")||await a.includes("ahead")))}(await i),await r)return e.actionName="Forward",await e;if(r=await async function(a){return!(!await a.includes("browser")||!await a.includes("fullscreen"))}(await i),await r)return e.actionName="FullScreen",await e;if(r=await async function(a){return!(!await u(await a)||!(await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("extract")||await a.includes("capture")||await a.includes("get")))}(await i),await r)return e.actionName="GetCurrentUrl",await e;if(r=await async function(a){return!(!await l(await a)||!(await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("extract")||await a.includes("capture")||await a.includes("get")||await a.includes("header")))}(await i),await r)return e.actionName="GetTitle",await e;if(r=await async function(a){return!!(await a.includes("browser")&&await a.includes("app")&&(await a.includes("maximi")||await a.includes("enlarge")||await a.includes("expand")||await a.includes("optimize")))}(await i),await r)return e.actionName="Maximize",await e;if(r=await async function(a){return!!(await a.includes("browser")&&await a.includes("app")&&(await a.includes("minim")||await a.includes("shrink")||await a.includes("hide")||await a.includes("collapse")))}(await i),await r)return e.actionName="Minimize",await e;if(r=await async function(a){return!(!(await a.includes("browser")||await a.includes("website")||await a.includes("webpage")||await a.includes("app"))||!await a.includes("newtab"))}(await i),await r)return e.actionName="NewTab",U={url:"Provide your url"},V=await o(await a),""!==await V.value&&(U.url=await await V.value),e.actionvalue=await JSON.stringify(await U),await e;if(r=await async function(a){return!(!(await a.includes("browser")||await a.includes("website")||await a.includes("webpage")||await a.includes("app"))||!await a.includes("newwindow"))}(await i),await r)return e.actionName="NewWindow",U={url:"Provide your url"},V=await o(await a),""!==await V.value&&(U.url=await await V.value),e.actionvalue=await JSON.stringify(await U),await e;if(r=await async function(a){return!(!(await a.includes("browser")||await a.includes("app")||await a.includes("page"))||!(await a.includes("refresh")||await a.includes("reload")||await a.includes("revisit")||await a.includes("redisplay")||await a.includes("renew")))}(await i),await r)return e.actionName="Refresh",await e;if(r=await async function(a){return!(!(await a.includes("browser")||await a.includes("website")||await a.includes("webpage")||await a.includes("app")||await a.includes("tab"))||!await a.includes("switch")&&!await a.includes("goto"))}(await i),await r){if(e.actionName="SwitchToWindow",U={browserindex:"Provide browser index"},V=await o(await a),""!==await V.value){var B=await d(await V.value);if(""!==await B){var R=await Number(await B);await isNaN(await R)||(V.value=await Number(await B)-1,U.browserindex=await V.value)}}return e.actionvalue=await JSON.stringify(await U),await e}return e.actionName="",await e}if(r=await async function(a){return!(!(await a.includes("goto")||await a.includes("visit")||await a.includes("reach")||await a.includes("navigate")||await a.includes("access"))||await a.includes("switch"))}(await i),await r)return e.actionName="Navigate",U={url:"Provide your url"},V=await o(await a),""!==await V.value&&(U.url=await await V.value),e.actionvalue=await JSON.stringify(await U),await e;if(r=await async function(a){return!!(await a.includes("save")&&await a.includes("the")||await a.includes("session"))}(await i),await r)return e.actionName="SaveSessionVariable",e.actionvalue='{"variablename":"Provide variable name"}',await e;if(r=await p(await i),await r)return e.actionName="GenerateUtilityValue",e.actionvalue='{"valuetobesend":"Provide value"}',await e;if(r=await p(await i),await r)return e.actionName="GenerateUtilityValue",e.actionvalue='{"valuetobesend":"Provide value"}',await e;var J=await async function(a){return!(!(await a.includes("checkbox")||await a.includes("tickbox")||await a.includes("toggle"))||await a.includes("all")||await a.includes("uncheck")&&await a.includes("unticked"))}(await i);if(await J)return e.actionName="Check",e.actionvalue="",x=await h(await a,await t,"Check"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,e.actionvalue=await x.actionvalue,await e;if(J=await async function(a){return!(!await a.includes("checkbox")&&!await a.includes("tickbox")||!await a.includes("all")||await a.includes("uncheck")&&await a.includes("unticked"))}(await i),await J)return e.actionName="CheckAll",e.actionvalue="",e.orLogicalName="TAGCHECKBOX",e.primaryLocatorProperty=await t.CHECKBOX,e.secondaryXPath="//input[@type='checkbox']",await e;if(J=await async function(a){return!(!await a.includes("checkbox")&&!await a.includes("tickbox")||!await a.includes("all")||!await a.includes("uncheck")&&!await a.includes("unticked"))}(await i),await J)return e.actionName="Uncheck",e.actionvalue="",x=await h(await a,await t,"Uncheck"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,e.actionvalue=await x.actionvalue,await e;if(J=await async function(a){return!(!await a.includes("checkbox")&&!await a.includes("tickbox")||!await a.includes("all")||!await a.includes("uncheck")&&!await a.includes("unticked"))}(await i),await J)return e.actionName="UncheckAll",e.actionvalue="",e.orLogicalName="TAGCHECKBOX",e.primaryLocatorProperty=await t.CHECKBOX,e.secondaryXPath="//input[@type='checkbox']",await e;if(J=await async function(a){return!(!(await a.includes("click")||await a.includes("press")||await a.includes("hit")||await a.includes("trigger"))||await a.includes("rightclick")||await a.includes("doubleclick")||await a.includes("times")||!(await a.includes("all")||await a.includes("every")||await a.includes("entire")||await a.includes("wholly")))}(await i),await J)return e.actionName="ClickAll",e.actionvalue="",x=await h(await a,await t,"ClickAll"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,e.actionvalue=await x.actionvalue,await e;if(J=await async function(a){return!(!(await a.includes("click")||await a.includes("press")||await a.includes("trigger")||await a.includes("choose")||await a.includes("tap"))||await a.includes("rightclick")||await a.includes("doubleclick")||await a.includes("times")||await a.includes("clickall")||await a.includes("lisbox")||await a.includes("dropdown")||await a.includes("keys")||await a.includes("every"))}(await i),await J)return e.actionName="Click",e.actionvalue="",x=await h(await a,await t,"Click"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,e.actionvalue=await x.actionvalue,await e;if(J=await async function(a){return!(!(await a.includes("click")||await a.includes("press")||await a.includes("hit")||await a.includes("trigger"))||await a.includes("rightclick")||await a.includes("doubleclick")||await a.includes("clickall")||!(await a.includes("times")||await a.includes("rounds")||await a.includes("occasion")))}(await i),await J){e.actionName="ClickNTimes",e.actionvalue="",x=await h(await a,await t,"ClickNTimes"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,U="",""!==await await x.actionvalue&&(U=await JSON.parse(await x.actionvalue));var X=await U.index;return void 0!==await X&&(delete U.index,U.countofclick=await X,U=await JSON.stringify(await U)),e.actionvalue=await U,await e}if(J=await async function(a){return!(!(await a.includes("click")||await a.includes("press")||await a.includes("hit")||await a.includes("trigger"))||await a.includes("rightclick")||await a.includes("times")||await a.includes("all")||!await a.includes("double"))}(await i),await J)return e.actionName="DoubleClick",e.actionvalue="",x=await h(await a,await t,"DoubleClick"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,e.actionvalue=await x.actionvalue,await e;if(J=await async function(a){return!(!(await a.includes("click")||await a.includes("press")||await a.includes("hit")||await a.includes("trigger"))||await a.includes("doubleclick")||await a.includes("times")||await a.includes("all")||!await a.includes("rightclick"))}(await i),await J)return e.actionName="RightClick",e.actionvalue="",x=await h(await a,await t,"RightClick"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,e.actionvalue=await x.actionvalue,await e;if(J=await async function(a){return!!(await a.includes("drag")||await a.includes("pull")||await a.includes("tow")||await a.includes("schlep"))}(await i),await J)return e.actionName="DragandDrop",e.actionvalue="",x=await h(await a,await t,"DragandDrop"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,O=await x.actionvalue,""!==await O.trim()?((O=await JSON.parse(await O)).nextelement="provide element name",e.actionvalue=JSON.stringify(await O)):e.actionvalue='{"nextelement":"provide element name"}',await e;if(J=await async function(a){return!(!(await a.includes("upload")||await a.includes("transfer")||await a.includes("import")||await a.includes("post")||await a.includes("dispatch")||await a.includes("transmit"))||!await a.includes("file"))}(await i),await J)return e.actionName="FileUpload",e.actionvalue="",x=await h(await a,await t,"FileUpload"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,O=await x.actionvalue,""!==await O.trim()?((O=await JSON.parse(await O)).filename="Provide your file name",e.actionvalue=JSON.stringify(await O)):e.actionvalue='{"filename":"Provide your file name"}',await e;if(J=await async function(a){return!!(await a.includes("focus")||await a.includes("scroll")||await a.includes("moveto")||await a.includes("highlight"))}(await i),await J)return e.actionName="Focus",e.actionvalue="",x=await h(await a,await t,"Focus"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,e.actionvalue=await x.actionvalue,await e;if(J=await async function(a){return!(!(await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("extract")||await a.includes("capture")||await a.includes("get"))||await a.includes("all")||await a.includes("every")||await a.includes("entire")||await a.includes("index")||await a.includes("position")||await a.includes("count"))}(await i),await J)return e.actionName="GetAttribute",e.actionvalue="",x=await h(await a,await t,"GetAttribute"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,O=await x.actionvalue,""!==await O.trim()?((O=await JSON.parse(await O)).attributename="provide attribute name",e.actionvalue=JSON.stringify(await O)):e.actionvalue='{"attributename":"provide attribute name"}',await e;if(J=await async function(a){return!(!(await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("extract")||await a.includes("capture")||await a.includes("get"))||await a.includes("index")||await a.includes("position")||await a.includes("count")||!(await a.includes("all")||await a.includes("every")||await a.includes("entire")))}(await i),await J)return e.actionName="GetAttributeForAllElements",e.actionvalue="",x=await h(await a,await t,"GetAttributeForAllElements"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,O=await x.actionvalue,""!==await O.trim()?((O=await JSON.parse(await O)).attributename="provide attribute name",e.actionvalue=JSON.stringify(await O)):e.actionvalue='{"attributename":"provide attribute name"}',await e;if(J=await async function(a){return!(!(await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("extract")||await a.includes("capture")||await a.includes("get"))||!await a.includes("index")&&!await a.includes("position")||await a.includes("all")||await a.includes("every")||await a.includes("entire"))}(await i),await J)return e.actionName="GetIndexOfTheElement",e.actionvalue="",x=await h(await a,await t,"GetIndexOfTheElement"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,e.actionvalue=await x.actionvalue,await e;if(J=await async function(a){return!!await a.includes("tagname")}(await i),await J)return e.actionName="GetTagName",e.actionvalue="",x=await h(await a,await t,"GetTagName"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,e.actionvalue=await x.actionvalue,await e;if(J=await async function(a){return!!(await a.includes("keyboard")||await a.includes("keys")||await a.includes("key"))}(await i),await J)return e.actionName="PressKeyBoard",e.actionvalue="",x=await h(await a,await t,"PressKeyBoard"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,O=await x.actionvalue,""!==await O.trim()?((O=await JSON.parse(await O)).keyname="provide key name",e.actionvalue=JSON.stringify(await O)):e.actionvalue='{"keyname":"provide key name"}',await e;if(J=await async function(a){return!(!(await a.includes("select")||await a.includes("choose")||await a.includes("pick"))||!(await a.includes("listbox")||await a.includes("selectbox")||await a.includes("dropdown")||await a.includes("select"))||await a.includes("option")||await a.includes("index"))}(await i),await J)return e.actionName="SelectByVisibleText",e.actionvalue="",x=await h(await a,await t,"SelectByVisibleText"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,O=await x.actionvalue,""!==await O.trim()?e.actionvalue=await O:e.actionvalue='{ "valuetobesend": "Provide text" }',await e;if(J=await async function(a){return!(!(await a.includes("select")||await a.includes("choose")||await a.includes("pick"))||!(await a.includes("listbox")||await a.includes("selectbox")||await a.includes("dropdown")||await a.includes("select"))||!await a.includes("option")&&!await a.includes("index"))}(await i),await J){if(e.actionName="SelectByIndex",e.actionvalue="",x=await h(await a,await t,"SelectByVisibleText"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,O=await x.actionvalue,""!==await O.trim()){if(O=await JSON.parse(await O),void 0!==await O.index){var W=await O.index;delete O.index,O.valuetobesend=await W}else O.valuetobesend="Provide index";e.actionvalue=JSON.stringify(await O)}else e.actionvalue='{ "valuetobesend": "Provide text" }';return await e}return J=await async function(a){return!(!await a.includes("frame")||await a.includes("default")||await a.includes("parent")||await a.includes("top"))}(await i),await J?(e.actionName="SwitchToFrame",e.actionvalue="",x=await h(await a,await t,"SwitchToFrame"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,e.actionvalue=await x.actionvalue,await e):(J=await async function(a){return!(!await a.includes("frame")||!(await a.includes("default")||await a.includes("parent")||await a.includes("top")||await a.includes("main")))}(await i),await J?(e.actionName="SwitchToDefaultContent",e.actionvalue="",await e):(J=await async function(a){return!(!(await a.includes("textbox")||await a.includes("set")||await a.includes("input")||await a.includes("editbox")||await a.includes("inputbox")||await a.includes("inputfield")||await a.includes("databox")||await a.includes("searchbox")||await a.includes("searchbar")||await a.includes("provide")||await a.includes("type")||await a.includes("put")||await a.includes("sendkeys")||await a.includes("enter")||await a.includes("field")||await a.includes("leave")||await a.includes("fill"))||await a.includes("all")||await a.includes("form"))}(await i),await J?(e.actionName="Type",e.actionvalue="",x=await h(await a,await t,"Type"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,O=await x.actionvalue,""!==await O.trim()?e.actionvalue=await O:(L=await async function(a){var t="";if(await a.toLocaleLowerCase().includes(" as "))try{t=await a.split(" as ")[1].toString().trim()}catch(a){t=""}return await t}(await a),""!==await L?((s={valuetobesend:"Provide text"}).valuetobesend=await L,e.actionvalue=await JSON.stringify(await s)):e.actionvalue='{ "valuetobesend": "Provide text" }'),(await i.includes("leave")||await i.includes("empty")||await i.includes("blank"))&&(e.actionvalue='{ "valuetobesend": "" }'),await e):(J=await async function(a){return!(!(await a.includes("textbox")||await a.includes("set")||await a.includes("input")||await a.includes("editbox")||await a.includes("inputbox")||await a.includes("inputfield")||await a.includes("databox")||await a.includes("searchbox")||await a.includes("searchbar")||await a.includes("provide")||await a.includes("type")||await a.includes("put")||await a.includes("sendkeys")||await a.includes("enter")||await a.includes("field")||await a.includes("leave")||await a.includes("fill"))||!await a.includes("all")&&!await a.includes("form"))}(await i),await J?(e.actionName="TypeAll",e.actionvalue="[]",e.orLogicalName="TAGTEXTBOX",e.primaryLocatorProperty=await t.TEXTBOX,e.secondaryXPath="//input",await e):(J=await async function(a){return!(!(await a.includes("retrieve")||await a.includes("obtain")||await a.includes("fetch")||await a.includes("get")||await a.includes("capture")||await a.includes("extract"))||!(await a.includes("count")||await a.includes("tally")||await a.includes("total")||await a.includes("all")))}(await i),await J?(e.actionName="Count",e.actionvalue="",x=await h(await a,await t,"Count"),e.primaryLocatorProperty=await x.primaryLocatorProperty,e.secondaryXPath=await x.secondaryXPath,e.orLogicalName=await x.orLogicalName,e.actionvalue=await x.actionvalue,await e):await e))))}(await m,await g)),""!==await x.actionName&&(r.actionName=await x.actionName,r.actionvalue=await async function(a){var t="{}";try{var e=await typeof await a;t="object"===await e?await JSON.stringify(await a):await a}catch(a){t="{}"}return await t}(await x.actionvalue),r.orLogicalName=await x.orLogicalName,r.primaryLocatorProperty=await x.primaryLocatorProperty,r.secondaryXPath=await x.secondaryXPath)}catch(a){r.actionName="",r.orLogicalName="",r.primaryLocator="xpath",r.primaryLocatorProperty="",r.secondaryXPath="",r.actionvalue=""}t.json(await r)}),r.post("/breakSteps",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var r=[],o=await a.body.step;try{let a=await n(await o);o=await a.normalize().out("text");let t=await n(await o);await t.normalize(),await t.contractions().expand(),o=await t.text()}catch(t){o=await a.body.step}var c=await a.body.aitoolname,u=await a.body.aitotken;void 0!==await c&&""!==await c&&"chatGPT"===await c&&void 0!==await u&&""!==await u&&(r=await async function(a,t){try{const e=`Please break down the following sentence into separate individual actions, and return them as a JSON array. \n    Focus on extracting the form fields and turning them into separate action sentences. \n    Do not include any introductory actions like 'Fill login form.' \n    Only include sentences like 'Fill username' and 'Fill password'. \n    Also, do not add any periods (dots) at the end of each sentence. \n    Here is the sentence to process:\n"${"string"==typeof a?a:await a}"`,i="https://api.openai.com/v1/chat/completions",r=(await w.post(i,{model:"gpt-4",messages:[{role:"user",content:e}]},{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}})).data.choices[0].message.content;return JSON.parse(r)}catch(a){return console.error("Error communicating with ChatGPT:",a.response?a.response.data:a.message),[]}}(await o,await u)),0===await r.length&&(r=await async function(a){try{const t=[];a.split(/(?:\band\b|,\s|;|\.\s|\s+and\s+|\s+or\s+)/).forEach(a=>{const e=a.trim();e&&n(e).sentences().out("array").forEach(a=>{const e=a.trim();e&&t.push(e)})})}catch(a){console.log(await a)}return 0===await output.length&&output.push(await a),await output}(await o))}catch(a){(r=[]).push(await o)}t.json(await r)}),r.post("/gettestdatacolumn",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var r=[],n=await a.body.step;const t=await n.match(/[a-zA-Z0-9._,]+/g);n=await t?await t.join(" "):"";var w=await m(await n),o=await v(await n);r=await g(await w,await o)}catch(a){r=[]}t.json(await r)});const C={Check:"Mark a radio button or checkbox as checked, or perform any action that checks an object.",CheckAll:"Mark all available checkboxes or radio buttons as checked.",Clear:"Remove content from an input field, such as clearing a username textbox.",Click:"Perform a single click action on a specified object.",ClickAll:"Perform a click action on all specified objects.",ClickNTimes:"Click a specified object multiple times (e.g., twice on an 'Add to Cart' button).",Count:"Retrieve the number of web elements matching specific criteria.",DoubleClick:"Perform a double-click action on a specified object.",DragandDrop:"Drag an element and drop it at a new location.",ExecuteScript:"Run a JavaScript command to interact with or modify the HTML DOM.",FileUpload:"Upload a file to the application using the file upload feature.",Focus:"Move the mouse, scroll, or focus on a web element.",GetAttribute:"Retrieve a specific attribute (e.g., 'id' or 'text') from an element.",GetAttributeForAllElements:"Retrieve a specified attribute for all matching elements (e.g., 'value' for all dropdown options).",GetCssValue:"Get the CSS value of a specified property for an element.",GetIndexOfTheElement:"Get the index of a specific web element within a list or container.",GetTagName:"Retrieve the tag name (e.g., 'button', 'input') of an element.",HoverandClick:"Hover over a parent element and then click a child element.",JSClick:"Perform a click action using JavaScript.",JSType:"Fill an input field or type text using JavaScript.for a example enter username , fill abc so here username and abc is the object and textbox is the objecttype",PressKeyBoard:"Trigger a keyboard event (e.g., pressing a key).",RightClick:"Perform a right-click action on a specified object.",SelectByIndex:"Select an item from a dropdown or list box based on its index (e.g., the second option).",SelectByValue:"Select an item from a dropdown or list box based on its value (e.g., 'IN' from a country dropdown).",SelectByVisibleText:"Select an item from a dropdown or list box based on visible text (e.g., 'India' from a country dropdown).",SequentialClick:"Perform sequential clicks on a menu and submenu or on related elements.",SwitchToDefaultContent:"Switch focus back to the main or parent frame from within an iframe.",SwitchToFrame:"Switch focus to a specified iframe within the page.",Type:"Enter text into an input field (e.g., type into a textbox).for a example enter username , fill abc so here username and abc is the object and textbox is the objecttype",TypeAll:"Enter text into multiple input fields or objects.",Uncheck:"Uncheck a checkbox or radio button.",UncheckAll:"Uncheck all checkboxes or radio buttons.",AlertAccept:"Accept a browser alert or popup.",AlertDismiss:"Dismiss or cancel a browser alert or popup.",AlertSendKeys:"Send input text to a browser alert.",AlertText:"Retrieve the text from a browser alert.",Back:"Navigate to the previous page in the browser history.",Close:"Close the browser or the currently active tab.",Forward:"Navigate to the next page in the browser history.",FullScreen:"Open the browser in full screen mode.",GetCurrentUrl:"Retrieve the URL of the currently active browser or tab.",GetTitle:"Retrieve the title of the currently active browser or tab.",Maximize:"Maximize the browser window to full screen.",Minimize:"Minimize the browser window.",Navigate:"Navigate to a specified URL in the browser (e.g., https://qabunch.com/).",NewTab:"Open a new tab and navigate to a specified URL.",NewWindow:"Open a new window and navigate to a specified URL.",Refresh:"Refresh the current page in the browser.",SwitchToWindow:"Switch focus to a different browser window or tab, identified by index (starting at 0).",Wait:"Pause execution for a specified duration.",WaitForAlertIsPresent:"Wait for a browser alert to appear within a specified duration (in seconds).",WaitForElementIsEnabled:"Wait for a web element to become enabled within a specified duration (in seconds).",WaitForElementTillDisplayed:"Wait for a web element to become visible within a specified duration (in seconds).",WaitForElementTillNotDisplayed:"Wait for a web element to become hidden within a specified duration (in seconds).",WaitForElementTillTextContains:"Wait for a web element's text to match the expected text within a specified duration (in seconds).",WaitForTitleContains:"Wait for the browser title to contain the expected value within a specified duration.",AssertTitleNotContains:"Verify that the browser title does not contain the expected text.",AssertUrlContains:"Verify that the browser URL contains the expected value.",AssertUrlEquals:"Verify that the browser URL exactly matches the expected value.",AssertUrlNotContains:"Verify that the browser URL does not contain the expected value.",AssertWindowCountEquals:"Verify that the number of open browser windows or tabs matches the expected count.",IsDisabled:"Check if a web element is disabled.",IsDisplayed:"Check if a web element is present and visible.",IsEnabled:"Check if a web element is enabled.",IsNotDisplayed:"Check if a web element is not present or visible.",IsSelected:"Check if a web element (checkbox or radio button) is selected.",AssertAlertTextContains:"Verify that the text in a browser alert contains the expected value.",AssertAlertTextEquals:"Verify that the text in a browser alert exactly matches the expected value.",AssertAlertTextNotContains:"Verify that the text in a browser alert does not contain the expected value.",AssertContains:"Verify that one value is contained within another , if there is no web and mobile object in the sentense.",AssertElementAttributeContains:"Verify that a web element's attribute contains the expected value.",AssertElementAttributeEquals:"Verify that a web element's attribute exactly matches the expected value.",AssertElementAttributeNotContains:"Verify that a web element's attribute does not contain the expected value.",AssertElementCountEquals:"Verify that the number of web elements matches the expected count.",AssertElementCountGreaterThan:"Verify that the number of web elements is greater than the expected count.",AssertElementCountLessThan:"Verify that the number of web elements is less than the expected count.",AssertEquals:"Verify that two values are equal.if there is no web and mobile object in the sentense",AssertGreaterThan:"Verify that one value is greater than another (for numbers).",AssertIsListSorted:"Verify that the elements in a list are in sorted order.",AssertIsNumberInAscendingOrder:"Verify that numbers in a list are in ascending order.",AssertIsNumberInDescendingOrder:"Verify that numbers in a list are in descending order.",AssertLessThan:"Verify that one value is less than another (for numbers).",AssertNotContains:"Verify that one value does not exist within another.",AssertTitleContains:"Verify that the browser title contains the expected text.",AssertStringLengthShouldBe:"Verify that a string has the expected length.",AssertTitleEquals:"Verify that the browser title exactly matches the expected value.",SaveSessionVariable:"Store a value during runtime in a session variable. For example, save the username in a session variable named 'myUsername'.",SaveGlobalVariable:"Store a value globally for use across different parts of the application. For example, save the username in a global variable named 'myUsername'.",RunDBQuery:"Execute a database query to retrieve or manipulate data.",SaveDBColumnValueInSessionVariable:"Save the value of a specific column from a query result into a session variable. The row index starts at 0. The element should be null in this case.",DBRecordsCount:"Retrieve the total number of records returned by the query. The element should be null in this case.",DBRecordCountShouldBeGreaterThan:"Assert that the total number of records returned by the query is greater than a specified value. The element should be null in this case.",DBRecordCountShouldBe:"Assert that the total number of records returned by the query matches a specified value. The element should be null in this case.",CallAPI:"Invoke existing API test scripts to perform operations or retrieve data.",SaveAPIResponseInSessionVariable:"Save the response from an API call into a session variable after executing the CallAPI method.",ExcelRowCountShouldBe:"Assert that the number of rows in an Excel sheet matches the expected count. If a sheet name is not provided, the first worksheet is used.",ExcelRowCountShouldBeGreaterThan:"Assert that the number of rows in an Excel sheet is greater than the expected count. If a sheet name is not provided, the first worksheet is used.",ExcelRowCountShouldBeLessThan:"Assert that the number of rows in an Excel sheet is less than the expected count. If a sheet name is not provided, the first worksheet is used. The element should be null in this case.",FileCountOnDownloadFolder:"Retrieve the count of files in the download folder that match the specified file name. The web element should be blank in this case.",IsFileExistOnDownloadFolder:"Check if a specific file exists in the download folder. This is used to verify if a file was successfully downloaded from the application.",PdfTotalPageCountShouldBe:"Verify that the total number of pages in a PDF document matches the expected count.",ReadPdfFile:"Read the content of a PDF file from the uploads or downloads folder on the server and save the content in a session variable. The element value should be blank in this case.",SaveExcelColumnValueInSessionVariable:"Save the value from a specific column in an Excel file into a session variable based on the row index.",CallMobileTestScript:"Invoke existing mobile test scripts. Pass the component and testId in the value section. The element should be blank in this case.",GenerateUtilityValue:"Generate dynamic test data for use in test scenarios."};a.exports=r},6856:(a,t,e)=>{const i=e(7252);var r=e(9896);const s=i.Router();var n="./dataHub/";const{isDirectoryExist:w,deleteFile:o,getPastDate:c}=e(7229),{authCheck:u}=e(2258);s.post("/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={isSuccess:!1,errorMessage:""};try{var o=a.params.projectName,l=a.params.testingtype,d=await a.headers.accountlabel;switch(await l){case"Web":case"Mobile":case"Api":break;default:return s.errorMessage="Invalid testing type provided",t.json(s)}var p=a.body.envName,m=a.body.days,v=await w(await d+"/"+o+"/"+l+"/Reports/"+p);if(await v){var g=[];switch(await m){case"7 Days":g=await c(7);break;case"14 Days":g=await c(14);break;case"30 Days":g=await c(30);break;case"45 Days":g=await c(45);break;case"60 Days":g=await c(60)}var h=await r.readdirSync(n+await d+"/"+o+"/"+l+"/Reports/"+p);for(let a=0;a<await h.length;a++){var f=await h[a];if(!await g.includes(await f.split("_")[0]))try{await r.unlinkSync(n+await d+"/"+o+"/"+l+"/Reports/"+p+"/"+f)}catch(a){}}s.isSuccess=!0}else s.isSuccess=!0}catch(a){s.errorMessage=a.toString()}t.json(s)}),a.exports=s},6928:a=>{"use strict";a.exports=require("path")},7229:(a,t,e)=>{var i=e(9896);const r=e(6928),s="./dataHub/",n=e(4716),w=e(2410),o=e(3351),{chain:c}=e(3404),{parser:u}=e(1025),{streamObject:l}=e(3184),{stringer:d}=e(8060),p=e(6212),m="w?J5GhtfynO!ma]GG@t:",v=e(2103);async function g(a){try{a&&await a()}catch(a){console.log("Error releasing lock: ",a.message)}}async function h(a,t,e){return new Promise((r,s)=>{const n=i.createWriteStream(a+t,{encoding:"utf8"}),w=c([u(),d()]);w.pipe(n),n.on("finish",()=>{r(!0)}),n.on("error",a=>{s(a)}),w.write(e),w.end()})}async function f(a){var t="{}";try{var e=await typeof await a;t="object"===await e?await JSON.stringify(await a):await a}catch(e){console.log("Unable to convert Json Object into JSON string "+await e),t=await async function(a){const t=new WeakSet;return JSON.stringify(a,(a,e)=>{if("object"==typeof e&&null!==e){if(t.has(e))return"[Circular]";t.add(e)}return e})}(await a)}return await t}async function y(a,t=2){if(0===await a)return"0 Bytes";const e=await t<0?0:t,i=await Math.floor(await Math.log(a)/await Math.log(1024));return await parseFloat((a/Math.pow(1024,i)).toFixed(await e))+" "+["Bytes","KB","MB","GB","TB","PB","EB"][i]}async function b(a,t="Bytes"){const e={Bytes:1,KB:1024,MB:1048576,GB:1073741824,TB:1099511627776,PB:0x4000000000000,EB:0x1000000000000000},i=await a.split(" "),r=await parseFloat(await i[0]),s=await i[1];if(isNaN(await r)||!await e[s])throw new Error("Invalid size format");return await(await r*await e[await s])}a.exports={isDirectoryExist:async function(a){try{return await i.existsSync(s+a)}catch(a){return!1}},saveFile:async function(a,t){let e;try{if(await i.existsSync(s+a))try{e=await p.lock(s+a,{retries:{retries:3,minTimeout:2e3,maxTimeout:3e4,factor:2}})}catch(t){if(console.log("Error acquiring lock: ",t.message),"Lock file is already being held"===t.message)return console.log("Unable to save file "+s+a+" because lock is already being held"),!1}return t=await f(t),await h(s,a,t),await g(e),!0}catch(a){console.log("Unable to save file because of: ",a.toString()),await g(e)}return!1},createDirectory:async function(a){try{return i.mkdirSync(s+a,{recursive:!0}),!0}catch(a){return!1}},deleteFile:async function(a){try{return await i.unlinkSync(s+await a),!0}catch(a){}return!1},renameFile:async function(a,t){try{return await i.renameSync(s+await a,s+await t),!0}catch(a){}return!1},getPastDate:async function(a){var t=[];const e=new Date;for(let s=0;s<await a;s++){var i=Number(a)-Number(s)-1,r=n(e).add(-i,"days");t.push(n(r).format("DD MMM YYYY"))}return await t},getMostRecentFile:async function(a){return await(a=>i.readdirSync(a).filter(t=>i.lstatSync(r.join(a,t)).isFile()).map(t=>({file:t,mtime:i.lstatSync(r.join(a,t)).mtime})).sort((a,t)=>t.mtime.getTime()-a.mtime.getTime()))(a)},addOrSubtractDaysToCurrentDate:async function(a=0,t="DD-MMM-yyyy",e=void 0){const i=await new Date;if(void 0===await e){var r=await n(i).add(Number(a),"days");return await n(r).format(t)}return r=await n().add(Number(await a)).utcOffset("+"+await e).format(await t),await r},getKeyValueFromJsonArray:async function(a,t,e,i){for(let r=0;r<await a.length;r++)if(await a[await r][await t]===await e)return await a[r][await i];return""},deleteAllFileFromFolder:async function(a){try{var t=await i.readdirSync(s+await a);for(let e=0;e<await t.length;e++)try{await i.unlinkSync(s+await a+await t[e])}catch(a){}}catch(a){}},deleteAllSubfolders:async function a(t){try{if(!await i.existsSync(await t))return!0;try{const r=await i.readdirSync(await t);for(let i=0;i<await r.length;i++){var e=await r[i];await a(await t+"/"+await e)}}catch(a){console.log(await a.toString())}return await i.rmdirSync(await t),!0}catch(a){console.log("Unable to delete folder because of "+await a.toSTring())}return!0},deleteOlderFile:async function(a,t){try{var e=await s+await a+"/**/*.json",r=await w.sync(await e),n=await async function(a){try{return(await Promise.all(a.map(async a=>({name:a,modifiedDate:(await i.statSync(a)).mtime})))).sort((a,t)=>t.modifiedDate-a.modifiedDate).map(a=>a.name)}catch(a){}}(await r);if(await r.length<=await Number(t))return;var o=Number(await n.length-await t);for(let a=0;a<await o;a++)try{await i.unlinkSync(await n[await n.length-(a+1)])}catch(a){}}catch(a){}},getFileCount:async function(a){try{var t=await s+await a+"/**/*.json",e=await w.sync(await t);return await e.length}catch(a){}return 0},getFolderSizeInBytes:async function(a){try{const i=await s+await a;var t=await o(await i),e=await y(await t,2);return await e}catch(a){}return"1KB"},isSpaceFreeOnAccount:async function(a,t,e){var r={isSuccess:!1,errorMessage:""};try{const d=await s+await a+"/"+await t;var n=await i.existsSync(await d);if(!await n)return r.isSuccess=!0,await r;var w=await o(await d),c=await y(await w,2),u=await b(await e),l=await b(await c);await l<await u?r.isSuccess=!0:r.errorMessage="Allocated space for account "+await t+" is "+await e+" . Please delete your reports and unused data or connect with Qabunch support team for adding new space."}catch(a){r.errorMessage=await a.toString()}return await r},readLargeJsonFile:async function(a){return new Promise((t,e)=>{const r=c([i.createReadStream(a,{encoding:"utf8"}),u(),l()]),s={};r.on("data",({key:a,value:t})=>{s[a]=t}),r.on("end",()=>{t(s)}),r.on("error",a=>{e(a)})})},verifyReqestHeaderAccountAndProject:async function(a){var t={isSuccess:!0,errorMessage:""};try{var e=await a.headers.userselectedaccount;if("undefined"===await e||void 0===await e||null===await e||""===await e)return t.errorMessage="Project can not be null.",t.isSuccess=!1,await t;var i=await a.headers.accountlabel;if("undefined"===await i||void 0===await i||null===await i||""===await i)return t.errorMessage="account can not be null.",t.isSuccess=!1,await t}catch(a){return t.errorMessage=await a.toString(),t.isSuccess=!1,await t}return await t},addLogMessageInConsole:async function(a){try{const t=await n().format("DD MMM YYYY hh:mm:ss A Z");a=await t+" "+await a,console.log(await a)}catch(a){}},saveFileAsEncyptedContent:async function(a,t){var e;try{try{await i.existsSync(s+a)&&(e=await p.lock(s+a,{retries:{retries:10,minTimeout:500,maxTimeout:1e4,factor:2}}))}catch(t){if(console.log(await t),"Lock file is already being held"===await t.message)return console.log("Unbale to save file "+s+a+" because Lock file is already being held"),!1}t=await f(await t),t=await v.AES.encrypt(await t,await m).toString();var r={qaautomaterencryptedfileData:await t};r=await JSON.stringify(await r),await h(s,await a,await r);try{await e()}catch(a){}return!0}catch(a){try{await e()}catch(a){}console.log("Unable To save file because of "+await a.toString())}return!1},readJSONFile:async function(a){try{var t=await JSON.parse(await i.readFileSync(await s+a,"utf8")),e=await t.qaautomaterencryptedfileData;if(void 0!==await e){var r=await v.AES.decrypt(await e,await m),n=await r.toString(await v.enc.Utf8),w=JSON.parse(await n);return await w}return await t}catch(t){throw console.log("Unable to read JSON file "+await a),new Error(await t.toString())}}}},7244:a=>{"use strict";a.exports=require("chromedriver")},7252:a=>{"use strict";a.exports=require("express")},7449:(a,t,e)=>{const i=e(7252),r=e(9896),s=i.Router(),{getSprintDefectDetails:n}=e(7455);var w="./dataHub/";const{authCheck:o}=e(2258),{readJSONFile:c}=e(7229),u=e(2410);async function d(a,t){for(let e=0;e<await t.length;e++)a.push(await t[e]);return await a}s.post("/project/:projectName/getdashboarddata",async(a,t)=>{var e={},i=await o(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await a.headers.accountlabel,m=[],v=[],g=[],h=[],f=[],y={totaltestcase:0,totaldefect:0,totaltestplan:0,totaltestcaseonlastexecution:0,passpercentageinlastexecution:0,automatedgraphdata:[],testprioritydata:[],componenttestcasedata:[],defectprioritydata:[],defectseveritydata:[],defectComponentData:[],defectStatusData:[],testPlanTotalTestData:[],testPlanComponentPassFailXaxis:[],testPlanComponentPassFailYaxis:[],testPlanPassFailXaxis:[],testPlanPassFailYaxis:[],testCaseCreationByUser:[],defectCreationByUser:[],testCaseExecutedByUser:[],testCaseCustomFieldGraphData:[],defectCustomFieldGraphData:[],TestPlanCustomFieldExecutionGraphData:[]},b={"Not Automated":0,Automated:0,"Not a right candidate":0,"N/A":0,"In Progress":0},S={},x={},M={},N={},T={},E={},A={Pass:0,Fail:0,Pending:0,NA:0,Blocked:0},P={},C={},k=[],j={},D={},O={};try{var I=await a.params.projectName,L=await a.body,F=await L.testCycle,U=await s+"/"+await I+"/Manual/Configuration.json",V={};try{V=await c(await U)}catch(a){V={}}if(0===await F.length)return t.json(await y);var B="";B=1===await F.length?await F[0]:await F.join(","),v=[];var R=await V.TestCaseCustomKeys;void 0===await R&&(R=[]);for(let a=0;a<await R.length;a++){var J=await R[a].key;v.push(await J)}var X=await V.DefectCustomKeys;void 0===await X&&(X=[]);for(let a=0;a<await X.length;a++)J=await X[a].key,g.push(await J);var W=!1;if(void 0!==await V.Tools&&await V.Tools.length>0){var Y=await async function(a){var t={isSuccess:!1,host:"",username:"",password:"",project:"",customissuetype:""};for(let e=0;e<await a.length;e++)if("Jira"===await a[e].tool){t.host=await a[e].url,t.username=await a[e].username,t.password=await a[e].password,t.project=await a[e].project,t.customissuetype=await a[e].customissuetype,t.isSuccess=!0;break}return await t}(await V.Tools);if(await Y.isSuccess){W=!0;var G={};G.host=await Y.host,G.username=await Y.username,G.password=await Y.password,G.project=await Y.project;var Q=["Bug"],q=await Y.customissuetype;if(void 0!==await q&&""!==await q){q=await q.toString().trim();var Z=await q.split(",");for(let a=0;a<await Z.length;a++)Q.push(await Z[a].toString().trim())}G.customissuetype=await Q,G.sprint=await F;var K=await n(await G);y.totaldefect=await K.totaldefect,y.defectprioritydata=await K.defectprioritydata,y.defectStatusData=await K.defectStatusData,y.defectCreationByUser=await K.defectCreationByUser}}var H="",_="",z="";if(1===await F.length?(H=await w+await s+"/"+await I+"/Manual/TestCaseDetails/**/"+await B+"/*.json",_=await w+await s+"/"+await I+"/Manual/DefectDetails/**/"+await B+"/*.json",z=await w+await s+"/"+await I+"/Manual/TestPlan/**/"+await B+"/*.json"):(H=await w+await s+"/"+await I+"/Manual/TestCaseDetails/**/{"+await B+"}/*.json",_=await w+await s+"/"+await I+"/Manual/DefectDetails/**/{"+await B+"}/*.json",z=await w+await s+"/"+await I+"/Manual/TestPlan/**/{"+await B+"}/*.json"),!await W){var $=await u.sync(await _);y.totaldefect=await $.length}var aa=await u.sync(await H);y.totaltestcase=await aa.length;var ta=await u.sync(await z);if(await ta.length>0)try{var ea=ta.map(a=>({file:a,createdDate:r.statSync(a).birthtime}));ea.sort((a,t)=>a.createdDate-t.createdDate);var ia=await ea.map(a=>a.file);ta=await ia}catch(a){console.log(await a)}if(y.totaltestplan=await ta.length,await ta.length>0){var ra=0,sa=0,na=0,wa=0,oa=0,ca=await ta[await ta.length-1].split("\\"),ua=await ca[await ca.length-1].replace(".json","");k.push(await ua);var la=await JSON.parse(await r.readFileSync(await ta[await ta.length-1],"utf8")),da=await la.AllTestCases;void 0===await da&&(da=[]),await da.length>0&&(m=await d(await m,await da)),y.totaltestcaseonlastexecution=await da.length;var pa=0;for(let a=0;a<await da.length;a++){var ma=await da[a].status,va=await da[a].component,ga=await da[a].executedBy;switch(await ma){case"Pass":pa=await Number(await pa)+1,ra=await Number(await ra)+1;break;case"Fail":sa=await Number(await sa)+1;break;case"Pending":na=await Number(await na)+1;break;case"NA":wa=await Number(await wa)+1;break;case"Blocked":oa=await Number(await oa)+1}void 0===await A[await ma]?A[await ma]=1:A[await ma]=await Number(A[await ma])+1,void 0===await P[await va]?(P[await va]={},P[await va][await ma]=1):(void 0===await P[await va][await ma]&&(P[await va][await ma]=0),P[await va][await ma]=await Number(P[await va][await ma])+1),void 0!==await ga&&""!==await ga.trim()&&(void 0===await O[await ga]?O[await ga]=1:O[await ga]=await Number(O[await ga])+1)}C[await ua]={},C[await ua].Pass=await ra,C[await ua].Fail=await sa,C[await ua].Pending=await na,C[await ua].NA=await wa,C[await ua].Blocked=await oa;var ha=await(100*await Number(await pa)/await da.length).toFixed(2);y.passpercentageinlastexecution=await ha;for(let a=0;a<await ta.length-1;a++){if(ra=0,sa=0,na=0,wa=0,oa=0,ca=await ta[a].split("\\"),ua=await ca[await ca.length-1].replace(".json",""),k.push(await ua),la=await JSON.parse(await r.readFileSync(await ta[a],"utf8")),da=await la.AllTestCases,await da.length>0&&(m=await d(await m,await da)),void 0!==await da)for(let a=0;a<await da.length;a++){switch(ma=await da[a].status,ga=await da[a].executedBy,va=await da[a].component,void 0===await A[await ma]?A[await ma]=1:A[await ma]=await Number(A[await ma])+1,void 0===await P[await va]?(P[await va]={},P[await va][await ma]=1):(void 0===await P[await va][await ma]&&(P[await va][await ma]=0),P[await va][await ma]=await Number(P[await va][await ma])+1),await ma){case"Pass":ra=await Number(await ra)+1;break;case"Fail":sa=await Number(await sa)+1;break;case"Pending":na=await Number(await na)+1;break;case"NA":wa=await Number(await wa)+1;break;case"Blocked":oa=await Number(await oa)+1}void 0!==await ga&&""!==await ga.trim()&&(void 0===await O[await ga]?O[await ga]=1:O[await ga]=await Number(O[await ga])+1)}C[await ua]={},C[await ua].Pass=await ra,C[await ua].Fail=await sa,C[await ua].Pending=await na,C[await ua].NA=await wa,C[await ua].Blocked=await oa}y.testPlanTotalTestData=await A,y.testCaseExecutedByUser=await O;var fa=[],ya=[],ba=[],Sa=[],xa=[],Ma=await Object.keys(await P);for(let a=0;a<await Ma.length;a++){var Na=await Ma[a];y.testPlanComponentPassFailXaxis.push(await Na);try{var Ta=await P[await Na].Pass;void 0!==await Ta&&NaN!==await Ta||(Ta=0)}catch(a){Ta=0}fa.push(await Ta);try{var Ea=await P[await Na].Fail;void 0!==await Ea&&NaN!==await Ea||(Ea=0)}catch(a){Ea=0}ya.push(await Ea);try{var Aa=await P[await Na].Pending;void 0!==await Aa&&NaN!==await Aa||(Aa=0)}catch(a){Aa=0}await ba.push(await Aa);try{var Pa=await P[await Na].NA;void 0!==await Pa&&NaN!==await Pa||(Pa=0)}catch(a){Pa=0}await Sa.push(await Pa);try{var Ca=await P[await Na].Blocked;void 0!==await Ca&&NaN!==await Ca||(Ca=0)}catch(a){Ca=0}await xa.push(await Ca)}y.testPlanComponentPassFailYaxis.push(await fa),y.testPlanComponentPassFailYaxis.push(await ya),y.testPlanComponentPassFailYaxis.push(await ba),y.testPlanComponentPassFailYaxis.push(await Sa),y.testPlanComponentPassFailYaxis.push(await xa),y.testPlanPassFailXaxis=await k,fa=[],ya=[],ba=[],Sa=[],xa=[],Ma=await Object.keys(await C);for(let a=0;a<await Ma.length;a++){Na=await Ma[a];try{Ta=await C[await Na].Pass,void 0!==await Ta&&NaN!==await Ta||(Ta=0)}catch(a){Ta=0}fa.push(await Ta);try{Ea=await C[await Na].Fail,void 0!==await Ea&&NaN!==await Ea||(Ea=0)}catch(a){Ea=0}ya.push(await Ea);try{Aa=await C[await Na].Pending,void 0!==await Aa&&NaN!==await Aa||(Aa=0)}catch(a){Aa=0}ba.push(await Aa);try{Pa=await C[await Na].NA,void 0!==await Pa&&NaN!==await Pa||(Pa=0)}catch(a){Pa=0}await Sa.push(await Pa);try{Ca=await C[await Na].Blocked,void 0!==await Ca&&NaN!==await Ca||(Ca=0)}catch(a){Ca=0}await xa.push(await Ca)}y.testPlanPassFailYaxis.push(await fa),y.testPlanPassFailYaxis.push(await ya),y.testPlanPassFailYaxis.push(await ba),y.testPlanPassFailYaxis.push(await Sa),y.testPlanPassFailYaxis.push(await xa)}var ka={};if(await aa.length>0){for(let a=0;a<await aa.length;a++){var ja=await JSON.parse(await r.readFileSync(await aa[a],"utf8")),Da=await ja.automationType,Oa=await ja.priority,Ia=(Na=await ja.placeHolder,await ja.createdBy);switch(await Da){case"Not Automated":b["Not Automated"]=Number(b["Not Automated"])+1;break;case"Automated":b.Automated=Number(b.Automated)+1;break;case"Not a right candidate":b["Not a right candidate"]=Number(b["Not a right candidate"])+1;break;case"N/A":b["N/A"]=Number(b["N/A"])+1;break;case"In Progress":b["In Progress"]=Number(b["In Progress"])+1}void 0===await S[await Oa]?S[await Oa]=1:S[await Oa]=Number(await S[await Oa])+1,void 0===await x[await Na]?x[await Na]=1:x[await Na]=await Number(x[await Na])+1,void 0===await j[await Ia]?j[await Ia]=1:j[await Ia]=await Number(await j[await Ia])+1;var La=await ja.testCaseCustomFields;if(void 0!==await La&&await La.length>0)for(l=0;l<await await La.length;l++){J=await La[l].key;var Fa=await La[l].value;""==await Fa&&(Fa="Value not given"),void 0===await ka[await J]?(ka[await J]={},ka[await J][await Fa]=1):void 0===ka[await J][await Fa]?ka[await J][await Fa]=1:ka[await J][await Fa]=Number(await ka[await J][await Fa])+1}}if(await v.length>0){var Ua=await Object.keys(await ka);if(await Ua.length>0)for(p=0;p<await Ua.length;p++)if(J=await Ua[p],await v.includes(await J)){var Va=await ka[await J],Ba=await Object.keys(await Va),Ra=[],Ja=[];for(let a=0;a<await Ba.length;a++){var Xa=await Ba[a];Ra.push(await Xa);var Wa=await Va[await Xa];Ja.push(await Wa)}var Ya={header:await J,labels:await Ra,yAxis:await Ja};h.push(await Ya)}}y.testCaseCustomFieldGraphData=await h,y.automatedgraphdata.push(await b.Automated),y.automatedgraphdata.push(await b["Not Automated"]),y.automatedgraphdata.push(await b["Not a right candidate"]),y.automatedgraphdata.push(await b["N/A"]),y.automatedgraphdata.push(await b["In Progress"]),y.testprioritydata=await S,y.componenttestcasedata=await x,y.testCaseCreationByUser=await j}var Ga={};if(!await W&&await $.length>0){for(let a=0;a<await $.length;a++){var Qa=await JSON.parse(await r.readFileSync(await $[a],"utf8")),qa=await Qa.priority,Za=(Na=await Qa.placeHolder,await Qa.status),Ka=(Ia=await Qa.createdBy,await Qa.severity);if(void 0===await M[await qa]?M[await qa]=1:M[await qa]=Number(await M[await qa])+1,void 0===await N[await Ka]?N[await Ka]=1:N[await Ka]=Number(await N[await Ka])+1,void 0===await T[await Na]?T[await Na]=1:T[await Na]=await Number(T[await Na])+1,void 0===await E[await Za]?E[await Za]=1:E[await Za]=await Number(E[await Za])+1,void 0===await D[await Ia]?D[await Ia]=1:D[await Ia]=await Number(await D[await Ia])+1,La=await Qa.customfields,void 0!==await La&&await La.length>0)for(l=0;l<await await La.length;l++)J=await La[l].key,Fa=await La[l].value,""==await Fa&&(Fa="Value not given"),void 0===await Ga[await J]?(Ga[await J]={},Ga[await J][await Fa]=1):void 0===Ga[await J][await Fa]?Ga[await J][await Fa]=1:Ga[await J][await Fa]=Number(await Ga[await J][await Fa])+1}if(await g.length>0&&(Ua=await Object.keys(await Ga),await Ua.length>0))for(p=0;p<await Ua.length;p++)if(J=await Ua[p],await g.includes(await J)){Va=await Ga[await J],Ba=await Object.keys(await Va),Ra=[],Ja=[];for(let a=0;a<await Ba.length;a++)Xa=await Ba[a],Ra.push(await Xa),Wa=await Va[await Xa],Ja.push(await Wa);Ya={header:await J,labels:await Ra,yAxis:await Ja},f.push(await Ya)}y.defectCustomFieldGraphData=await f,y.defectprioritydata=await M,y.defectseveritydata=await N,y.defectComponentData=await T,y.defectStatusData=await E,y.defectCreationByUser=await D}}catch(a){console.log(await a)}var Ha=await async function(a,t,e,i){var s=[],n={};try{if(await e.length>0&&await i.length>0)for(let s=0;s<await i.length;s++){var o=await i[s].status,c=await i[s].component,l=await i[s].testid,d=await w+await a+"/"+await t+"/Manual/TestCaseDetails/"+await c+"/**/"+await l+".json",p=await u.sync(await d);if(await p.length>0){var m=await JSON.parse(await r.readFileSync(await p[0],"utf8")),v=await m.testCaseCustomFields;void 0===await v&&(v=[])}else console.log("Test case is deleted from the server for component "+await c+" and Testid "+await l+", but still present in Test plan."),m={testCaseCustomFields:[]},v=[];for(let a=0;a<await e.length;a++){var g=await e[a],h="Not Provided";void 0===await n[await g]&&(n[await g]={},n[await g].labels=[]);for(let a=0;a<await v.length;a++){var f=await v[a].key;if(await f===await g){h=await v[a].value;try{void 0!==await h&&""!==await h.toString().trim()||(h="Not Provided")}catch(a){h="Not Provided"}break}}switch(await n[await g].labels.includes(await h)||await n[await g].labels.push(await h),void 0===await n[await g][await h]&&(n[await g][await h]={},n[await g][h].Pass=0,n[await g][h].Fail=0,n[await g][h].Pending=0,n[await g][h].NA=0,n[await g][h].Blocked=0),await o){case"Pass":n[await g][h].Pass=await Number(n[await g][h].Pass)+1;break;case"Fail":n[await g][h].Fail=await Number(n[await g][h].Fail)+1;break;case"Pending":n[await g][h].Pending=await Number(n[await g][h].Pending)+1;break;case"NA":n[await g][h].NA=await Number(n[await g][h].NA)+1;break;case"Blocked":n[await g][h].Blocked=await Number(n[await g][h].Blocked)+1}}}}catch(a){}try{var y=await Object.keys(await n);if(await y.length>0)for(let a=0;a<await y.length;a++){var b={header:"",labels:[],yAxis:[]},S=await y[a],x=await n[await S].labels;b.header=await S,b.labels=await x;var M=[],N=[],T=[],E=[],A=[],P=[];for(let a=0;a<await x.length;a++){var C=await x[a],k=await n[await S][await C];N.push(await k.Pass),T.push(await k.Fail),E.push(await k.Pending),A.push(await k.NA),P.push(await k.Blocked)}M.push(await N),M.push(await T),M.push(await E),M.push(await A),M.push(await P),b.yAxis=await M,s.push(await b)}}catch(a){}return await s}(await s,await I,await v,await m);y.TestPlanCustomFieldExecutionGraphData=await Ha,t.json(y)}),a.exports=s},7455:(a,t,e)=>{var i=e(6560);const r=e(8938);a.exports={getSprintDefectDetails:async function(a){var t={isSuccess:!1,errorMessage:"",totaldefect:0,defectprioritydata:[],defectStatusData:[],alldefectidwithtitle:[],defectCreationByUser:[]};try{var e=await a.host,s=await a.username,n=await a.password,w=await a.project,o=await a.sprint,c=await a.customissuetype;if(void 0===await c&&(c=["Bug"]),void 0===await e||""===await e)return t.errorMessage="host key is missing.",t;if(void 0===await s||""===await s)return t.errorMessage="username key is missing.",t;if(void 0===await n||""===await n)return t.errorMessage="password key is missing.",t;if(void 0===await w||""===await w)return t.errorMessage="project key is missing.",t;if(void 0===await o||0===await o.length)return t.errorMessage="Sprintis missing.",t;var u=await new i({protocol:"https",host:await e,username:await s,password:await n,apiVersion:"3",strictSSL:!0}),l=await async function(a,t){try{const e=await a.getAllBoards({projectKeyOrId:t});return e.values&&0!==e.values.length?e.values[0].id:""}catch(a){return""}}(await u,await w),d=await u.getAllSprints(l),p=!1,m=await d.values.map(a=>a.name);for(let a=0;a<await o.length;a++){var v=await o[a];for(let a=0;a<await m.length;a++){var g=await m[a];if(await g===await v){p=!0;break}}if(await p)break}var h=await d.values.filter(a=>"active"===a.state).map(a=>a.name);0===await o.length?o=await h:await p||(o=await h);const M=await c.map(a=>`"${a}"`).join(", ");var f={},y={},b={},S=[],x=0;for(const a of o)try{const t=`project = "${w}" AND issuetype IN (${M}) AND Sprint = "${a}"`,i=(await r.post(`https://${e}/rest/api/3/search/jql`,{jql:t,maxResults:1e3,fields:["summary","status","priority","description","creator"]},{headers:{Authorization:`Basic ${Buffer.from(`${s}:${n}`).toString("base64")}`,Accept:"application/json","Content-Type":"application/json"}})).data;if(0===i.issues.length){console.log(`⚠️ No issues found for Sprint: ${a}`);continue}x=Number(i.issues.length)+await x;for(const a of i.issues){let t=a.key,e=a.fields.status?.name||"Unknown",i=a.fields.priority?.name||"Unknown",r=a.fields.summary||"No description",s=a.fields.description||"No description",n=a.fields.creator.displayName||"No description";void 0!==await s.content&&(s=await s.content,s=await s[0].content[0].text),f[i]=(f[i]||0)+1,y[e]=(y[e]||0)+1,b[n]=(b[n]||0)+1,S.push({defectid:t,title:r,description:await s,createdBy:await n})}}catch(t){console.error(`⚠️ Error fetching Sprint '${a}': ${t.message}`);continue}t.totaldefect=await x,t.defectprioritydata=await f,t.defectStatusData=await y,t.alldefectidwithtitle=await S,t.defectCreationByUser=await b}catch(a){t.errorMessage=a.toString()}return t},getallIssueDetails:async function(a){let t={isSuccess:!1,errorMessage:"",defectprioritydata:{},defectStatusData:{}};try{let{host:e,username:r,password:s,project:n,allissues:w}=a;if(!e)return t.errorMessage="Host key is missing.",t;if(!r)return t.errorMessage="Username key is missing.",t;if(!s)return t.errorMessage="Password key is missing.",t;if(!n)return t.errorMessage="Project key is missing.",t;if(!w||!Array.isArray(w)||0===w.length)return t.errorMessage="Issue keys list is missing or empty.",t;let o=new i({protocol:"https",host:e,username:r,password:s,apiVersion:"3",strictSSL:!0});const c=`key IN (${w.map(a=>`"${a}"`).join(",")})`,u=await o.searchJira(c,{maxResults:w.length});if(0===u.issues.length)return t.errorMessage="No issues found.",t;for(const a of u.issues){let e=a.fields.status?.name||"Unknown",i=a.fields.priority?.name||"Unknown";t.defectprioritydata[i]=(t.defectprioritydata[i]||0)+1,t.defectStatusData[e]=(t.defectStatusData[e]||0)+1}t.isSuccess=!0}catch(a){t.errorMessage=a.toString()}return t}}},7565:(a,t,e)=>{const i=e(7252),r=e(9896),{readdir:s}=e(9896).promises,n=i.Router(),{saveFile:w,isDirectoryExist:o,createDirectory:c,deleteFile:u,isSpaceFreeOnAccount:l}=e(7229);var d="./dataHub/",p="./dataHub/";const{authCheck:m}=e(2258),{getPastDate:v,getMostRecentFile:g}=e(7229),h=e(2410),f=e(4716),{get:y}=e(382),b=e(3618),{getSprintDefectDetails:S}=e(7455),x=e(8938);async function M(a){const t=await b(await a);return await t.match("#Noun").out("array")}async function N(a){const t=await b(await a);return await t.match("#Pronoun").out("array")}async function T(a,t){if(0===await t.length)return await a;for(let i=0;i<await t.length;i++){var e=await t[i];if(await a.includes(await e)){const t=await a.indexOf(await e);await t>-1&&await a.splice(t,1)}}return await a}async function E(a){var t=[],e=[];try{var i=await async function(a){try{var t=[];return t=await a.split("\n"),1===await t.length&&(await t[0].toLocaleLowerCase().includes("not")||await t[0].toLocaleLowerCase().includes("n/a"))?[]:await t}catch(a){}return await t}(await a);if(await i.length>0)for(let a=0;a<await i.length;a++){var r=await i[a].toString().toLocaleLowerCase();r=await r.toString().replace("fields",""),r=await r.toString().replace("combinations",""),r=await r.toString().replace("combination","");var s=await r;if(await r.includes(":")){s=await r.split(":")[0].trim();var n=await r.split(":")[1].trim();e.push(await n)}else await r.includes("-")&&(s=await r.split("-")[0].trim(),n=await r.split("-")[1].trim(),e.push(await n));const l=await s.match(/[a-zA-Z]+/g);s=await l?await l.join(" "):"";var w=await M(await s),o=await N(await s),c=await T(await w,o);for(let a=0;a<await c.length;a++){var u=await c[a].toString().toUpperCase().trim();const e=await u.match(/[a-zA-Z]+/g);u=await e?await e.join(" "):"",await t.includes(await u)||t.push(await u)}}}catch(a){}return await{output:t,valuedata:e}}async function A(a){try{return await a.toString().includes("[")||await a.toString().includes("]")?a.replace(/[\[\]]/g,"*"):await a}catch(t){return await a}}async function P(a,t,e){try{let i=await a.filter(a=>!(a.testid===t&&a.component===e));return i=await i.map((a,t)=>({...a,id:t+1})),i}catch(a){return[]}}n.post("/project/:projectName/addnewtesttree",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage,n=await a.headers.accountlabel,u={isFileSaved:!1,errorMessage:"",testTreeData:""};try{var p=a.params.projectName,v=await l(await n,await p,await s);if(!await v.isSuccess)return u.errorMessage=await v.errorMessage,t.json(u);var g=await o(await n+"+"/await p+"/Manual");await g||await c(await n+"/"+await p+"/Manual");var h=[];try{var f=await d+await n+"/"+await p+"/Manual/PlaceHolderTree.json";h=await JSON.parse(await r.readFileSync(await f,"utf8"))}catch(a){}try{await h.includes(null)&&(h=await h.filter(a=>null!==a))}catch(a){}var y=await a.body.newPlaceHolderName.toString().trim();if(""===await y)u.errorMessage="Placeholder name can not be blank.";else{var b=!1,S=await h,x=await a.body.relativePath.toString().trim(),M=await y,N=await x.split("/"),T=[];for(let a=1;a<await N.length;a++){var E=await N[a];for(let a=0;a<await S.length;a++){var A=await S[a].key;if(await A.toLowerCase().trim()===E.toLocaleLowerCase().trim()){S=await S[a].nodes,T.push(await a);break}}}for(let a=0;a<await S.length;a++)if(await M.toLowerCase().trim()===await S[a].key.toLowerCase().trim()){b=!0;break}if(await b)u.errorMessage="Placeholder "+await M+" is already exist on server.";else{var P={key:await y,label:await y,nodes:[]};S.push(await P);var C=await h;for(let a=0;a<await T.length;a++){var k=await T[a];C[await k]=await h[await k]}var j=await C;await w(await n+"/"+await p+"/Manual/PlaceHolderTree.json",await j),u.isFileSaved=!0;try{f=await d+await n+"/"+await p+"/Manual/PlaceHolderTree.json",h=await JSON.parse(await r.readFileSync(await f,"utf8"))}catch(a){}var D=[{key:await p,label:await p,nodes:await h}];u.testTreeData=await D}}}catch(a){u.errorMessage=a.toString()}t.json(u)}),n.post("/project/:projectName/createnewtestcase",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage,n=await a.headers.accountlabel,u={isFileSaved:!1,errorMessage:"",testId:""};try{var p=await a.params.projectName,v=await l(await n,await p,await s);if(!await v.isSuccess)return u.errorMessage=await v.errorMessage,t.json(u);var g=await a.body,h=await g.placeHolder.trim();if(await h.includes(":")||await h.includes("|")||await h.includes("*")||await h.includes('"')||await h.includes("<"))return u.errorMessage='Component name should not have following special characters (:,*,?,">,<)',t.json(u);var y=await g.testCycle.trim(),b=await g.createdBy;h=await h+"/"+await y;var S=await g.testCaseName;S=await S.toString().trim(),g.testCaseName=await S;var x=await o(await n+"/"+await p+"/Manual/TestCaseDetails/"+await h);await x||await c(await n+"/"+await p+"/Manual/TestCaseDetails/"+await h);var M={};try{var N=await d+await n+"/"+await p+"/Manual/NewTestId.json";M=await JSON.parse(await r.readFileSync(await N,"utf8"))}catch(a){M={}}g.History=[{id:1,history:"Test Case Created.",by:await b,timestamp:await f().format()}],g.Comments=[];var T="QB-"+Number(await Object.keys(await M).length+1);await w(await n+"/"+await p+"/Manual/TestCaseDetails/"+await h+"/"+await T+".json",await g),u.isFileSaved=!0,M[await T]=await b,await w(await n+"/"+await p+"/Manual/NewTestId.json",await M),u.testId=await T}catch(a){u.errorMessage=a.toString()}t.json(u)}),n.post("/project/:projectName/gettestcase",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var s=[],n=await a.headers.accountlabel,w=await a.body.componentPath.trim(),o=await a.params.projectName,c=await n+"/"+await o+"/Manual/TestCaseDetails/",u="",l=await w.split("/");for(let a=1;a<await l.length;a++)u=await u+"/"+await l[a];await u.includes("/")&&(u=await u.substring(1));var d=1;c=await c+await u;var v=await p+await c;v=await A(v);var g=await h.sync(await v+"/**/*.json");for(let a=0;a<await g.length;a++){var f=await g[a].split("\\"),y=await f[await f.length-1],b=await JSON.parse(await r.readFileSync(await g[a],"utf8")),S=await b.testCaseCustomFields;void 0===await S&&(S=[]);var x={id:await d,testId:await y.replace(".json",""),testname:await b.testCaseName,component:await b.placeHolder,priority:await b.priority,type:await b.testingType,automationtype:await b.automationType,cycle:await b.testCycle,reference:await b.references,createdby:await b.createdBy};for(let a=0;a<await S.length;a++){var M=await S[a].key,N=await S[a].value;x[await M]=await N}s.push(await x),d=Number(await d)+1}}catch(a){}t.json(await s)}),n.post("/project/:projectName/addtestcomment",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage,n={isFileSaved:!1,errorMessage:""};try{var o=await a.params.projectName,c=await a.headers.accountlabel,u=await l(await c,await o,await s);if(!await u.isSuccess)return n.errorMessage=await u.errorMessage,t.json(n);var p=await a.body,v=await p.testPath.trim(),g=await p.testComment,h=await a.headers.useremail,y=await c+"/"+await o+"/Manual/TestCaseDetails/"+v+".json",b={};try{var S=await d+await c+"/"+await y;b=await JSON.parse(await r.readFileSync(await S,"utf8"));var x=await b.Comments;void 0===await x&&(x=[]);var M={id:Number(await x.length)+1,comment:await g,by:await h,timestamp:await f().format()};x.push(await M),b.Comments=await x,await w(await y,await b),n.isFileSaved=!0}catch(a){n.errorMessage=a.toString()}}catch(a){n.errorMessage=a.toString()}t.json(n)}),n.post("/project/:projectName/updatetestcase",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage,n={isFileSaved:!1,errorMessage:""},u=!1;istestCycleSame=!0;var p={};try{var v=await a.params.projectName,g=await a.headers.accountlabel,y=await l(await g,await v,await s);if(!await y.isSuccess)return n.errorMessage=await y.errorMessage,t.json(n);var b=!1,S=(p=await a.body,await a.headers.useremail),x=await p.testPath.trim();try{var M=await x.toString().split("/"),N="";for(let a=0;a<await M.length;a++)N=await N+"/"+await M[a].toString().trim();N=await N.substring(1),x=await N}catch(a){}var T=await p.testcaseNewCycle;void 0!==await T&&""!==await T&&""!==await T.toString().trim()&&(u=!0);var E=await g+"/"+await v+"/Manual/TestCaseDetails/"+x+".json";try{var A=await d+await E;testInfo=await JSON.parse(await r.readFileSync(await A,"utf8"));var P=await p.history,C="";await p.testCaseName.toString().trim()!==await testInfo.testCaseName.toString().trim()&&(C="Title ("+await await testInfo.testCaseName+"->"+await await p.testCaseName+").",b=!0),await p.priority!==await testInfo.priority&&(C=C+"Priority ("+await await testInfo.priority+"->"+await await p.priority+")."),await p.testingType!==await testInfo.testingType&&(C=C+"Type ("+await await testInfo.testingType+"->"+await await p.testingType+")."),await p.automationType!==await testInfo.automationType&&(C=C+"Automation type ("+await await testInfo.automationType+"->"+await await p.automationType+")."),await p.references!==await testInfo.references&&(C=C+"References ("+await await testInfo.references+"->"+await await p.references+")."),await p.testPrecondition!==await testInfo.testPrecondition&&(C=C+"Preconditions ("+await await testInfo.testPrecondition+"->"+await await p.testPrecondition+")."),await p.testcaseData!==await testInfo.testcaseData&&(C=C+"Test data ("+await await testInfo.testcaseData+"->"+await await p.testcaseData+")."),await p.testObjective!==await testInfo.testObjective&&(C=C+"Objective ("+await await testInfo.testObjective+"->"+await await p.testObjective+")."),await u&&await T!==await testInfo.testCycle&&(istestCycleSame=!1,C=C+"Test Cycle ("+await await testInfo.testCycle+"->"+await await T+").");try{if(await JSON.stringify(await p.testCaseCustomFields)!==await JSON.stringify(await testInfo.testCaseCustomFields))for(let a=0;a<await p.testCaseCustomFields.length;a++){var k=!1,j=await p.testCaseCustomFields[a].key,D=await p.testCaseCustomFields[a].value;for(let a=0;a<await testInfo.testCaseCustomFields.length;a++){var O=await testInfo.testCaseCustomFields[a].key;if(await O===await j){k=!0;var I=await testInfo.testCaseCustomFields[a].value;await D!==await I&&(C=C+j+" ("+await I+"->"+await D+").");break}}await k||(C=C+j+" (Not exist->"+await D+").")}}catch(a){}await p.expectedStepStyle!==await testInfo.expectedStepStyle?C+="Expected Result option field is updated with test step.":await P.includes("Steps")&&(C+="Manual Test Step"),await P.includes("Attachment")&&(C+="Attachment.");var L="";""!==await C&&(L="Test Case "+await C+" fields updated.");var F=await testInfo.testCaseName;testInfo.testCaseName=await p.testCaseName,testInfo.priority=await p.priority,testInfo.testingType=await p.testingType,testInfo.automationType=await p.automationType,testInfo.references=await p.references,testInfo.testPrecondition=await p.testPrecondition,testInfo.testcaseData=await p.testcaseData,testInfo.testSteps=await p.testSteps,testInfo.testExpectedResult=await p.testExpectedResult,testInfo.testObjective=await p.testObjective,testInfo.testCaseCustomFields=await p.testCaseCustomFields,testInfo.attachment=await p.attachment,testInfo.expectedStepStyle=await p.expectedStepStyle,await u&&(await istestCycleSame||(testInfo.testCycle=await T));var U=await p.testStepWithExpectedResult;void 0===await U&&(U=[]),testInfo.testStepWithExpectedResult=await U;var V=await testInfo.History;if(void 0===await V&&(V=[]),""!=await L){var B={id:Number(await V.length)+1,history:await L,by:await S,timestamp:await f().format()};V.push(await B)}if(testInfo.History=await V,await w(await E,await testInfo),await b&&await async function(a,t,e,i,s){try{var n=await d+await a+"/"+await t+"/Manual/TestSuite/*.json",o=await h.sync(await n);if(await o.length>0)for(let a=0;a<await o.length;a++){var c=await JSON.parse(await r.readFileSync(await o[a],"utf8"));if(await JSON.stringify(await c).includes(await i)){var u=await c.AllTestCases;for(let t=0;t<await u.length;t++){var l=await u[t].component,p=await u[t].testname;if(await l===await e&&await p===await i){u[t].testname=await s,c.AllTestCases=await u;var m=await await o[a];m=await m.split("\\").slice(1).join("\\"),await w(await m,await c);break}}}}}catch(a){console.log(await a.toString())}}(await g,await v,await testInfo.placeHolder,await F,await p.testCaseName.toString().trim()),await u&&!await istestCycleSame){var R=await x.split("/")[await x.split("/").length-1];const a=await x.split("/")[await x.split("/").length-2];var J=await x.replace("/"+await a+"/","/"+await T+"/"),X=await J.split("/").slice(0,-1).join("/"),W=await g+"/"+await v+"/Manual/TestCaseDetails/"+await X;await o(await W)||await c(await W),await r.renameSync(await d+await E,await d+await W+"/"+await R+".json")}n.isFileSaved=!0}catch(a){n.errorMessage=a.toString()}}catch(a){n.errorMessage=a.toString()}t.json(n)}),n.post("/project/:projectName/gettestiddetails",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={};try{var n=await a.params.projectName,w=(s=await a.body,await s.testPath.trim()),o=await a.headers.accountlabel;try{var c=await w.toString().split("/"),u="";for(let a=0;a<await c.length;a++)u=await u+"/"+await c[a].toString().trim();u=await u.substring(1),w=await u}catch(a){}var l=await o+"/"+await n+"/Manual/TestCaseDetails/"+w+".json";try{var p=await d+await l;s=await JSON.parse(await r.readFileSync(await p,"utf8"))}catch(a){s={}}}catch(a){s={}}t.json(s)}),n.post("/project/:projectName/deletetestcase",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={isFileDeleted:!1,errorMessage:""};try{var n=await a.headers.accountlabel,o=await a.params.projectName,c=await a.body,l=await c.testPath.trim(),p=await c.testId.trim(),v=await a.headers.useremail,g=await n+"/"+await o+"/Manual/TestCaseDetails/"+l+".json";try{var f=await g;await u(await f),s.isFileDeleted=!0;var y={};try{f=await d+await n+"/"+await o+"/Manual/DeletedTestId.json",y=await JSON.parse(await r.readFileSync(await f,"utf8"))}catch(a){y={}}f=await n+"/"+await o+"/Manual/DeletedTestId.json",y[await p]=await v,await w(await f,await y);var b=await c.component;await async function(a,t,e,i){try{var s=await d+await a+"/"+await t+"/Manual/TestSuite/*.json",n=await h.sync(await s);if(await n.length>0)for(let a=0;a<await n.length;a++){var o=await JSON.parse(await r.readFileSync(await n[a],"utf8"));if(await JSON.stringify(await o).includes(await i)){var c=await o.AllTestCases;for(let t=0;t<await c.length;t++){var u=await c[t].component,l=await c[t].testid;if(await u===await e&&await l===await i){var p=await P(await c,await i,await e);o.AllTestCases=await p;var m=await await n[a];m=await m.split("\\").slice(1).join("\\"),await w(await m,await o);break}}}}}catch(a){console.log(await a.toString())}}(await n,await o,await b,await p),s.isFileDeleted=!0}catch(a){s.errorMessage=a.toString()}}catch(a){s.errorMessage=a.toString()}t.json(s)}),n.post("/project/:projectName/getautomationsteps",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={component:"",testId:"",testName:"",listOfTestSteps:[],dependentCustomFunction:[],testDataTableHeader:[],listOfTestScriptData:[],manualTestSteps:""};try{var n=await a.headers.accountlabel,w=await a.params.projectName,o=await a.body,c=await o.placeHolder.trim(),u=await o.testId.trim();s.testId=await u;var l=await p+await n+"/"+w+"/Web/TestScripts/**/"+await u+"@*.json";l=await A(l);var v=await h.sync(await l);if(0==await v.length){var g=await c.split("/");s.testName=await o.testName,s.component=await g[await g.length-3];var f=await o.testSteps,y=await o.testExpectedResult;void 0!==await y&&""!==await y.toString().trim()&&(f=await f+" \n"+await y),s.manualTestSteps=await f;var b=await o.testdata;if(""!==await b.toString().trim()&&void 0!==await b){var S=await async function(a){var t=[],e=[],i={};try{var r=(await E(await a)).output,s=(await E(await a)).valuedata;if(await r.length>0){var n={dataField:"id",text:"#",headerStyle:{width:"20px"}};t.push(await n);for(let a=0;a<await r.length;a++){var w=await r[a].toString().toUpperCase();(n={}).dataField=await w,n.text=await w,n.headerStyle={},n.headerStyle.width="150px",t.push(await n),await s.length>0&&(i.id=1,i[await w]=await s[a])}await s.length>0&&e.push(await i)}}catch(a){}return await{columnNeedToSend:t,columnValueNeedToSend:e}}(await b);await S.columnNeedToSend.length>1&&(s.testDataTableHeader=await S.columnNeedToSend,await S.columnValueNeedToSend.length>0&&(s.listOfTestScriptData=await S.columnValueNeedToSend))}var x=await o.testPrecondition;const a=await x.match(/[a-zA-Z0-9._,]+/g);if(x=await a?await a.join(" "):"",""!==await x.toString().trim()&&void 0!==x){var M={id:1,customfunction:await x,parameter:""};try{var N=await d+await n+"/"+await w+"/Web/CustomPageFunction/Page/"+await x+".json",T=(await JSON.parse(await r.readFileSync(await N,"utf8"))).argumentlist;void 0!==await T&&""!==await T&&(M.parameter=await JSON.stringify(await T))}catch(a){}s.dependentCustomFunction.push(await M)}}else{var P=await v[0];g=await P.split("\\"),s.testName=await g[await g.length-1].split("@")[1].replace(".json",""),s.component=await g[await g.length-2];var C=await JSON.parse(await r.readFileSync(await P,"utf8"));s.listOfTestSteps=await C.allsteps,s.dependentCustomFunction=await C.dependentpage,s.testDataTableHeader=await C.testdatacolumn,s.listOfTestScriptData=await C.testdataset}}catch(a){}t.json(s)}),n.post("/project/:projectName/getalltestid",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var r=await a.headers.accountlabel,s=[],n=await a.body.componentPath.trim(),w=await a.params.projectName,o=await r+"/"+await w+"/Manual/TestCaseDetails/",c="",u=await n.split("/");for(let a=1;a<await u.length;a++)c=await c+"/"+await u[a];await c.includes("/")&&(c=await c.substring(1)),o=await o+await c;var l=await p+await o;l=await A(l);var d=await h.sync(await l+"/**/*.json");for(let a=0;a<await d.length;a++){var v=await d[a].split("\\"),g=await v[await v.length-1].replace(".json",""),f={value:await g,label:await g};s.push(await f)}}catch(a){console.log(await a)}t.json(await s)}),n.post("/project/:projectName/gettestdetailsbasedonid",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={};try{var n=await a.headers.accountlabel,w=await a.params.projectName,o=(s=await a.body,await s.parent),c=await s.testid,u=await d+await n+"/"+await w+"/Manual/TestCaseDetails/**/"+await o+"/**/"+await c+".json";u=await A(u);var l=await h.sync(await u);try{await l.length>0&&(s=await JSON.parse(await r.readFileSync(await l[0],"utf8")))}catch(a){s={}}}catch(a){s={}}t.json(s)}),n.post("/project/:projectName/generateaimanualtestcases",async(a,t)=>{var e={isSuccess:!1,errorMessage:"",ListOfBasicTestCaseDetails:[],ListOfTestCaseStepDetails:{}},i=await m(await a);if(!await i.isSuccess)return e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var r=await a.params.projectName;if(await a.headers.accountlabel,void 0===await r)return e.errorMessage="Project name can not be blank.",t.json(await e);if(""===await r.toString().trim())return e.errorMessage="Project name can not be blank.",t.json(await e);var s=await a.body.aitoolname;if(void 0===await s)return e.errorMessage="Tool name can not be blank.",t.json(await e);if(""===await s.toString().trim())return e.errorMessage="Tool name can not be blank.",t.json(await e);var n=await a.body.aitotken;if(void 0===await n)return e.errorMessage="Token name can not be blank.",t.json(await e);if(""===await n.toString().trim())return e.errorMessage="Token name can not be blank.",t.json(await e);var w=await a.body.userinput;if(void 0===await w)return e.errorMessage="User Input can not be blank.",t.json(await e);if(""===await w.toString().trim())return e.errorMessage="User input can not be blank.",t.json(await e);var o=await a.body.expectedresultstyle;if(void 0===await o)return e.errorMessage="Expected Result option can not be blank.",t.json(await e);if(!await["At the end of step","At the each step"].includes(await o))return e.errorMessage="Expected Result option is invalid.",t.json(await e);if(w=await w.toString().trim(),"chatGPT"!==await s)return e.errorMessage="QAautoMATER is as of now integrated with chatGPT only.",t.json(await e);e=await async function(a,t,e){try{var i={isSuccess:!1,errorMessage:"",ListOfBasicTestCaseDetails:[],ListOfTestCaseStepDetails:[]};const r=`\n    Please analyze the following statement and generate at least 5 comprehensive positive, negative, and edge manual test cases. If the scenario can have more than 10 test cases, please provide all relevant test cases. Each test case should include:\n  \n    1. \`testcaseName\`: The name of the test case without any prefix and suffix like "Test Case 1".\n    2. \`Precondition\`: The generic precondition describing the page or context where the test steps are executed (e.g., "User is on the Home page", "User is on the Payment page"). Ensure the precondition is consistent across all test cases.\n    3. \`testdata\`: The data required to execute the test case.\n    4. \`teststep\`: An array of steps to execute the test case. Each step should include an \`expectedresult\` field with the expected outcome for that step. Do not prefix the steps with numbers like "Step 1".\n    5. \`priority\`: The priority of the test case. Assign values as Low, Medium, or High based on the importance of the test case.\n    6. \`objective\`: The objective or purpose of the test case (e.g., "Verify that the user can log in successfully", "Ensure the payment gateway processes transactions correctly").\n  \n    Return the output as a valid JSON object only. The JSON output should have the following format:\n    \`\`\`json\n    [\n      {\n        "testcaseName": "Test Case Name without any prefix",\n        "precondition": "Generic precondition describing the page or context where test steps are executed",\n        "testdata": "Test data to be used",\n        "teststep": [\n          { "step": "Action to perform", "expectedresult": "Expected result" },\n          { "step": "Next action to perform", "expectedresult": "Expected result" },\n          ...\n        ],\n        "priority": "Low/Medium/High",\n        "objective": "Objective or purpose of the test case"\n      }\n    ]\n    \`\`\`\n  \n    Do not include any text outside the JSON object. If you cannot generate test cases, respond with a JSON object containing an "error" key and a descriptive message.\n    \n    Statement: "${a}"\n  `,s="https://api.openai.com/v1/chat/completions",n=(await x.post(s,{model:"gpt-4",messages:[{role:"user",content:r}],max_tokens:1500,temperature:.5},{headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}})).data.choices[0].message.content.trim();let w;try{w=JSON.parse(n)}catch(a){const t=n.match(/\{[^]*\}/);if(!t)return i.errorMessage="The response from ChatGPT is not in the expected JSON format.",i;w=JSON.parse(t[0])}if(!Array.isArray(w)||0===w.length)return i.errorMessage="User input is not sufficient for creating manual test cases. Please provide a more detailed statement.",i;i.isSuccess=!0;const o=await async function(a,t){var e={BasicDetails:[],TestStepDetails:{}},i=[],r={};for(let e=0;e<await a.length;e++){var s={},n=await Number(e)+1;r[await n]=[],(s={id:n,name:"",objective:"",priority:"",precondition:"",testdata:""}).name=await a[e].testcaseName,s.objective=await a[e].objective,s.priority=await a[e].priority,s.precondition=await a[e].precondition,s.testdata=await a[e].testdata,i.push(await s);var w=await a[e].teststep,o=[];for(let a=0;a<await w.length;a++){var c=await Number(a)+1,u={};(u={id:await c,step:"",expectedresult:""}).step=await w[a].step,"At the end of step"===await t?a===await w.length-1?u.expectedresult=await w[a].expectedresult:u.expectedresult="":u.expectedresult=await w[a].expectedresult,o.push(await u)}r[await n]=await o}return e.BasicDetails=await i,e.TestStepDetails=await r,await e}(w,e);return i.ListOfBasicTestCaseDetails=o.BasicDetails,i.ListOfTestCaseStepDetails=o.TestStepDetails,i.errorMessage=`${w.length} manual test cases were generated by the AI engine.`,i}catch(a){return console.error("Error communicating with ChatGPT:",a.response?a.response.data:a.message),i.errorMessage=a.response?JSON.stringify(a.response.data):a.message,i}}(await w,await n,await o)}catch(a){e.errorMessage=await a.toString()}t.json(e)}),n.post("/project/:projectName/getsprinttasks",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isSuccess:!1,errorMessage:"",alldefectidwithtitle:[]};try{var s=await a.body;(r=await S(await s)).isSuccess=!0}catch(a){r.errorMessage=await a.toString()}t.json(r)}),n.post("/project/:projectName/getdetailsbasedonid",async(a,t)=>{var e={},i=await m(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={};try{var n=await a.params.projectName,w=(s=await a.body,await s.testid),o=await a.headers.accountlabel;try{var c=await d+await o+"/"+n+"/Manual/TestCaseDetails/**/**/"+await w+".json",u=await h.sync(await c);await u.length>0&&(s=await JSON.parse(await r.readFileSync(await u[0],"utf8")))}catch(a){}}catch(a){s={}}t.json(s)}),n.post("/project/:projectName/performbulkaction",async(a,t)=>{var e={isSuccess:!1,errorMessage:""},i=await m(await a);if(!await i.isSuccess)return e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var s=await a.headers.useremail,n=await a.params.projectName,u=await a.headers.accountlabel;if(void 0===await n)return e.errorMessage="Project name can not be blank.",t.json(await e);if(""===await n.toString().trim())return e.errorMessage="Project name can not be blank.",t.json(await e);var l=await a.body.testAttributeName;if(void 0===await l)return e.errorMessage="Test Attribute Name can not be undefined.",t.json(await e);if(""===await l.toString().trim())return e.errorMessage="Test Attribute Name can not be blank.",t.json(await e);switch(await l){case"Priority":case"Automation Status":case"Cycle":break;default:return e.errorMessage="Invalid Test Attribute Name",t.json(await e)}var p=await a.body.testAttributValue;if(void 0===await p)return e.errorMessage="Attribute value can not be blank.",t.json(await e);if(""===await p.toString().trim())return e.errorMessage="Attribute value can not be blank.",t.json(await e);var v=await a.body.listOfTestCases;if(void 0===await v)return e.errorMessage="Test Cases are invalid.",t.json(await e);if(0===await v.length)return e.errorMessage="There is no test case provided.",t.json(await e);var g=await d+await u+"/"+await n+"/Manual/TestCaseDetails/";for(let a=0;a<await v.length;a++){var h="",y=await u+"/"+await n+"/Manual/TestCaseDetails/",b=!1,S=await v[a],x=await S.component,M=await S.cycle,N=await S.testId,T=await g+await x+"/"+await M+"/"+await N+".json",E=await y+await x+"/"+await M+"/"+await N+".json",A=await JSON.parse(await r.readFileSync(await T,"utf8")),P=await A.History;void 0===await P&&(P=[]);var C="";switch(await l){case"Priority":var k=A.priority;A.priority=await p,C="Priority ("+await k+"->"+await p+").";break;case"Automation Status":var j=A.automationType;A.automationType=await p,C="Automation Status ("+await j+"->"+await p+").";break;case"Cycle":var D=await A.testCycle;A.testCycle=await p,C="Test Cycle ("+await D+"->"+await p+").",b=!0,h=await y+await x+"/"+await p}var O="";if(""!==await C&&(O="Test Case "+await C+" fields updated."),""!=await O){var I={id:Number(await P.length)+1,history:await O,by:await s,timestamp:await f().format()};P.push(await I)}if(A.History=await P,await w(await E,await A),await b){var L=await o(await h);await L||await c(await h),await r.renameSync(await T,await d+await h+"/"+await N+".json")}}e.isSuccess=!0}catch(a){e.errorMessage=await a.toString()}t.json(e)}),a.exports=n},7576:(a,t,e)=>{const i=e(7252).Router();var r="./dataHub/";const{authCheck:s}=e(2258),{deleteFile:n,createDirectory:w,isSpaceFreeOnAccount:o}=e(7229),c=e(9896),u=e(2410);i.post("/project/:projectName",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var c=await i.totalStorage,u=await a.headers.accountlabel,l={isSuccess:!1,errorMessage:"",fileName:""};try{var d=await a.params.projectName,p=await o(await u,await d,await c);if(!await p.isSuccess)return l.errorMessage=await p.errorMessage,t.json(l);let e;await a.files&&0!==await Object.keys(await a.files).length||(l.isSuccess=!1,l.errorMessage="No file selected."),e=await a.files.file,(await e.name.includes(".bat")||await e.name.includes(".exe")||await e.name.includes(".ps"))&&(l.isSuccess=!1,l.errorMessage="File is not supported for upload.");var m=await r+await u+"/"+await d+"/Web/Uploads/"+await e.name;w(await u+"/"+await d+"/Web/Uploads/"),await n(await m),await e.mv(await m,function(a){a?(l.errorMessage=a,l.isSuccess=!1):l.isSuccess=!1}),l.fileName=await e.name,l.isSuccess=!0}catch(a){l.errorMessage=await a}t.json(l)}),i.post("/project/:projectName/env/:envName",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var c=await i.totalStorage,u=await a.headers.accountlabel,l={isSuccess:!1,errorMessage:"",fileName:""};try{var d=await a.params.projectName,p=await o(await u,await d,await c);if(!await p.isSuccess)return l.errorMessage=await p.errorMessage,t.json(l);var m=await a.params.envName;let e;""===await m.toString().trim()&&(l.isSuccess=!1,l.errorMessage="Environment can not be blank."),m=await m.toString().toUpperCase(),await a.files&&0!==await Object.keys(await a.files).length||(l.isSuccess=!1,l.errorMessage="No file selected."),e=await a.files.file,(await e.name.includes(".bat")||await e.name.includes(".exe")||await e.name.includes(".ps"))&&(l.isSuccess=!1,l.errorMessage="File is not supported for upload.");var v=await r+await u+"/"+await d+"/Mobile/Downloads/"+await m+"/"+await e.name;w(await u+"/"+await d+"/Mobile/Downloads/"+await m),await n(await v),await e.mv(await v,function(a){a?(l.errorMessage=a,l.isSuccess=!1):l.isSuccess=!1}),l.fileName=await e.name,l.isSuccess=!0}catch(a){l.errorMessage=await a}t.json(l)}),i.post("/project/:projectName/addattachment",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var n=await i.totalStorage,c=await a.headers.accountlabel,u={isSuccess:!1,errorMessage:"",fileName:""};try{var l=await a.params.projectName,d=await o(await c,await l,await n);if(!await d.isSuccess)return u.errorMessage=await d.errorMessage,t.json(u);let e,i;await a.files&&0!==await Object.keys(await a.files).length||(u.isSuccess=!1,u.errorMessage="No file selected."),e=await a.files.file,(await e.name.includes(".bat")||await e.name.includes(".exe")||await e.name.includes(".ps"))&&(u.isSuccess=!1,u.errorMessage="File is not supported for upload.");var p=await await a.headers.foldername;switch(await p){case"Defects":case"TestCases":case"TestPlan":break;default:if(!await p.includes("TestPlan"))return u.isSuccess=!1,u.errorMessage="Please pass the correct request body.",t.json(u)}i=await await a.headers.prefix;var m="/Manual/Attachments/"+await p+"/",v=await i+await e.name,g=await r+await c+"/"+await l+"/Manual/Attachments/"+await p+"/"+await v;w(await c+"/"+await l+await m+"/"),await e.mv(await g,function(a){a?(u.errorMessage=a,u.isSuccess=!1):u.isSuccess=!1}),u.fileName=await e.name,u.isSuccess=!0}catch(a){u.errorMessage=await a}t.json(u)}),i.get("/project/:projectName/downloadattachment",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var n={isSuccess:!1,content:null,"content-type":"",errorMessage:""};try{var w=await a.headers.accountlabel,o=await a.params.projectName,u=await await a.headers.foldername,l=await a.headers.filename;const e=await l.split(".").pop().toLowerCase();let i;switch(await e){case"jpg":case"jpeg":i="image/jpeg";break;case"png":i="image/png";break;case"gif":i="image/gif";break;case"pdf":i="application/pdf";break;case"txt":i="text/plain";break;case"doc":case"docx":i="application/msword";break;case"xls":case"xlsx":i="application/vnd.ms-excel";break;case"csv":i="text/csv";break;case"mp4":i="video/mp4";break;case"mov":i="video/quicktime";default:i="application/octet-stream"}var d=await r+await w+"/"+await o+"/Manual/Attachments/"+await u+"/"+await l;if(!await c.existsSync(await d))return n.errorMessage="File "+await l+" does not exist on server.",t.json(await n);const s=await c.readFileSync(await d).toString("base64");n.content=await s,n.isSuccess=!0,n["content-type"]=await i}catch(a){n.errorMessage=await a}t.json(await n)}),i.post("/project/:projectName/deleteunusedfile",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var n={isSuccess:!1};try{var w=await a.params.projectName,o=await a.body.foldername,l=await a.body.prefix,d=await a.body.files,p=await a.headers.accountlabel;switch(await o){case"Defects":case"TestCases":case"TestPlan":break;default:if(!await o.includes("TestPlan"))return uploadDetails.isSuccess=!1,uploadDetails.errorMessage="Please pass the correct request body.",t.json(uploadDetails)}var m=await r+await p+"/"+await w+"/Manual/Attachments/"+await o+"/",v=await u.sync(await m+l+"*");if(await v.length>0){var g=[];for(let a=0;a<await v.length;a++){var h=await v[a].split("\\"),f=await h[await h.length-1];g.push(await f)}for(let a=0;a<await d.length;a++){var y=await d[a].file,b=await l+await y;await g.includes(await b)&&(g=await g.filter(a=>a!==b))}if(await g.length>0)for(let a=0;a<await g.length;a++)try{await c.unlinkSync(await m+await g[a])}catch(a){}return n.isSuccess=!0,t.json(n)}n.isSuccess=!0}catch(a){n.errorMessage=await a}t.json(n)}),i.post("/project/:projectName/deletetestexecutionfile",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var n={isSuccess:!1};try{var w=await a.headers.accountlabel,o=await a.params.projectName,l=await a.body.testcycle,d=await a.body.testplan,p=await a.body.filename,m=await r+await w+"/"+await o+"/Manual/Attachments/TestPlan/"+await l+"/"+await d+"/"+await p,v=await u.sync(await m);if(await v.length>0){try{await c.unlinkSync(await v[0])}catch(a){}return t.json(n)}n.isSuccess=!0}catch(a){n.errorMessage=await a}t.json(n)}),i.post("/project/:projectName/testingType/:testingType",async(a,t)=>{var e={},i=await s(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var c=await i.totalStorage,u={isSuccess:!1,errorMessage:"",fileName:""};try{var l=await a.params.projectName,d=await a.params.testingType,p=await a.headers.accountlabel;switch(await d){case"Web":case"Mobile":case"Api":break;default:return t.json(u)}var m=await o(await p,await l,await c);if(!await m.isSuccess)return u.errorMessage=await m.errorMessage,t.json(u);let e;await a.files&&0!==await Object.keys(await a.files).length||(u.isSuccess=!1,u.errorMessage="No file selected."),e=await a.files.file,(await e.name.includes(".bat")||await e.name.includes(".exe")||await e.name.includes(".ps"))&&(u.isSuccess=!1,u.errorMessage="File is not supported for upload.");var v=await r+await p+"/"+await l+"/"+await d+"/Uploads/"+await e.name;w(await p+"/"+await l+"/"+await d+"/Uploads/"),await n(await v),await e.mv(await v,function(a){a?(u.errorMessage=a,u.isSuccess=!1):u.isSuccess=!1}),u.fileName=await e.name,u.isSuccess=!0}catch(a){u.errorMessage=await a}t.json(u)}),a.exports=i},7582:(a,t,e)=>{const i=e(7252).Router(),{authCheck:r}=e(2258);var s=e(6560);const n=e(8938),w=e(2305);async function o(a){return{type:"doc",version:1,content:[{type:"paragraph",content:[{type:"text",text:a||""}]}]}}i.post("/createnewdefect",async(a,t)=>{var e={},i=await r(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var c={isSuccess:!1,errorMessage:"",defectid:""};try{var u=await a.headers.useremail,l=await a.body,d=await l.host,p=await l.username,m=await l.password,v=await l.project,g=await l.title,h=await l.stepstoreproduce,f=await l.attachment,y=await l.sprint,b=await l.reference,S=await l.customissuetype;if(void 0===await S&&(S="Bug"),void 0===await d||""===await d)return c.errorMessage="host key is missing in requestbody",t.json(await c);if(void 0===await p||""===await p)return c.errorMessage="username key is missing in requestbody",t.json(await c);if(void 0===await m||""===await m)return c.errorMessage="password key is missing in requestbody",t.json(await c);if(void 0===await v||""===await v)return c.errorMessage="project key is missing in requestbody",t.json(await c);if(void 0===await g||""===await g)return c.errorMessage="title key is missing in requestbody",t.json(await c);if(void 0===await h||""===await h)return c.errorMessage="stepstoreproduce key is missing in requestbody",t.json(await c);var x,M,N=await new s({protocol:"https",host:await d,username:await p,password:await m,apiVersion:"3",strictSSL:!0});if("Bug"===await S)var T={fields:{project:{key:await v},summary:await g,description:await o(await h),issuetype:{name:"Bug"}}};else T={fields:{project:{key:await v},summary:await g,description:await o(await h),issuetype:{name:await S},parent:{key:await b}}};var E=await N.addNewIssue(await T);M=await E.key,c.defectid=await M,x=await E.id;try{await N.addComment(await M,"A defect is automatically created from the QAautoMATER UI, initiated by the "+await u)}catch(a){}if("Bug"===await S){if(void 0!==await y&&""!==await y)try{var A,P=await N.getAllBoards(),C=await P.values,k=!1;for(let a=0;a<await C.length;a++)if(await C[a].location.projectKey===await v){k=!0,A=await C[a].id;break}if(await k){var j,D=!1,O=await N.getAllSprints(await A),I=await O.values;for(let a=0;a<await I.length;a++)if(await I[a].name===await y){D=!0,j=await I[a].id;break}await D&&await N.addIssueToSprint(await x,await j)}}catch(a){}if(void 0!==await b&&""!==await b)try{await N.get;const a={type:{name:"Blocks"},inwardIssue:{key:await M},outwardIssue:{key:await b}};await N.issueLink(await a)}catch(a){}}if(void 0!==await f&&""!==await f)try{const a=Buffer.from(await f,"base64"),t=new w;t.append("file",await a,{filename:await M+"_attachment.png"});const e={auth:{username:p,password:m},headers:{...t.getHeaders(),"X-Atlassian-Token":"no-check"}};await n.post(`https://${d}/rest/api/2/issue/${await M}/attachments`,await t,await e)}catch(a){}c.isSuccess=!0,c.errorMessage="Defect "+await M+" is successfully created in jira."}catch(a){c.errorMessage=a.toString()}t.json(await c)}),a.exports=i},7685:(a,t,e)=>{const i=e(7252).Router(),{saveFile:r,isDirectoryExist:s,createDirectory:n,deleteFile:w,isSpaceFreeOnAccount:o}=e(7229),{authCheck:c}=e(2258);var u=e(9896);i.get("/component/:componentName/testid/:testdetails/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await c(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=a.params.projectName,s=a.params.testingtype,n=a.params.componentName,w=a.params.testdetails,o=await a.headers.accountlabel,l={};try{var d=await"./dataHub/"+await o+"/"+r+"/"+s+"/MockRepo/"+n+"/"+w+".json";l=await JSON.parse(await u.readFileSync(await d,"utf8"))}catch(a){}t.json(l)}),i.post("/component/:componentName/testid/:testdetails/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await c(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var w=await i.totalStorage,u={isFileSaved:!1,errorMessage:""};try{var l=a.params.projectName,d=await a.headers.accountlabel,p=await o(await d,await l,await w);if(!await p.isSuccess)return u.errorMessage=await p.errorMessage,t.json(u);var m=a.params.testingtype,v=a.params.componentName,g=a.params.testdetails;await s(await d+"/"+l+"/"+m+"/MockRepo/"+v)||await n(await d+"/"+l+"/"+m+"/MockRepo/"+v),await r(await d+"/"+l+"/"+m+"/MockRepo/"+v+"/"+g+".json",a.body),u.isFileSaved=!0}catch(a){u.errorMessage=a.toString()}t.json(u)}),i.delete("/component/:componentName/testid/:testdetails/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await c(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileDeleted:!1,errorMessage:""};try{var s=await a.headers.accountlabel,n=a.params.projectName,o=a.params.testingtype,u=a.params.componentName,l=a.params.testdetails;await w(await s+"/"+n+"/"+o+"/MockRepo/"+u+"/"+l+".json"),r.isFileDeleted=!0}catch(a){r.errorMessage=a.toString()}t.json(r)}),a.exports=i},8011:(a,t,e)=>{const i=e(7252).Router(),{saveFile:r,isDirectoryExist:s,createDirectory:n,isSpaceFreeOnAccount:w,readJSONFile:o,saveFileAsEncyptedContent:c}=e(7229),{authCheck:u}=e(2258);e(9896),i.post("/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,l={isFileSaved:!1,errorMessage:""};try{var d=await a.headers.accountlabel,p=a.params.projectName,m=await w(await d,await p,await r);if(!await m.isSuccess)return l.errorMessage=await m.errorMessage,t.json(l);var v=a.params.testingtype;switch(await v){case"Web":case"Mobile":case"Api":break;default:return l.errorMessage="Invalid Testing Type provided.",t.json(l)}await s(await d+"/"+p+"/"+v)||await n(await d+"/"+p+"/"+v);var g={};try{var h=await d+"/"+await p+"/"+v+"/CommonTestData.json";g=await o(await h);var f=await g.CommonTestData;void 0===await f&&(g.CommonTestData={},f={})}catch(a){}var y=await await a.body.keyForAddandUpdate;if(void 0!==await y){var b=await Object.keys(await y);for(let a=0;a<await b.length;a++){var S=await b[a].toString().trim();void 0===await f[await S.toString().toUpperCase()]&&(f[await S.toString().toUpperCase()]={}),f[await S.toString().toUpperCase()]=await y[await S]}}var x=await await a.body.keyForDelete;if(void 0!==await x)for(let a=0;a<await x.length;a++)try{var M=await x[a];const{[M]:t,...e}=await f;f=await e}catch(a){}g.CommonTestData=await f,await c(await d+"/"+p+"/"+v+"/CommonTestData.json",await g),l.isFileSaved=!0}catch(a){l.errorMessage=a.toString()}t.json(l)}),i.get("/project/:projectName/testingtype/:testingtype",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={},s=a.params.projectName,n=a.params.testingtype,w=await a.headers.accountlabel;switch(await n){case"Web":case"Mobile":case"Api":break;default:return fileSaved.errorMessage="Invalid Testing Type provided.",t.json(fileSaved)}try{var c=await w+"/"+await s+"/"+n+"/CommonTestData.json";r=await o(await c)}catch(a){}t.json(r)}),i.post("/project/:projectName/testingtype/:testingtype/addnewenvironment",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,l={isFileSaved:!1,errorMessage:""};try{var d=a.params.projectName,p=await a.headers.accountlabel,m=await w(await p,await d,await r);if(!await m.isSuccess)return l.errorMessage=await m.errorMessage,t.json(l);var v=a.params.testingtype;switch(await v){case"Web":case"Mobile":case"Api":break;default:return l.errorMessage="Invalid Testing Type provided.",t.json(l)}var g=await a.body.envname;if(void 0===await g||""===await g)return l.errorMessage="Invalid Environment name provided.",t.json(l);await s(await p+"/"+d+"/"+v)||await n(await p+"/"+d+"/"+v);var h={};try{var f=await p+"/"+await d+"/"+v+"/CommonTestData.json";h=await o(await f)}catch(a){h={}}var y=await h.CommonTestData;void 0===await y&&(y={},h.CommonTestData={});var b=await h.TestDataExistingEnvironment;if(void 0===await b&&(b=[],h.TestDataExistingEnvironment=[]),await b.includes(await g))return l.errorMessage="Environment "+await g+" is already exist on the server.",t.json(l);b.push(await g),h.TestDataExistingEnvironment=await b;var S=await Object.keys(await y);for(let a=0;a<await S.length;a++){var x=await S[a];void 0===await y[await x][await g]&&(y[await x][await g]="")}h.CommonTestData=await y,await c(await p+"/"+await d+"/"+await v+"/CommonTestData.json",await h),l.isFileSaved=!0}catch(a){l.errorMessage=a.toString()}t.json(l)}),i.post("/project/:projectName/testingtype/:testingtype/deleteenvironment",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileSaved:!1,errorMessage:""};try{var s=a.params.projectName,n=a.params.testingtype,w=await a.headers.accountlabel;switch(await n){case"Web":case"Mobile":case"Api":break;default:return r.errorMessage="Invalid Testing Type provided.",t.json(r)}var l=await a.body.envname;if(void 0===await l||""===await l)return r.errorMessage="Invalid Environment name provided.",t.json(r);var d={};try{var p=await w+"/"+await s+"/"+n+"/CommonTestData.json";d=await o(await p)}catch(a){return r.errorMessage="Common test data file does not exist on server.",t.json(r)}var m=await d.CommonTestData;void 0===await m&&(m={},d.CommonTestData={});var v=await d.TestDataExistingEnvironment;if(void 0===await v)return v=[],d.TestDataExistingEnvironment=[],r.isFileSaved=!0,r.errorMessage="Environment is already does not exist on server",t.json(r);if(!await v.includes(await l))return r.isFileSaved=!0,r.errorMessage="Environment "+await l+" is already does not exist on the server.",t.json(r);const e=await v.filter(a=>!a.includes(l));v=await e,d.TestDataExistingEnvironment=await v;var g=await Object.keys(await m);for(let a=0;a<await g.length;a++){var h=await g[a];void 0!==await m[await h][await l]&&delete m[await h][await l]}d.CommonTestData=await m,await c(await w+"/"+s+"/"+n+"/CommonTestData.json",await d),r.isFileSaved=!0}catch(a){r.errorMessage=a.toString()}t.json(r)}),a.exports=i},8060:a=>{"use strict";a.exports=require("stream-json/Stringer")},8062:(a,t,e)=>{const i=e(7252),r=e(9896),s=i.Router(),{authCheck:n}=e(2258);s.get("/project/:projectName",async(a,t)=>{var e={},i=await n(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var s=[],w=await a.params.projectName,o=await a.headers.accountlabel,c=[],u=await r.readdirSync("./dataHub/"+await o+"/"+w+"/Web/CustomPageFunction/Function");for(let a=0;a<await u.length;a++){var l=await u[a];await l.includes(".json")&&(l=await l.replace(".json",""),c.push(await l))}await c.length>0&&(await c.sort(),s=await c);var d=["JSClick","Count","Focus","ClickOnAllListOfWebElement","Wait","GetIndexOfTheElement","FileUpload","JSClear","SelectByVisibleText","SelectByVisibleTextSimilarElements","SelectByValue","SelectByValueSimilarElements","SelectByIndex","SelectByIndexSimilarElements","Clear","Click","ClickNTimes","GetAttribute","GetCssValue","GetTagName","GetText","IsDisplayed","IsNotDisplayed","IsEnabled","IsDisabled","IsSelected","Type","TypeSimilarElements","SwitchToFrame","SwitchToDefaultContent","WaitForElementTillDisplayed","WaitForElementTillNotDisplayed","WaitForElementTillTextContains","Check","CheckSimilarElements","Uncheck","UncheckSimilarElements","DoubleClick","RightClick","PressKeyBoard","ClickSimilarElements","GetAttributeForSimilarElements","GetAttributeForAllSimilarElements","SaveSessionVariable","DragandDrop"];await d.sort();var p=["Navigate","Close","GetCurrentUrl","GetTitle","SwitchToWindow","Maximize","Minimize","FullScreen","Refresh","Back","Forward","AlertAccept","AlertDismiss","AlertSendKeys","AlertText","NewWindow","NewTab"];await p.sort(),s=await s.concat(await d.concat(await p));var m=["GenerateUtilityValue","AssertTitleEquals","AssertTitleContains","AssertTitleNotContains","AssertUrlEquals","AssertUrlContains","AssertUrlNotContains","AssertElementTextEquals","AssertElementTextContains","AssertElementTextNotContains","AssertElementAttributeEquals","AssertElementAttributeContains","AssertElementAttributeNotContains","AssertElementCountEquals","AssertElementCountGreaterThan","AssertElementCountLessThan","AssertEquals","AssertContains","AssertNotContains","AssertWindowCountEquals"];await m.sort(),s=await s.concat(await m)}catch(a){}t.json(s)}),a.exports=s},8215:a=>{"use strict";a.exports=require("text-to-image")},8220:(a,t,e)=>{const i=e(4716);async function r(a,t,e){try{var i=await t/await a*100,r=Number(await a)+Number(await i);return r=await r.toFixed(await e),await r}catch(a){throw a}}async function s(a){return isNaN(await a)||(a=await Number(await a)),await a}a.exports={Array_ExcludeCharacters:async function(a,t){try{if(!Array.isArray(a))throw new Error("userInput must be an array");if(!Array.isArray(t))throw new Error("excludedItems must be an array");const e=new RegExp("["+t.map(a=>"\\"+a).join("")+"]","g");return a.map(a=>a.toString().replace(e,"").trim())}catch(a){return console.log("Error:",a),[]}},List_GetUniqueValues:async function(a){try{var t=await a;await Array.isArray(a)||(a=JSON.parse(await a));var e=[];for(let t=0;t<await a.length;t++){var i=await a[t];i=await i.toString().trim(),await e.includes(await i)||e.push(await i)}return await e}catch(a){return await t}},JSON_getKeyValue:async function(a,t){try{var e=await async function(a){var t=[];if(await a.includes("[")&&await a.includes("]")){var e=await a.split("[");for(let a=0;a<await e.length;a++){var i=await e[a];if(""!==await i.trim()){var r=await i.split("]")[0];t.push(await r)}}}else t.push(await a);return await t}(await t),i=await a;for(let a=0;a<await e.length;a++)t=await s(await e[a]),i=await i[await t]}catch(a){}return await i},String_Trim:async function(a){try{return a.toString().trim()}catch(a){throw a}},String_ToUpperCase:async function(a){try{return a.toString().toUpperCase()}catch(a){throw a}},String_ToLowerCase:async function(a){try{return a.toString().toLowerCase()}catch(a){throw a}},String_Substring:async function(a,t,e){try{return void 0===await e?a.toString().substring(t):a.toString().substring(t,e)}catch(a){throw a}},String_StartsWith:async function(a,t){try{return a.toString().startsWith(t)}catch(a){throw a}},String_SplitandSaveValueAsPerIndex:async function(a,t,e){try{var i=await a.toString().split(await t);if(await e>=await i.length)throw new"IndextoSave "+await e+" is greater than array size "+await i.length;return await i[await e].trim()}catch(a){throw a}},String_Split:async function(a,t){try{return a.toString().split(await t).map(a=>a.trim())}catch(a){throw a}},String_Replace:async function(a,t,e){try{const i=new RegExp(t,"g");return a.toString().replace(i,e)}catch(a){throw a}},String_RemoveNumberFromTheString:async function(a){try{return a=(a=a.toString()).replace(/\d+/g,""),a=await a.trim(),await a}catch(a){throw a}},String_Length:async function(a){try{return a.toString().length}catch(a){throw a}},String_ExtractNumberFromTheString:async function(a,t=!0){if(void 0===await a||null===await a)return await a;let e;return a=a.toString().trim(),e=void 0===t||t?a.replace(/[^0-9]/g,""):a.replace(/[^0-9.]/g,""),e?await parseFloat(await e):NaN},String_EndsWith:async function(a,t){try{return a.toString().endsWith(t)}catch(a){throw a}},String_Concat:async function(a,t){try{const e=(a=a.toString())+" "+(t=t.toString());return await e}catch(a){throw a}},Array_Length:async function(a){try{return await a.length}catch(a){throw new a}},Math_SubtractTwoNumber:async function(a,t,e){try{var i=Number(await a)-Number(await t);return i=await i.toFixed(await e),await i}catch(a){throw a}},Math_SubtractPercentage:async function(a,t,e){try{var i=await t/await a*100,r=Number(await a)-Number(await i);return r=await r.toFixed(await e),await r}catch(a){throw a}},Math_Round:async function(a,t){try{const e=Math.pow(10,t);return Math.round(a*e)/e}catch(a){throw a}},Math_Reminder:async function(a,t){try{if(0===t)throw new Error("Division by zero is not allowed.");var e=a%t;return await e}catch(a){throw a}},Math_MultiplyTwoNumber:async function(a,t,e){try{var i=Number(await a)*Number(await t);return i=await i.toFixed(await e),await i}catch(a){throw a}},Math_GetPercentage:async function(a,t,e){try{var i=await t/await a*100,r=await i.toFixed(await e);return await r}catch(a){throw a}},Math_Floor:async function(a){try{return Math.floor(a)}catch(a){throw a}},Math_DivideTwoNumber:async function(a,t,e){try{if(0===t)throw new Error("Division by zero is not allowed.");var i=a/t;return i=await i.toFixed(await e),await i}catch(a){throw a}},Math_Ceil:async function(a){try{return Math.ceil(a)}catch(a){throw a}},Math_AddTwoNumber:async function(a,t,e){try{var i=Number(await a)+Number(await t);return i=await i.toFixed(await e),await i}catch(a){throw a}},Math_AddPercentage:r,Math_AddPercentage:r,Math_Abs:async function(a){try{return Math.abs(a)}catch(a){throw a}},Date_getDate:async function(a,t){try{const r=new Date;var e=await i(await r).add(Number(await a),"days");return i(e).format(t)}catch(a){}return await""},Date_GetDateDifference:async function(a,t,e,r,s){try{const n=i(a,t),w=i(e,r);switch(s.toLowerCase()){case"month":case"months":return Math.floor(w.diff(n,"months",!0));case"day":case"days":return Math.floor(w.diff(n,"days",!0));case"year":case"years":return Math.floor(w.diff(n,"years",!0));case"hour":case"hours":return w.diff(n,"hours",!0);case"minute":case"minutes":return w.diff(n,"minutes",!0);case"second":case"seconds":return w.diff(n,"seconds",!0);default:throw new Error("Invalid difference unit: "+s)}}catch(a){throw console.error("Error:",a),a}},Date_FormatDateTemplate:async function(a,t,e){try{let r=i(a,t,!0);if(!r.isValid())throw new Error("Invalid date format for "+await a+" with Format "+await t);return r.format(e)}catch(a){}return await inputArray},Array_DeleteItem:async function(a,t){try{const e=await a.filter(a=>a!==t);return await e}catch(a){}return await a},Array_DeleteItemBasedOnIndex:async function(a,t){try{const e=[...a];return e.splice(t,1),e}catch(t){return a}},Array_GetValueBasedOnIndex:async function(a,t){var e;return e=await a[await t],await e},Array_Push:async function(a,t){try{var e=await a;return e.push(await t),await e}catch(a){}return await a},Array_Search:async function(a,t){try{return await a.includes(await t)}catch(a){}return await!1},Array_Sort:async function a(t){try{return(await a(t)).reverse()}catch(a){console.error(a)}return t},Array_SortDesc:async function(a){try{return a.sort((a,t)=>isNaN(a)||isNaN(t)?"string"==typeof a&&"string"==typeof t?a.localeCompare(t):"number"==typeof a?-1:1:parseFloat(a)-parseFloat(t))}catch(a){console.error(a)}return a},Array_SumOfArray:async function(a){try{return a.reduce((a,t)=>{const e="string"==typeof t?parseFloat(t):t;return isNaN(e)?a:a+e},0)}catch(a){console.error(a)}return 0}}},8330:a=>{"use strict";a.exports=JSON.parse('{"name":"qaautomaterserver","version":"1.3.36","description":"","main":"index.js","isForOnPremBuild":false,"scripts":{"start":"supervisor index.js","start:prod":"supervisor ./dist/server.js","build":"webpack --config webpack.prod.js --mode=production"},"author":"Pravesh Jha","license":"ISC","dependencies":{"@faker-js/faker":"^9.9.0","ajv":"^8.17.1","appium-adb":"^12.12.6","axios":"^1.11.0","body-parser":"^2.2.0","chromedriver":"^143.0.0","codegen":"^0.1.0","compromise":"^14.14.4","cors":"^2.8.5","crypto-js":"^4.2.0","du":"^1.0.0","express":"^5.1.0","express-fileupload":"^1.5.2","fast-csv":"^5.0.2","form-data":"^4.0.4","geckodriver":"^4.4.4","glob":"^11.0.3","jira-client":"^8.2.2","jsonwebtoken":"^9.0.2","moment":"^2.30.1","morgan":"^1.10.1","ms-chromium-edge-driver":"^0.5.1","mysql2":"^3.14.2","nodemailer":"^7.0.5","oracledb":"^6.9.0","pdf-parse":"^1.1.1","proper-lockfile":"^4.1.2","selenium-webdriver":"^4.38.0","stream-json":"^1.9.1","supervisor":"^0.12.0","text-to-image":"^7.0.1","webdriver-manager":"^12.1.9","webdriverio":"^9.18.4","xlsx":"^0.18.5"},"devDependencies":{"@babel/core":"^7.28.0","babel-loader":"^10.0.0","html-webpack-plugin":"^5.6.3","webpack":"^5.100.2","webpack-cli":"^6.0.1","webpack-node-externals":"^3.0.0"},"pkg":{"outputPath":"exe","targets":["win"],"assets":["./node_modules/axios/dist/node/axios.cjs"]}}')},8505:(a,t,e)=>{const{executeTestStep:i,evaluateValuecomingfromTestScript:r,createElementandElements:s,executeDependendtPageFunction:n,takeScreenshot:w,createElementasPerProvidedValue:o,waitForPageLoad:c,saveScreenshot:u}=e(6221),l="./dataHub/",{Builder:d,Browser:p,By:m,Key:v,until:g,Select:h,Capabilities:f,Actions:y}=e(4973);var b=e(9280);const S=e(3851);var x=e(7244).path,M=e(4475),N=e(8609).path,T=e(1559),E=e(1816),A=e(636),P=e(9896);const C=e(6928);var k="";async function j(a,t){var e={isStepInvolved:!1,parentSteps:{}};try{var i=await Object.keys(await t);if(await i.length>0)for(let o=0;o<await i.length;o++){var r=await i[o],s=await t[await r],n=await Object.keys(await s);for(let t=0;t<await n.length;t++){var w=await n[t];(await s[await w]).includes(await a)&&(e.isStepInvolved=!0,e.parentSteps[await r]=w)}}}catch(a){}return await e}async function D(a,t,e){try{void 0!==await a[await t]&&(e[await t]={});var i=await a.ifTrue;void 0!==await i&&await Array.isArray(await i)&&(e[await t]={},e[await t].true=await i)}catch(a){}try{i=await a.ifFalse,void 0!==await i&&await Array.isArray(await i)&&(void 0===e[await t]&&(e[await t]={}),e[await t].false=await i)}catch(a){}return await e}async function O(a){try{var t=await a.ifTrue;if(void 0!==await t)return!0}catch(a){}try{if(t=await a.ifFalse,void 0!==await t)return!0}catch(a){}return await!1}async function I(a,t,e,i,r,s){var n=await t;"Mobile"!==await e&&"Tablet"!==await e||(t="Chrome");try{var w=await C.resolve(await l+await r+"/Web/Downloads/")}catch(a){w=""}let o=null;var c=null;try{(c=new S.Preferences).setLevel(S.Type.PERFORMANCE,S.Level.ALL)}catch(a){}switch(t.toString().trim().toLowerCase()){case"chrome":if("Server"===await a){var u=(new b.Options).setChromeBinaryPath(await"C://Program Files//Google//Chrome//Application//chrome.exe");u.setProxy(null),u.setAcceptInsecureCerts(!0),u.excludeSwitches(["enable-automation"]),"Mobile"!==await e&&"Tablet"!==await e||await u.setMobileEmulation({deviceName:await n}),u.setUserPreferences({"profile.default_content_setting_values.notifications":2,"profile.default_content_setting_values.geolocation":2,"download.default_directory":w});const a=new b.ServiceBuilder(await x),t=(new d).forBrowser("chrome");u.addArguments("--pageLoadStrategy=none","--disable-notifications","--incognito","--disable-web-security","--allow-running-insecure-content","--ignore-certificate-errors","--disable-features=IsolateOrigins,site-per-process","--disable-features=BlockInsecurePrivateNetworkRequests","--dns-prefetch-disable","--no-sandbox","--disable-dev-shm-usage","--proxy-server='direct://'","--proxy-bypass-list=*"),void 0!==await s&&"Yes"===await s&&(u.addArguments("--headless"),u.addArguments("--window-size=1920,1080"));try{u.setLoggingPrefs(await c)}catch(a){console.log(await a)}u.addArguments("--user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"),t.setChromeOptions(await u),t.setChromeService(await a),o=await t.build()}else(g=await f.chrome()).setProxy(null),g.setAcceptInsecureCerts(!0),g=await L(await i,await e,await t,await g),o=await(new d).usingServer(await i.HubUrl).withCapabilities(await g).build();break;case"firefox":if("Server"===await a){var m=new M.ServiceBuilder(await N).build(),v=new M.Options(await m);v.addArguments("-no-sandbox"),v.addArguments("--disable-extensions"),v.addArguments("--disable-web-security"),v.setPreference("credentials_enable_service",!1),v.setPreference("profile.default_content_setting_values.cookies",1),v.setPreference("profile.cookie_controls_mode",0),v.addArguments(["user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Firefox/98.0.0.0 Safari/537.36"]),v.setPreference("browser.download.dir",w),v.setPreference("browser.download.folderList",2),v.setAcceptInsecureCerts(!0),void 0!==await s&&"Yes"===await s&&v.addArguments("--headless");try{v.setLoggingPrefs(c)}catch(a){}const a=(new d).forBrowser("firefox");a.setFirefoxOptions(v),o=await a.build(),await o.setFileDetector(new A.FileDetector)}else(g=f.firefox()).setProxy(null),g.setAcceptInsecureCerts(!0),g=await L(await i,await e,await t,g),o=await(new d).usingServer(await i.HubUrl).withCapabilities(g).build();break;case"edge":var g=f.edge();if("Server"===await a){const a=await new E.paths,t=await new T.Options;await t.setBinaryPath(await a.browserPath),t.addArguments("-no-sandbox"),t.addArguments("--disable-extensions"),t.addArguments("--disable-web-security"),void 0!==await s&&"Yes"===await s&&t.addArguments("--headless");try{t.setLoggingPrefs(c)}catch(a){}t.addArguments(["user-agent=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Edge/98.0.0.0 Safari/537.36"]),t.setAcceptInsecureCerts(!0),t.setUserPreferences({credentials_enable_service:!1}),t.setUserPreferences({"profile.default_content_setting_values.cookies":1}),t.setUserPreferences({"profile.cookie_controls_mode":0}),t.setUserPreferences({"download.default_directory":await w}),o=await(new d).forBrowser(p.EDGE).setEdgeOptions(await t).setEdgeService(new T.ServiceBuilder(a.driverPath)).build()}else g.setProxy(null),g.setAcceptInsecureCerts(!0),g=await L(await i,await e,await t,g),o=await(new d).usingServer(await i.HubUrl).withCapabilities(g).build();break;case"safari":g=f.SAFARI(),"Server"===await a?o=await(new d).forBrowser(p.SAFARI).build():(g=await L(await i,await e,await t,g),o=await(new d).usingServer(await i.HubUrl).withCapabilities(g).build())}return await o}async function L(a,t,e,i){var r;r="desktop"===await t.toString().toLowerCase()?await a.Capabilities[await t][await e]:await a.Capabilities[await t];var s=await Object.keys(await r);for(let a=0;a<await s.length;a++){var n=await s[a],w=await r[await n];null!==await w&&""!==await w.toString().trim()&&await i.set(await n,await w)}return await i}async function F(a){try{var t=await m.xpath("//button[contains(text(),'Accept') or contains(text(),'cookies') or contains(text(),'Agree')]");await(await a).findElement(await t).click()}catch(a){}}async function U(a){if(""!==await k)return await k;try{await a.getCapabilities().then(a=>{k=a.get("browserVersion")})}catch(a){return""}}async function V(a){var t={};try{var e=await typeof await a;t="string"===await e?await JSON.parse(await a):await a}catch(a){t={}}return await t}async function B(a){var t="{}";try{var e=await typeof await a;t="object"===await e?await JSON.stringify(await a):await a}catch(a){t="{}"}return await t}a.exports={executeTestScript:async function(a,t,e,s,d,p,m,v,g,h,f,y,b,S,x,M,N,T,E,A){let C=null;var k=null;try{try{var L=await E.HeadlessMode}catch(a){L="No"}var R=new Date,J={isSuccess:!0,assertionData:[],globalError:"",executiontime:0},X=[],W=[],Y=await async function(a,t,e,i){var r={isSuccess:!0,assertionData:[],globalError:"",executiontime:0},s=await l+await a+"/"+await t+"/Web/TestScripts/"+await e+"/"+await i+".json";if(!await P.existsSync(await s)){var n={};n.errorMessage="Test script "+await i+" does not found on the server.";var w={id:1,stepdefinition:"Test Script Execution",action:"NA",testdata:await n,status:"Fail",screenshot:""};r.assertionData.push(await w),r.isSuccess=!0}return await r}(await a,await t,await e,await s);if(!await Y.isSuccess)return await Y;var G=await l+await a+"/"+await t+"/Web/OR.json",Q=l+await a+"/"+await t+"/Web/TestScripts/"+await e+"/"+await s+".json",q=await P.readFileSync(await G,"utf8");q=await JSON.parse(await q);var Z=await P.readFileSync(await Q,"utf8");Z=await JSON.parse(await Z);var K=await Z.allsteps,H=await Z.testdataset,_=1;await H.length>0&&(_=await H.length);var z=1,$="";for(let e=0;e<await _;e++){$="";var aa=new Date,ta=await Z.dependentpage;C=await I(await m,await p,await v,await g,await t,await L),await U(await C),await(await C).manage().window().maximize(),await C.get(await d),await F(await C),await c(await C,60,await S),k=await C;var ea={output:""};A.mainDriver=await C;var ia={};void 0!==await T&&(ia.TestIdDetails=await T,ia.TestId=await T.TestId,ia.TestName=await T.TestName,ia.Environment=await T.Environment,ia.ExecutedBy=await T.ExecutedBy,ia.Component=await T.Component);var ra=!0;try{if(await ta.length>0){var sa=await n(a,await t,await ta,await C,await h,await H,await ia,await q,await f,await ea,await b,await S,await e,await x,await M,await N,await E,await A);ra=await sa.isSuccess;var na=await sa.stepAssertion,wa={};await ra||(wa.errorMessage=await sa.errorMessage);try{wa.TestData=JSON.parse(await sa.testData)}catch(a){wa.TestData={}}wa.ListOfTestSteps=await sa.supportingEvidence;try{wa=JSON.stringify(await wa)}catch(a){wa="{}"}na.testdata=await wa,X.push(await na),J.isSuccess=await ra}if(await ra){var oa={},ca={};for(let n=0;n<await K.length;n++){try{var ua,la={},da={},pa={isSuccess:!0},ma="Pass",va=await z,ga=await K[n].isreporting,ha=await K[n].id,fa=await K[n].stepdefinition,ya=await K[n].action,ba=await K[n].element,Sa=await K[n].value;Sa=await r(await Sa,await h,await H,await ia,await e,await da,await Sa,await b,await E);try{la.TestData=await JSON.parse(await Sa)}catch(a){la.TestData={}}ua=await O(await la.TestData),await ua&&(oa=await D(la.TestData,await ha,await oa));var xa=!1,Ma=await j(await ha,await oa);if(await Ma.isStepInvolved){var Na=[],Ta=await Ma.parentSteps,Ea=await Object.keys(await Ta);for(let a=0;a<await Ea.length;a++){var Aa=await Ea[a],Pa=await Ta[await Aa],Ca=await ca[await Aa];await Pa.toString()===await Ca.toString()?Na.push("true"):Na.push("false")}xa=!!await Na.includes("false")}if(await xa){la.warningMessage="Conditional statement found.Hence test step execution skipped.";try{la=JSON.stringify(await la)}catch(a){la="{}"}Fa={id:await va,stepdefinition:await fa,action:await ya,testdata:await la,status:"Warning",screenshot:$},X.push(await Fa)}else{await Sa;var ka=await o(await a,await C,await ba,await q,await ya,await h,await H,await ia,await e,await f,await t,!1,await Sa,await da,await b,await S,await x,await M,await E);if(await ka.isElementPresent){void 0!==await ka.shadowDriver&&(C=await ka.shadowDriver);var ja=await ka.element,Da=await ka.elements,Oa=await ka.elementIndex;pa=await i(await a,await t,await ya,await C,await ja,await Sa,await ea,await ia,await f,await q,await h,await H,await Da,await Oa,await b,await S,await x,await ba,await e,!1,await da,await M,await E,await A),la=await pa.supportingEvidence,void 0===await la&&(la={});try{la.TestData=await JSON.parse(await Sa)}catch(a){la.TestData={}}ca[await ha]=await pa.isSuccess}else if(await ua)ca[await ha]=!1,pa.isSuccess=!0,pa.errorMessage=await ka.errorMessage,la.errorMessage=await ka.errorMessage,la.warningMessage="Conditional statement,hence step status showing Warning.",ma="Warning";else if(""===await ga||"Yes"===await ga){pa.isSuccess=!1;var Ia=await ka.errorMessage,La="";try{La=await JSON.parse(await Ia)}catch(a){La=await Ia}pa.errorMessage=await La,la.errorMessage=await La,ma="Fail"}pa.isSuccess||(await ua?(J.isSuccess=!0,pa.isSuccess=!0,la.errorMessage=await pa.errorMessage,la.warningMessage="Conditional statement,hence step status showing Warning.",ma="Warning"):""!==await ga&&"Yes"!==await ga||(J.isSuccess=!1,la.errorMessage=await pa.errorMessage,ma="Fail")),"For each step"===await y&&($="Yes"===await N?await u(await a,await t,await k,"Web",await b,await s,Number(await e)+1,Number(await n)+1):await w(await k)),"CallMobileTestScript"===await ya&&($=await mobilescreenshot);try{la=await V(await la),la=await B(await la)}catch(a){la="{}"}var Fa={id:await va,stepdefinition:await fa,action:await ya,testdata:await la,status:await ma,screenshot:$};if(X.push(await Fa),!pa.isSuccess)break}}catch(i){if(""===await ga||"Yes"===await ga){J.isSuccess=!1,ma="Fail","For each step"===await y&&($="Yes"===await N?await u(await a,await t,await k,"Web",await b,await s,Number(await e)+1,Number(await n)+1):await w(await k)),(la={}).errorMessage=await i.toString();try{la=JSON.stringify(await la)}catch(a){la="{}"}Fa={id:await va,stepdefinition:await fa,action:await ya,testdata:await la,status:await ma,screenshot:$},X.push(await Fa);break}}z=await z+1}if("For failure & success"===await y&&"CallMobileTestScript"!==await ya){$="Yes"===await N?await u(await a,await t,await k,"Web",await b,await s,Number(await e)+1,1):await w(await k);var Ua=await X.length-1;X[await Ua].screenshot=await $}}}catch(a){var Va=await a.toString();console.log(await Va),(la={}).errorMessage=await Va;try{la=JSON.stringify(await la)}catch(a){la="{}"}if(J.isSuccess=!1,void 0===await X||0===await X.length){var Ba=new Date,Ra=await(await Ba.getTime()-await aa.getTime())/1e3;Fa={id:1,stepdefinition:"Test Script Execution",action:"NA",testdata:await la,status:"Fail",screenshot:""},X.push(await Fa)}}if(await _>1){Ba=new Date,Ra=await(await Ba.getTime()-await aa.getTime())/1e3;var Ja={};Ja.ExecutionTime=await Ra+" seconds",Fa={id:await z,stepdefinition:"End of Iteration for Data Row id "+(e+1),action:await"ExecutionTime",testdata:await Ja,status:"",screenshot:""},X.push(await Fa),z=await z+1}W.push(await J.isSuccess),J.assertionData=await X;try{await(await C).quit()}catch(a){}}}catch(a){console.log(await a.toString()),J.globalError=await a.toString();try{await(await C).quit()}catch(a){}if(await J.globalError.includes("no such file or directory")){la={errorMessage:"Test script does not found on the server."};try{la=JSON.stringify(await la)}catch(a){la="{}"}Fa={id:1,stepdefinition:"Test Script Execution",action:"NA",testdata:await la,status:"Fail",screenshot:""},X.push(await Fa),W.push(!1),J.assertionData=await X}else{(la={}).errorMessage=await a.toString();try{la=JSON.stringify(await la)}catch(a){la="{}"}Fa={id:1,stepdefinition:"Test Script Execution",action:"NA",testdata:await la,status:"Fail",screenshot:""},X.push(await Fa),W.push(!1),J.assertionData=await X}J.isSuccess=!1}await W.includes(!1)&&(J.isSuccess=!1);var Xa=new Date;return Ra=await(await Xa.getTime()-await R.getTime())/1e3,Ra=await Number(await Ra.toString().split(".")[0]),J.executiontime=await Ra,J},launchBrowser:I,acceptCookies:F,getBrowserVersion:U}},8577:a=>{"use strict";a.exports=require("cors")},8609:a=>{"use strict";a.exports=require("geckodriver")},8611:a=>{"use strict";a.exports=require("http")},8659:(a,t,e)=>{const i=e(7252),r=e(9896),s=i.Router();var n="./dataHub/";const{authCheck:w}=e(2258),o={UIAction:{Check:{description:"This method is used for checking  web element. It is widely used for checkbox and radio button.This method also can be used if multiple element are found.",example:'1.{"Web Element":"CHKXYZ","Value":" "} 2.{"Web Element":"CHKXYZ","Value":"{"index":0} 3.{"Web Element":"CHKXYZ","Value":"{"id":"QaBunch"} 4.{"Web Element":"CHKXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},CheckAll:{description:"This method check all the checkbox which are displayed on the page.",example:'1.{"Web Element":"CHKXYZ","Value":" "}'},Click:{description:"This method is used for clicking on a web element.This method also can be used if multiple element are found.",example:'1.{"Web Element":"BUTTONXYZ","Value":" "} 2.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},Clear:{description:"This method is used clear the input the value, please use this method only if Type method is not working, this method used keyboard action Control+A and delete",example:'1.{"Web Element":"TextBOXUserName","Value":" "}'},ClickAll:{description:"This method is used for click action for all elements. This action can be used when you need to click on all the checkbox.This action is only applicable when multiple elements are present in the html dom.",example:"1.{'Web Element':'CHECKALL','Value':''}"},ClickNTimes:{description:"This method click n times on the webelement . value can be provided from the value section.This method also can be used if multiple element are found.",example:'1.{"Web Element":"BUTTONXYZ","Value":"{"countofclick":2}"} 2.{"Web Element":"BUTTONXYZ","Value":"{"countofclick":2,"index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"countofclick":2,"id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"countofclick":2,"text":"QAautoMATER","class":"QaBunch"}',value:'{"countofclick":2}'},Count:{description:"This method retrieves the count of web elements based on the web element property.",example:"1.{'Web Element':'LINKXYZ','Value':' '}"},DoubleClick:{description:"This method is used for double click on a web element.This method also can be used if multiple element are found.",example:'1.{"Web Element":"LINKXYZ","Value":" "} 2.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},DragandDrop:{description:"This method drag the element to another location . location here refering to another element and this element name can be passed from the value section.",example:'1.{"Web Element":"LISTCOUNTRY","Value":"{"nextelement":"buttonXYZ"}" 2.{"Web Element":"BUTTONXYZ","Value":"{"nextelement":"buttonXYZ","index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"nextelement":"buttonXYZ","id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"nextelement":"buttonXYZ","text":"QAautoMATER","class":"QaBunch"}}',value:'{"nextelement":"provide element name"}'},DragandDropByJavascript:{description:"This method drag the element to another location using javascript executor method. location here refering to another element and this element name can be passed from the value section.",example:'1.{"Web Element":"LISTCOUNTRY","Value":"{"nextelement":"buttonXYZ"}" 2.{"Web Element":"BUTTONXYZ","Value":"{"nextelement":"buttonXYZ","index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"nextelement":"buttonXYZ","id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"nextelement":"buttonXYZ","text":"QAautoMATER","class":"QaBunch"}}',value:'{"nextelement":"provide element name"}'},DragByOffset:{description:"This method drags the element from the source position by the specified offset values.",example:'{"Web Element":"LISTCOUNTRY","Value":"{"offset":{"x":0,"y":0}}"',value:'{"offset":{"x":0,"y":0}}'},HoverandClick:{description:"This method is best used for performing menu and submenu clicks. It allows you to perform sequential actions on two web elements in one go by hovering over the parent element specified in the WebElement section, and then interacting with the next element specified in the value section. If the next element is parameterized, you need to use the direct XPath in the nextelement section.",example:'1.{"Web Element":"LINKMENU","Value":"{"nextelement":"LINKSUBMENU"}" 2.{"Web Element":"LINKMENU","Value":"{"nextelement":"buttonXYZ"}',value:'{"nextelement":"provide element name"}'},SequentialClick:{description:"This method is best used for performing menu and submenu clicks. It allows you to perform sequential actions on two web elements in one go by clicking over the parent element specified in the WebElement section, and then interacting with the next element specified in the value section. If the next element is parameterized, you need to use the direct XPath in the nextelement section.",example:'1.{"Web Element":"LINKMENU","Value":"{"nextelement":"LINKSUBMENU"}" 2.{"Web Element":"LINKMENU","Value":"{"nextelement":"buttonXYZ"}',value:'{"nextelement":"provide element name"}'},FileUpload:{description:"This method is used for uploading file on the application, file name can be passed from the value section.",example:'1.{"Web Element":"InputFILE","Value":"{"filename":"QAautoMAER.xlsx"}"} 2.{"Web Element":"BUTTONXYZ","Value":"{"filename":"QAautoMAER.xlsx","nextelement":"buttonXYZ","index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"filename":"QAautoMAER.xlsx","nextelement":"buttonXYZ","id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"filename":"QAautoMAER.xlsx","nextelement":"buttonXYZ","text":"QAautoMATER","class":"QaBunch"}}',value:'{"filename":"Provide your file name"}'},Focus:{description:"This method is used for mouse movement on a web element.This method also can be used if multiple element are found.",example:'1.{"Web Element":"LINKXYZ","Value":" "} 2.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},GetAttribute:{description:"This method is used for getting the attribute of the element. attribute name can be passed from the value section.",example:'1.{"Web Element":"BUTTONXYZ","Value":"{"attributename":"href"}"} 2.{"Web Element":"CHKXYZ","Value":"{"attributename":"href","index":0} 3.{"Web Element":"CHKXYZ","Value":"{"attributename":"href","id":"QaBunch"} 4.{"Web Element":"CHKXYZ","Value":"{"attributename":"href","text":"QAautoMATER","class":"QaBunch"}',value:'{"attributename":"provide attribute name"}'},GetAttributeForAllElements:{description:"This method is used for getting the attribute of the all element.expected attribute can be passed from the value section.This can be used when you need to get all Country name from the country dropdown",example:'1.{"Web Element":"LISTCOUNTRY","Value":"{"attributename":"value"}"}2.{"Web Element":"CHKXYZ","Value":"{"attributename":"href","index":0} 3.{"Web Element":"CHKXYZ","Value":"{"attributename":"href","id":"QaBunch"} 4.{"Web Element":"CHKXYZ","Value":"{"attributename":"href","text":"QAautoMATER","class":"QaBunch"}',value:'{"attributename":"provide attribute name"}'},GetCssValue:{description:"This method is used for getting the css value of the element. attribute name can be passed from the value section.",example:'1.{"Web Element":"BUTTONXYZ","Value":"{"attributename":"color"}"} 2.{"Web Element":"CHKXYZ","Value":"{"attributename":"color","index":0} 3.{"Web Element":"CHKXYZ","Value":"{"attributename":"color","id":"QaBunch"} 4.{"Web Element":"CHKXYZ","Value":"{"attributename":"color","text":"QAautoMATER","class":"QaBunch"}',value:'{"attributename":"provide css attribute"}'},GetIndexOfTheElement:{description:"This method get the index of the web element as per provided attribute and its value.",example:'1.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 2.{"Web Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 3.{"Web Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},GetIndexOfTheVisibleElement:{description:"This method get the index of the visible web element, It helps in such case where hidden element is present in HTML dom. Please note it will not additional attribute also index start with 0",example:'{"Web Element":"BUTTONXYZ","Value":"{}"'},GetTagName:{description:"This method retrives the tag name of the element.Value should be blank in this case.",example:'1.{"Web Element":"BUTTONXYZ","Value":" "} 2.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},JSClick:{description:"This method is widely used when a web element is present in the HTML DOM but not displayed on the web page. It serves as an alternative to the Click method.Value should be blank in this case.",example:'1.{"Web Element":"BUTTONXYZ","Value":" "} 2.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},PressKeyBoard:{description:"This Method is used pressing keyboard on weblement . KeyName can be send in value section.",example:'1.{"Web Element":"INPUTXYZ","Value":"{"keyname":"TAB"}"} 2.{"Web Element":"BUTTONXYZ","Value":"{"keyname":"TAB","index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"keyname":"TAB","id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"keyname":"TAB","text":"QAautoMATER","class":"QaBunch"} ',value:'{"keyname":"provide key name"}'},RightClick:{description:"This Method is used pressing keyboard on weblement . KeyName can be send in value section.",example:'1.{"Web Element":"BUTTONXYZ","Value":" "} 2.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},SelectByIndex:{description:"This method select the value from dropdown based on index. Index is number which can be passed from the value section",example:'1.{"Web Element":"LISTXYZ","Value":"{"valuetobesend":"1"}"} 2.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"1","index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"1","id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"1","text":"QAautoMATER","class":"QaBunch"}',value:'{"valuetobesend":"provide index"}'},SelectByValue:{description:"This method select the value from dropdown based on value option.  option can be provided from the value section.",example:'1.{"Web Element":"LISTXYZ","Value":"{"valuetobesend":"1"}"} 2.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"1","index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"1","id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"1","text":"QAautoMATER","class":"QaBunch"}',value:'{"valuetobesend":"Provide value"}'},SelectByVisibleText:{description:"This method select the value from dropdown based on text option. Text option can be provided from the value section.",example:'1.{"Web Element":"LISTXYZ","Value":"{"valuetobesend":"QAautoMATER"}"} 2.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"QAautoMATER","index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"QAautoMATER","id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"QAautoMATER","text":"QAautoMATER","class":"QaBunch"}',value:'{"valuetobesend":"Provide text"}'},SwitchToDefaultContent:{description:"This method is used for switching to parent frame. it is widely used when element is exist into frame X and after that we need to peform action on different frame for same parent.",example:"1.{'Web Element':'INPUTXYZ','Value':' '}"},SwitchToFrame:{description:"This method is used for switching to frame. it is widely used when element is exist into frame.value should be blank in this case.",example:"1.{'Web Element':'INPUTXYZ','Value':' '}"},Type:{description:"This method type the value in editbox . value can be provided from the value section.",example:'1.{"Web Element":"LISTXYZ","Value":"{"valuetobesend":"QAautoMATER"}"} 2.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"QAautoMATER","index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"QAautoMATER","id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"QAautoMATER","text":"QAautoMATER","class":"QaBunch"}',value:'{"valuetobesend":"Provide value"}'},JSType:{description:"This method internally update the value attribute in html dom . value can be provided from the value section.",example:'1.{"Web Element":"LISTXYZ","Value":"{"valuetobesend":"QAautoMATER"}"} 2.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"QAautoMATER","index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"QAautoMATER","id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"valuetobesend":"QAautoMATER","text":"QAautoMATER","class":"QaBunch"}',value:'{"valuetobesend":"Provide value"}'},ExecuteScript:{description:"This Executescript is javascript command using this method javascript action can be performed in the html dom . javascript action can be pass in the value section.",example:'{"Web Element":"LISTXYZ","Value":"{"valuetobesend":"arguments[0].removeAttribute("type")}',value:'{"valuetobesend":"Provide value"}'},TypeAll:{description:"This method type the random value in all editbox . random value can be override , we can pass value from the value section based element attribute. value should be in JSON array format",example:'[{"id":"user-name","valuetobesend":"mycustomvalue"},{"name":"QaBunch","valuetobesend":"mycustomvalue"}]',value:"{}"},Uncheck:{description:"This method is used for unchecking web element. It is widely used for checkbox and radio button.Please note value should be blank in this case.",example:'1.{"Web Element":"CHKXYZ","Value":" "} 2.{"Web Element":"CHKXYZ","Value":"{"index":0} 3.{"Web Element":"CHKXYZ","Value":"{"id":"QaBunch"} 4.{"Web Element":"CHKXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},UncheckAll:{description:"This method uncheck all checkbox which are displayed on the page.",example:'1.{"Web Element":"CHKXYZ","Value":" "}'},SwitchToShadowDriver:{description:"This method set the shadow driver as provided shadowRoot Element, it also handle nested shadow dom object, element should be blank in this case.",example:'1.{"Web Element":"","Value":"{"shadowRoots":"["OR.A","OR.B"]"}"}',value:'{"shadowRoots":[]}'},SwitchToDynamicShadowDriver:{description:"This method set the shadow driver as provided shadowRoot Element, it also handle nested shadow dom object, element should be blank in this case.",example:'1.{"Web Element":"","Value":"{"shadowRoots":"["OR.A","OR.B"]"},"webElement","OR.Test"}',value:'{"shadowRoots":[],"webElement":"Please provide web element"}'},GetChildOfShadowDriver:{description:"This method return all shadow child as per provided parent driver, it also handle nested shadow dom object, element should be blank in this case.",example:'1.{"Web Element":"","Value":"{"shadowRoots":"["OR.A","OR.B"]"}}',value:'{"shadowRoots":[]}'},GetTagOfChildElements:{description:"This method return tag name of all child elements",example:'1.{"Web Element":"","Value":""}',value:"{}"}},BrowserAction:{AlertAccept:{description:"This method is used for acceptng the browser alert.Please note browser alert is different from application alert.",example:"{'Web Element':' ','Value':' '}"},AlertDismiss:{description:"This method is used for cancel the browser alert.Please note browser alert is different from application alert.",example:"{'Web Element':' ','Value':' '}"},AlertSendKeys:{description:"This method is used for providing the value in browser alert.Please note browser alert is different from application alert.",example:'{"Web Element":" ","Value":"{"valuetobesend":"Provide your value"}"}',value:'{"valuetobesend":"Provide your value"}'},AlertText:{description:"This method is used for getting the browser alert text .Please note browser alert is different from application alert.",example:"{'Web Element':' ','Value':' '}"},Back:{description:"This method is used for browser back action.",example:"{'Web Element':' ','Value':' '}"},Close:{description:"This method is used for closing the browser or active tab of the browser.",example:"{'Web Element':' ','Value':' '}"},Forward:{description:"This method is used for browser forward action.",example:"{'Web Element':' ','Value':' '}"},FullScreen:{description:"This method open browser in full screen mode.",example:"{'Web Element':' ','Value':' '}"},GetCurrentUrl:{description:"This method get url of the active browser or tab, if multiple windows are open then you need to switch window.",example:"{'Web Element':' ','Value':' '}"},GetTitle:{description:"This method get title of the active browser or tab, if multiple windows are open then you need to switch window.",example:"{'Web Element':' ','Value':' '}"},Maximize:{description:"This method is used for maximize the browser window.",example:"{'Web Element':' ','Value':' '}"},Minimize:{description:"This method is used for minimize the browser window.",example:"{'Web Element':' ','Value':' '}"},Navigate:{description:"This method is used for navigating URL on browser e.g. you can use this method for navigating https://qabunch.com/ on browser.",example:'1. {"Web Element":" ","Value":"{"url":"https://qabunch.com/"}"}',value:'{"url":"Provide url"}'},NewTab:{description:"This method is widely used while working on existing application we need new application in new tab, we can pass new application url in value section.",example:'1. {"Web Element":" ","Value":"{"url":"https://qabunch.com/"}"}',value:'{"url":"Provide url"}'},NewWindow:{description:"This method is widely used while working on existing application we need new application in new window, we can pass new application url in value section.",example:'1. {"Web Element":" ","Value":"{"url":"https://qabunch.com/"}"}',value:'{"url":"Provide url"}'},Refresh:{description:"This method is used for refresh the browser.",example:"{'Web Element':' ','Value':' '}"},SwitchToWindow:{description:"This method is widely used when multiple tab or windows are open, you can switch window after passing index of the window. Index is started with 0.",example:'1. {"Web Element":" ","Value":"{"browserindex":1}"}',value:'{"browserindex":"Provide browser index"}'},GetResponseFromNetworkLogs:{description:"This method retrieves the meta data responses from the network logs based on a partial request URL. It checks if the partial URL was called in the network logs, and if it was, it returns the corresponding request and response.",example:"{'Web Element':' ','Value':'{'requestUrl','auth'}'}",value:'{"requestUrl":"Provide request url"}'}},WaitAction:{Wait:{description:"This method will wait for the specified duration as provided. Please note webelement should be blank, Value should be number and it represents in seconds",example:'1. {"Web Element":" ","Value":"{"timeout":5}"}',value:'{"timeout":5}'},WaitForElementTillDisplayed:{description:"This method will wait for the specified duration as provided until the web element is displayed on the page.Please note Value should be number and it represents in seconds",example:'1. {"Web Element":"LinkXYZ","Value":"{"timeout":30}"}',value:'{"timeout":30}'},WaitForElementTillNotDisplayed:{description:"This method will wait for the specified duration as provided until the web element is not displayed on the page.Please note Value should be number and it represents in seconds",example:'1. {"Web Element":"LinkXYZ","Value":"{"timeout":30}"}',value:'{"timeout":30}'},WaitForElementTillTextContains:{description:"This method will wait for the specified duration as provided until the web element is not displayed and text is match with provided text on the page.Please note Value should be number and it represents in seconds",example:'1. {"Web Element":"LinkXYZ","Value":"{"timeout":30,"expectedtext":"QAautoMATER"}"}',value:'{"timeout":30,"expectedtext":"provide expected text"}'},WaitForElementIsEnabled:{description:"This method will wait for the specified duration as provided until the web element is enabled on the page.Please note Value should be number and it represents in seconds",example:'1. {"Web Element":"LinkXYZ","Value":"{"timeout":30}"}',value:'{"timeout":30}'},WaitForElementIsDisabled:{description:"This method will wait for the specified duration as provided until the web element is disabled on the page.Please note Value should be number and it represents in seconds",example:'1. {"Web Element":"LinkXYZ","Value":"{"timeout":30}"}',value:'{"timeout":30}'},WaitForAlertIsPresent:{description:"This method will wait for the specified duration as provided until the browser got an alert,Please note Value should be number and it represents in seconds",example:'1. {"Web Element":"","Value":"{"timeout":30}"}',value:'{"timeout":30}'},WaitForTitleContains:{description:"This method will wait for the specified duration as provided until the browser title contains the xpected value. timeout and value can be provided in value section.",example:'1. {"Web Element":"LinkXYZ","Value":"{"timeout":30,"expectedtext":"QAautoMATER"}"}',value:'{"timeout":30,"expectedtext":"Provide browser title"}'}},AssertionAction:{IsDisplayed:{description:"This method verify webelemnt is present on web application.",example:'{"Web Element":"LINKXYZ","Value": " "} 2.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},IsNotDisplayed:{description:"This method verify webelemnt is not present on web application.",example:'{"Web Element":"LINKXYZ","Value": " "} 2.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},IsEnabled:{description:"This method verify webelemnt is enabled on web application.",example:'{"Web Element":"LINKXYZ","Value": " "} 2.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},IsDisabled:{description:"This method verify webelemnt is disabled on web application.",example:'{"Web Element":"LINKXYZ","Value": " "} 2.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},IsSelected:{description:"This method verify webelemnt is selected on web application. It is widely used for checbox and readio button.",example:'{"Web Element":"LINKXYZ","Value": " "} 2.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},AssertTitleEquals:{description:"This method retrieves the active browser title and compares it to the expected value.Expected value can be pass in value section.",example:'1. {"Web Element":" ","Value":"{"title":"QAautoMATER"}"}',value:'{"title":"Provide expected title"}'},AssertTitleContains:{description:"This method retrieves the active browser title and check expected value contains the text.Expected value can be pass in value section.Please note Web element should be null in that case.",example:'1. {"Web Element":" ","Value":"{"title":"QAautoMATER"}"}',value:'{"title":"Provide expected title"}'},AssertTitleNotContains:{description:"This method retrieves the active browser title and verify expected text does not contains.Expected value can be pass in value section.Please note Web element should be null in that case.",example:'1. {"Web Element":" ","Value":"{"title":"QAautoMATER"}"}',value:'{"title":"Provide expected title"}'},AssertUrlEquals:{description:"This method retrieves the active browser url and compares it to the expected value.Expected value can be pass in value section.Please note Web element should be null in that case.",example:'1. {"Web Element":" ","Value":"{"url":"https://qabunch.com/"}"}',value:'{"url":"Provide Url Address"}'},AssertUrlContains:{description:"This method retrieves the active browser url and verify expected url contains or not.Expected value can be pass in value section.Please note Web element should be null in that case.",example:'1. {"Web Element":" ","Value":"{"url":"https://qabunch.com/"}"}',value:'{"url":"Provide Url Address"}'},AssertUrlNotContains:{description:"This method retrieves the active browser url and verify expected url does not contains.Expected value can be pass in value section.Please note Web element should be null in that case.",example:'1. {"Web Element":" ","Value":"{"url":"https://qabunch.com/"}"}',value:'{"url":"Provide Url Address"}'},AssertElementAttributeEquals:{description:"This method retrieves the webelement attribute and compares it to the expected value.attribure and expected value can be pass in value section.",example:"{'Web Element':'LinkXYZ','Value':'attributeNames:{'id':'myId','name':'myName'}'}",value:'{"attributeNames":{}}'},AssertElementAttributeContains:{description:"This method retrieves the webelement attribute and verify webelement attribute value contains expected value.attribure and expected value can be pass in value section.",example:"{'Web Element':'LinkXYZ','Value':'attributeNames:{'id':'myId','name':'myName'}'}",value:'{"attributeNames":{}}'},AssertElementAttributeNotContains:{description:"This method retrieves the webelement attribute and verify webelement attribute value does not contains expected value.attribure and expected value can be pass in value section.",example:"{'Web Element':'LinkXYZ','Value':'attributeNames:{'id':'myId','name':'myName'}'}",value:'{"attributeNames":{}}'},AssertElementCountEquals:{description:"This method get the count of webelemnt and compare it to with expected value. expected value should be number which can be passed in value section",example:'1. {"Web Element":"allLinks","Value":"{"expectedcount":10}"}',value:'{"expectedcount":"Provide Expected count here"}'},AssertElementCountGreaterThan:{description:"This method get the count of webelemnt and verify count is greter than expected value. expected value should be number which can be passed in value section",example:'1. {"Web Element":"allLinks","Value":"{"expectedcount":10}"}',value:'{"expectedcount":"Provide Expected count here"}'},AssertElementCountLessThan:{description:"This method get the count of webelemnt and verify count is less than expected value. expected value should be number which can be passed in value section",example:'1. {"Web Element":"allLinks","Value":"{"expectedcount":10}"}',value:'{"expectedcount":"Provide Expected count here"}'},AssertEquals:{description:"This method compare two value, Expected and actual value can be pass from the value section.Web Element  should be blank for this",example:'1.{"Web Element":" ","Value":"{"actualvalue":"paste your actual value","expectedvalue":"write your expected value"}}',value:'{"actualvalue" : "","expectedvalue" : ""}'},AssertGreaterThan:{description:"This method verify actual value is greater than expected value. it works only for number.element value will be null",example:'1.{"Web Element":" ","Value":"{"actualvalue":"10","expectedvalue":"5"}}',value:'{"actualvalue" : " ","expectedvalue" : " "}'},AssertLessThan:{description:"This method verify actual value is lessaer than expected value. it works only for number.element value will be null",example:'1.{"Web Element":" ","Value":"{"actualvalue":"4","expectedvalue":"5"}}',value:'{"actualvalue" : " ","expectedvalue" : " "}'},AssertContains:{description:"This method check second value exist on first value, Expected and actual value can be pass from the value section.Web Element should be blank for this",example:'1.{"Web Element":" ","Value":"{"actualvalue":"paste your actual value","expectedvalue" :"write your expected value"}}',value:'{"actualvalue" : "","expectedvalue" : ""}'},AssertNotContains:{description:"This method check second value does not exist on first value, Expected and actual value can be pass from the value section.WebElement should be blank for this",example:'1.{"Web Element":" ","Value":"{"actualvalue":"paste your actual value","expectedvalue" :"write your expected value"}}',value:'{"actualvalue" : "","expectedvalue" : ""}'},AssertWindowCountEquals:{description:"This method get the count of browser or tab and compare it to expected value. Expected value can be passed in value section.Please note Web element should be blank in this case.",example:'1. {"Web Element":" ","Value":"{"expectedcount":2}"}',value:'{"expectedcount":"Provide browser count"}'},AssertAlertTextEquals:{description:"This method retrieves the browser alert text and compares it to the expected value.Expected value can be pass in value section.Please note Web element should be null in that case.",example:'1. {"Web Element":" ","Value":"{"expectedtext":"QAautoMATER"}"}',value:'{"expectedtext":"provide expected text"}'},AssertAlertTextContains:{description:"This method retrieves the the browser alert text  and check expected value contains the text.Expected value can be pass in value section.Please note Web element should be null in that case.",example:'1. {"Web Element":" ","Value":"{"expectedtext":"QAautoMATER"}"}',value:'{"expectedtext":"provide expected text"}'},AssertAlertTextNotContains:{description:"This method retrieves the the browser alert text and verify expected text does not contains.Expected value can be pass in value section.Please note Web element should be null in that case.",example:'1. {"Web Element":" ","Value":"{"expectedtext":"QAautoMATER"}"}',value:'{"expectedtext":"provide expected text"}'},AssertIsNumberInAscendingOrder:{description:"This method verifies whether the numbers present in a list are in ascending order. The web element value should be blank in this case",example:'1.{"Web Element":" ","Value":"{"valuetobesend":"[1,2,3,4]"}}',value:'{"valuetobesend":[]}'},AssertIsNumberInDescendingOrder:{description:"This method verifies whether the numbers present in a list are in Descending order. The web element value should be blank in this case.",example:'1.{"Web Element":" ","Value":"{"valuetobesend":"[1,2,3,4]"}}',value:'{"valuetobesend":[]}'},AssertIsListSorted:{description:"This method verifies whether the string present in a sorted order. The web element value should be blank in this case.",example:'1.{"Web Element":" ","Value":"{"valuetobesend":"["QA","AB"]"}}',value:'{"valuetobesend":["QA","AB"]}'},AssertStringLengthShouldBe:{description:"This method verifies the provided string length. The web element value should be blank in this case.",example:'1.{"Web Element":" ","Value":"{"inputstring":"Session,MyString","expectedlength":0}}',value:'{"inputstring":"","expectedlength":0}'}},ApplicationAction:{},SaveAction:{SaveSessionVariable:{description:'This method can be used in two ways: First, in the step just before this function, the output can be stored using the SaveSessionVariable method—for example, if you retrieve an elements attribute and store it as a session variable (e.g., myId), it can be accessed throughout the test script by referencing Session.myId; second, you can store multiple variables at once, such as a random first name, last name, and address, by adding multiple keys like {"myFirstName": "Utility.firstName", "myLastName": "Utility.lastName", "myAddress": "Utility.address"}. Please note: 1. Session variable scope is limited to the test script level. 2. a. A pre-stored session variable Session.TestIdDetails returns a JSON object: {"Component": "TestScriptComponent", "TestId": "Your Test Id", "TestName": "Your Test Name", "Environment": "envName", "ExecutedBy": "executedBy"}. b. Session.TestId returns the executed test ID, Session.Component returns the executed test script component, Session.Environment returns the execution environment, Session.ExecutedBy returns who executed the test, and Session.TestName returns the executed test case name. Please Note Session.Capability return Json object of device capability',example:'1. {"Web Element": " ","Value":"{"variablename":"orderId"}"} 2. {"Web Element": " ","Value":"{"myFirstName": "Utility.firstName", "myLastName": "Utility.lastName", "MyAddress": "Utility.address"}"}',value:'{"variablename":"Provide variable name"}'},SaveGlobalVariable:{description:'This method can be used in two ways: First, in the step just before this function, the output can be stored using the SaveGlobalVariable method—for example, if you retrieve an elements attribute and store it as a global variable (e.g., myId), it can be accessed throughout the entire test suite by referencing Global.myId; second, you can store multiple variables at once, such as a random first name, last name, and address, by adding multiple keys like {"myFirstName": "Utility.firstName", "myLastName": "Utility.lastName", "MyAddress": "Utility.address"}. Please Note: 1. Global variable scope covers the entire test suite. 2. There are some predefined global variables: Global.Environment (returns the executing environment), Global.ApplicationUrl (returns the application URL), Global.Browser (returns the executed browser), and Global.Platform (returns the platform name).',example:'1. {"Web Element": " ","Value":"{"variablename":"orderId"}"} 2. {"Web Element": " ","Value":"{"myFirstName": "Utility.firstName", "myLastName": "Utility.lastName", "MyAddress": "Utility.address"}"}',value:'{"variablename":"Provide variable name"}'},CreateRequestParametersInSessionVariable:{description:"This method creates requestParameters which can be used for directly passing test data to the method. It takes an input totalLength,listOfParameters (used in the method), listOfParametersValue, and creates the requestParameters value according to the QAautoMATER template. This can be saved as a user-provided variable.Web element should be blank in this case.",example:'1. {"Mobile Element": " ","Value":"{"totalLength":"3","listOfParameters":"["ARGS.Username","ARGS.Password"]","listOfParametersValue":"["admin",["mypassword1","mypassword2"]","variableName":"myvar"}"}',value:'{"totalLength":"1","listOfParameters":["ARGS.param1","ARGS.param2"],"listOfParametersValue":["param1value",["param2value1","param2value2"]],"variableName":"myvar"}'}},RandomAction:{GenerateUtilityValue:{description:"This method can be used for generating test data which is in dynamic nature.This method is used with UtilityData . Please note Web element should be null and value comes from Utility Function.",example:"1. {'Web Element':' ','Value':'Utility.email'} 2. {'Web Element':' ','Value':'Utility.string(length=10)||12'}",value:'{"valuetobesend":"Provide value"}'},"String.Trim":{description:'This method removes whitespace from both ends of the string. For example, if userInput is " QAautoMATER "QAautoMATER"',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput"}'},"String.Length":{description:'This method returns the number of characters in a string. For example, if userInput is "QAautoMATER", then it returns 11.',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput"}'},"String.Substring":{description:'The method extracts a portion of a string based on the startIndex and endIndex parameters. For example, if userInput is "JavaScript" and startIndex is 0 and endIndex is 4, it returns "Java". If the endIndex is not specified, the extraction will continue to the end of the string. For example, if startIndex is 4 and endIndex is not specified, it returns "Script".',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','startPosition':0,'endPosition':0}",value:'{"userInput":"ProvideYourInput","startPosition":0,"endPosition":1}'},"String.ToUpperCase":{description:'This method converts all characters in the string to uppercase. For example, if userInput is "QAautoMATER", it returns "QAAUTOMATER".',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput"}'},"String.ToLowerCase":{description:'This method converts all characters in the string to lowercase. For example, if userInput is "QAautoMATER", it returns "qaautomater".',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput"}'},"String.Split":{description:'Splits the string into an array of substrings using the specified delimiter. For example, if userInput is "QAautoMATER is Awesome" and the delimiter = is, it returns an array of ["QAautoMATER", "Awesome"].',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','delimiter':'Input'}",value:'{"userInput":"ProvideYourInput","delimiter":"ProvideYourInput"}'},"String.Replace":{description:'The String.Replace method replaces occurrences of valueToReplace with replaceBy in the string. For example, if userInput = "QaautoMATER is good", valueToReplace = "good", and replaceBy = "Awesome", then it returns QaautoMATER is Awesome.',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','valueToReplace':'ProvideYourInput','replaceBy':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput","valueToReplace":"ProvideYourInput","replaceBy":"ProvideYourInput"}'},"String.StartsWith":{description:'This method checks if the string starts with the specified substring and returns true or false. For example, if userInput is "QAautoMATER is awesome" and searchString is "QAautoMATER", it returns true. If searchString is "qaautomater", it returns false because the check is case-sensitive.',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','searchString':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput","searchString":"ProvideYourInput"}'},"String.EndsWith":{description:'This method checks if the string ends with the specified substring and returns true or false. For example, if userInput is "QAautoMATER is awesome" and searchString is "awesome", it returns true. If searchString is "Awesome", it returns false, because the check is case-sensitive.',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','searchString':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput","searchString":"ProvideYourInput"}'},"String.Concat":{description:'This method concatenates (joins) multiple strings together including space; for example, if userInput is "QAautoMATER" and userInput2 is "awesome", it will return "QAautoMATER awesome"',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','userInput2':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput","userInput2":"ProvideYourInput"}'},"String.ExtractNumberFromTheString":{description:'This method extracts and returns the numeric value from a given string. The user can choose whether to include the decimal point in the extracted number. For example, if userInput is "QAautoMATER 12.15" and willYouremoveDot is false, it will return 12.15. If willYouremoveDot is true, it will return 1215',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','willYouremoveDot',true}",value:'{"userInput":"ProvideYourInput","willYouremoveDot":true}'},"String.RemoveNumberFromTheString":{description:'This method removes all numeric characters from a given string and returns the resulting string with only non-numeric characters. For example, if userInput is "QAautoMATER ..12_awesome", then it returns "QAautoMATER .._awesome',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput"}'},"String.SplitandSaveValueAsPerIndex":{description:'This method splits the string based on the provided delimiter and returns an array of items. Then, based on the specified index position, it returns the item at that index. For example, if userInput is "qaautomater is awesome", delimiter is "is", and indexToSave is 0, it returns "qaautomater" because the split action returns ["qaautomater", "awesome"], and the value at index 0 is "qaautomater".',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','delimiter':'ProvideYourInput','indexToSave':0}",value:'{"userInput":"ProvideYourInput","delimiter":"ProvideYourInput","indexToSave":0}'},"Math.Abs":{description:"Returns the absolute value of a number. For example, if userInput is -7.89, it returns 7.89.",example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput"}'},"Math.Ceil":{description:"This method rounds a number up to the next largest integer. For example, if userInput is 4.3, it returns 5.",example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput"}'},"Math.Floor":{description:"This method is a JavaScript function that rounds a number down to the nearest integer. For example, if the user input is 8.9, it returns 8.",example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput"}'},"Math.Round":{description:"This method rounds a number to a specified number of decimal places. For example, if the number is 4.56789 and you want to round it to 2 decimal places, the method will return 4.57. If you specify 3 decimal places, it will return 4.568., for decimal space 0 it return 5",example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.AddTwoNumber":{description:"This method adds two numbers and returns the sum. For example, if userInput1 = 1, userInput2 = 2.2, and numberToShowafterDecimal = 0, the output will be 3 (Round of Operation). If numberToShowafterDecimal = 1, the output will be 3.2. if numberToShowafterDecimal =0 then it perform round of operation.",example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','userInput2':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","userInput2":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.SubtractTwoNumber":{description:"This method subtracts two numbers and returns the result; for example, if userInput1 is 2.2, userInput2 is 1, and numberToShowafterDecimal is 0, the output will be 1 (rounded), and if numberToShowafterDecimal is 1, the output will be 1.2.",example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','userInput2':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","userInput2":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.MultiplyTwoNumber":{description:"This method multiplies two numbers and returns the value. For example, if userInput1 is 1, userInput2 is 2.1, and numberToShowAfterDecimal is 0, the output will be 2 (rounded result). If numberToShowAfterDecimal is 1, the output will be 2.1. Please note that if numberToShowAfterDecimal is 0, it performs rounding of the result.",example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','userInput2':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","userInput2":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.DivideTwoNumber":{description:"This method divides one number by another and returns the quotient. For example, if the first number is 10 and the second number is 2, the method returns 5 by performing the division 10 ÷ 2 if numberToShowAfterDecimal is 0. If the numbers are 9 and 2, it returns 4.5 by performing the division 9 ÷ 2 if numberToShowAfterDecimal is 1. Please note that if numberToShowAfterDecimal is 0, it performs rounding of the result.",example:"{'Web Element':' ','Value':'{'dividend':'ProvideYourInput','divisor':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"dividend":"ProvideYourInput","divisor":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.Reminder":{description:"This method calculates the remainder when dividing the dividend by the divisor. For example, if the dividend is 9 and the divisor is 2, it returns 1",example:"{'Web Element':' ','Value':'{'dividend':'ProvideYourInput','divisor':'ProvideYourInput'}'}",value:'{"dividend":"ProvideYourInput","divisor":"ProvideYourInput"}'},"Math.GetPercentage":{description:"This method calculates the percentage of a given number. For example, if the user input is 100 and the percentageToCalculate is 20, with numberToShowAfterDecimal set to 0, it returns 20 because 20 is 20% of 100. Please note that if numberToShowAfterDecimal is 0, it performs rounding of the result.",example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','percentageToCalculate':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","percentageToCalculate":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.AddPercentage":{description:"This method adds a specified percentage to a given number. For example, if the number is 100, the percentageValue is 20, and numberToShowafterDecimal is 0, the method returns 120 by calculating 20% of 100 (which is 20) and adding it to the original number. If numberToShowafterDecimal is 1, it returns 120.0.",example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','percentageValue':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","percentageValue":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.SubtractPercentage":{description:"This method subtracts a specified percentage from a given number. For example, if the number is 100, the percentageValue is 20, and numberToShowafterDecimal is 0, the method returns 80 by calculating 20% of 100 (which is 20) and subtracting it from the original number. If numberToShowafterDecimal is 1, it returns 80.0.",example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','percentageValue':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","percentageValue":"ProvideYourInput","numberToShowafterDecimal":0}'},"Array.Length":{description:'This method returns the size of the array; for example, if userInput is ["a", "b"], it will return 2.',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput"}'},"Array.ExcludeCharacters":{description:"This method removes all specified characters from every string inside a given array and returns a cleaned array.",example:"{'Web Element':' ','Value':'{'userInput':'[]','excludeCharacters':'[]'}",value:'{"userInput":"Provide InputList","excludeCharacters":[]}'},"Array.GetValueBasedOnIndex":{description:'This method retrieves and returns the value from a list or array based on the specified index. For example, if userInput is ["QAautoMATER", "is", "Awesome"] and indexPosition is 0, it returns QAautoMATER.',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','indexPosition':0}'}",value:'{"userInput":"ProvideYourInput","indexPosition":0}'},"Array.Search":{description:'This method searches an array to verify if a particular item is present and returns a boolean value indicating whether the item was found. For example, if userInput is ["QAautoMATER", "is"] and searchItem is "is", it returns true. Please note that this search is case-sensitive.',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','searchItem':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput","searchItem":"ProvideYourInput"}'},"Array.Sort":{description:'This method sorts the elements of an array in ascending order, arranging the items from the smallest to the largest based on their natural order. This applies to both numeric values and strings, where strings are sorted lexicographically. For example, if userInput is ["b", "d", "a", "c"], the output will be ["a", "b", "c", "d"]. If userInput is [5, 2, 10], the output will be [2, 5, 10].',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput"}'},"Array.SumOfArray":{description:"This method calculates and returns the sum of all the numeric elements in an array. It adds up the value of each element and provides the total sum as the result. For example, if userInput is [1, 2, 3], it returns 6",example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput"}'},"Array.SortDesc":{description:'This method sorts the elements of an array in descending order, arranging the items from the largest to the smallest based on their natural order. This applies to both numeric values and strings, where strings are sorted in reverse lexicographical order. For example, if userInput is ["b", "d", "a", "c"], the output will be ["d", "c", "b", "a"]. If userInput is [5, 2, 10], the output will be [10, 5, 2].',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput"}'},"Array.Push":{description:'This method adds elements to the end of the array and returns the new length of the array. For example, if userInput is ["QAautoMATER", "is"] and newElement is "Awesome", the output array will be ["QAautoMATER", "is", "Awesome"]',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','newElement','ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput","newElement":"ProvideYourInput"}'},"Array.DeleteItem":{description:'This method removes an item from an array based on the provided item and returns a new array with the item removed.For example, if userInput is ["Test", "Testing"] and itemToDelete is "Test", then the method returns the array ["Testing"].',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','itemToDelete','ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput","itemToDelete":"ProvideYourInput"}'},"Array.DeleteItemBasedOnIndex":{description:'This method removes an item from an array based on the provided index and returns a new array with the item removed. For example, if userInput is ["A", "B", "C"] and indexPosition is 1, it will delete the item at index 1 (which is "B") and return ["A", "C"].',example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','indexPosition',0}'}",value:'{"userInput":"ProvideYourInput","indexPosition":0}'},"Date.getDate":{description:'This method returns a formatted date based on the current date. It takes two arguments: addOrSubtractDaysFromPresentDate and dateTemplate. The addOrSubtractDaysFromPresentDate argument specifies the number of days to add or subtract from the current date. The dateTemplate argument allows the user to define the format of the returned date. For example, calling Date.getDate(0, "DD MMM yyyy") would return the current date in the format 14 Aug 2014 if the current date is August 14, 2014.',example:"{'Web Element':' ','Value':'{'addorDaysfromPresentDate':'ProvideYourInput','dateTemplate','ProvideYourInput'}'}",value:'{"addorDaysfromPresentDate":0,"dateTemplate":"DD MMM yyyy"}'},"Date.FormatDateTemplate":{description:"This method parses a date string using a set of possible date formats and returns the date in the specified output format. It is designed to handle date strings in various formats, converting them into a standardized format. For example, if userInput is 14 Aug 2024, initialDateTemplate is DD MMM YYYY, and expectedDateTemplate is YYYY MMM DD, the output would be 2024 Aug 14.",example:"{'Web Element':' ','Value':'{'userInput':'ProvideYourInput','initialDateTemplate','ProvideYourInput','expectedDateTemplate','ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput","initialDateTemplate":"DD MM yyyy","expectedDateTemplate":"yyyy DD MM"}'},"Date.GetDateDifference":{description:"This method calculates the difference between two dates based on the specified unit. The user can choose the unit of difference, such as days, months, years, hours, minutes, or seconds. For example, if startDate is 14 Aug 2024, startDateTemplate is DD MMM YYYY, endDate is 16 Aug 2024, endDateTemplate is DD MMM YYYY, and differenceIn is days, it returns 2. If differenceIn is months, it returns 0. Similarly, you can use this method to get the difference in hours, minutes, and seconds by providing the appropriate differenceIn option.",example:"{'Web Element':' ','Value':'{'startDate':'ProvideYourInput','startDateTemplate','ProvideYourInput','endDate','ProvideYourInput','endDateTemplate':'DD MMM yyyy','diffIn':'days'}'}",value:'{"startDate":"ProvideYourInput","startDateTemplate":"DD MMM yyyy","endDate":"ProvideYourInput","endDateTemplate":"DD MMM yyyy","diffIn":"days"}'},"JSON.getKeyValue":{description:'This method returns the value of a key from a JSON object based on the provided key name or namespace. For example, if your JsonData is {"id":1} and the keyName is id, it returns 1. If your JsonData is {"data":{"childData":{"id":2}}} and you want to get the value of id, the keyName would be data[childData][id], and it returns 2. If your JsonData is [{"id":1},{"id":2}] and you want to get the id of the second index, you would pass the keyName as 1[id], and it returns 2',example:"{'Web Element':' ','Value':'{'JsonData':'ProvideYourJsonObject','keyName','ProvidenamespaceofKey'}'}",value:'{"JsonData":"ProvideYourJsonObject","keyName":"ProvidenamespaceofKey"}'},"List.GetUniqueValues":{description:"This method removes duplicate values from a list; for example, if the list contains two ‘A’ items, it returns a list with only one ‘A’.”",example:"{'Web Element':' ','Value':'{'userInput':'yourlistitem'}'}",value:'{"userInput":"ProvideYourList"}'}},DBAction:{RunDBQuery:{description:"This method run DB query.Webelement should be null in that case.Please note If the database differs from the configuration setup, an additional key, database, can be passed in the value section.",example:"{'Web Element':' ','Value':'{'Query':'Select top 1 * from table','database':'mynewdatabase'}'}",value:'{"Query":"Select * from table"}'},SaveDBColumnValueInSessionVariable:{description:"After running the Query , we can save results column in variable based on the row index. index started with 0.Element should be null in that case.",example:"{'Web Element':' ','Value':'{'rowIndex':0,'ColumnName':'Your variable Name'}'}",value:'{"rowIndex":0,"ColumnName":"Your Variable name"}'},DBRecordCountShouldBe:{description:"After running the Query , We can put assertion based on total rows count.Element should be null in that case.",example:"{'Web Element':' ','Value':'{'rowsCount':1}'}",value:'{"rowsCount":0}'},DBRecordCountShouldBeGreaterThan:{description:"After running the Query , We can put assertion based on total rows count.Element should be null in that case.",example:"{'Web Element':' ','Value':'{'rowsCount':1}'}",value:'{"rowsCount":1}'},DBRecordCountShouldBeLessThan:{description:"After running the Query , We can put assertion based on total rows count.Element should be null in that case.",example:"{'Web Element':' ','Value':'{'rowsCount':1}'}",value:'{"rowsCount":2}'},DBRecordsCount:{description:"This method retrives the total records count.Webelement should be null in that case.Please note If the database differs from the configuration setup, an additional key, database, can be passed in the value section.",example:"{'Web Element':' ','Value':'{'Query':'Select * from table','database':'mynewdatabase'}'}",value:'{"Query":"Select * from table"}'}},ApiAction:{CallAPI:{description:"This method call existing API test scripts, In value section we need to pass component and testId.Element should be blank in this case.Please note we can also override the relativeUrl, requestHeader and Requesbody using same method.",example:"{'Web Element':' ','Value':'{'component':'component name','testId':'QB-01','relativeUrl':'/api/testid'}','requestHeader[Accept]:'myAcceptHeaderKey','requestBody[userName]:'session.Username'}",value:'{"component":"Provide component","testId":"Provide TestId"}'},SaveAPIResponseInSessionVariable:{description:"After Executiong the CallAPI method, we can retrive the response and save it in session variable.Web element value should be blank in this case.",example:"{'Web Element':' ','Value':'{'ColumnName':'Your variable Name'}'}",value:'{"myVar":"ResponseHeader[KeyName]","myVar2":"ResponseBody[KeyName]"}'}},FileReaderAction:{IsFileExistOnDownloadFolder:{description:"This method is used if any file is exist on download location. this method is widely used when some file is downloaded from the application and verify File is download on the system. file name can be passed in value section.Web Element should be blank in this case",example:'1. {"Web Element":" ","Value":"{"filename":"QAautoMATER.pdf"}"}',value:'{"filename":"provide Expected FileName"}'},FileCountOnDownloadFolder:{description:"This method is retrive to get similar file count on download folder. file name can be passed in value section.Web Element should be blank in this case",example:'1. {"Web Element":" ","Value":"{"filename":"QAautoMATER.pdf"}"}',value:'{"filename":"provide Expected FileName"}'},ReadPdfFile:{description:"This method read the pdf file from the uploads and downloads folder from the server, and save pdf content which can be save by SaveSessionVariable method after calling this method. Please note element value should be blank in that case.",example:"{'Web Element':' ','Value':'{'filename':'mydoc.pdf'}'}",value:'{"filename":"provide pdf file name"}'},PdfTotalPageCountShouldBe:{description:"This method is used to verify the page count of a PDF document.",example:"{'Web Element':' ','Value':'{'filename':'mydoc.pdf','expectedCount':2}'}",value:'{"filename":"provide pdf file name","expectedCount":2}'},ExcelRowCountShouldBe:{description:"This method compare the excel row count and expected row count should be equal based on excel name and sheet name, if sheet name not provided then it picks first worksheet .Element should be null in that case.",example:"{'Web Element':' ','Value':'{'filename':'myExcel.xlsx','sheetname':'mySheet','expectedCount':2}'}",value:'{"filename":"provide excel file name","expectedCount":2}'},ExcelRowCountShouldBeGreaterThan:{description:"This method compare the excel row count and expected row count should be Greater than based on excel name and sheet name, if sheet name not provided then it picks first worksheet .Element should be null in that case.",example:"{'Web Element':' ','Value':'{'filename':'myExcel.xlsx','sheetname':'mySheet','expectedCount':2}'}",value:'{"filename":"provide excel file name","expectedCount":2}'},ExcelRowCountShouldBeLessThan:{description:"This method compare the excel row count and expected row count should be less than based on excel name and sheet name, if sheet name not provided then it picks first worksheet .Element should be null in that case.",example:"{'Web Element':' ','Value':'{'filename':'myExcel.xlsx','sheetname':'mySheet','expectedCount':2}'}",value:'{"filename":"provide excel file name","expectedCount":2}'},SaveExcelColumnValueInSessionVariable:{description:"This method retrieves an Excel cell value by column name, with optional sheet name (defaults to the first sheet) and optional row index—returning all values if the row index is not provided.",example:"{'Web Element':' ','Value':'{filename:myExcel.xlsx,rowIndex:1,'ColumnName':'Your Variable name'}'}",value:'{"filename":"myExcel.xlsx","sheetname":"","rowIndex":1,"ColumnName":"Your Variable name"}'},SaveColumnValuesBasedOnConditionalColumnAndValue:{description:"This method searches the Excel sheet for rows where a specific column contains the given value, and returns all matching values from the selected column.",example:"{'Web Element':' ','Value':'{filename:myExcel.xlsx,'sheetname':'provideSheetName','conditionalcolumnname':'['col1','col2']','conditionalcolumnvalues':'['col1value','col2value]','columnnametofetch':'['colname1','colname2']}'}",value:'{"filename":"myExcel.xlsx","sheetname":"provideSheetName","conditionalcolumnname":["col1","col2"],"conditionalcolumnvalues":["col1value","col2value"],"columnnametofetch":["colname1","colname2"]}'}},MobileTestScripts:{CallMobileTestScript:{description:"This method call existing mobile test scripts, In value section we need to pass component and testId.Element should be blank in this case.",example:"{'Web Element':' ','Value':'{'component':'component name','testId':'QB-01'}",value:'{"component":"Provide component","testId":"Provide TestId","testdata":{"1":{}}}'}}};s.get("/project/:projectName",async(a,t)=>{var e={},i=await w(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{o.ApplicationAction={};var s=await o,c={UIAction:[],ApplicationAction:[],BrowserAction:[],WaitAction:[],AssertionAction:[],SaveAction:[],RandomAction:[],DBAction:[],ApiAction:[],MobileTestScripts:[],FileReaderAction:[],UIActionHelpText:[]},u=await a.params.projectName,l=await a.headers.accountlabel;try{var d=await r.readdirSync(n+await l+"/"+u+"/Web/CustomPageFunction/Function");for(let a=0;a<await d.length;a++){var p=await d[a];if(await p.includes(".json")){p=await p.replace(".json",""),s.ApplicationAction[p]={},s.ApplicationAction[p].description="",s.ApplicationAction[p].parameter="";var m=await n+await l+"/"+u+"/Web/CustomPageFunction/Function/"+p+".json",v=await JSON.parse(await r.readFileSync(await m,"utf8"));try{var g=await v.argumentlist;""!==await g&&(s.ApplicationAction[p].parameter=JSON.stringify(await v.argumentlist))}catch(a){s.ApplicationAction[p].parameter=""}void 0!==await v.description&&(s.ApplicationAction[p].description=await v.description)}}}catch(a){}var h=await s.UIAction,f=await Object.keys(await h),y=[];for(let a=0;a<await f.length;a++)y.push(await f[a].toString());await y.sort();var b=[];for(let a=0;a<await y.length;a++){var S={id:Number(a)+1,action:await y[a]};b.push(await S)}c.UIAction=await b,h=await s.BrowserAction,f=await Object.keys(await h),y=[];for(let a=0;a<await f.length;a++)y.push(await f[a].toString());await y.sort(),b=[];for(let a=0;a<await y.length;a++)S={id:Number(a)+1,action:await y[a]},b.push(await S);c.BrowserAction=await b,h=await s.AssertionAction,f=await Object.keys(await h),y=[];for(let a=0;a<await f.length;a++)y.push(await f[a].toString());await y.sort(),b=[];for(let a=0;a<await y.length;a++)S={id:Number(a)+1,action:await y[a]},b.push(await S);c.AssertionAction=await b,h=await s.WaitAction,f=await Object.keys(await h),y=[];for(let a=0;a<await f.length;a++)y.push(await f[a].toString());await y.sort(),b=[];for(let a=0;a<await y.length;a++)S={id:Number(a)+1,action:await y[a]},b.push(await S);c.WaitAction=await b,h=await s.SaveAction,f=await Object.keys(await h),y=[];for(let a=0;a<await f.length;a++)y.push(await f[a].toString());await y.sort(),b=[];for(let a=0;a<await y.length;a++)S={id:Number(a)+1,action:await y[a]},b.push(await S);c.SaveAction=await b,h=await s.RandomAction,f=await Object.keys(await h),y=[];for(let a=0;a<await f.length;a++)y.push(await f[a].toString());await y.sort(),b=[];for(let a=0;a<await y.length;a++)S={id:Number(a)+1,action:await y[a]},b.push(await S);c.RandomAction=await b,h=await s.ApplicationAction,f=await Object.keys(await h),y=[];for(let a=0;a<await f.length;a++)y.push(await f[a].toString());await y.sort(),b=[];for(let a=0;a<await y.length;a++)S={id:Number(a)+1,action:await y[a]},b.push(await S);c.ApplicationAction=await b;var x=await s.DBAction;f=await Object.keys(await x),y=[];for(let a=0;a<await f.length;a++)y.push(await f[a].toString());await y.sort(),b=[];for(let a=0;a<await y.length;a++)S={id:Number(a)+1,action:await y[a]},b.push(await S);c.DBAction=await b;var M=await s.ApiAction;f=await Object.keys(await M),y=[];for(let a=0;a<await f.length;a++)y.push(await f[a].toString());await y.sort(),b=[];for(let a=0;a<await y.length;a++)S={id:Number(a)+1,action:await y[a]},b.push(await S);c.ApiAction=await b,M=await s.FileReaderAction,f=await Object.keys(await M),y=[];for(let a=0;a<await f.length;a++)y.push(await f[a].toString());await y.sort(),b=[];for(let a=0;a<await y.length;a++)S={id:Number(a)+1,action:await y[a]},b.push(await S);c.FileReaderAction=await b,M=await s.MobileTestScripts,f=await Object.keys(await M),y=[];for(let a=0;a<await f.length;a++)y.push(await f[a].toString());await y.sort(),b=[];for(let a=0;a<await y.length;a++)S={id:Number(a)+1,action:await y[a]},b.push(await S);c.MobileTestScripts=await b,c.UIActionHelpText=await s}catch(a){}t.json(c)}),a.exports=s},8688:(a,t,e)=>{const i=e(7252).Router(),{readJSONFile:r}=e(7229),s=e(4716);i.get("/org/:orgname/project/:projectname",async(a,t)=>{var e={isSuccess:!1,projectDetails:{},orgDetails:{},errorMessage:""};try{var i,n=a.params.orgname,w=a.params.projectname,o=await r("OrgLicenceDetails/"+await n+".json");if(void 0===await o)return e.errorMessage=await accountName+" account does not exist in License key. Please connect QaBunch Support Team.",t.json(e);i=await s();var c=await s(await i).format("DD MMM yyyy"),u=!1;if(void 0===await o.UILicenceValidity)o.isUIComponentDisplayed=!1;else{var l=await s(await o.UILicenceValidity,"DD MMM yyyy"),d=await l.diff(await c,"days",!0);await d>0&&(u=!0,o.isUIComponentDisplayed=!0)}var p=!1;if(void 0===await o.APILicenceValidity)o.isApiComponentDisplayed=!1;else{var m=await s(await o.APILicenceValidity,"DD MMM yyyy");d=await m.diff(await c,"days",!0),await d>0&&(p=!0,o.isApiComponentDisplayed=!0)}var v=!1;if(void 0===await o.MobileLicenceValidity)o.isMobileComponentDisplayed=!1;else{var g=await s(await o.MobileLicenceValidity,"DD MMM yyyy");d=await g.diff(await c,"days",!0),await d>0&&(v=!0,o.isMobileComponentDisplayed=!0)}await v||await p||await u?o.isAutomationComponentDisplayed=!0:o.isAutomationComponentDisplayed=!1,e.orgDetails=await o;var h=await o[await w];if(void 0===await h)return e.errorMessage=await w+" project does not exist in "+await n+" License key. Please connect QaBunch Support Team.",t.json(e);var f=await h.licenseValidityFromPresentDay;if(f=await s(await f,"DD MMM yyyy"),d=await f.diff(await c,"days",!0),await d<=0)return e.errorMessage="Your project License has expired for project "+await w+". Please connect QaBunch support team.",t.json(e);e.projectDetails=await h,e.isSuccess=!0}catch(a){e.errorMessage=await a.toString()}t.json(e)}),a.exports=i},8786:(a,t,e)=>{e(9896);const i=e(3498),{readJSONFile:r}=e(7229),s=e(5504);a.exports={runDBQuery:async function(a,t,e,n,w){var o={isSuccess:!0,errorMessage:"",output:[],supportingEvidence:{}};try{var c=await a+"/"+await t+"/Configuration.json",u=await r(await c);if(void 0===await u.DBDETAILS)return o.isSuccess=!1,o.errorMessage="DBDETAILS is not found under configuration page. Please make sure all details are present in configuration page.",await o;if(void 0===await u.DBDETAILS[await e])return o.isSuccess=!1,o.errorMessage=await e+" is not found under DBDETILA section on configuration page. Please make sure all details are present in configuration page.",await o;var l=await Object.keys(await u.DBDETAILS[await e]);if(0===await l.length)return o.isSuccess=!1,o.errorMessage="Server type is not found under DBDETILA section on configuration page. Please make sure all details are present in configuration page.",await o;var d=await l[0],p=await u.DBDETAILS[await e][await d].port,m=await u.DBDETAILS[await e][await d].host,v=await u.DBDETAILS[await e][await d].user,g=await u.DBDETAILS[await e][await d].password;if(void 0===await w||""===await w)var h=await u.DBDETAILS[await e][await d].databasename;else h=await w.toString().trim();switch(await d.toString().toUpperCase()){case"SQL":o=await async function(a,t,e,r,s,n){var w={isSuccess:!0,errorMessage:"",output:[],supportingEvidence:{}};try{if(void 0===await a||""===await a)var o=await i.createConnection({host:await t,user:await e,password:await r,database:await s});else o=await i.createConnection({host:await t,user:await e,password:await r,database:await s,port:Number(await a)});if(await n.trim().toUpperCase().startsWith("SELECT")){const[a,t]=await o.query(await n);await a.length>0&&(w.output=JSON.stringify(await a))}else await o.query(await n)}catch(a){w.isSuccess=!1,w.errorMessage=await a.toString()}return await w}(await p,await m,await v,await g,await h,await n);break;case"ORACLE":o=await async function(a,t,e,i,r,n){var w={};let o;w.isSuccess=!0,w.errorMessage="",w.output=[],w.supportingEvidence={};try{n=await n.toString().trim(),await n.trim().endsWith(";")&&(n=await n.trim().slice(0,-1));const c=await t+(a?`:${a}`:"")+`/${r}`;if(o=await s.getConnection({user:await e,password:await i,connectString:c}),await n.trim().toUpperCase().startsWith("SELECT")){const a=await o.execute(n,[],{outFormat:s.OUT_FORMAT_OBJECT});try{JSON.stringify(a)}catch(a){console.log("Query Results Error:",a)}if(a.rows.length>0){const t=new WeakSet;w.output=JSON.stringify(a.rows.map(function(a){let e={};for(let i in a){let r=a[i];if("object"==typeof r&&null!==r){if(t.has(r)){e[i]="[Circular]";continue}t.add(r)}r instanceof s.Lob?e[i]="[LOB Data]":e[i]=r}return e}))}}}catch(a){w.isSuccess=!1,w.errorMessage=await a.toString()}finally{if(o)try{await o.close()}catch(a){console.error("Error closing the connection: ",a)}}return await w}(await p,await m,await v,await g,await h,await n)}}catch(a){o.isSuccess=!1,o.errorMessage=await a.toString()}return await o}}},8870:(a,t,e)=>{const i=e(7252).Router(),{getActiveThreadCounter:r,getPlanForAccount:s,addUIExecutionThread:n,resetUIExecutionThread:w}=e(5843),{executeTestScript:o,getBrowserVersion:c}=e(8505),{saveFile:u,isDirectoryExist:l,createDirectory:d,addOrSubtractDaysToCurrentDate:p,deleteAllFileFromFolder:m,isSpaceFreeOnAccount:v,addLogMessageInConsole:g,readJSONFile:h}=e(7229),{getAllCustomFunction:f,getUuid:y}=e(6777),{sendEmail:b,sendEmailUsingSMTPRelay:S}=e(1751);var x="./dataHub/";const{authCheck:M}=e(2258);var N=e(9896);const T=e(2410);async function E(a,t,e){for(let s=0;s<await a.length;s++){var i=await a[s].component,r=await a[s].testid;if(await i===await t&&await r===await e)return s}return-1}async function A(a,t,e,i,r,s,n,w,o,c,u,l,d){try{if(void 0!==await a&&"Yes"===await a&&void 0!==await t&&""!==await t&&void 0!==await e&&void 0!==await e.EMAILDETAILS){var p=await e.EMAILDETAILS.DefaultEmailProtocol;if(void 0!==await p&&""!==await p){var m=await e.EMAILDETAILS[await p],v={};v.host=await m.host,v.port=await m.port,v.senderEmail=await m.senderEmail,v.password=await m.password,v.recipientEmail=await t,v.TitlePrefix=await i,v.env=await r,v.executionDate=await s,v.executionTime=await n,v.totalPass=await w,v.totalFail=await o,v.suiteName=await u,v.executedBy=await l,v.resultOfTestScripts=await d,v.totalExecutionTime=await async function(a){try{a=await Number(await a);let t=Math.floor(await a/3600),e=Math.floor(await a%3600/60),i=await a%60,r=[];return await t>0&&r.push(`${t} Hour${t>1?"s":""}`),await e>0&&r.push(`${e} Minute${e>1?"s":""}`),await i>0&&r.push(`${i} Second${i>1?"s":""}`),r.length>0?r.join(" "):"0 seconds"}catch(t){return a+" seconds"}}(await c),"SMTP Relay"===await p?await S(await v):await b(await v)}}}catch(a){console.log("Email Sent exception ocuured "+await a.toString())}}i.post("/project/:projectName",async(a,t)=>{var e={},i=await M(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var b=await i.totalStorage,S=await a.headers.useremail,P=await a.headers.accountlabel,C={globalError:"",listOfTestScipts:[],testscriptAssertionData:[],executionTimeForTestScripts:{}},k=!1,j={},D=0,O=0;try{var I=await a.params.projectName,L=(P=await a.headers.accountlabel,await v(await P,await I,await b));if(!await L.isSuccess)return C.globalError=await L.errorMessage,console.log("Execution is triggered by the user "+await S+" becuase space is insufficient, execution terminated."),t.json(C);var F=new Date,U=await p(0,"DD MMM YYYY"),V=await p(0,"hh mm A"),B=[],R=await a.body.environment,J=await a.body.runAt,X=await Number(await a.body.threadCount),W=await a.body.reportInDashBoard,Y=await a.body.screenName,G=await a.body.deviceName,Q=await a.body.applicationUrl;B=await a.body.testscriptforExecution;var q=await a.body.PageLoaderXpath,Z=await a.body.suiteName,K=await a.body.emailTriggerValue,H=await a.body.recipientEmail,_=!0;void 0!==await Z&&"CustomTestScriptSelection"!==await Z||(Z="CustomTestScriptSelection",_=!1);var z,$=[],aa={},ta={};try{var ea=await P+"/"+await I+"/Web/Configuration.json";ta=await h(await ea)}catch(a){}var ia={};try{ea=await P+"/"+await I+"/Web/CommonTestData.json";var ra=await h(await ea);ia=void 0===await ra.CommonTestData?{}:await ra.CommonTestData}catch(a){ia={},ra={}}var sa=await ra.TestDataExistingEnvironment;void 0===await sa&&(sa=[]),z=await a.body.environment,await m(await P+"/"+I+"/Web/Downloads/"),await d(await P+"/"+await I+"/Web/Downloads/");var na=await f(await P,await I);try{aa=await ta.ExecutionCapabilities[await J]}catch(a){if("Server"!==await J)return console.log("Execution is triggered by the user "+await S+" but capability details are needed for cloud execution server ."),C.globalError="Please add capability details on UI configuration page for cloud execution server "+await J,t.json(await C);aa={}}var wa={},oa=await ta.DefaultScreenshotOption;void 0===await oa&&(oa="For failure & success");var ca=await ta.defaultTimeOut;void 0===await ca&&(ca=0);var ua="Yes";try{ua=await ta.SelectedSelfHealingOption,void 0===await ua&&(ua="Yes")}catch(a){ua="Yes"}var la="No";try{la=await ta.SelectedHeadlessOption,void 0===await la&&(la="No")}catch(a){la="No"}var da=await B.length;if(da<=X&&(X=await da),"Server"===await J){var pa=await r(await P,await I,"Web"),ma=await s(await i),va=Number(await ma.maxThreadForUI);if(await pa>=Number(await ma.maxThreadForUI))return console.log("Execution is triggered by the user "+await S+" but "+await va+" thread are already active, as per your plan max "+await va+" thread can be active at a time, Please release the thread or wait till thread get released."),C.globalError=await va+" thread are already active, as per your plan max "+await va+" thread can be active at a time, Please release the thread or wait till thread get released.",t.json(await C);var ga=await Number(await va)-await Number(await pa);if(Number(await X)>Number(await ga))return console.log("Execution is triggered by the user "+await S+" Only "+await ga+" thread is/are available.Please update Thread count* as per availability"),C.globalError="Only "+await ga+" thread is/are available.Please update Thread count* as per availability",await g(await C.globalError),t.json(await C);await n(await P,await I,await S,await X,"Web"),k=!0}var ha=[],fa=[];console.log("********* Execution is triggered by the user "+await S+" with Environment "+await R+", thread count "+await X+", Report to be saved in Dashboard value "+await W+",testsuite,"+await Z+" and test script count "+await da);var ya={};ya.Environment=await R,ya.ApplicationUrl=await Q,ya.Browser=await G,ya.PlatForm=await Y,ya.ExecutedBy=await S,ya.SelfHealing=await ua,ya.HeadlessMode=await la,"Desktop"===await Y?ya.IsResponsive=!1:ya.IsResponsive=!0;try{var ba=await P+"/"+await I+"/Web/Misc/GlobalVariable.Json",Sa=await h(await ba);if(await Object.keys(await Sa).length>0){var xa=await Object.keys(await Sa);for(let a=0;a<await xa.length;a++){var Ma=await xa[a],Na=await Sa[await Ma];ya[await Ma]=await Na}}}catch(a){}for(let a=0;a<await B.length;a++){await a;try{var Ta=await B[await a].component;if(void 0!==await Ta&&null!==await Ta&&""!==await Ta){var Ea=await B[a].testid,Aa=await B[a].testname,Pa={};Pa.Component=await Ta,Pa.TestId=await Ea,Pa.TestName=await Aa,Pa.Environment=await R,Pa.ExecutedBy=await S;var Ca=o(await P,await I,await Ta,await Ea+"@"+await Aa,await Q,await G,await J,await Y,await aa,await ia,await na,await oa,await z,await q,await ca,await ua,await W,await Pa,await ya,await{});ha.push(Ca),await new Promise(a=>setTimeout(a,1e3)),"server"===await J.toString().toLowerCase().trim()&&(fa.push(Ca),await fa.length===await X&&await Promise.any(fa.map((a,t)=>a.then(a=>[a,t]))).then(([a,t])=>{fa.splice(t,1)}))}}catch(t){console.log("Exception: for reading component for test script index "+await a+" , hence skipping this test script "+JSON.stringify(await B))}}await Promise.all(await ha).then(a=>{var t=a;for(let a=0;a<t.length;a++){var e=Number(a+1);B[a].id=e,t[a].isSuccess?(B[a].status="Pass",D+=1):(B[a].status="Fail",O+=1),j[e.toString()]=t[a].assertionData,wa[Number(e)]=t[a].executiontime;var i={component:B[a].component,duration:t[a].executiontime};$.push(i)}}),C.executionTimeForTestScripts=await wa,C.listOfTestScipts=await B,C.testscriptAssertionData=await j;var ka={};for(let a=0;a<await $.length;a++){var ja=await $[a].component,Da=await $[a].duration;void 0===await ka[ja]?ka[await ja]=Number(await Da):ka[await ja]=Number(ka[ja])+Number(await Da)}if(C.executionTimeForComponent=await ka,"yes"===await W.toString().toLowerCase())try{var Oa=await C.listOfTestScipts,Ia=await c(null),La={},Fa=await a.body.existingSuiteName,Ua=await x+await P+"/"+I+"/Web/Reports/"+await R+"/"+Fa+".json",Va=await N.existsSync(await Ua);if(""!==await Fa&&void 0!==await Fa&&await Va){var Ba=((new Date).getTime()-F.getTime())/1e3;Ba=await Number(await Ba.toString().split(".")[0]),La={TimeStamp:await U+" "+await V,TotalTestScripts:await Oa.length,Duration:await Ba+" seconds",ExecutedBy:await S,Browser:await G+" "+await Ia},ea=await x+await P+"/"+I+"/Web/Reports/"+await R+"/"+Fa+".json";var Ra=await JSON.parse(await N.readFileSync(await ea,"utf8"));for(let a=0;a<await Oa.length;a++){var Ja=await Oa[a].component;if(void 0!==await Ja&&null!==await Ja&&""!==await Ja){Ea=await Oa[a].testid;var Xa=await Oa[a].status,Wa=await E(await Ra.listOfExecutedTestScripts,await Ja,await Ea);if(await Wa>=0){var Ya=await Ra.listOfExecutedTestScripts[await Wa].status;if(Oa[a].id=Number(await Wa)+1,Ra.listOfExecutedTestScripts[await Wa]=await Oa[a],Ra.assertionResultsForAllTestScripts[Number(await Wa+1).toString()]=await C.testscriptAssertionData[Number(await a+1).toString()],await Xa!==await Ya)if("pass"===await Xa.toLowerCase()){var Ga=Number(Ra.totalPass),Qa=Number(Ra.totalFail);Ra.totalPass=await Ga+1,""!==await Ya&&(Ra.totalFail=await Qa-1);var qa=Number(Ra.componentPassFail[0][await Ja]),Za=Number(Ra.componentPassFail[1][await Ja]);Ra.componentPassFail[0][await Ja]=await qa+1,""!==await Ya&&(Ra.componentPassFail[1][await Ja]=await Za-1)}else"fail"===await Xa.toLowerCase()&&(Ga=Number(Ra.totalPass),Qa=Number(Ra.totalFail),""!==await Ya&&(Ra.totalPass=await Ga-1),Ra.totalFail=await Qa+1,qa=Number(Ra.componentPassFail[0][await Ja]),Za=Number(Ra.componentPassFail[1][await Ja]),""!==await Ya&&(Ra.componentPassFail[0][await Ja]=await qa-1),Ra.componentPassFail[1][await Ja]=await Za+1)}}}void 0===await Ra.testSuiteReExecutionHistory&&(Ra.testSuiteReExecutionHistory=[]),Ra.testSuiteReExecutionHistory.push(await La),await u(await P+"/"+I+"/Web/Reports/"+await R+"/"+Fa+".json",await Ra);try{Ba=((new Date).getTime()-F.getTime())/1e3,Ba=await Number(await Ba.toString().split(".")[0]);var Ka=await Fa;await Ka.includes("-")&&(Ka=await Ka.split("-")[0]),await A(await K,await H,await ta,"Web",await R,await U,await V,await D,await O,await Ba,await Ka,await S,await C),await g(await S+" Total "+await D+" scripts get passed.  "+await O+" scripts get failed and total execution time is "+await Ba+" seconds.")}catch(a){}}else{var Ha=[],_a={},za={};for(let a=0;a<await Oa.length;a++){Ja=await Oa[a].component,void 0===_a[await Ja]&&(_a[await Ja]=0),void 0===za[await Ja]&&(za[await Ja]=0);var $a=await Oa[a].status;"Pass"===await $a?_a[await Ja]=await _a[await Ja]+1:"Fail"===$a&&(za[await Ja]=await za[await Ja]+1)}Ha.push(await _a),Ha.push(await za);var at={};at.executedBy=await S,at.executionStartDate=await U,at.executionStartTime=await V,at.testingType="Integration Testing",at.listOfExecutedTestScripts=await C.listOfTestScipts,at.assertionResultsForAllTestScripts=await C.testscriptAssertionData,at.environment=await R,at.totalPass=await D,at.totalFail=await O,at.screen=await Y,at.devicebrowser=await G+" "+await Ia,at.componentPassFail=await Ha,at.executionTimeData=await C.executionTimeForComponent,at.executionTimeForTestScripts=await C.executionTimeForTestScripts;var tt=await a.body.triggerFrom;void 0===await tt&&(tt="QAautoMATER UI"),at.triggerFrom=await tt,Ba=((new Date).getTime()-F.getTime())/1e3,Ba=await Number(await Ba.toString().split(".")[0]),at.totalExecutionTime=await Ba,await l(await P+"/"+I+"/Web/Reports/"+R)||await d(await P+"/"+I+"/Web/Reports/"+await R);var et=at.executionStartDate.toString().trim()+"_"+at.executionStartTime.toString().trim(),it=await at.executionStartTime.toString().trim(),rt=await it.split(" "),st=(Number(await rt[1]),x+await P+"/"+I+"/Web/Reports/"+await R+"/*"+await et+".json"),nt=await T.sync(await st);if(await nt.length>0&&(et=await et+" "+await y()),await Va||""===Fa)et=await Z+"-"+await et;else{try{await Fa.includes("-")&&(Fa=await Fa.split("-")[0])}catch(a){Fa=await Z}Z=await Fa,et=await Fa+"-"+await et}if(at.suiteName=await Z,await _||"CustomTestScriptSelection"!==await Z)try{var wt=await Z,ot=await x+await P+"/"+I+"/Web/TestSuite/"+wt+".json",ct=await N.existsSync(await ot);if(await ct){var ut=await JSON.parse(await N.readFileSync(await ot,"utf8")),lt=await ut.testsuite;if(await lt.length!==await da){var dt=await C.testscriptAssertionData,pt=await C.listOfTestScipts,mt=[],vt={};for(let a=0;a<await lt.length;a++){var gt=await lt[a];gt.status="";var ht=await gt.id,ft=await gt.component,yt=await gt.testid;for(let a=0;a<await pt.length;a++){var bt=await pt[a].component,St=await pt[a].testid;if(await bt==await ft&&await St==await yt){gt.status=await pt[a].status,vt[await ht.toString()]=await dt[await pt[a].id.toString()];break}}mt.push(await gt)}at.assertionResultsForAllTestScripts=await vt,at.listOfExecutedTestScripts=await mt}}}catch(a){}await u(await P+"/"+I+"/Web/Reports/"+await R+"/"+et+".json",await at),console.log("********* Test Reports is successfully saved to the server where execution is triggered by the user "+await S),await A(await K,await H,await ta,"Web",await R,await at.executionStartDate,await at.executionStartTime,await D,await O,await at.totalExecutionTime,await Z,await S,await C)}}catch(a){console.log("Unable to Save Reports because of "+await a.toString()+" execution is triggered by "+await S)}else try{Ba=((new Date).getTime()-F.getTime())/1e3,Ba=await Number(await Ba.toString().split(".")[0]),await A(await K,await H,await ta,"Web",await R,await U,await V,await D,await O,await Ba,await Z,await S,await C),await g(await S+" Total "+await D+" scripts get passed.  "+await O+" scripts get failed and total execution time is "+await Ba+" seconds.")}catch(a){}}catch(a){console.log("Test suite execution throw exception and reports not generated "+await a.toString()+". execution is triggered by "+await S)}try{""!==await C.globalError&&(console.log("Unexpected error "+await C.globalError),await C.listOfTestScipts.length>0&&(C.globalError=""))}catch(a){}"Server"===await J&&await k&&await w(await P,await I,await S,await X,"Web"),t.json(C)}),a.exports=i},8938:a=>{"use strict";a.exports=require("axios")},9015:(a,t,e)=>{const i=e(7252).Router();var r="./dataHub/";const s=e(829),{saveFile:n,isDirectoryExist:w,createDirectory:o,addLogMessageInConsole:c,readJSONFile:u,saveFileAsEncyptedContent:l}=e(7229),{authCheck:d,isLicenseValid:p}=e(2258),m=e(8330);var v=e(9896);const g=e(4716),h=e(2410),f=e(6928);async function y(a,t){var e=0,i=await Object.keys(await a);for(let n=0;n<await i.length;n++){var r=await i[n],s=await a[await r].accounts;await s.includes(await t)&&(e=Number(await e)+1)}return e}e(2103),e(3106),i.get("/:userEmail",async(a,t)=>{var e=a.params.userEmail.toString().trim().toLocaleLowerCase(),i={isUserExistonServer:!1,errorMessage:"",accounts:[],accountLabel:[],orgname:""};try{var r=await u("UserAccountInfo.json"),s=await r[await e];void 0===await s&&(i.errorMessage="User "+await e+" does not exist on Server.",t.json(await i));var n=await s.accountLabel[0];i.orgname=await n;var w=await u(await n+"/UserDetails/UserDetails.json"),o=await w[await e];if(void 0===await o)i.errorMessage="User "+await e+" does not exist on server.";else{var l=await w[await e].accounts;await l.includes(null)&&(l=await l.filter(a=>null!==a)),i.accounts=await l;var d=await w[await e].accountLabel;i.accountLabel=await d,i.isUserExistonServer=!0}}catch(a){i.errorMessage=await a.toString()}await c(await e+" trying to logging into QAautoMATER application."),t.json(await i)}),i.post("/",async(a,t)=>{var e={isUserAuthenticated:!1,token:"",errorMessage:"",firstName:"",lastName:"",isSuperAdmin:!1,expiresOn:"",host:"",isManualComponentDisplayed:!1,isDefectComponentDisplayed:!1,isAutomationComponentDisplayed:!1,isUIComponentDisplayed:!1,isApiComponentDisplayed:!1,isMobileComponentDisplayed:!1,support:""};e.apiVersion=await m.version,e.totalStorage="",e.UserAllAccount=[];try{var i=await a.body.userEmail.toString().trim().toLowerCase(),l=await a.body.password,d=await a.headers.userselectedaccount,h=await a.headers.accountlabel,f=await a.headers.serverurl,y=await u(await h+"/UserDetails/UserDetails.json"),b=await y[i];if(void 0===await b)return(x={isUserAuthenticated:!1}).errorMessage="User "+await i+" does not exist on Server",await c(await i+" "+x.errorMessage),t.json(await x);var S=await b.secretKey;if(await S!==await l){var x={isUserAuthenticated:!1,errorMessage:"Password does not match."};return await c(await i+" "+x.errorMessage),t.json(await x)}try{var M=await p(await h,await d,await f);if(!await M.isUserExistonServer)return e.errorMessage=await M.errorMessage.toString(),await c(await i+" "+await M.errorMessage),t.json(await e);e.expiresOn=await M.expiresOn,e.isManualComponentDisplayed=await M.isManualComponentDisplayed,e.isDefectComponentDisplayed=await M.isDefectComponentDisplayed,e.isAutomationComponentDisplayed=await M.isAutomationComponentDisplayed,e.isUIComponentDisplayed=await M.isUIComponentDisplayed,e.isApiComponentDisplayed=await M.isApiComponentDisplayed,e.isMobileComponentDisplayed=await M.isMobileComponentDisplayed,e.support=await M.support,e.totalStorage=await M.totalStorage;var N,T=await M.expiresOn;T=await g(await T,"DD MMM yyyy"),N=await g();var E=await g(await N).format("DD MMM yyyy"),A=await T.diff(await E,"days",!0);const a=`${await A}d`,r=await l,n=await i;token=await s.sign({email:n},r,{expiresIn:a}),e.token=await token}catch(a){return e.errorMessage=await a.message,await c(await i+" "+await a.message),t.json(await e)}e.isUserAuthenticated=!0;var P=!1;try{var C=await u(await h+"/UserDetails/AccountAdmin.json");await C[await d].includes(await i)&&(P=!0)}catch(a){P=!1}e.isSuperAdmin=await P;var k=await y[await i].firstName;void 0===await k&&(k="FirstName"),e.firstName=await k;var j=await y[await i].lastName;void 0===await j&&(j="LastName"),e.lastName=await j;var D=await w(await h+"/UserSession");await D||await o(await h+"/UserSession");var O=await r+await h+"/UserSession/UserSession.json",I=await w(await O);if(!await I){const a={},t=JSON.stringify(await a,null,2);await v.writeFileSync(await O,await t)}var L=await JSON.parse(await v.readFileSync(await O,"utf8"));void 0===await L[await d]&&(L[await d]={}),L[await d][await i]=await token;var F=[],U=await M.accounts,V=await y[await i].accounts;for(let a=0;a<await V.length;a++){var B=await V[a];await U.includes(await B)&&F.push(await B)}e.UserAllAccount=await F,await n(await h+"/UserSession/UserSession.json",await L)}catch(a){return(x={isUserAuthenticated:!1}).errorMessage=await a.toString(),await c(await i+" "+x.errorMessage),t.json(await x)}await c(await i+" Login done."),t.json(await e)}),i.post("/signout",async(a,t)=>{var e={isSuccess:!1,errorMessage:""},i="",s="";try{i=await a.headers.authorization.split(" ")[1],s=await a.headers.useremail.toString().trim().toLocaleLowerCase();var w=await a.headers.userselectedaccount,o=await a.headers.accountlabel;if(!await i)return t.status=400,e.errorMessage="Autherization token is missing",await c(await s+" "+await e.errorMessage),t.json(await e)}catch(a){e.errorMessage=await a.message,await c(await s+" "+await e.errorMessage)}try{s=await s.toLocaleLowerCase();var u=await w.toString().trim().toLocaleLowerCase();if(u=await u+"cicduser",await s.includes(await u))e.isSuccess=!0;else{var l=await r+await o+"/UserSession/UserSession.json",d=await JSON.parse(await v.readFileSync(await l,"utf8"));d[await w][await s.toLocaleLowerCase()]="",await n(await o+"/UserSession/UserSession.json",await d),e.isSuccess=!0}}catch(a){e.errorMessage=await a.message,await c(await s+" "+await e.errorMessage)}await c(await s+" logout successfully done."),t.json(await e)}),i.post("/changepassword",async(a,t)=>{var e={},i=await d(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isPasswordChanged:!1,errorMessage:""};try{var s=await a.headers.accountlabel,n=a.body.userEmail.toString().toLowerCase(),w=a.body.password,o=a.body.newPassword,c=await u(await s+"/UserDetails/UserDetails.json"),p=await c[n];void 0!==p?w.toString()===await p.secretKey?(c[n].secretKey=o,await l(await s+"/UserDetails/UserDetails.json",c),r.isPasswordChanged=!0):r.errorMessage="Password does not match":r.errorMessage="User does not exist on server"}catch(a){r.errorMessage=a.toString()}t.json(r)}),i.post("/updateprofile",async(a,t)=>{var e={},i=await d(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isProfileUpdated:!1,errorMessage:""};try{var s=await a.headers.accountlabel,n=await a.headers.useremail.toLocaleLowerCase().trim(),w=a.body.firstName,o=a.body.lastName,c=await u(await s+"/UserDetails/UserDetails.json");c[await n].firstName=await w.trim(),c[await n].lastName=await o.trim(),await l(await s+"/UserDetails/UserDetails.json",c),r.isProfileUpdated=!0}catch(a){r.errorMessage=a.toString()}t.json(r)}),i.post("/addnewuser",async(a,t)=>{var e={},i=await d(await a);if(!await i.isSuccess)return e.isSuccess=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var s=await i.maxUsers,w=await a.headers.useremail;w=await w.toString().toLocaleLowerCase().trim();var o=await a.headers.userselectedaccount,c=await a.headers.accountlabel,p=await i.accounts,m=await u(await c+"/UserDetails/AccountAdmin.json"),g=await m[await o];if(!await g.includes(await w))return e.isSuccess=!1,e.errorMessage="User does not have permission to add new user.",t.json(await e);var h=await a.body.allUserData,f=await i.maxUsers;if(await h.length>await Number(await f))return e.isSuccess=!1,e.errorMessage="As per QaBunch agreement , you can add up to "+await f+" users.",t.json(await e);var b=await async function(a){var t={isValid:!1,errorMessage:""};try{var e=await a,i=[];for(let a=0;a<await e.length;a++){var r=await e[a].email;r=await r.toString().trim().toLocaleLowerCase();var s=await e[a].firstname,n=await e[a].lastname,w=await e[a].password;if(""===await r.trim()||""===await s.trim()||""===await n.trim()||""===await w.trim())return t.errorMessage="User Profile data are in in correct form. Email,firstname,lastname and password are mandatory.",t;if(await i.includes(await r.toString().toLowerCase()))return t.errorMessage="Duplicate Email "+await r+" are found.",t;await i.push(await r.toString().toLowerCase());var o=/[^A-Za-z-]/gi;if(await o.test(await s))return t.errorMessage="First name "+await s+" should not have special character and number.",t;if(await o.test(await n))return t.errorMessage="Last name "+await n+" should not have special character and number.",t;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(await r))return t.errorMessage="Email "+await r+" is not valid",t}t.isValid=!0}catch(a){}return await t}(await h);if(!await b.isValid)return e.errorMessage=await b.errorMessage,t.json(await e);var S=await u(await c+"/UserDetails/UserDetails.json"),x=await async function(a){var t=[];try{var e=await a;for(let a=0;a<await e.length;a++){var i=await e[a].account;for(let a=0;a<await i.length;a++){var r=await i[a].label;await t.includes(await r)||t.push(await r)}}}catch(a){}return await t}(await h);for(let a=0;a<await x.length;a++){var M=await x[a],N=await y(await S,await M),T=await s;if(Number(await N)>await Number(await T))return e.errorMessage="Account "+await M+" has reached the maximum allowed users.",t.json(await e)}var E=await u("UserAccountInfo.json"),A=[];for(let a=0;a<await h.length;a++){w=await h[a].email.toString().trim().toLocaleLowerCase(),A.push(await w);var P=await h[a].firstname.toString().trim(),C=await h[a].lastname.toString().trim(),k=await h[a].password.toString().trim(),j=await h[a].isadmin;await j&&(await g.includes(await w)||(g.push(await w),m[await o]=await g,await l(await c+"/UserDetails/AccountAdmin.json",await m)));var D=await h[a].account,O=[],I=[];for(let a=0;a<await D.length;a++){var L=await D[a].label;await p.includes(await L)&&O.push(await L)}if(void 0===await S[await w])S[await w]={},S[await w].firstName=await P,S[await w].lastName=await C,S[await w].secretKey=await k,S[await w].accounts=await O,await I.push(await c),S[await w].accountLabel=await I,E[await w]={},E[await w].accountLabel=await I;else{var F=[];F=await S[await w].accounts;for(let a=0;a<await O.length;a++){var U=await O[a];await F.includes(await U)||F.push(await U)}var V=await F;for(let a=0;a<await F.length;a++){var B=await F[a];await O.includes(await B)||await p.includes(await B)&&(V=await V.filter(a=>a!==B))}S[await w].accounts=await V,S[await w].firstName=await P,S[await w].lastName=await C,await k.toString().startsWith("***")||(S[await w].secretKey=await k);var R=S[await w].accountLabel;void 0===await R?(I.push(await c),S[await w].accountLabel=await I,E[await w].accountLabel=[],E[await w].accountLabel=await I):await R.includes(await c)||(await R.push(await c),S[await w].accountLabel=await R,E[await w].accountLabel=await R)}}var J=[],X=await Object.keys(await S);for(let a=0;a<await X.length;a++)if(w=await X[a].toString().toLocaleLowerCase().trim(),!await A.includes(await w)){var W=await S[await w].accounts;if(await W.includes(await o)){let a=await W;for(let t=0;t<await p.length;t++){var Y=await p[t];a=await a.filter(a=>a!==Y)}var G=await S[await w].accountLabel;0===await a.length?(J.push(await w),await delete S[await w],await delete E[await w]):(await G.includes(await c)&&(G=await G.filter(a=>a!==c),S[await w].accountLabel=await G,E[await w].accountLabel=await G),S[await w].accounts=await a),await g.includes(await w)&&(g=await g.filter(a=>a!==w),m[await o]=await g,await l(await c+"/UserDetails/AccountAdmin.json",await m))}}X=await Object.keys(await S);for(let a=0;a<await X.length;a++)w=await X[a].toString().toLocaleLowerCase(),W=await S[await w].accounts,0===await W.length&&(J.push(await w),await delete S[await w],await delete E[await w],await g.includes(await w)&&(g=await g.filter(a=>a!==w),m[await o]=await g,await l(await c+"/UserDetails/AccountAdmin.json",await m)));if(await l(await c+"/UserDetails/UserDetails.json",S),await l("UserAccountInfo.json",await E),await J.length>0){var Q=await r+await c+"/UserSession/UserSession.json",q=await JSON.parse(await v.readFileSync(await Q,"utf8"));for(let a=0;a<await J.length;a++){var Z=await Object.keys(await q);for(let a=0;a<await Z.length;a++){var K=await Z[a];void 0!==await q[await K][await w]&&await delete q[await K][await w]}}await n(await c+"/UserSession/UserSession.json",await q)}e.errorMessage="User profile section is/are successfully updated.",e.isSuccess=!0}catch(a){e.errorMessage=await a.toString()}t.json(await e)}),i.post("/updateaccount",async(a,t)=>{var e={isUserAuthenticated:!1},i=await a.body.account,s=await a.headers.userselectedaccount,w=await a.headers.accountlabel;try{var o=await r+await w+"/UserSession/UserSession.json",c=await JSON.parse(await v.readFileSync(await o,"utf8")),u=await a.headers.useremail;u=await u.toString().toLocaleLowerCase().trim();var l=await c[await s][await u];c[await s][await u]="",void 0===await c[await i]&&(c[await i]={}),c[await i][await u]=await l,await n(await w+"/UserSession/UserSession.json",await c)}catch(a){return e.errorMessage=await a.toString(),t.json(await e)}a.headers.userselectedaccount=await i;var p=await d(await a);if(!await p.isSuccess){e.isUserAuthenticated=!1,e.errorMessage=p.errorMessage,t.status=await p.responseCode;try{o=await r+await w+"/UserSession/UserSession.json",c=await JSON.parse(await v.readFileSync(await o,"utf8")),u=await a.headers.useremail,u=await u.toString().toLocaleLowerCase().trim(),l=await c[await i][await u],c[await i][await u]="",void 0===await c[await s]&&(c[await s]={}),c[await s][await u]=await l,await n(await w+"/UserSession/UserSession.json",await c)}catch(a){return e.errorMessage=await a.toString(),t.json(await e)}return t.json(await e)}try{e.errorMessage="",e.firstName=await p.firstName,e.lastName=await p.lastName,e.isSuperAdmin=await p.isSuperAdmin,e.expiresOn=await p.expiresOn,e.host=await p.host,e.isManualComponentDisplayed=await p.isManualComponentDisplayed,e.isDefectComponentDisplayed=await p.isDefectComponentDisplayed,e.isAutomationComponentDisplayed=await p.isAutomationComponentDisplayed,e.isUIComponentDisplayed=await p.isUIComponentDisplayed,e.isApiComponentDisplayed=await p.isApiComponentDisplayed,e.isMobileComponentDisplayed=await p.isMobileComponentDisplayed,e.support=await p.support,e.apiVersion=await m.version,e.totalStorage=await p.totalStorage,e.isUserAuthenticated=!0,e.isSuperAdmin=await p.isSuperAdmin}catch(a){e.isUserAuthenticated=!1,e.errorMessage=a.message}t.json(await e)}),i.post("/getpendingwork",async(a,t)=>{var e={},i=await d(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s={totalItem:0,pendingData:[],errorMessage:""};try{var n=await a.body,w=await n.account;if(void 0===await w||""===await w)return s.errorMessage="Account Name can not be blank.",t.json(s);var o=await n.sprint;if(void 0===await o||""===await o)return s.errorMessage="Sprint can not be blank.",t.json(s);var c=await a.headers.useremail,u=0,l=0,p=[],m=[],g=await a.headers.accountlabel;try{var y=await r+await g+"/"+await w+"/Manual/DefectDetails/**/**/"+await o+"/**/*.json",b=await h.sync(await y);for(let a=0;a<await b.length;a++)try{var S=await JSON.parse(await v.readFileSync(await b[a],"utf8")),x=await S.assignedTo.value;if(await x.toLocaleLowerCase().trim()===await c.toLocaleLowerCase().trim()){var M=await S.status;if(M=await M.toLocaleLowerCase().trim(),"close"!==await M&&"closed"!==await M&&"completed"!==await M){var N=await f.parse(await b[a]),T=await N.name;u=Number(await u)+1,p.push(await T)}}}catch(a){}}catch(a){}try{var E=await r+await g+"/"+await w+"/Manual/TestPlan/"+await o+"/**/*.json",A=await h.sync(await E);for(let a=0;a<await A.length;a++)try{var P=await JSON.parse(await v.readFileSync(await A[a],"utf8")),C=await P.AllTestCases;for(let a=0;a<await C.length;a++)if(x=await C[a].assignto,await x.toLocaleLowerCase().trim()===await c.toLocaleLowerCase().trim()&&(M=await C[a].status,M=await M.toLocaleLowerCase().trim(),"pass"!==await M&&"fail"!==await M&&"na"!==await M)){var k=await C[a].testid;l=Number(await l)+1,m.push(await k)}}catch(a){}}catch(a){}var j=Number(await l)+Number(await u);if(await j>0){s.totalItem=Number(await j);var D=[],O=0;if(await Number(await l)>0){O=1;var I={id:await O,page:"Test Plan",itemcount:Number(await l),item:await JSON.stringify(await m)};D.push(await I)}await Number(await u)>0&&(O=await Number(O)+1,I={id:await O,page:"Defect",itemcount:Number(await u),item:await JSON.stringify(await p)},D.push(await I)),s.pendingData=await D}}catch(a){s.errorMessage=a.toString()}t.json(s)}),i.post("/getaccountnsnamefordmin",async(a,t)=>{var e={accounts:[],allUsersProfile:[],errorMessage:""},i=await d(await a);if(!await i.isSuccess)return e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var r=await a.headers.useremail.toString().toLocaleLowerCase().trim(),s=await a.headers.userselectedaccount,n=await a.headers.accountlabel,w=await u(await n+"/UserDetails/AccountAdmin.json"),o=await w[await s];if(void 0===await o)return e.errorMessage="Project "+await s+" does not exist on AccountAdmin file.",t.json(await e);if(!await o.includes(await r))return e.errorMessage="User does not have admin rights for the project "+await s,t.json(await e);var c=await i.accounts;if(0===await c.length)return e.errorMessage="here is no project found for account "+await n,t.json(await e);var l=[],p=[];for(let a=0;a<await c.length;a++)try{var m=await c[a];if(await w[await m].includes(await r)){var v={};await p.includes(await m)||p.push(await m),v.label=await m,v.value=await m,l.push(await v)}}catch(a){}if(await p.length>0){var g=[],h=await u(await n+"/UserDetails/UserDetails.json"),f=await Object.keys(await h),y=1;for(let a=0;a<await f.length;a++){var b=[],S=await f[a],x=await h[await S].accounts;if(await x.includes(await s)){var M,N=!1;await w[await s].includes(await S)&&(N=!0);for(let a=0;a<await x.length;a++){var T=await x[a];if(await p.includes(await T)){var E={};E.label=await T,E.value=await T,b.push(await E)}}M={id:Number(await y),email:await S,firstname:await h[await S].firstName,lastname:await h[await S].lastName,account:await b,password:"********",isadmin:await N},g.push(await M),y=Number(await y)+1}}e.allUsersProfile=await g}return e.accounts=await l,t.json(await e)}catch(a){e.errorMessage=await a.toString()}t.json(await e)}),a.exports=i},9023:(a,t,e)=>{const i=e(7252),r=e(9896),s=i.Router(),n="./dataHub/",{authCheck:w}=e(2258),o={UIAction:{RestartAppTillElementIsPresent:{description:"This method will restart the app and verify provide mobile element is present is displayed or not.count can be drived from the value section,Package name need to be send",example:'1.{"Mobile Element":"BUTTONXYZ","Value":"{totalAttempt:5,packageName:""}"}',value:'{"totalAttempt":"1","packageName":""}'},Click:{description:"This method is used for clicking on a mobile element.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"BUTTONXYZ","Value":" "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},Tap:{description:"This method is used for tap on a mobile element.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"BUTTONXYZ","Value":" "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},Pinch:{description:"This method is used for pinch on a mobile element.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"BUTTONXYZ","Value":" "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},ZoomIn:{description:"This method is used for Zoom in for a mobile element.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"BUTTONXYZ","Value":" "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},ZoomOut:{description:"This method is used for Zoom out for a mobile element.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"BUTTONXYZ","Value":" "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},ClickAll:{description:"This method is used for click action for all mobile elements. This action can be used when you need to click on all the checkbox.This action is only applicable when multiple mobile elements are present for same property.",example:"1.{'Mobile Element':'CHECKALL','Value':''}"},ClickNTimes:{description:"This method click n times on the mobileelement . value can be provided from the value section.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"BUTTONXYZ","Value":"{"countofclick":2}"} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"countofclick":2,"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"countofclick":2,"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"countofclick":2,"text":"QAautoMATER","class":"QaBunch"}',value:'{"countofclick":2}'},Count:{description:"This method retrieves the count of mobile elements based on the mobile element property.",example:"1.{'Mobile Element':'LINKXYZ','Value':' '}"},GetAttribute:{description:"This method is used for getting the attribute of the mobile element. attribute name can be passed from the value section.",example:'1.{"Mobile Element":"BUTTONXYZ","Value":"{"attributename":"href"}"} 2.{"Mobile Element":"CHKXYZ","Value":"{"attributename":"href","index":0} 3.{"Mobile Element":"CHKXYZ","Value":"{"attributename":"href","id":"QaBunch"} 4.{"Mobile Element":"CHKXYZ","Value":"{"attributename":"href","text":"QAautoMATER","class":"QaBunch"}',value:'{"attributename":"provide attribute name"}'},Type:{description:"This method type the value in editbox . value can be provided from the value section.",example:'1.{"Mobile Element":"LISTXYZ","Value":"{"valuetobesend":"QAautoMATER"}"} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"valuetobesend":"QAautoMATER","index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"valuetobesend":"QAautoMATER","id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"valuetobesend":"QAautoMATER","text":"QAautoMATER","class":"QaBunch"}',value:'{"valuetobesend":"Provide value"}'},TypeAll:{description:"This method type the random value in all editbox . random value can be override , we can pass value from the value section based element attribute. value should be in JSON array format",example:'[{"id":"user-name","valuetobesend":"mycustomvalue"},{"name":"QaBunch","valuetobesend":"mycustomvalue"}]',value:"{}"},FileUpload:{description:"This method is used for uploading file on the application, file name can be passed from the value section.",example:'1.{"Mobile Element":"InputFILE","Value":"{"filename":"QAautoMAER.xlsx"}"} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"filename":"QAautoMAER.xlsx","nextelement":"buttonXYZ","index":0} 3.{"Web Element":"BUTTONXYZ","Value":"{"filename":"QAautoMAER.xlsx","nextelement":"buttonXYZ","id":"QaBunch"} 4.{"Web Element":"BUTTONXYZ","Value":"{"filename":"QAautoMAER.xlsx","nextelement":"buttonXYZ","text":"QAautoMATER","class":"QaBunch"}}',value:'{"filename":"Provide your file name"}'},Check:{description:"This method is used for checking  mobile element. It is widely used for checkbox and radio button.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"CHECKBOXXYZ","Value":" "} 2.{"Mobile Element":"CHECKBOXXYZ","Value":"{"index":0} 3.{"Mobile Element":"CHECKBOXXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"CHECKBOXXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},CheckAll:{description:"This method check all the checkbox which are displayed on the page.",example:'{"Mobile Element":"CHKXYZ","Value":" "}'},Uncheck:{description:"This method is used for unchecking  mobile element. It is widely used for checkbox and radio button.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"CHECKBOXXYZ","Value":" "} 2.{"Mobile Element":"CHECKBOXXYZ","Value":"{"index":0} 3.{"Mobile Element":"CHECKBOXXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"CHECKBOXXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},UncheckAll:{description:"This method is used for unchecking  all mobile element. It is widely used for checkbox and radio button.This method also can be used if multiple element are found.",example:'{"Mobile Element":"CHECKBOXXYZ","Value":" "}'},DoubleClick:{description:"This method is used for double clicking on a mobile element.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"BUTTONXYZ","Value":" "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},LongClick:{description:"This method is used for long click on a mobile element.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"BUTTONXYZ","Value":" "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},Focus:{description:"This method is used for mouse movement on a mobile element.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"LINKXYZ","Value":" "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},Scroll:{description:"This method is used for scroll the mobile element , it only wotks for text property , if multiple text retuns then we can pass index. return type of this method is void",example:'1.{"Mobile Element":"LINKXYZ","Value":"{"index":"0"}"',value:'{"index":"0"}'},DragandDrop:{description:"This method drag the element to another location . location here refering to another element and this element name can be passed from the value section.",example:'1.{"Mobile Element":"LISTCOUNTRY","Value":"{"Mobile":"buttonXYZ"}" 2.{"Mobile Element":"BUTTONXYZ","Value":"{"nextelement":"buttonXYZ","index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"nextelement":"buttonXYZ","id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"nextelement":"buttonXYZ","text":"QAautoMATER","class":"QaBunch"}}',value:'{"nextelement":"provide element name"}'},SwipeLeftAt:{description:"This method is used for swipe left on a mobile element.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"BUTTONXYZ","Value":" "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},SwipeRightAt:{description:"This method is used for swipe right on a mobile element.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"BUTTONXYZ","Value":" "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},SwipeUpAt:{description:"This method is used for swipe up on a mobile element.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"BUTTONXYZ","Value":" "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},SwipeDownAt:{description:"This method is used for swipe up on a mobile element.This method also can be used if multiple element are found.",example:'1.{"Mobile Element":"BUTTONXYZ","Value":" "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'}},BrowserAction:{LaunchMobileApplication:{description:"This method launches the mobile app. By default, it uses the capabilities defined on the configuration page; however, additional capabilities can be passed in the value section to override the configuration values.",example:'{"appium:app":"abc.apk"}',value:"{}"},GetContext:{description:"This method is used for retriving the all the context of mobile app",example:"{'Mobile Element':' ','Value':' '}"},PushFile:{description:"This method is used to push a local file to the executed device. This method takes two arguments: devicePath and fileName. devicePath refers to the path on the device where the file will be saved (for example, /sdcard/example.txt), and fileName is the name of the file that needs to be saved. This file should be present on the QAautomater server (for example, example.txt).",example:"{'Mobile Element':' ','Value':'{'devicePath':'/sdcard/myexample.txt','fileName':'example.txt'}'}",value:'{"devicePath":"","fileName":""}'},SwitchContext:{description:"This method is used for switch to context based on index, index can be provided in value section",example:"{'Mobile Element':' ','Value':'{index:0}'}",value:'{"index":"0"}'},AlertAccept:{description:"This method is used for accepting the mobile app alert.Please note mobile alert is different from application alert. value should be blank in this case.",example:"{'Mobile Element':' ','Value':' '}"},AlertDismiss:{description:"This method is used for cancel the mobile alert.Please note mobile app alert is different from application alert.value should be blank in this case.",example:"{'Mobile Element':' ','Value':' '}"},AlertText:{description:"This method is used for getting the Mobile alert text .Please note mobile alert is different from application alert.value should be blank in that case",example:"{'Mobile Element':' ','Value':' '}"},Close:{description:"This method close the mobile app if valuetobesend is provided blank then it close the app which is under test, if We provide package name then it close specific app.Mobile Element value should be blank in this case.",example:'{"Value":"appPackageName"}',value:'{"valuetobesend":""}'},Back:{description:"This method go to on previous step of mobile app.Mobile Element value should be blank in this case.",example:'{"Value":""}'},Refresh:{description:"This method Refresh the mobile app. Mobile element and value should be blank.",example:'{"Value":""}'},GetCurrentPackage:{description:"This method is used for getting the current package name for mobile app.value should be blank in that case",example:"{'Mobile Element':' ','Value':' '}"},GetCurrentActivity:{description:"This method is used for getting the current activity name for mobile app.value should be blank in that case",example:"{'Mobile Element':' ','Value':' '}"},Launch:{description:"This method is used for launching mobile app based on apppackage and appactivity.",example:"{'Mobile Element':' ','Value':'{'apppackage':'com.android.camera2','appactivity':'com.android.camera.CameraLauncher}",value:'{"apppackage":"provide appPackage","appactivity":"provide appactivity"}'},SwitchTo:{description:"This method is used for switch to specific mobile app based on app package. Generally this method is used when multiple mobile app are open.",example:"{'Mobile Element':' ','Value':'{'valuetobesend':'com.android.camera2'}",value:'{"valuetobesend":"appPackageName"}'},HideKeyboard:{description:"This method hike the keyborad from the mobile app.Mobile Element and value should be blank in this case.",example:'{"Value":""}'},RestartApp:{description:"This method is used for Restart the App.Mobile Element and value should be blank for this case",example:"{'Mobile Element':' ','Value':''}"},SwipeLeft:{description:"This method is used for swipe left action, Mobile element and value should be blank in this case",example:'1.{"Mobile Element":"","Value":" "}'},SwipeRight:{description:"This method is used for swipe right action, Mobile element and value should be blank in this case",example:'1.{"Mobile Element":"","Value":" "}'},SwipeUp:{description:"This method is used for swipe up action, Mobile element and value should be blank in this case",example:'1.{"Mobile Element":"","Value":" "}',value:'{"totalSwipeCount":"1"}'},SwipeDown:{description:"This method is used for swipe down action, Mobile element and value should be blank in this case",example:'1.{"Mobile Element":"","Value":" "}',value:'{"totalSwipeCount":"1"}'},SendKeysUsingKeyPad:{description:"This method is used for clicking value from Keypad.Mobile Element should be blank for this case.",example:'{"Mobile Element":" ","Value":"{"valuetobesend":"1234"}"}',value:'{"valuetobesend":"KeyPadValue"}'},ExecuteScript:{description:"This method is used for overriding the command of appium method, we can directly pass command in execute method, Please note Mobile element should be blank in that case.",example:'{"Mobile Element":" ","Value":"{"valuetobesend":"mobile: pressKey", [{"keycode":4}]"}"}',value:'{"valuetobesend":""}'}},WaitAction:{Wait:{description:"This method will wait for the specified duration as provided. Please note Mobile element should be blank, value should be number and it represents in seconds",example:'1. {"Mobile Element":" ","Value":"{"timeout":5}"}',value:'{"timeout":5}'},WaitForElementTillDisplayed:{description:"This method will wait for the specified duration as provided until the mobile element is displayed on the app.Please note value should be number and it represents in seconds",example:'1. {"Mobile Element":"TextXYZ","Value":"{"timeout":30}"} 2. {"Mobile Element":"TextXYZ","Value":"{"timeout":30,"index":2}"}',value:'{"timeout":30}'},WaitForElementTillNotDisplayed:{description:"This method will wait for the specified duration as provided until the mobile element is not displayed on the app.Please note Value should be number and it represents in seconds",example:'1. {"Mobile Element":"TextXYZ","Value":"{"timeout":30}"} 2. {"Mobile Element":"TextXYZ","Value":"{"timeout":30,"index":2}"}',value:'{"timeout":30}'},WaitForElementTillTextContains:{description:"This method will wait for the specified duration as provided until the mobile element text as per provided value.Please note Value should be number and it represents in seconds",example:'1. {"Mobile Element":"LinkXYZ","Value":"{"timeout":30,"expectedtext":"QAautoMATER"}"} 2. {"Mobile Element":"LinkXYZ","Value":"{"timeout":30,"expectedtext":"QAautoMATER","index":2}"}',value:'{"timeout":30,"expectedtext":"provide expected text"}'},WaitForElementIsEnabled:{description:"This method will wait for the specified duration as provided until the mobile element is enabled on the app.Please note Value should be number and it represents in seconds",example:'1. {"Mobile Element":"LinkXYZ","Value":"{"timeout":30}"} 2. {"Mobile Element":"LinkXYZ","Value":"{"timeout":30,"index":2}"}',value:'{"timeout":30}'},WaitForElementIsDisabled:{description:"This method will wait for the specified duration as provided until the mobile element is disabled on the app.Please note Value should be number and it represents in seconds",example:'1. {"Mobile Element":"LinkXYZ","Value":"{"timeout":30}"} 2. {"Mobile Element":"LinkXYZ","Value":"{"timeout":30,"index":2}"}',value:'{"timeout":30}'}},AssertionAction:{IsDisplayed:{description:"This method verify mobileelemnt is present on mobile application.",example:'{"Mobile Element":"LINKXYZ","Value": " "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},IsNotDisplayed:{description:"This method verify mobileelemnt is not present on web application.",example:'{"Mobile Element":"LINKXYZ","Value": " "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},IsEnabled:{description:"This method verify mobileelemnt is enabled on mobile application.",example:'{"Mobile Element":"LINKXYZ","Value": " "} 2.{"Mobile Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},IsDisabled:{description:"This method verify mobileelemnt is disabled on Mobile application.",example:'{"Mobile Element":"LINKXYZ","Value": " "} 2.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},IsSelected:{description:"This method verify mobileelement is selected on Mobile application. It is widely used for checbox and readio button.",example:'{"Mobile Element":"LINKXYZ","Value": " "} 2.{"Web Element":"BUTTONXYZ","Value":"{"index":0} 3.{"Mobile Element":"BUTTONXYZ","Value":"{"id":"QaBunch"} 4.{"Mobile Element":"BUTTONXYZ","Value":"{"text":"QAautoMATER","class":"QaBunch"}'},IsAppInstalled:{description:"This method verify app is installed on mobile or not based on package name. Mobile Element should be blank in that case.",example:'{"Mobile Element":"","Value":"{"valuetobesend":"com.android.camera2"}"}',value:'{"valuetobesend":"appPackageName"}'},AssertAlertTextContains:{description:"This method retrieves the the mobile alert text  and check expected value contains the text.Expected value can be pass in value section.Please note mobile element should be null in that case.",example:'{"Mobile Element":" ","Value":"{"expectedtext":"QAautoMATER"}"}',value:'{"expectedtext":"provide expected text"}'},AssertAlertTextEquals:{description:"This method retrieves the mobile alert text and compares it to the expected value.Expected value can be pass in value section.Please note Mobile element should be null in that case.",example:'{"Mobile Element":" ","Value":"{"expectedtext":"QAautoMATER"}"}',value:'{"expectedtext":"provide expected text"}'},AssertAlertTextNotContains:{description:"This method retrieves the the mobile alert text and verify expected text does not contains.Expected value can be pass in value section.Please note Mobile element should be null in that case.",example:'{"Mobile Element":" ","Value":"{"expectedtext":"QAautoMATER"}"}',value:'{"expectedtext":"provide expected text"}'},AssertElementCountEquals:{description:"This method get the count of mobile and compare it to with expected value. expected value should be number which can be passed in value section",example:'{"Mobile Element":"allLinks","Value":"{"expectedcount":10}"}',value:'{"expectedcount":"Provide Expected count here"}'},AssertElementCountGreaterThan:{description:"This method get the count of mobileelemnt and verify count is greter than expected value. expected value should be number which can be passed in value section",example:'{"Mobile Element":"allLinks","Value":"{"expectedcount":10}"}',value:'{"expectedcount":"Provide Expected count here"}'},AssertElementCountLessThan:{description:"This method get the count of mobileelemnt and verify count is less than expected value. expected value should be number which can be passed in value section",example:'{"Mobile Element":"allLinks","Value":"{"expectedcount":10}"}',value:'{"expectedcount":"Provide Expected count here"}'},AssertElementAttributeNotContains:{description:"This method retrieves the mobileelement attribute and verify mobileelement attribute value does not contains expected value.attribure and expected value can be pass in value section.",example:"{'mobile Element':'LinkXYZ','Value':'attributeNames:{'id':'myId','name':'myName'}'}",value:'{"attributeNames":{}}'},AssertElementAttributeEquals:{description:"This method retrieves the mobileelement attribute and compares it to the expected value.attribure and expected value can be pass in value section.",example:"{'mobile Element':'LinkXYZ','Value':'attributeNames:{'id':'myId','name':'myName'}'}",value:'{"attributeNames":{}}'},AssertElementAttributeContains:{description:"This method retrieves the mobileelement attribute and verify mobileelement attribute value contains expected value.attribure and expected value can be pass in value section.",example:"{'mobile Element':'LinkXYZ','Value':'attributeNames:{'id':'myId','name':'myName'}'}",value:'{"attributeNames":{}}'},AssertIsNumberInAscendingOrder:{description:"This method verifies whether the numbers present in a list are in ascending order. The web element value should be blank in this case",example:'1.{"Web Element":" ","Value":"{"valuetobesend":"[1,2,3,4]"}}',value:'{"valuetobesend":[]}'},AssertIsNumberInDescendingOrder:{description:"This method verifies whether the numbers present in a list are in Descending order. The web element value should be blank in this case.",example:'1.{"Web Element":" ","Value":"{"valuetobesend":"[1,2,3,4]"}}',value:'{"valuetobesend":[]}'},AssertIsListSorted:{description:"This method verifies whether the string present in a sorted order. The web element value should be blank in this case.",example:'1.{"Web Element":" ","Value":"{"valuetobesend":"["QA","AB"]"}}',value:'{"valuetobesend":["QA","AB"]}'},AssertEquals:{description:"This method compare two value, Expected and actual value can be pass from the value section.Mobile Element  should be blank for this",example:'1.{"Mobile Element":" ","Value":"{"actualvalue":"paste your actual value","expectedvalue":"write your expected value"}}',value:'{"actualvalue" : "","expectedvalue" : ""}'},AssertGreaterThan:{description:"This method verify actual value is greater than expected value. it works only for number.element value will be null",example:'1.{"Web Element":" ","Value":"{"actualvalue":"10","expectedvalue":"5"}}',value:'{"actualvalue" : " ","expectedvalue" : " "}'},AssertLessThan:{description:"This method verify actual value is lessaer than expected value. it works only for number.element value will be null",example:'1.{"Web Element":" ","Value":"{"actualvalue":"4","expectedvalue":"5"}}',value:'{"actualvalue" : " ","expectedvalue" : " "}'},AssertContains:{description:"This method check second value exist on first value, Expected and actual value can be pass from the value section.Web Element should be blank for this",example:'1.{"Mobile Element":" ","Value":"{"actualvalue":"paste your actual value","expectedvalue" :"write your expected value"}}',value:'{"actualvalue" : "","expectedvalue" : ""}'},AssertNotContains:{description:"This method check second value does not exist on first value, Expected and actual value can be pass from the value section.WebElement should be blank for this",example:'1.{"Mobile Element":" ","Value":"{"actualvalue":"paste your actual value","expectedvalue" :"write your expected value"}}',value:'{"actualvalue" : "","expectedvalue" : ""}'},AssertStringLengthShouldBe:{description:"This method verifies the provided string length. The element value should be blank in this case.",example:'1.{"Mobile Element":" ","Value":"{"inputstring":"Session,MyString","expectedlength":0}}',value:'{"inputstring":"","expectedlength":0}'}},ApplicationAction:{},SaveAction:{SaveSessionVariable:{description:'This method can be used in two ways: First, in the step just before this function, the output can be stored using the SaveSessionVariable method—for example, if you retrieve an elements attribute and store it as a session variable (e.g., myId), it can be accessed throughout the test script by referencing Session.myId; second, you can store multiple variables at once, such as a random first name, last name, and address, by adding multiple keys like {"myFirstName": "Utility.firstName", "myLastName": "Utility.lastName", "myAddress": "Utility.address"}. Please note: 1. Session variable scope is limited to the test script level. 2. a. A pre-stored session variable Session.TestIdDetails returns a JSON object: {"Component": "TestScriptComponent", "TestId": "Your Test Id", "TestName": "Your Test Name", "Environment": "envName", "ExecutedBy": "executedBy"}. b. Session.TestId returns the executed test ID, c. Session.Component returns the executed test script component, Session.Environment returns the execution environment, d. Session.ExecutedBy returns who executed the test,  e. Session.TestName returns the executed test case name f. session.Capability retuns the capability which sent to the device g. Session.DeviceName retuns the executed device name and Session.DeviceModal retuns the executed Device model',example:'1. {"Mobile Element": " ","Value":"{"variablename":"orderId"}"} 2.{"Web Element": " ","Value":"{"myFirstName": "Utility.firstName", "myLastName": "Utility.lastName", "MyAddress": "Utility.address"}"}',value:'{"variablename":"Provide variable name"}'},SaveGlobalVariable:{description:'This method can be used in two ways: First, in the step just before this function, the output can be stored using the SaveGlobalVariable method—for example, if you retrieve an elements attribute and store it as a global variable (e.g., myId), it can be accessed throughout the entire test suite by referencing Global.myId; second, you can store multiple variables at once, such as a random first name, last name, and address, by adding multiple keys like {"myFirstName": "Utility.firstName", "myLastName": "Utility.lastName", "MyAddress": "Utility.address"}. Please Note: 1. Global variable scope covers the entire test suite. 2. There are some predefined global variables: Global.Environment (returns the executing environment), Global.DeviceName (returns the device name), and Global.Platform (returns the platform name).',example:'1. {"Mobile Element": " ","Value":"{"variablename":"orderId"}"} 2. {"Web Element": " ","Value":"{"myFirstName": "Utility.firstName", "myLastName": "Utility.lastName", "MyAddress": "Utility.address"}"}',value:'{"variablename":"Provide variable name"}'},CreateRequestParametersInSessionVariable:{description:"This method creates requestParameters which can be used for directly passing test data to the method. It takes an input loopCounter,listOfParameters (used in the method), listOfParametersValue, and creates the requestParameters value according to the QAautoMATER template. This can be saved as a user-provided variable.Mobile element should be blank in this case.",example:'1. {"Mobile Element": " ","Value":"{"totalLength":"3","listOfParameters":"["ARGS.Username","ARGS.Password"]","listOfParametersValue":"["admin",["mypassword1","mypassword2"]","variableName":"myvar"}"}',value:'{"totalLength":"1","listOfParameters":["ARGS.param1","ARGS.param2"],"listOfParametersValue":["param1value",["param2value1","param2value2"]],"variableName":"myvar"}'}},RandomAction:{GenerateUtilityValue:{description:"This method can be used for generating test data which is in dynamic nature.This method is used with UtilityData . Please note Web element should be null and value comes from Utility Function.",example:"1. {'Mobile Element':' ','Value':'Utility.email'} 2. {'Mobile Element':' ','Value':'Utility.string(length=10)||12'}",value:'{"valuetobesend":"Provide value"}'},"String.Trim":{description:'This method removes whitespace from both ends of the string. For example, if userInput is " QAautoMATER "QAautoMATER"',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput"}'},"String.Length":{description:'This method returns the number of characters in a string. For example, if userInput is "QAautoMATER", then it returns 11.',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput"}'},"String.Substring":{description:'The method extracts a portion of a string based on the startIndex and endIndex parameters. For example, if userInput is "JavaScript" and startIndex is 0 and endIndex is 4, it returns "Java". If the endIndex is not specified, the extraction will continue to the end of the string. For example, if startIndex is 4 and endIndex is not specified, it returns "Script".',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','startPosition':0,'endPosition':0}",value:'{"userInput":"ProvideYourInput","startPosition":0,"endPosition":1}'},"String.ToUpperCase":{description:'This method converts all characters in the string to uppercase. For example, if userInput is "QAautoMATER", it returns "QAAUTOMATER".',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput"}'},"String.ToLowerCase":{description:'This method converts all characters in the string to lowercase. For example, if userInput is "QAautoMATER", it returns "qaautomater".',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput"}'},"String.Split":{description:'Splits the string into an array of substrings using the specified delimiter. For example, if userInput is "QAautoMATER is Awesome" and the delimiter = is, it returns an array of ["QAautoMATER", "Awesome"].',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','delimiter':'Input'}",value:'{"userInput":"ProvideYourInput","delimiter":"ProvideYourInput"}'},"String.Replace":{description:'The String.Replace method replaces occurrences of valueToReplace with replaceBy in the string. For example, if userInput = "QaautoMATER is good", valueToReplace = "good", and replaceBy = "Awesome", then it returns QaautoMATER is Awesome.',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','valueToReplace':'ProvideYourInput','replaceBy':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput","valueToReplace":"ProvideYourInput","replaceBy":"ProvideYourInput"}'},"String.StartsWith":{description:'This method checks if the string starts with the specified substring and returns true or false. For example, if userInput is "QAautoMATER is awesome" and searchString is "QAautoMATER", it returns true. If searchString is "qaautomater", it returns false because the check is case-sensitive.',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','searchString':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput","searchString":"ProvideYourInput"}'},"String.EndsWith":{description:'This method checks if the string ends with the specified substring and returns true or false. For example, if userInput is "QAautoMATER is awesome" and searchString is "awesome", it returns true. If searchString is "Awesome", it returns false, because the check is case-sensitive.',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','searchString':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput","searchString":"ProvideYourInput"}'},"String.Concat":{description:'This method concatenates (joins) multiple strings together including space; for example, if userInput is "QAautoMATER" and userInput2 is "awesome", it will return "QAautoMATER awesome"',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','userInput2':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput","userInput2":"ProvideYourInput"}'},"String.ExtractNumberFromTheString":{description:'This method extracts and returns the numeric value from a given string. The user can choose whether to include the decimal point in the extracted number. For example, if userInput is "QAautoMATER 12.15" and willYouremoveDot is false, it will return 12.15. If willYouremoveDot is true, it will return 1215',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','willYouremoveDot',true}",value:'{"userInput":"ProvideYourInput","willYouremoveDot":true}'},"String.RemoveNumberFromTheString":{description:'This method removes all numeric characters from a given string and returns the resulting string with only non-numeric characters. For example, if userInput is "QAautoMATER ..12_awesome", then it returns "QAautoMATER .._awesome',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput"}'},"String.SplitandSaveValueAsPerIndex":{description:'This method splits the string based on the provided delimiter and returns an array of items. Then, based on the specified index position, it returns the item at that index. For example, if userInput is "qaautomater is awesome", delimiter is "is", and indexToSave is 0, it returns "qaautomater" because the split action returns ["qaautomater", "awesome"], and the value at index 0 is "qaautomater".',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','delimiter':'ProvideYourInput','indexToSave':0}",value:'{"userInput":"ProvideYourInput","delimiter":"ProvideYourInput","indexToSave":0}'},"Math.Abs":{description:"Returns the absolute value of a number. For example, if userInput is -7.89, it returns 7.89.",example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput"}'},"Math.Ceil":{description:"This method rounds a number up to the next largest integer. For example, if userInput is 4.3, it returns 5.",example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput"}'},"Math.Floor":{description:"This method is a JavaScript function that rounds a number down to the nearest integer. For example, if the user input is 8.9, it returns 8.",example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput"}'},"Math.Round":{description:"This method rounds a number to a specified number of decimal places. For example, if the number is 4.56789 and you want to round it to 2 decimal places, the method will return 4.57. If you specify 3 decimal places, it will return 4.568., for decimal space 0 it return 5",example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.AddTwoNumber":{description:"This method adds two numbers and returns the sum. For example, if userInput1 = 1, userInput2 = 2.2, and numberToShowafterDecimal = 0, the output will be 3 (Round of Operation). If numberToShowafterDecimal = 1, the output will be 3.2. if numberToShowafterDecimal =0 then it perform round of operation.",example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','userInput2':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","userInput2":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.SubtractTwoNumber":{description:"This method subtracts two numbers and returns the result; for example, if userInput1 is 2.2, userInput2 is 1, and numberToShowafterDecimal is 0, the output will be 1 (rounded), and if numberToShowafterDecimal is 1, the output will be 1.2.",example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','userInput2':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","userInput2":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.MultiplyTwoNumber":{description:"This method multiplies two numbers and returns the value. For example, if userInput1 is 1, userInput2 is 2.1, and numberToShowAfterDecimal is 0, the output will be 2 (rounded result). If numberToShowAfterDecimal is 1, the output will be 2.1. Please note that if numberToShowAfterDecimal is 0, it performs rounding of the result.",example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','userInput2':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","userInput2":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.DivideTwoNumber":{description:"This method divides one number by another and returns the quotient. For example, if the first number is 10 and the second number is 2, the method returns 5 by performing the division 10 ÷ 2 if numberToShowAfterDecimal is 0. If the numbers are 9 and 2, it returns 4.5 by performing the division 9 ÷ 2 if numberToShowAfterDecimal is 1. Please note that if numberToShowAfterDecimal is 0, it performs rounding of the result.",example:"{'Mobile Element':' ','Value':'{'dividend':'ProvideYourInput','divisor':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"dividend":"ProvideYourInput","divisor":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.Reminder":{description:"This method calculates the remainder when dividing the dividend by the divisor. For example, if the dividend is 9 and the divisor is 2, it returns 1",example:"{'Mobile Element':' ','Value':'{'dividend':'ProvideYourInput','divisor':'ProvideYourInput'}'}",value:'{"dividend":"ProvideYourInput","divisor":"ProvideYourInput"}'},"Math.GetPercentage":{description:"This method calculates the percentage of a given number. For example, if the user input is 100 and the percentageToCalculate is 20, with numberToShowAfterDecimal set to 0, it returns 20 because 20 is 20% of 100. Please note that if numberToShowAfterDecimal is 0, it performs rounding of the result.",example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','percentageToCalculate':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","percentageToCalculate":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.AddPercentage":{description:"This method adds a specified percentage to a given number. For example, if the number is 100, the percentageValue is 20, and numberToShowafterDecimal is 0, the method returns 120 by calculating 20% of 100 (which is 20) and adding it to the original number. If numberToShowafterDecimal is 1, it returns 120.0.",example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','percentageValue':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","percentageValue":"ProvideYourInput","numberToShowafterDecimal":0}'},"Math.SubtractPercentage":{description:"This method subtracts a specified percentage from a given number. For example, if the number is 100, the percentageValue is 20, and numberToShowafterDecimal is 0, the method returns 80 by calculating 20% of 100 (which is 20) and subtracting it from the original number. If numberToShowafterDecimal is 1, it returns 80.0.",example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','percentageValue':'ProvideYourInput','numberToShowafterDecimal':0}'}",value:'{"userInput":"ProvideYourInput","percentageValue":"ProvideYourInput","numberToShowafterDecimal":0}'},"Array.Length":{description:'This method returns the size of the array; for example, if userInput is ["a", "b"], it will return 2.',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput'}",value:'{"userInput":"ProvideYourInput"}'},"Array.ExcludeCharacters":{description:"This method removes all specified characters from every string inside a given array and returns a cleaned array.",example:"{'Mobile Element':' ','Value':'{'userInput':'[]','excludeCharacters':'[]'}",value:'{"userInput":"Provide InputList","excludeCharacters":[]}'},"Array.GetValueBasedOnIndex":{description:'This method retrieves and returns the value from a list or array based on the specified index. For example, if userInput is ["QAautoMATER", "is", "Awesome"] and indexPosition is 0, it returns QAautoMATER.',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','indexPosition':0}'}",value:'{"userInput":"ProvideYourInput","indexPosition":0}'},"Array.Search":{description:'This method searches an array to verify if a particular item is present and returns a boolean value indicating whether the item was found. For example, if userInput is ["QAautoMATER", "is"] and searchItem is "is", it returns true. Please note that this search is case-sensitive.',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','searchItem':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput","searchItem":"ProvideYourInput"}'},"Array.Sort":{description:'This method sorts the elements of an array in ascending order, arranging the items from the smallest to the largest based on their natural order. This applies to both numeric values and strings, where strings are sorted lexicographically. For example, if userInput is ["b", "d", "a", "c"], the output will be ["a", "b", "c", "d"]. If userInput is [5, 2, 10], the output will be [2, 5, 10].',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput"}'},"Array.SumOfArray":{description:"This method calculates and returns the sum of all the numeric elements in an array. It adds up the value of each element and provides the total sum as the result. For example, if userInput is [1, 2, 3], it returns 6",example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput"}'},"Array.SortDesc":{description:'This method sorts the elements of an array in descending order, arranging the items from the largest to the smallest based on their natural order. This applies to both numeric values and strings, where strings are sorted in reverse lexicographical order. For example, if userInput is ["b", "d", "a", "c"], the output will be ["d", "c", "b", "a"]. If userInput is [5, 2, 10], the output will be [10, 5, 2].',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput"}'},"Array.Push":{description:'This method adds elements to the end of the array and returns the new length of the array. For example, if userInput is ["QAautoMATER", "is"] and newElement is "Awesome", the output array will be ["QAautoMATER", "is", "Awesome"]',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','newElement','ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput","newElement":"ProvideYourInput"}'},"Array.DeleteItem":{description:'This method removes an item from an array based on the provided item and returns a new array with the item removed.For example, if userInput is ["Test", "Testing"] and itemToDelete is "Test", then the method returns the array ["Testing"].',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','itemToDelete','ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput","itemToDelete":"ProvideYourInput"}'},"Array.DeleteItemBasedOnIndex":{description:'This method removes an item from an array based on the provided index and returns a new array with the item removed. For example, if userInput is ["A", "B", "C"] and indexPosition is 1, it will delete the item at index 1 (which is "B") and return ["A", "C"].',example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','indexPosition',0}'}",value:'{"userInput":"ProvideYourInput","indexPosition":0}'},"Date.getDate":{description:'This method returns a formatted date based on the current date. It takes two arguments: addOrSubtractDaysFromPresentDate and dateTemplate. The addOrSubtractDaysFromPresentDate argument specifies the number of days to add or subtract from the current date. The dateTemplate argument allows the user to define the format of the returned date. For example, calling Date.getDate(0, "DD MMM yyyy") would return the current date in the format 14 Aug 2014 if the current date is August 14, 2014.',example:"{'Mobile Element':' ','Value':'{'addorDaysfromPresentDate':'ProvideYourInput','dateTemplate','ProvideYourInput'}'}",value:'{"addorDaysfromPresentDate":0,"dateTemplate":"DD MMM yyyy"}'},"Date.FormatDateTemplate":{description:"This method parses a date string using a set of possible date formats and returns the date in the specified output format. It is designed to handle date strings in various formats, converting them into a standardized format. For example, if userInput is 14 Aug 2024, initialDateTemplate is DD MMM YYYY, and expectedDateTemplate is YYYY MMM DD, the output would be 2024 Aug 14.",example:"{'Mobile Element':' ','Value':'{'userInput':'ProvideYourInput','initialDateTemplate','ProvideYourInput','expectedDateTemplate','ProvideYourInput'}'}",value:'{"userInput":"ProvideYourInput","initialDateTemplate":"DD MM yyyy","expectedDateTemplate":"yyyy DD MM"}'},"Date.GetDateDifference":{description:"This method calculates the difference between two dates based on the specified unit. The user can choose the unit of difference, such as days, months, years, hours, minutes, or seconds. For example, if startDate is 14 Aug 2024, startDateTemplate is DD MMM YYYY, endDate is 16 Aug 2024, endDateTemplate is DD MMM YYYY, and differenceIn is days, it returns 2. If differenceIn is months, it returns 0. Similarly, you can use this method to get the difference in hours, minutes, and seconds by providing the appropriate differenceIn option.",example:"{'Mobile Element':' ','Value':'{'startDate':'ProvideYourInput','startDateTemplate','ProvideYourInput','endDate','ProvideYourInput','endDateTemplate':'DD MMM yyyy','diffIn':'days'}'}",value:'{"startDate":"ProvideYourInput","startDateTemplate":"DD MMM yyyy","endDate":"ProvideYourInput","endDateTemplate":"DD MMM yyyy","diffIn":"days"}'},"JSON.getKeyValue":{description:'This method returns the value of a key from a JSON object based on the provided key name or namespace. For example, if your JsonData is {"id":1} and the keyName is id, it returns 1. If your JsonData is {"data":{"childData":{"id":2}}} and you want to get the value of id, the keyName would be data[childData][id], and it returns 2. If your JsonData is [{"id":1},{"id":2}] and you want to get the id of the second index, you would pass the keyName as 1[id], and it returns 2',example:"{'Mobile Element':' ','Value':'{'JsonData':'ProvideYourJsonObject','keyName','ProvidenamespaceofKey'}'}",value:'{"JsonData":"ProvideYourJsonObject","keyName":"ProvidenamespaceofKey"}'},"List.GetUniqueValues":{description:"This method removes duplicate values from a list; for example, if the list contains two ‘A’ items, it returns a list with only one ‘A’.”",example:"{'Mobile Element':' ','Value':'{'userInput':'yourlistitem'}'}",value:'{"userInput":"ProvideYourList"}'}},AndroidCommand:{RunADBCommand:{description:"This method run adb command. command send be in value section.",example:"1.{'Mobile Element':' ','Value':'devices'}",value:'{"valuetobesend":"Provide adb command here"}'},RunShellCommand:{description:"This method run shell command. command send be in value section",example:"{'Mobile Element':' ','Value':'pm list packages}",value:'{"valuetobesend":"Provide adb shellcommand here"}'}},DBAction:{RunDBQuery:{description:"This method run DB query.Webelement should be null in that case.Please note If the database differs from the configuration setup, an additional key, database, can be passed in the value section.",example:"{'Mobile Element':' ','Value':'{'Query':'Select top 1 * from table','database':'mynewdatabaseName'}'}",value:'{"Query":"Select * from table"}'},SaveDBColumnValueInSessionVariable:{description:"After running the Query , we can save results column in variable based on the row index. index started with 0.Element should be null in that case.",example:"{'Mobile Element':' ','Value':'{'rowIndex':0,'ColumnName':'Your variable Name'}'}",value:'{"rowIndex":0,"ColumnName":"Your Variable name"}'},DBRecordCountShouldBe:{description:"After running the Query , We can put assertion based on total rows count.Element should be null in that case.",example:"{'Mobile Element':' ','Value':'{'rowsCount':1}'}",value:'{"rowsCount":0}'},DBRecordCountShouldBeGreaterThan:{description:"After running the Query , We can put assertion based on total rows count.Element should be null in that case.",example:"{'Mobile Element':' ','Value':'{'rowsCount':1}'}",value:'{"rowsCount":1}'},DBRecordCountShouldBeLessThan:{description:"After running the Query , We can put assertion based on total rows count.Element should be null in that case.",example:"{'Mobile Element':' ','Value':'{'rowsCount':1}'}",value:'{"rowsCount":2}'},DBRecordsCount:{description:"This method retrives the total records count.mobile element should be null in that case.Please note If the database differs from the configuration setup, an additional key, database, can be passed in the value section.",example:"{'Web Element':' ','Value':'{'Query':'Select * from table','database':'mynewdatabaseName'}'}",value:'{"Query":"Select * from table"}'}},ApiAction:{CallAPI:{description:"This method call existing API test scripts, In value section we need to pass component and testId.Element should be blank in this case.Please note we can save Request header and requestbody in session variable",example:"{'Mobile Element':' ','Value':'{'component':'component name','testId':'QB-01','relativeUrl':'/api/testid'}','requestHeader[Accept]:'myAcceptHeaderKey','requestBody[userName]:'session.Username'}",value:'{"component":"Provide component","testId":"Provide TestId"}'},SaveAPIResponseInSessionVariable:{description:"After Executiong the CallAPI method, we can retrive the response and save it in session variable.Web element value should be blank in this case.",example:"{'Mobile Element':' ','Value':'{'ColumnName':'Your variable Name'}'}",value:'{"myVar":"ResponseHeader[KeyName]","myVar2":"ResponseBody[KeyName]"}'}},FileReaderAction:{ReadPdfFile:{description:"This method read the pdf file from the uploads and downloads folder from the server, and save pdf content which can be save by SaveSessionVariable method after calling this method. Please note element value should be blank in that case.",example:"{'Mobile Element':' ','Value':'{'filename':'mydoc.pdf'}'}",value:'{"filename":"provide pdf file name"}'},PdfTotalPageCountShouldBe:{description:"This method is used to verify the page count of a PDF document.",example:"{'Mobile Element':' ','Value':'{'filename':'mydoc.pdf','expectedCount':2}'}",value:'{"filename":"provide pdf file name","expectedCount":2}'},ExcelRowCountShouldBe:{description:"This method compare the excel row count and expected row count should be equal based on excel name and sheet name, if sheet name not provided then it picks first worksheet .Element should be null in that case.",example:"{'Mobile Element':' ','Value':'{'filename':'myExcel.xlsx','sheetname':'mySheet','expectedCount':2}'}",value:'{"filename":"provide excel file name","expectedCount":2}'},ExcelRowCountShouldBeGreaterThan:{description:"This method compare the excel row count and expected row count should be Greater than based on excel name and sheet name, if sheet name not provided then it picks first worksheet .Element should be null in that case.",example:"{'Mobile Element':' ','Value':'{'filename':'myExcel.xlsx','sheetname':'mySheet','expectedCount':2}'}",value:'{"filename":"provide excel file name","expectedCount":2}'},ExcelRowCountShouldBeLessThan:{description:"This method compare the excel row count and expected row count should be less than based on excel name and sheet name, if sheet name not provided then it picks first worksheet .Element should be null in that case.",example:"{'Mobile Element':' ','Value':'{'filename':'myExcel.xlsx','sheetname':'mySheet','expectedCount':2}'}",value:'{"filename":"provide excel file name","expectedCount":2}'},SaveExcelColumnValueInSessionVariable:{description:"This method retrieves an Excel cell value by column name, with optional sheet name (defaults to the first sheet) and optional row index—returning all values if the row index is not provided.record will saved in session variable",example:"{'Web Element':' ','Value':'{filename:myExcel.xlsx,rowIndex:1,'ColumnName':'Your Variable name'}'}",value:'{"filename":"myExcel.xlsx","sheetname":"","rowIndex":1,"ColumnName":"Your Variable name"}'},SaveColumnValuesBasedOnConditionalColumnAndValue:{description:"This method searches the Excel sheet for rows where a specific column contains the given value, and returns all matching values from the selected column.",example:"{'Web Element':' ','Value':'{filename:myExcel.xlsx,'sheetname':'provideSheetName','conditionalcolumnname':'['col1','col2']','conditionalcolumnvalues':'['col1value','col2value]','columnnametofetch':'['colname1','colname2']}'}",value:'{"filename":"myExcel.xlsx","sheetname":"provideSheetName","conditionalcolumnname":["col1","col2"],"conditionalcolumnvalues":["col1value","col2value"],"columnnametofetch":["colname1","colname2"]}'}}};s.get("/project/:projectName",async(a,t)=>{var e={},i=await w(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{o.ApplicationAction={};var s=await o,c={UIAction:[],AndroidCommand:[],ApplicationAction:[],BrowserAction:[],WaitAction:[],AssertionAction:[],SaveAction:[],RandomAction:[],DBAction:[],ApiAction:[],UIActionHelpText:[]},u=await a.params.projectName;try{var l=await r.readdirSync(n+u+"/Mobile/CustomPageFunction/Function");for(let a=0;a<await l.length;a++){var d=await l[a];if(await d.includes(".json")){d=await d.replace(".json",""),s.ApplicationAction[d]={},s.ApplicationAction[d].description="",s.ApplicationAction[d].parameter="";var p=await n+u+"/Mobile/CustomPageFunction/Function/"+d+".json",m=await JSON.parse(await r.readFileSync(await p,"utf8"));try{var v=await m.argumentlist;""!==await v&&(s.ApplicationAction[d].parameter=JSON.stringify(await m.argumentlist))}catch(a){s.ApplicationAction[d].parameter=""}void 0!==await m.description&&(s.ApplicationAction[d].description=await m.description)}}}catch(a){}var g=await s.UIAction,h=await Object.keys(await g),f=[];for(let a=0;a<await h.length;a++)f.push(await h[a].toString());await f.sort();var y=[];for(let a=0;a<await f.length;a++){var b={id:Number(a)+1,action:await f[a]};y.push(await b)}c.UIAction=await y,g=await s.BrowserAction,h=await Object.keys(await g),f=[];for(let a=0;a<await h.length;a++)f.push(await h[a].toString());await f.sort(),y=[];for(let a=0;a<await f.length;a++)b={id:Number(a)+1,action:await f[a]},y.push(await b);c.BrowserAction=await y,g=await s.AssertionAction,h=await Object.keys(await g),f=[];for(let a=0;a<await h.length;a++)f.push(await h[a].toString());await f.sort(),y=[];for(let a=0;a<await f.length;a++)b={id:Number(a)+1,action:await f[a]},y.push(await b);c.AssertionAction=await y,g=await s.WaitAction,h=await Object.keys(await g),f=[];for(let a=0;a<await h.length;a++)f.push(await h[a].toString());await f.sort(),y=[];for(let a=0;a<await f.length;a++)b={id:Number(a)+1,action:await f[a]},y.push(await b);c.WaitAction=await y,g=await s.SaveAction,h=await Object.keys(await g),f=[];for(let a=0;a<await h.length;a++)f.push(await h[a].toString());await f.sort(),y=[];for(let a=0;a<await f.length;a++)b={id:Number(a)+1,action:await f[a]},y.push(await b);c.SaveAction=await y,g=await s.AndroidCommand,h=await Object.keys(await g),f=[];for(let a=0;a<await h.length;a++)f.push(await h[a].toString());await f.sort(),y=[];for(let a=0;a<await f.length;a++)b={id:Number(a)+1,action:await f[a]},y.push(await b);c.AndroidCommand=await y,g=await s.RandomAction,h=await Object.keys(await g),f=[];for(let a=0;a<await h.length;a++)f.push(await h[a].toString());await f.sort(),y=[];for(let a=0;a<await f.length;a++)b={id:Number(a)+1,action:await f[a]},y.push(await b);c.RandomAction=await y,g=await s.ApplicationAction,h=await Object.keys(await g),f=[];for(let a=0;a<await h.length;a++)f.push(await h[a].toString());await f.sort(),y=[];for(let a=0;a<await f.length;a++)b={id:Number(a)+1,action:await f[a]},y.push(await b);c.ApplicationAction=await y;var S=await s.DBAction;h=await Object.keys(await S),f=[];for(let a=0;a<await h.length;a++)f.push(await h[a].toString());await f.sort(),y=[];for(let a=0;a<await f.length;a++)b={id:Number(a)+1,action:await f[a]},y.push(await b);c.DBAction=await y;var x=await s.ApiAction;h=await Object.keys(await x),f=[];for(let a=0;a<await h.length;a++)f.push(await h[a].toString());await f.sort(),y=[];for(let a=0;a<await f.length;a++)b={id:Number(a)+1,action:await f[a]},y.push(await b);c.ApiAction=await y,x=await s.FileReaderAction,h=await Object.keys(await x),f=[];for(let a=0;a<await h.length;a++)f.push(await h[a].toString());await f.sort(),y=[];for(let a=0;a<await f.length;a++)b={id:Number(a)+1,action:await f[a]},y.push(await b);c.FileReaderAction=await y,c.UIActionHelpText=await s}catch(a){}t.json(c)}),a.exports=s},9094:(a,t,e)=>{const i=e(7252),{isSpaceFreeOnAccount:r,addLogMessageInConsole:s,readJSONFile:n}=e(7229),w=i.Router(),{getAllCustomFunction:o}=e(6777),{getActiveThreadCounter:c,getPlanForAccount:u,deleteUserThread:l,addActiveThreadByUser:d}=e(5843),{launchMobileApp:p}=e(861),{takeScreenshot:m,executeTestStep:v,evaluateValuecomingfromTestScript:g,executeDependendtPageFunction:h,createElementasPerProvidedValue:f}=e(4967);var y={};const{authCheck:b}=e(2258);e(9896),w.post("/debuggerwindow",async(a,t)=>{var e={},i=await b(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var w=await i.totalStorage,o=await a.headers.accountlabel;try{var v={status:"Pass",message:"",screenshot:"",command:"",supportingEvidence:{}},g=(o=await a.headers.accountlabel,await a.body.platform),h=await a.body.device,f=await a.body.environment,S=await a.body.userEmail.toLowerCase(),x=await a.body.projectName,M=await a.body.commonTestData,N=await a.body.applicationName;void 0===await N&&(N="");var T=await a.body.testDetails,E={};E.Environment=await f,E.ExecutedBy=await S,void 0!==await T&&(void 0!==await T.testid&&""!==await T.testid&&(E.TestId=await T.testid),void 0!==await T.testname&&""!==await T.testname&&(E.TestName=await T.testname),void 0!==await T.component&&""!==await T.component&&(E.Component=await T.component));var A=await r(await o,await x,await w);if(!await A.isSuccess)return v.message=await A.errorMessage,t.json(v);var P=await a.body.runAt;if(void 0!==await y[await S]){try{await(await y[await S]).deleteSession({shutdownDriver:!0}),await new Promise(a=>setTimeout(a,2e3))}catch(a){}await delete y[await S]}var C=await o+"/"+await x+"/Mobile/Configuration.json",k=await n(await C);if("Server"===await P){await l(await o,await x,await S,"Mobile");var j=await c(await o,await x,"Mobile"),D=await u(await i),O=Number(await D.maxThreadForMobile);if(await j>=Number(await D.maxThreadForMobile))return v.status="Fail",v.message=await O+" thread are already active, as per your plan max "+await O+" thread can be active at a time, Please wait till thread get released",await s(await v.message),t.json(await v)}var I=await p(o,await x,await P,await g,await h,await k,await f,await M,await N,await E);if(v.supportingEvidence=await I.supportingEvidence,!await I.isSuccess)return v.status="Fail",v.message=await I.errorMessage,v.supportingEvidence.errorMessage=await I.errorMessage,t.json(await v);y[await S]=await I.driver;var L=await m(await y[await S]);v.screenshot=await L,"Server"===await P&&await d(await x,await S,"Mobile")}catch(a){v.status="Fail",v.message=a.message;try{if(void 0!==await y[await S]){await(await y[await S]).deleteSession({shutdownDriver:!0});try{await(await y[await S]).quit()}catch(a){}try{await delete y[await S]}catch(a){}}}catch(a){}"Server"===await P&&await l(await o,await x,await S,"Mobile")}t.json(await v)}),w.post("/debuggerwindow/quit",async(a,t)=>{var e={},i=await b(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);try{var r=await a.headers.accountlabel,s=await a.body.userEmail.toLowerCase(),n=await a.body.projectName,w=await a.body.runAt,o={isSuccess:!0};if(void 0!==await await y[await s]){try{await(await y[await s]).deleteSession({shutdownDriver:!0}),await new Promise(a=>setTimeout(a,2e3))}catch(a){}try{await delete y[await s]}catch(a){}}}catch(a){o.isSuccess=!1}"Server"===await w&&await l(await r,await n,await s,"Mobile"),t.json(o)}),w.post("/debugstep",async(a,t)=>{var e={},i=await b(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await i.totalStorage,n=await a.headers.accountlabel;try{var w={status:"Pass",message:"",screenshot:"",isSuccess:!0,primaryLocator:"",primaryLocatorProperty:"",secondaryXPath:"",command:"",supportingEvidence:{},testData:{}},c=[],u="",l="",d="",p=await a.body.isPageFunction,S=await a.body.projectName,x=await r(await n,await S,await s);if(!await x.isSuccess)return w.message=await x.errorMessage,t.json(w);await p?c=await a.body.testStep:(u=await a.body.testStep.action,l=await a.body.testStep.value,d=await a.body.testStep.element);var M=await a.body.userEmail.toLowerCase().trim(),N=await a.body.orData,T=await o(await S,"Mobile"),E=await a.body.commonTestData,A=await a.body.testSpecificData,P=await a.body.platform,C=await a.body.commonTestDataEnvironment,k=await a.body.defaultTimeOut,j="Yes";try{j=await a.body.SelectedSelfHealingOption,void 0===await j&&(j="Yes")}catch(a){j="Yes"}var D=await a.body.pageLoaderXpath;void 0===await D&&(D=[]);var O={},I={},L={},F={};if(l=await g(await l,await E,await A,await I,0,await L,await l,await C,await F),await p){var U=await h(await n,await S,await c,await y[await M],await E,await A,await I,await N,await T,await O,await P,await C,0,await j,"No",await k,await F,await D);w.supportingEvidence=await U.supportingEvidence,await U.isSuccess||(w.status="Fail",w.supportingEvidence.errorMessage=await U.errorMessage),w.testData=await U.testData,w.message=await U.errorMessage}else{var V=await f(await n,await y[await M],await d,await N,await u,await E,await A,await I,0,await T,await S,!0,await l,await L,await P,await C,await k,await j,await F,await D);if(await V.isElementPresent){w.primaryLocator=await V.primaryLocator,w.primaryLocatorProperty=await V.primaryLocatorProperty,w.secondaryXPath=await V.secondaryXPath;var B=await v(await n,await S,await u,await y[await M],await V.element,await l,O,I,await T,await N,await E,await A,await V.elements,await V.elementIndex,await P,await C,await d,0,await L,await j,await F,await k,await D);w.supportingEvidence=await B.supportingEvidence,void 0!==await O.output&&""!==await O.output&&(w.message="Result : "+await O.output),await B.isSuccess||(w.status="Fail",w.message=await B.errorMessage,w.supportingEvidence.errorMessage=await B.errorMessage);try{w.testData=JSON.parse(await l)}catch(a){w.testData={}}}else{w.testData=await l,w.status="Fail";var R=await V.errorMessage;w.message=await R;var J="";try{J=await JSON.parse(await R)}catch(a){J=await R}w.supportingEvidence.errorMessage=await J}}}catch(a){void 0===await w.supportingEvidence&&(w.supportingEvidence={}),w.status="Fail",w.message=await a.message,w.supportingEvidence.errorMessage=await a.message,w.testData=await l}try{if("RunADBCommand"===await u||"RunShellCommand"===await u){var X="";try{X=await JSON.parse(await l),X=await X.valuetobesend}catch(a){X=await l}w.command=await X}else{await new Promise(a=>setTimeout(a,1e3));var W=await m(await y[await M]);w.screenshot=await W}}catch(a){}t.json(w)}),a.exports=w},9147:(a,t,e)=>{const i="./dataHub/";var r=e(9896);const s=e(416),n=e(2410),w=e(5751),o=e(6928);a.exports={getColumnValuesBasedOnConditions:async function(a,t,e,i){try{"string"==typeof t&&(t=JSON.parse(t)),"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof i&&(i=JSON.parse(i));const r=w.utils.decode_range(a["!ref"]);let s={};for(let t=r.s.c;t<=r.e.c;t++){const e=a[w.utils.encode_cell({r:r.s.r,c:t})];e&&(s[e.v]=t)}let n={};for(const a of i)n[a]=[];for(let o=r.s.r+1;o<=r.e.r;o++){let r=!0;for(let i=0;i<t.length;i++){const n=t[i],c=e[i],u=s[n];if(void 0===u){r=!1;break}const l=w.utils.encode_cell({r:o,c:u});if(!(a[l]?.v||"").toString().toLowerCase().includes(c.toLowerCase())){r=!1;break}}if(r)for(const t of i){const e=s[t],i=w.utils.encode_cell({r:o,c:e}),r=a[i]?.v??null;n[t].push(r)}}return n}catch(a){return console.error("Error:",a),{}}},readPdfFile:async function(a,t,e){var w={isSuccess:!0,errorMessage:"",output:{},supportingEvidence:{}};try{const p=await e.toString().toLowerCase().includes(".pdf");if(!await p)return w.isSuccess=!1,w.errorMessage="Provided pdf file name is incorrect. Please provide correct details.",await w;e=await o.parse(e).name;var c=await i+await a+"/"+await t+"/Downloads/*"+await e+"*.pdf",u=await n.sync(await c);if(0===await u.length&&(c=await i+await a+"/"+await t+"/Uploads/*"+await e+"*.pdf",u=await n.sync(await c),0===await u.length))return w.isSuccess=!1,w.errorMessage="pdf file "+await e+" does not exist on server,Please make sure file should be exist on server.",await w;const m=await u[Number(await u.length-1)],v=await r.readFileSync(await m);var l;l=await s(await v);var d=await l.text;w.output=await d}catch(a){w.isSuccess=!1,w.errorMessage=await a.toString()}return await w},verifyPdfPageCount:async function(a,t,e,w){var o={isSuccess:!0,errorMessage:"",output:{},supportingEvidence:{}};try{const l=await e.toString().toLowerCase().includes(".pdf");if(!await l)return o.isSuccess=!1,o.errorMessage="Provided pdf file name is incorrect. Please provide correct details.",await o;var c=await i+await a+"/"+await t+"/Downloads/"+await e,u=await n.sync(await c);if(0===await u.length&&(c=await i+await a+"/"+await t+"/Uploads/"+await e,u=await n.sync(await c),0===await u.length))return o.isSuccess=!1,o.errorMessage="pdf file "+await e+" does not exist on server,Please make sure file should be exist on server.",await o;const d=await u[Number(await u.length-1)],p=await r.readFileSync(await d),m=(await s(await p)).numpages;if(Number(await m)!==Number(await w))return o.isSuccess=!1,o.errorMessage="Expected pdf page count "+await w+" does not match with actual page count  "+await m,await o}catch(a){o.isSuccess=!1,o.errorMessage=await a.toString()}return await o},getRowCountFromExcel:async function(a,t,e,r){var s={isSuccess:!0,errorMessage:"",output:0,supportingEvidence:{}};try{const d=await e.toString().toLowerCase().includes(".xls");if(!await d)return s.isSuccess=!1,s.errorMessage="Provided excel file name is incorrect. Please provide correct details.",await s;e=await o.parse(e).name;var c=await i+await a+"/"+await t+"/Downloads/*"+await e+"*.xlsx",u=await n.sync(await c);if(0===await u.length&&(c=await i+await a+"/"+await t+"/Uploads/*"+await e+"*.xls",u=await n.sync(await c),0===await u.length))return s.isSuccess=!1,s.errorMessage="Excel file "+await e+" does not exist on server,Please make sure file should be exist on server.",await s;const p=await u[Number(await u.length-1)],m=await w.readFile(await p);var l;void 0===await r||""===await r?(l=await m.SheetNames[0],l=await m.Sheets[await l]):l=await m.Sheets[await r];const v=await w.utils.decode_range(await l["!ref"]),g=await v.e.r+1;s.output=await g,s.isSuccess=!0}catch(a){s.isSuccess=!1,s.errorMessage=await a.toString()}return await s},readExcelFile:async function(a,t,e,r){var s={isSuccess:!0,errorMessage:""};s.sheetname=await r,s.output=0,s.supportingEvidence={};try{const m=await e.toString().toLowerCase().includes(".xls")||await e.toString().toLowerCase().includes(".csv");if(!await m)return s.isSuccess=!1,s.errorMessage="Provided excel file name is incorrect. Please provide correct details.",await s;var c=await e;e=await o.parse(e).name;var u=await o.parse(await c).ext,l=await i+await a+"/"+await t+"/Downloads/*"+await e+"*"+await u,d=await n.sync(await l);if(0===await d.length&&(l=await i+await a+"/"+await t+"/Uploads/*"+await e+"*"+await u,d=await n.sync(await l),0===await d.length))return s.isSuccess=!1,s.errorMessage="Excel file "+await e+" does not exist on server,Please make sure file should be exist on server.",await s;const v=await d[Number(await d.length-1)],g=await w.readFile(await v);var p;void 0===await r||""===await r?(p=await g.SheetNames[0],s.sheetname=await p,p=await g.Sheets[await p]):p=await g.Sheets[await r],s.output=await p,s.isSuccess=!0}catch(a){s.isSuccess=!1,s.errorMessage=await a.toString()}return await s},getCellCalueFromExcel:async function(a,t,e){try{let i;for(const a in e){const r=w.utils.decode_cell(a);if(0===r.r&&e[a].v===t){i=r.c;break}}if(void 0===i)return;if(void 0===await a||0===await a){const a=[];for(const t in e){const r=w.utils.decode_cell(t);r.c===i&&r.r>0&&a.push(e[t].v)}return a}const r=w.utils.encode_cell({r:a-1,c:i});return e[r]?e[r].v:void 0}catch(a){return}}}},9155:(a,t,e)=>{const i=e(7252).Router(),{saveFile:r,isDirectoryExist:s,createDirectory:n,deleteAllSubfolders:w,isSpaceFreeOnAccount:o,addLogMessageInConsole:c,readJSONFile:u,saveFileAsEncyptedContent:l}=e(7229);var d="./dataHub/";const{authCheck:p}=e(2258);var m=e(9896);const v=e(2410),g=e(6212);async function h(a){try{return await a.toString().includes("[")||await a.toString().includes("]")?a.replace(/[\[\]]/g,"*"):await a}catch(t){return await a}}async function f(a){try{a=await a.map((a,t)=>({...a,id:t+1}))}catch(t){a=[]}return a}i.get("/project/:projectName",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=a.params.projectName,s=await a.headers.accountlabel,n={};try{await a.header("Cache-Control","private, no-cache, no-store, must-revalidate"),await t.header("Cache-Control","private, no-cache, no-store, must-revalidate");var w=await s+"/"+await r+"/Manual/Configuration.json";n=await u(await w)}catch(a){}t.json(n)}),i.post("/project/:projectName/mncustomkeys",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.headers.accountlabel,s=await a.headers.useremail,n=await i.totalStorage,w={isFileSaved:!1,errorMessage:!1},d=a.params.projectName,m=await o(await r,await d,await n);if(!await m.isSuccess)return w.errorMessage=await m.errorMessage,t.json(w);var v={};try{var g=await r+"/"+await d+"/Manual/Configuration.json";v=await u(await g)}catch(a){v={}}try{var h=await a.body.mncustomkey;void 0===await v.TestCaseCustomKeys&&(v.TestCaseCustomKeys=[]),v.TestCaseCustomKeys=await h,await l(await r+"/"+await d+"/Manual/Configuration.json",v),w.isFileSaved=!0,await c("Custom key is successfully updated by the user "+await s)}catch(a){await c("Unable to add Custom key by user "+await s+" becuase of "+await a.toString()),w.errorMessage=await a}t.json(await w)}),i.post("/project/:projectName/newtestcycle",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.headers.accountlabel,w=await a.headers.useremail,d=await i.totalStorage,m={isFileSaved:!1,errorMessage:""};try{await a.header("Cache-Control","private, no-cache, no-store, must-revalidate"),await t.header("Cache-Control","private, no-cache, no-store, must-revalidate");var v=a.params.projectName,g=await o(await r,await v,await d);if(!await g.isSuccess)return m.errorMessage=await g.errorMessage,t.json(m);var h=await s(await r+"/"+await v+"/Manual");await h||await n(await r+"/"+await v+"/Manual");var f={};try{var y=await r+"/"+await v+"/Manual/Configuration.json";f=await u(await y)}catch(a){f={}}var b=await a.body.newTestCycle.toString().trim();if(""===await b)m.errorMessage=" Test Cycle Name can not be blank.",await c(await w+" Test Cycle Name can not be blank.");else{var S=!1,x=await f.ListOfTestCycle;if(void 0!==await x){const a=await x.map(a=>a.toLowerCase());if(await a.includes(await b.toLowerCase()))m.errorMessage=" Test Cycle Name is already exist on server.",await c(await w+" Test Cycle Name is already exist on server."),S=!0;else{var M=[];M.push(await b),M=await M.concat(await x),f.ListOfTestCycle=await M}}else f.ListOfTestCycle=[],f.ListOfTestCycle.push(await b);await S||(await l(await r+"/"+await v+"/Manual/Configuration.json",f),m.isFileSaved=!0,await c(await w+" Test Cycle is successfully added."))}}catch(a){m.errorMessage=await a.toString(),await c(await w+" "+await m.errorMessage)}t.json(m)}),i.post("/project/:projectName/currenttestcycle",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,w=await a.headers.accountlabel,c={isFileSaved:!1,errorMessage:""};try{await a.header("Cache-Control","private, no-cache, no-store, must-revalidate"),await t.header("Cache-Control","private, no-cache, no-store, must-revalidate");var d=a.params.projectName,m=await o(await w,await d,await r);if(!await m.isSuccess)return c.errorMessage=await m.errorMessage,t.json(c);var v=await s(await w+"/"+await d+"/Manual");await v||await n(await w+"/"+await d+"/Manual");var g={};try{var h=await w+"/"+await d+"/Manual/Configuration.json";g=await u(await h)}catch(a){g={}}var f=await a.body.currentTestCycle.toString().trim();""===await f?c.errorMessage="Current Test Cycle Name can not be blank.":(g.CurrentTestCycle="",g.CurrentTestCycle=await f,await l(await w+"/"+await d+"/Manual/Configuration.json",g),c.isFileSaved=!0)}catch(a){c.errorMessage=a.toString()}t.json(c)}),i.get("/project/:projectName/testtree",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await a.headers.accountlabel;await a.header("Cache-Control","private, no-cache, no-store, must-revalidate"),await t.header("Cache-Control","private, no-cache, no-store, must-revalidate");var n=await a.params.projectName,w=[],o=[{label:await n,key:await n,nodes:[]}];try{var c=await d+await s+"/"+await n+"/Manual/PlaceHolderTree.json";w=await JSON.parse(await m.readFileSync(await c,"utf8"))}catch(a){w=[]}w.includes(null)&&(w=await w.filter(a=>null!==a),await r(await s+"/"+await n+"/Manual/PlaceHolderTree.json",await w)),o[0].nodes=await w,t.json(o)}),i.get("/listofusers",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.headers.accountlabel,s=[];try{var n=await a.headers.userselectedaccount;if(void 0===await n||""===await n||null===await n)return t.json(await s);var w=await u(await r+"/UserDetails/UserDetails.json"),o=await Object.keys(await w);for(let a=0;a<await o.length;a++){var c=await o[await a],l=await w[await c].accounts;await l.includes(await n)&&s.push(await c)}}catch(a){s=[]}t.json(await s)}),i.post("/project/:projectName/saveenvironment",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.headers.accountlabel,w=await i.totalStorage,c={isFileSaved:!1,errorMessage:""};try{var d=a.params.projectName,m=await o(await r,await d,await w);if(!await m.isSuccess)return c.errorMessage=await m.errorMessage,t.json(c);var v=await i.maxNumberOfEnvPerAccount,g=await a.body;if(await g.length>await v)return c.errorMessage="Only "+await v+" environment are allowed per project.If you need add more environment,Please connect QaBunch support team.",t.json(c);await s(await r+"/"+d+"/Manual/")||await n(await r+"/"+await d+"/Manual/");var h={};try{var f=await r+"/"+await d+"/Manual/Configuration.json";h=await u(await f)}catch(a){h={}}void 0===await h.Environment&&(h.Environment=[]),h.Environment=await g,await l(await r+"/"+await d+"/Manual/Configuration.json",await h),c.isFileSaved=!0}catch(a){c.errorMessage=a.toString()}t.json(c)}),i.post("/project/:projectName/deletecomponent",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await a.headers.accountlabel,n=await a.headers.useremail;if(!await i.isSuperAdmin)return e.errorMessage="The user does not have permission to delete the file",t.status=403,t.json(await e);var o={isFileSaved:!1,errorMessage:""};try{var c=a.body.component;if(""===await c.toString().trim()||!await c.includes("/"))return o.errorMessage="Please provide correct component name.",t.json(await o);var u=await c.toString().split("/"),l=await u[0];u=await u.splice(1);var g=await u.join("/"),y=await d+await s+"/"+await l+"/Manual/TestCaseDetails/"+await g,b=await y+"/**/*.json";b=await h(b);var S=await v.sync(await b),x=[];for(let a=0;a<await S.length;a++){var M=await S[a].split("\\"),N=await M[await M.length-1].replace(".json","");await x.push(await N);try{console.log("Command for delete file "+await S[a]),await m.unlinkSync(await S[a]),console.log("File is successfully deleted from the server.")}catch(a){console.log("Unable to delete test case because of "+await a.toString())}}if(o.isFileSaved=await w(await y),await o.isFileSaved){if(await x.length>0){try{var T=await d+await s+"/"+await l+"/Manual/DeletedTestId.json",E=await JSON.parse(await m.readFileSync(await T,"utf8"))}catch(a){E={}}for(let a=0;a<await x.length;a++)E[await x[a]]=await n;await r(await s+"/"+await l+"/Manual/DeletedTestId.json",await E)}}else o.errorMessage="test case file are in open state.";try{var A=await u,P=await d+await s+"/"+await l+"/Manual/PlaceHolderTree.json",C=await JSON.parse(await m.readFileSync(await P,"utf8")),k=await async function(a,t){if(!Array.isArray(a)||!Array.isArray(t)||0===t.length)return a;return await async function a(e,i){if(i>=t.length)return;const r=t[i],s=e.findIndex(a=>a.key===r);-1!==s&&(i===t.length-1?e.splice(s,1):await a(e[s].nodes,i+1))}(a,0),a}(await C,await A);await r(await s+"/"+await l+"/Manual/PlaceHolderTree.json",await k),await async function(a,t,e){try{var i=await d+await e+"/"+await a+"/Manual/TestSuite/*.json",s=await v.sync(await i);if(await s.length>0)for(let a=0;a<await s.length;a++){var n=await JSON.parse(await m.readFileSync(await s[a],"utf8"));if(await JSON.stringify(await n).includes(await t)){var w=await n.AllTestCases,o=await w;for(let a=0;a<await w.length;a++){var c=await w[a].component;if(await c.includes("/")){var u=await c.split(await t)[0];""===await u&&(o=await await o.filter(a=>!(a.component===c)))}else await c===await t&&(o=await await o.filter(a=>!(a.component===t)))}o=await f(await o),n.AllTestCases=await o;var l=await await s[a];l=await l.split("\\").slice(1).join("\\"),await r(await l,await n);break}}}catch(a){console.log(await a.toString())}}(await l,await g,await s),o.isFileSaved=!0}catch(a){}}catch(a){o.errorMessage=a.toString()}t.json(o)}),i.post("/project/:projectName/renamecomponent",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var s=await a.headers.accountlabel,n=await a.headers.useremail;if(!await i.isSuperAdmin)return e.errorMessage="The user does not have permission to delete the file",t.status=403,await c(await n+" "+await e.errorMessage),t.json(await e);var w={isFileSaved:!1,errorMessage:""};try{var o=a.body.oldcomponent;if(""===await o.toString().trim()||!await o.includes("/"))return w.errorMessage="Please provide correct component name.",t.json(await w);var u=a.body.newcomponent,l=await u.trim();if(""===await u.toString().trim())return w.errorMessage="New component name can not be blank.",t.json(await w);const e=await o.split("/");await e.shift();const i=(o=await e.join("/")).lastIndexOf("/");u=-1===await i?await u:o.slice(0,i)+"/"+await u;var f=await a.params.projectName,y=await d+await s+"/"+await f+"/Manual/TestCaseDetails/"+await o,b=await d+await s+"/"+await f+"/Manual/TestCaseDetails/"+await u,S=await y+"/**/*.json";S=await h(S);var x=await v.sync(await S);for(let a=0;a<await x.length;a++){var M;try{try{await m.existsSync(await x[a])&&(M=await g.lock(await x[a],{retries:{retries:10,minTimeout:500,maxTimeout:2e3,factor:2}}))}catch(e){return w.errorMessage="Unbale to read file "+await x[a]+" because Lock file is already being held "+await e.toString(),console.log("Unbale to read file "+await x[a]+" because Lock file is already being held"),t.json(w)}var N=await JSON.parse(await m.readFileSync(await await x[a],"utf8"));N.placeHolder=await u,await m.writeFileSync(await x[a],await JSON.stringify(await N));try{await M()}catch(a){}}catch(a){}}try{await m.renameSync(await y,await b)}catch(a){}var T=await d+await s+"/"+await f+"/Manual/PlaceHolderTree.json",E=await JSON.parse(await m.readFileSync(await T,"utf8"));w.isFileSaved=await async function(a,t,e,i,s){try{var n=!1,w=await a,o=await t,c=await e,u=await o.split("/"),l=[];for(let a=0;a<await u.length;a++){var d=await u[a];for(let t=0;t<await w.length;t++){var p=await w[t].key;if(await p.toLowerCase().trim()===d.toLocaleLowerCase().trim()){a===await u.length-1&&(w[t].key=await e,w[t].label=await e),w=await w[t].nodes,l.push(await t);break}}}for(let a=0;a<await w.length;a++)if(await c.toLowerCase().trim()===await w[a].key.toLowerCase().trim()){n=!0;break}if(await n)return!1;var m=await a;for(let t=0;t<await l.length;t++){var v=await l[t];m[await v]=await a[await v]}return await r(await s+"/"+await i+"/Manual/PlaceHolderTree.json",await m),!0}catch(a){}return!1}(await E,await o,await l.trim(),await f,await s),await w.isFileSaved||(w.errorMessage="Not Permitted."),await async function(a,t,e,i){try{var s=await d+await i+"/"+await a+"/Manual/TestSuite/*.json",n=await v.sync(await s);if(await n.length>0)for(let a=0;a<await n.length;a++){var w=await JSON.parse(await m.readFileSync(await n[a],"utf8"));if(await JSON.stringify(await w).includes(await t)){var o=await w.AllTestCases;for(let i=0;i<await o.length;i++){var c=await o[i].component;if(await c===await t){o[i].component=await e,w.AllTestCases=await o;var u=await await n[a];u=await u.split("\\").slice(1).join("\\"),await r(await u,await w)}}}}}catch(a){console.log(await a.toString())}}(await f,await o,await u,await s)}catch(a){w.errorMessage=a.toString();try{await M()}catch(a){}}t.json(w)}),i.post("/project/:projectName/gettestidforcomponent",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=[];try{var n=await a.headers.accountlabel,w=a.params.projectName,o=await a.body.component;if(""===await o&&!await o.includes("/"))return t.json(r);if(""===await w)return t.json(r);let e=await o.split("/");await e.shift(),o=await e.join("/");var c=await n+"/"+await w+"/Manual/TestCaseDetails/"+await o,u=await s(await c);if(!await u)return t.json(r);var l=await d+await c,m=await l+"/**/*.json";m=await h(m);var g=await v.sync(await m);for(let a=0;a<await g.length;a++){var f=await g[a];let t=await f.split("\\"),e=await t[await t.length-1].replace(".json","");r.push(await e)}}catch(a){}t.json(r)}),i.post("/project/:projectName/movetestcases",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileSaved:!1,errorMessage:""};try{var w=await a.headers.accountlabel,o=a.params.projectName,c=await a.body.sourceComponent,u=await a.body.destinationComponent,l=await a.body.listOfTestId,f=await a.body.testcycle;if(""===await c&&!await c.includes("/"))return r.errorMessage="source component name is incorrect",t.json(output);if(""===await u&&!await u.includes("/"))return r.errorMessage="destination component name is incorrect",t.json(output);if(""===await o)return r.errorMessage="Project name can not be blank.",t.json(r);if(0===await l.length)return r.errorMessage="Please select test case to move.",t.json(r);if(""===await f||void 0===await f)return r.errorMessage="testCycle can not be blank.Please set default test cycle from the configuration page.",t.json(r);f=await f.toString().trim();let e=await c.split("/");await e.shift(),c=await e.join("/");let i=await u.split("/");await i.shift(),u=await i.join("/");var y=await w+"/"+await o+"/Manual/TestCaseDetails/"+await c,b=await w+"/"+await o+"/Manual/TestCaseDetails/"+await u,S=await s(await y);if(!await S)return r.errorMessage="Souce component does not exist on server.",t.json(r);var x=await s(await b);if(!await x)return r.errorMessage="destination component does not exist on server.",t.json(r);for(let a=0;a<await l.length;a++){var M=await l[a].value;y=await h(y);var N,T=await v.sync(await await d+await y+"/**/"+await M+".json");if(0===await T.length)return r.errorMessage="TestId "+await M+" does not exist on server.",t.json(r);N=await T[0];var E=await JSON.parse(await m.readFileSync(await N,"utf8"));E.placeHolder=await u,await m.writeFileSync(await N,await JSON.stringify(await E)),await n(await b+"/"+await f),await m.renameSync(await N,await d+await b+"/"+await f+"/"+await M+".json")}try{const a=await d+await o+"/Manual/TestSuite/*.json";var A=await v.sync(await a);if(await A.length>0)for(let a=0;a<await A.length;a++){var P,C=await A[a];try{await m.existsSync(await C)&&(P=await g.lock(await C,{retries:{retries:10,minTimeout:500,maxTimeout:2e3,factor:2}}))}catch(a){return r.errorMessage="Unbale to read file "+C+" because Lock file is already being held "+await a.toString(),console.log("Unbale to read file "+C+" because Lock file is already being held"),t.json(r)}T=await JSON.parse(await m.readFileSync(await C,"utf8"));var k=await T.AllTestCases;if(await JSON.stringify(await T).includes(await c)){for(let a=0;a<await l.length;a++){var j=await l[a].value;if(await JSON.stringify(await T).includes(await j))for(let a=0;a<await k.length;a++){var D=await k[a].component,O=await k[a].testid;if(await c===await D&&await O===await j){k[await a].component=await u;break}}}T.AllTestCases=await k;var I=await JSON.stringify(await T);await m.writeFileSync(await C,await I)}try{await P()}catch(a){}}}catch(a){}r.isFileSaved=!0}catch(a){r.errorMessage=await a.toString()}t.json(r)}),i.post("/project/:projectName/defectcustomkeys",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.headers.accountlabel,s=await i.totalStorage,n={isFileSaved:!1,errorMessage:!1},w=a.params.projectName,c=await o(await r,await w,await s);if(!await c.isSuccess)return n.errorMessage=await c.errorMessage,t.json(n);var d={};try{var m=await r+"/"+await w+"/Manual/Configuration.json";d=await u(await m)}catch(a){}try{var v=await a.body.defectcustomkey;void 0===await d.DefectCustomKeys&&(d.DefectCustomKeys=[]),d.DefectCustomKeys=await v,await l(await r+"/"+await w+"/Manual/Configuration.json",d),n.isFileSaved=!0}catch(a){n.errorMessage=await a}t.json(await n)}),i.post("/project/:projectName/testplancustomkeys",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,s=await a.headers.accountlabel,n={isFileSaved:!1,errorMessage:!1},w=a.params.projectName,c=await o(await s,await w,await r);if(!await c.isSuccess)return n.errorMessage=await c.errorMessage,t.json(n);var d={};try{var m=await s+"/"+await w+"/Manual/Configuration.json";d=await u(await m)}catch(a){}try{var v=await a.body.testplancustomkey;void 0===await d.TestPlanCustomKeys&&(d.TestPlanCustomKeys=[]),d.TestPlanCustomKeys=await v,await l(await s+"/"+await w+"/Manual/Configuration.json",d),n.isFileSaved=!0}catch(a){n.errorMessage=await a}t.json(await n)}),i.post("/project/:projectName/getdefectidforcomponent",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=[];try{var n=await a.headers.accountlabel,w=a.params.projectName,o=await a.body.component;if(""===await o&&!await o.includes("/"))return t.json(r);if(""===await w)return t.json(r);let e=await o.split("/");await e.shift(),o=await e.join("/");var c=await n+"/"+await w+"/Manual/DefectDetails/"+await o,u=await s(await c);if(!await u)return t.json(r);var l=await d+await c,m=await l+"/**/*.json";m=await h(m);var g=await v.sync(await m);for(let a=0;a<await g.length;a++){var f=await g[a];let t=await f.split("\\"),e=await t[await t.length-1].replace(".json","");r.push(await e)}}catch(a){}t.json(r)}),i.post("/project/:projectName/movedefects",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={isFileSaved:!1,errorMessage:""};try{var w=await a.headers.accountlabel,o=a.params.projectName,c=await a.body.sourceComponent,u=await a.body.destinationComponent,l=await a.body.listOfDefectId,g=await a.body.testcycle;if(""===await c&&!await c.includes("/"))return r.errorMessage="source component name is incorrect",t.json(output);if(""===await u&&!await u.includes("/"))return r.errorMessage="destination component name is incorrect",t.json(output);if(""===await o)return r.errorMessage="Project name can not be blank.",t.json(r);if(0===await l.length)return r.errorMessage="Defect is found for Move.",t.json(r);if(""===await g)return r.errorMessage="testCycle can not be blank.",t.json(r);let e=await c.split("/");await e.shift(),c=await e.join("/");let i=await u.split("/");await i.shift(),u=await i.join("/");var f=await w+"/"+await o+"/Manual/DefectDetails/"+await c,y=await w+"/"+await o+"/Manual/DefectDetails/"+await u,b=await s(await f);if(!await b)return r.errorMessage="Souce component does not exist on server.",t.json(r);var S=await s(await y);await S||await n(await w+"/"+await o+"/Manual/DefectDetails/"+await u);for(let a=0;a<await l.length;a++){var x=await l[a].value;f=await h(f);var M=await v.sync(await await d+await f+"/**/"+await x+".json"),N=await JSON.parse(await m.readFileSync(await M[0],"utf8"));N.placeHolder=await u,await m.writeFileSync(await M[0],await JSON.stringify(await N)),await n(await y+"/"+await g),await m.renameSync(await M[0],await d+await y+"/"+await g+"/"+await x+".json")}r.isFileSaved=!0}catch(a){r.errorMessage=await a.toString()}t.json(r)}),i.post("/project/:projectName/defectconfigurablefeilds",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,s={isFileSaved:!1,errorMessage:!1},n=a.params.projectName,w=await a.headers.accountlabel,c=await o(await w,await n,await r);if(!await c.isSuccess)return s.errorMessage=await c.errorMessage,t.json(s);var d={};try{var m=await w+"/"+await n+"/Manual/Configuration.json";d=await u(await m)}catch(a){}try{var v=await a.body.defectconfigurablefields;void 0===await d.DefectConfigurableFields&&(d.DefectConfigurableFields=[]),d.DefectConfigurableFields=await v,await l(await w+"/"+await n+"/Manual/Configuration.json",d),s.isFileSaved=!0}catch(a){s.errorMessage=await a}t.json(await s)}),i.post("/project/:projectName/savethirdpartyaitoolsdata",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await i.totalStorage,s=await a.headers.accountlabel,w={isFileSaved:!1,errorMessage:""},c=a.params.projectName,d=await o(await s,await c,await r);if(!await d.isSuccess)return w.errorMessage=await d.errorMessage,t.json(w);var m={};await n(await s+"/"+await c+"/Manual");try{var v=await s+"/"+await c+"/Manual/Configuration.json";m=await u(await v)}catch(a){m={}}try{var g=await a.body.ThirdPartyAiToolsData;if(void 0===await g)return w.errorMessage="Request body is invalid.",t.json(w);if(await g.length>1)return w.errorMessage="Request body is invalid.",t.json(w);var h=await g[0].token;if(void 0===await h)return w.errorMessage="Request body is invalid.",t.json(w);void 0===await m.ThirdPartyAiToolsData&&(m.ThirdPartyAiToolsData=[]),m.ThirdPartyAiToolsData=await g,await l(await s+"/"+await c+"/Manual/Configuration.json",m),w.isFileSaved=!0}catch(a){w.errorMessage=await a.toString()}t.json(await w)}),i.post("/project/:projectName/testexecutioncustomkeys",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.headers.accountlabel,s=await i.totalStorage,n={isFileSaved:!1,errorMessage:!1},w=a.params.projectName,c=await o(await r,await w,await s);if(!await c.isSuccess)return n.errorMessage=await c.errorMessage,t.json(n);var d={};try{var m=await r+"/"+await w+"/Manual/Configuration.json";d=await u(await m)}catch(a){}try{var v=await a.body.testexecutioncustomkey;void 0===await d.TestExecutionCustomKeys&&(d.TestExecutionCustomKeys=[]),d.TestExecutionCustomKeys=await v,await l(await r+"/"+await w+"/Manual/Configuration.json",d),n.isFileSaved=!0}catch(a){n.errorMessage=await a}t.json(await n)}),i.post("/project/:projectName/testingtools",async(a,t)=>{var e={},i=await p(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.headers.accountlabel,w=await i.totalStorage,c={isFileSaved:!1,errorMessage:""};try{var d=a.params.projectName,m=await o(await r,await d,await w);if(!await m.isSuccess)return c.errorMessage=await m.errorMessage,t.json(c);var v="Manual";await s(await r+"/"+d+"/"+v)||await n(await r+"/"+d+"/"+v);var g={};try{var h=await r+"/"+await d+"/"+v+"/Configuration.json";g=await u(await h)}catch(a){}g.Tools=await a.body,await l(await r+"/"+d+"/"+v+"/Configuration.json",g),c.isFileSaved=!0}catch(a){c.errorMessage=a.toString()}t.json(c)}),a.exports=i},9280:a=>{"use strict";a.exports=require("selenium-webdriver/chrome")},9466:(a,t,e)=>{const i=e(7252).Router(),{saveFile:r,isDirectoryExist:s,createDirectory:n,getFolderSizeInBytes:w,addLogMessageInConsole:o}=e(7229);var c="./dataHub/";const{authCheck:u}=e(2258);var l=e(9896);e(2410),i.get("/project/:projectName/getstorage",async(a,t)=>{var e={},i=await u(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r={consumedStorage:""};try{var s=a.params.projectName,n=await a.headers.accountlabel,c=await w(await n+"/"+await s);r.consumedStorage=await c,await o("Get Storage called for project "+await s+" and consumed space is "+await c)}catch(a){}t.json(r)}),i.get("/support",async(a,t)=>{var e=[];try{var i=await a.headers.userselectedaccount;if(void 0===await i||""===await i)return await t.json(e);var r=await a.headers.accountlabel,s=await c+"Supports/"+await r+"/"+await i+".json",n=await JSON.parse(await l.readFileSync(await s,"utf8"));e=await n.ReqTable}catch(a){e=[]}t.json(e)}),i.post("/support",async(a,t)=>{var e={isSuccess:!1,errorMessage:!1},i={};try{var s=await a.headers.useremail,w=await a.headers.accountlabel;const M=["Manual","Web","Mobile","Api","Other"],N=["Defect","Enhancement","New Requirment","Other"],T=["Low","Medium","High","Critical"];var u,d=await a.headers.userselectedaccount,p=await a.body,m=await p.title,v=await p.reqdescription,g=await p.supportfor,h=await p.titckettype,f=await p.priority;if(""===await m.toString().trim())return e.errorMessage="Request Title can not be blank",t.json(e);if(""===await v.toString().trim())return e.errorMessage="Request description can not be blank",t.json(e);if(!await M.includes(await g))return e.errorMessage="Wrong input is provided for Support for field",t.json(e);if(!await N.includes(await h))return e.errorMessage="Wrong input is provided for Ticket type field",t.json(e);if(!await T.includes(await f))return e.errorMessage="Wrong input is provided for Priority field",t.json(e);i={};try{var y=await c+"Supports/"+await w+"/"+await d+".json";i=await JSON.parse(await l.readFileSync(await y,"utf8"))}catch(a){i={}}var b=await i.ReqTable;void 0===await b&&(i.ReqTable=[],b=[]),u=Number(await b.length)+1;var S="CR-"+await u,x={id:await await u,reqid:await S,title:await m,supportfor:await g,titckettype:await h,priority:await f,status:"Request Created",comments:"",createdby:await s};i[await S]=await v,i.ReqTable.push(await x),await n("Supports/"+await w),await r("Supports/"+await w+"/"+await d+".json",await i),e.isSuccess=!0,e.errorMessage="Support Ticket "+await S+" is successfully created.",await o("Support Ticket created for project "+await d+" by user "+await s)}catch(a){e.errorMessage=await a.toString()}t.json(e)}),i.post("/support/update",async(a,t)=>{var e={isSuccess:!1,errorMessage:""},i={};try{var s=await a.headers.userselectedaccount,n=await a.headers.accountlabel,w=await a.body,o=await Object.keys(await w);if(0===await o.length)return e.errorMessage="Invalid body.",t.json(e);i={};try{var u=await c+"Supports/"+await n+"/"+await s+".json";i=await JSON.parse(await l.readFileSync(await u,"utf8"))}catch(a){return e.errorMessage="Support file does not exist.",t.json(e)}var d=await i.ReqTable;if(void 0===await d)return e.errorMessage="ReqTable does not exist in support file.",t.json(e);var p=!1;for(let a=0;a<await o.length;a++){var m=await o[a];for(let a=0;a<await d.length;a++){var v=await d[a].reqid;if(await m===await v){p=!0;var g=await Object.keys(await w[await m]);for(let t=0;t<await g.length;t++){var h=await g[t],f=await await w[await m][await h];void 0!==await d[a][await h]&&(d[a][await h]=await f)}break}}}await p?(i.ReqTable=await d,await r("Supports/"+await n+"/"+await s+".json",await i),e.isSuccess=!0):e.errorMessage="Provided Request id does not exist on the server."}catch(a){e.errorMessage=await a.toString()}t.json(e)}),a.exports=i},9611:(a,t,e)=>{const i=e(9896),r=e(7252),s=e(4716),n=r.Router(),{getPastDate:w,getMostRecentFile:o,readJSONFile:c}=e(7229);var u="./dataHub/",l="./dataHub/";const{authCheck:d}=e(2258),p=e(2410);n.get("/project/:projectName/testingtype/:testingtype/daysdevcounter/:daysDevCounter",async(a,t)=>{var e={},r=await d(await a);if(!await r.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=r.errorMessage,t.status=await r.responseCode,t.json(await e);var n=await a.headers.accountlabel,o=a.params.projectName,l=a.params.testingtype,m=Number(a.params.daysDevCounter),v=await w(Number(m)),g={};for(let a=0;a<await v.length;a++)g[await v[a]]=0;var h={TotalTestScripts:0,TotalComponents:0,ModuleScriptCountXaxis:[],ModuleScriptCountYaxis:[],DayWiseTestScriptDevelopment:[],TotalNumberofExecutions:0,OverallScriptExecutionCount:0,PassPercentageInOverallExecution:0,UseXaxisforTestScriptCount:[],UseYaxisforTestScriptCount:[[]],WeeklyTestScriptDevelopmentCount:0},f=[];let y=0;var b={},S={};try{S=await c(await n+"/UserDetails/UserDetails.json")}catch(a){S={}}var x=await async function(){const a=[];let t=await s().subtract(1,"weeks").startOf("isoWeek");for(let e=0;e<7;e++)a.push(t.format("DD MMM YYYY")),t=t.add(1,"days");return a}(),M=0;try{f=await i.readdirSync(u+await n+"/"+o+"/"+l+"/TestScripts"),h.TotalComponents=f.length,h.ModuleScriptCountXaxis=await f;for(let a=0;a<await f.length;a++){var N=await i.readdirSync(u+await n+"/"+o+"/"+l+"/TestScripts/"+f[await a]),T=await N.length;y+=Number(T),h.ModuleScriptCountYaxis.push(await T);for(let t=0;t<await N.length;t++){var E=await i.statSync(u+await n+"/"+o+"/"+l+"/TestScripts/"+f[await a]+"/"+N[t]),A=await s(E.birthtime).format("DD MMM YYYY");if(await v.includes(await A)){var P=await JSON.parse(await i.readFileSync(await u+await n+"/"+o+"/"+l+"/TestScripts/"+f[await a]+"/"+N[t],"utf8")),C=await P.createdBy;void 0===await C&&(C=await P.lastUpdatedBy);var k="User not Found";if(void 0!==await C){const a=await C.match(/[\w.-]+@[\w.-]+\.\w+/);if(await a){var j=await await a[0],D=await S[await j];k=void 0!==await D?await D.firstName+" "+await D.lastName:await j}}else console.log("createdby field is not defined for "+await l+" test scripts component "+await f[await a]+" and test id details "+await N[t]);void 0===await b[await k]?b[await k]=1:b[await k]=await Number(await b[await k])+1,g[await A]=await g[await A]+1}await x.includes(await A)&&(M=Number(await M)+1)}}h.TotalTestScripts=y;for(let a=0;a<await v.length;a++)h.DayWiseTestScriptDevelopment.push(await g[await v[a]]);var O=await Object.keys(await b);if(await O.length>0){h.UseXaxisforTestScriptCount=await O;var I=[],L=[];for(let a=0;a<await O.length;a++){k=await O[a];var F=await b[await k];L.push(await F)}I.push(await L),h.UseYaxisforTestScriptCount=await I}h.WeeklyTestScriptDevelopmentCount=await M}catch(a){}try{var U=await u+await n+"/"+await o+"/"+await l+"/Reports/**/*.json",V=await p.sync(await U);if(await V.length>0){h.TotalNumberofExecutions=await V.length;var B,R=0,J=0;for(let a=0;a<await V.length;a++){var X=await JSON.parse(await i.readFileSync(await V[a],"utf8"));try{var W=await X.totalPass,Y=await X.totalFail;R=await Number(await R)+await W,J=await Number(await J)+await Y}catch(a){}}if(B=Number(await R)+Number(await J),h.OverallScriptExecutionCount=await B,await B>0){var G=100*await(Number(await R)/Number(await B)),Q=await G.toFixed(2);h.PassPercentageInOverallExecution=await Q}}}catch(a){}t.json(h)}),n.get("/project/:projectName/testingtype/:testingtype/env/:envName/executiondate/:executionDate",async(a,t)=>{var e={},r=await d(await a);if(!await r.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=r.errorMessage,t.status=await r.responseCode,t.json(await e);var s=await a.headers.accountlabel,n=a.params.projectName,w=a.params.testingtype,o=a.params.envName,c=a.params.executionDate,l=[];try{var p=await i.readdirSync(u+await s+"/"+n+"/"+w+"/Reports/"+o);for(let a=0;a<await p.length;a++)await p[a].includes(c)&&l.push(await p[a].split("_")[1].replace(".json",""))}catch(a){}t.json(l)}),n.get("/project/:projectName/testingtype/:testingtype/env/:envName/executiondate/:executionDate/executiontime/:executiontime",async(a,t)=>{var e={},r=await d(await a);if(!await r.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=r.errorMessage,t.status=await r.responseCode,t.json(await e);var s=await a.headers.accountlabel,n=a.params.projectName,w=a.params.testingtype,o=a.params.envName,c={},u=a.params.executionDate+"_"+a.params.executiontime+".json";try{var m=await l+await s+"/"+n+"/"+w+"/Reports/"+o+"/*"+u,v=await p.sync(await m);c=await JSON.parse(await i.readFileSync(await v[0]))}catch(a){}t.json(await c)}),n.get("/project/:projectName/testingtype/:testingtype/env/:envName/reportcounter/:counter",async(a,t)=>{var e={},r=await d(await a);if(!await r.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=r.errorMessage,t.status=await r.responseCode,t.json(await e);var s=await a.headers.accountlabel,n={lastResultTotalExecutedScript:0,lastResultPassPercenatage:0,totalPassInXCounter:0,totalFailInXCounter:0,executionHistoryXaxis:[],executionHistoryPassFailData:[],allExecutionTimeData:[],allExecutionDataDayWise:[],allComponnetFailureData:[]},w=a.params.projectName,c=a.params.testingtype,p=a.params.envName,m=Number(a.params.counter),v=0,g=0,h=[],f=[],y=[];try{var b=await o(u+await s+"/"+w+"/"+c+"/Reports/"+p),S=await b[0].file,x=await l+await s+"/"+w+"/"+c+"/Reports/"+p+"/"+S,M=await JSON.parse(await i.readFileSync(await x,"utf8"));n.lastResultTotalExecutedScript=Number(await M.totalPass)+Number(await M.totalFail),n.lastResultPassPercenatage=Number(Number(await M.totalPass)/n.lastResultTotalExecutedScript*100).toFixed(2);for(let a=0;a<await m;a++)try{S=await b[a].file,n.executionHistoryXaxis.push(S.replace(".json","").replace("_"," ")),x=await l+await s+"/"+w+"/"+c+"/Reports/"+p+"/"+S,M=await JSON.parse(await i.readFileSync(await x,"utf8"));var N=Number(await M.totalPass),T=Number(await M.totalFail);v+=N,h.push(await N),g+=T,f.push(await T),y.push(await M.totalExecutionTime),n.allComponnetFailureData.push(await M.componentPassFail[1])}catch(a){}n.executionHistoryXaxis.reverse(),n.totalPassInXCounter=await v,n.totalFailInXCounter=await g,n.executionHistoryPassFailData.push(await h.reverse()),n.executionHistoryPassFailData.push(await f.reverse()),n.allExecutionTimeData.push(await y.reverse())}catch(a){}t.json(n)}),n.get("/project/:projectName/testingtype/:testingtype/env/:envName/executioncounter/:counter",async(a,t)=>{var e={},i=await d(await a);if(!await i.isSuccess)return e.isUserAuthenticated=!1,e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var r=await a.headers.accountlabel,s=a.params.projectName,n=a.params.testingtype,c=a.params.envName,l=a.params.counter,p={},m=await w(Number(l));for(let a=0;a<m.length;a++)p[await m[a]]=0;try{var v=await o(u+await r+"/"+s+"/"+n+"/Reports/"+c);for(let a=0;a<await v.length;a++){let t=await v[a].file.lastIndexOf("-"),e=await v[a].file.substring(t+1);var g=await e.toString().split("_")[0];m.includes(g)&&(p[await g]=Number(p[await g])+1)}}catch(a){}t.json(p)}),a.exports=n},9896:a=>{"use strict";a.exports=require("fs")},9908:(a,t,e)=>{const i=e(7252).Router(),{authCheck:r}=e(2258),{executeApiTestScript:s}=e(645);i.post("/project/:projectName",async(a,t)=>{var e={isSuccess:"Pass",assertionData:[],responseData:{},executiontime:0,errorMessage:""},i=await r(await a);if(!await i.isSuccess)return e.errorMessage=i.errorMessage,t.status=await i.responseCode,t.json(await e);var n=await a.params.projectName,w=await a.body.component,o=await a.headers.accountlabel;await s(await o,await n,await w)}),a.exports=i}},t={};!function e(i){var r=t[i];if(void 0!==r)return r.exports;var s=t[i]={exports:{}};return a[i](s,s.exports,e),s.exports}(6024)})();